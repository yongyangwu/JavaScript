!function(V,W,s){"use strict";function K(){this.el=[1,0,0,0,1,0,0,0,1]}function q(S){var x={};return{get:function(H){if(x[H]!==s)return x[H];var r;switch(H){case"WEBGL_depth_texture":r=S.getExtension("WEBGL_depth_texture")||S.getExtension("MOZ_WEBGL_depth_texture")||S.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=S.getExtension("EXT_texture_filter_anisotropic")||S.getExtension("MOZ_EXT_texture_filter_anisotropic")||S.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=S.getExtension("WEBGL_compressed_texture_s3tc")||S.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=S.getExtension("WEBGL_compressed_texture_pvrtc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":r=S.getExtension("WEBGL_compressed_texture_etc1");break;default:r=S.getExtension(H)}return x[H]=r,r}}}function w(M,i,e){function d(){if(K!==s)return K;var W=i.get("EXT_texture_filter_anisotropic");return K=null!==W?M.getParameter(W.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function W(C){if("highp"===C){if(M.getShaderPrecisionFormat(M.VERTEX_SHADER,M.HIGH_FLOAT).precision>0&&M.getShaderPrecisionFormat(M.FRAGMENT_SHADER,M.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return"mediump"===C&&M.getShaderPrecisionFormat(M.VERTEX_SHADER,M.MEDIUM_FLOAT).precision>0&&M.getShaderPrecisionFormat(M.FRAGMENT_SHADER,M.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var K;e=e||{};var b=e.precision!==s?e.precision:"highp",Q=W(b);Q!==b&&(console.warn("WebGL:",b,"not supported, using",Q,"instead."),b=Q);var c=e.logarithmicDepthBuffer===!0,G=M.getParameter(M.MAX_TEXTURE_IMAGE_UNITS),I=M.getParameter(M.MAX_VERTEX_TEXTURE_IMAGE_UNITS),r=M.getParameter(M.MAX_TEXTURE_SIZE),x=M.getParameter(M.MAX_CUBE_MAP_TEXTURE_SIZE),U=M.getParameter(M.MAX_VERTEX_ATTRIBS),y=M.getParameter(M.MAX_VERTEX_UNIFORM_VECTORS),u=M.getParameter(M.MAX_VARYING_VECTORS),F=M.getParameter(M.MAX_FRAGMENT_UNIFORM_VECTORS),f=I>0,w=!!i.get("OES_texture_float"),R=f&&w;return{getMaxAnisotropy:d,getMaxPrecision:W,precision:b,logarithmicDepthBuffer:c,maxTextures:G,maxVertexTextures:I,maxTextureSize:r,maxCubemapSize:x,maxAttributes:U,maxVertexUniforms:y,maxVaryings:u,maxFragmentUniforms:F,vertexTextures:f,floatFragmentTextures:w,floatVertexTextures:R}}var k="ht";if(!V[k]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),V.performance&&V.performance.now||function(){var a=Date.now();V.performance||(V.performance={}),V.performance.now=function(){return Date.now()-a}}();for(var E=Date.now(),K=16,Y=["ms","moz","webkit","o"],e=0;e<Y.length&&!V.requestAnimationFrame;++e)V.requestAnimationFrame=V[Y[e]+"RequestAnimationFrame"],V.cancelAnimationFrame=V[Y[e]+"CancelAnimationFrame"]||V[Y[e]+"CancelRequestAnimationFrame"];V.requestAnimationFrame||(V.requestAnimationFrame=function(i){var O=Date.now(),q=K+E-O;return 0>q&&(q=0),E=O,V.setTimeout(function(){E=Date.now(),i(performance.now())},q)}),V.cancelAnimationFrame||(V.cancelAnimationFrame=function(T){return V.clearTimeout(T)}),W.assign===s&&(W.assign=function(n){if(n===s||null===n)throw new TypeError("Cannot convert undefined or null to object");for(var m=W(n),G=1;G<arguments.length;G++){var T=arguments[G];if(T!==s&&null!==T)for(var k in T)W.prototype.hasOwnProperty.call(T,k)&&(m[k]=T[k])}return m})}();var t=V.document,N=null,z=V[k]={},u=V[k+"config"],Q=z.Default=u&&u.Default||{},e=z.Style=u&&u.Style||{},v=z.Attr=u&&u.Attr||{},L=z.Color=u&&u.Color||{},P=z.IsGetter=u&&u.IsGetter||{};!function(){var M=!1;try{var m=W.defineProperty({},"passive",{get:function(){M=!0}});V.addEventListener("test",m,m),V.removeEventListener("test",m,m)}catch(K){M=!1}Q.passiveSupported=M}();var x,J,U,A,n=Q.passiveSupported,r=Q.eventListenerOptionsFalse=n?{passive:!1,capture:!1}:!1,B=Q.eventListenerOptionsTrue=n?{passive:!1,capture:!0}:!0,l=Math,O=l.round,S=l.floor,C=l.ceil,F=l.sqrt,E=l.max,h=l.min,c=l.abs,H=l.cos,j=l.acos,R=l.sin,Z=l.pow,M=l.asin,f=l.PI,m=2*f,G=f/2,o=l.tan,_=l.atan2,Y=l.random,g=l.log,T=!0,b=!1,i=V.parseInt||global.parseInt,D="2019-9-30",X=V.navigator?V.navigator.platform.indexOf("Win")>-1:!1,a=function(i){return i*i},p=V.setTimeout,I=V.clearTimeout,$=V.location,d=V.navigator?V.navigator.userAgent.toLowerCase():"",y=function(u){return u.test(d)},es=y(/msie/),pb=y(/msie/)||y(/trident/),xj=y(/msie 10/),sj=y(/edge/),dl=y(/firefox/),Fl=y(/mac/),Ab=Q.isTouchable===s?X?!1:t?"ontouchend"in t:!1:Q.isTouchable,ro="default",gd="single",Tm="multiple",fr="front",ms="back",pc="left",hl="right",_m="top",Jr="bottom",No="center",or="eye",Ui="middle",Mm="east",Gg="west",kc="north",vj="none",Dm="px",Vm="absolute",Lm="border",Jd="triangle",ah="rect",Pd="circle",Sq="cylinder",Ri="shape",Hi="items",Ue="normal",Qp="remove",Nq="clear",lf="width",Gr="height",ip="ingroup",Rh="check",Ar="uncheck",Sk="radio",Hm="radioOn",jd="radioOff",zd="points",Mh="values",mo="series",Pr="body",mb="label",gm="label2",wb="note",Fb="note2",Ej="icons",md="labelFont",Oh="labelColor",Yb="labelSelectColor",Ac="note.expanded",zn="note2.expanded",Bp="edge.expanded",Tr="edge.points",Yl="edge.type",Om="rotation",Qm="hidden",Ti="visible",hd="tuv",yf="no",Di="draw",go="select",ql="currentSubGraph",En="selectBackground",mc="autoMakeVisible",gg="autoHideScrollBar",cl="scrollBarColor",nl="scrollBarSize",Bk="indent",pf="rowHeight",cd="columnLineColor",Si="rowLineColor",Wc="columnLineVisible",Bo="rowLineVisible",Cq="visibleFunc",tj="expandIcon",sc="collapseIcon",of="checkMode",Zi="sortFunc",yh="editable",Oq="batchEditable",jn="tristate",Io="asc",Ik="desc",Jh="position",Se="elevation",vb="children",hq="translateX",yo="translateY",eh="dataModel",vr="maxSize",yn="state",ul="shape3d",er="shape3d.resolution",_h="shape3d.visible",ak="shape3d.from.visible",br="shape3d.to.visible",bl="shape3d.top.visible",Fd="shape3d.bottom.visible",Vl="repeat.uv.length",Mq="serializeValue",ln="deserializeValue",Qo="centerUniform",Po="uniform",We="rgba(255,255,255,0)",ih="style",Fn="attr",Qf="field",yk="string",bk="boolean",Sm="color",Of="int",xe="number",bo="ew-resize",gr="ns-resize",Rc="pointer",Eb="auto",mp="mousedown",rd="mousemove",rn="mouseup",uk="mouseout",Sg="touchstart",hj="touchmove",Bn="touchend",Hh="keydown",il="keyup",Sc=["DOMMouseScroll","mousewheel"],Qd=dl?Sc[0]:Sc[1],ci=Ab?[Sg,hj,Bn,Hh,il,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Hh,il,"keypress","input",mp,rd,rn,uk,Qd,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],bm=N,mg=N,xm=N,hs=rn.length,dn=function(){xm&&(I(xm.timeout),xm=N)},Rk=function(){xm&&Tb(xm.e,xm.info)};V.addEventListener&&(Ab||(V.addEventListener(uk,function(){dn()},r),V.addEventListener(Qd,function(){Fc()},r)),V.addEventListener(il,function(o){91===o.keyCode?Sh={}:delete Sh[o.keyCode]},B),V.addEventListener(Hh,function(u){Sh[u.keyCode]=!0},B),V.addEventListener("blur",function(){Sh={}},r));var lo,Pe,Yo,$g=0,jf=N,Nr=function(C,s){var P=p(function(){delete jf[P],Uo(jf)&&(jf=N),C()},s);return P},Lb=N,Mk=N,Dg={},Fi={},km={},Eg={},Oi={},Sh={},Uc={},Zn={},bh={},ae={},kj=/.json$/,nk=/^data:image\/svg\+xml/,rh={},ob=[],Ee={},io=N,Er=N,Yq=function(){},jh=function(){throw"Oops!"},hb=[0,0,0],nj={x:0,y:0,width:0,height:0},em=N,vp=N,ok=N,wn=function(c,M){Fi[c]=M,M&&M.comps&&!M.uuid&&(M.uuid=z.Math.generateUUID()),Fg[c]&&(M.cacheRule=Fg[c],delete Fg[c])},xn=function(k){vp&&!k._72O&&(ok||(ok={}),ok[k._72O=Zb()]=k),lo!=N?Ce()<.05&&A&&!Pe&&(yq=dn):yq=jm},Uq=function(R,E,f,c){vp||(vp={});var u=vp[R];if(u){if(u.url===E)return;u.image?(u.image.onload=Yq,u.image.onerror=Yq):u.request&&(u.request.onload=Yq,u.request.onerror=Yq)}if(kj.test(E)){var Z=new lr;if(vp[R]={request:Z,url:E},E=Q.beforeLoadURL(E),E.data){var j=Q.parse(E.data);js(R,j),Q.handleImageLoaded(R,j)}else{Z.onload=function(){if(200===this.status||0===this.status){var b=Q.parse(Z.getResponseText());js(R,b),Q.handleImageLoaded(R,b)}else js(R,Q.handleUnfoundImage(R,E)||N)},Z.onerror=function(){js(R,Q.handleUnfoundImage(R,E)||N)};var k={};k.url=encodeURI(E),k.sync=!1,Z.send(k)}}else{var j=new Image;vp[R]={image:j,url:E},/^data:image/.test(E)||(E=Q.beforeLoadURL(E),E=Q.appendTimeStamp(E),E=encodeURI(E),j.crossOrigin=Q.crossOrigin),Q.convertImageSrc(E,function(J){pb&&(E.toLowerCase().indexOf(".svg")>0||nk.test(E))?(t.body.appendChild(j),j.style.visibility="hidden",j.onload=function(){p(function(){if(f&&(j.width=f),c&&(j.height=c),!j.width||!j.height){var L=j.width||j.clientWidth,z=j.height||j.clientHeight;j.width=L,j.height=z}Q.handleImageLoaded(R,j),js(R,j),t.body.removeChild(j),j.style.visibility=""},180)},j.onerror=function(){js(R,Q.handleUnfoundImage(R,E)||N),t.body.removeChild(j),j.style.visibility=""}):(j.onload=function(){f&&(j.width=f),c&&(j.height=c),Q.handleImageLoaded(R,j),js(R,j)},j.onerror=function(){js(R,Q.handleUnfoundImage(R,E)||N)}),j.src=J})}},js=function(b,d){if(wn(b,d),delete vp[b],Uo(vp)&&(vp=N,ok)){for(var a in ok){var T=ok[a];T._2O&&T._2O[b]&&(T.deleteTexture(b),delete T._2O[b]),T.invalidateAll&&T.invalidateAll(s,"imageLoaded",b),T.redraw&&T.redraw(),T.iv(),delete T._72O}ok=N}if(d&&ok)for(var a in ok){var T=ok[a];T.invalidateAll&&T.invalidateAll(s,"imageLoading",b),T.redraw&&T.redraw(),T.iv()}},gs=function(){return g=l&&Date,function(){return V.performance&&V.performance.now?V.performance.now():Date.now()}}(),ss=function(S,C){C?I(S):V.cancelAnimationFrame(S)},Ol=function(Q,p,X){return{width:Q,height:p,comps:pi(X)?X:[X]}},Th=function(Y,K){return{type:Pd,rect:[Y,K,1.6,1.6],borderWidth:1,borderColor:tg,gradient:pq,gradientColor:Vo,background:tg}},ti=function(T,c){return Ol(16,16,{type:Jd,rect:[4,4,10,8],background:T,rotation:c?1.57:3.14})},me=function(B,Y){return Ol(16,16,{type:Jd,rect:[4,4,8,7],background:B,rotation:Y?3.14:0})},Le=function(P){var o=P._orientation;return"horizontal"===o||"h"===o},Xq=function(I,y){var E=N||4,U=N||1,O=N||1;0>E?E=0:E>.25&&(E=.25);var k,n,l,A,T,G,W,p=.5,z=[],v=[],Q=[],u=m/O,j=m/U,g=p-E;for(n=0;U>=n;n++)for(A=-f+n*j,G=H(A),T=R(A),k=0;O>=k;k++)l=k*u,W=g+E*G,z.push(H(l)*W,T*E,-R(l)*W),(J=[I,y])&&v.push(k/O,1-n/U);for(n=0;U>n;n++){var s=n*(O+1),r=(n+1)*(O+1);for(k=0;O>k;k++)Q.push(s+k,r+k+1,r+k,s+k,s+k+1,r+k+1),wc.z=Um.z=[I,y]}},ys=function(f){var N=2,p=0;for(var x in f)x.length===N&&i(x,32)===ef&&(io=Er=f[x]),p++;return p},pl=function(D,R,P,l){return P||(P=Ab?5:3,P/=l||1),{x:D-P,y:R-P,width:2*P,height:2*P}},ll=function(O,l,j,R){var p=this;l||(l=Ab?5:3,j=20,R=20);var b={x:O,y:l,width:j,height:R};if(j)for(var h=0;j>h;h++)if(3===j)R=20;else for(var z=0;R>z;z++)p=V?V:j;var i={x:f,y:2*f};if(Fr(b,i)){var B=Gr[0]+_m[0]+Nq[1]+Io.length,I=Qm[0]+jn[0]+Nq[1]+Pr.length;Sf[or]=[p[B],p[I]],p[B]=ar[or],p[I]=ar[ul]}},bg=function(t){return(/ble$/.test(t)||/ed$/.test(t)||P[t]?"is":"get")+t.charAt(0).toUpperCase()+t.slice(1)},ar=function(s){return"set"+s.charAt(0).toUpperCase()+s.slice(1)},fh=function(j){return typeof j===yk||j instanceof String},vg=function(s){return typeof s===xe},jm=function(W){return typeof W===bk},yp=function(D){return D&&"object"==typeof D},Wp=function(W){return"function"==typeof W},pi=function(G){return G instanceof Array},Cg=function(n){return n instanceof cb},Dr=function(c){return pi(c)?new cb(c):c},wg=function(W){return W instanceof Bj},Wg=function(s){return s instanceof pg},tm=function(m){return m instanceof zk},Bg=function(l,Q){if(!(l instanceof z.Group))return!1;if(!Q)return l.isExpanded();var k=Q.getDataUI(l);return k&&k._88I?!0:!1},Tg=function(T){return T instanceof Xh},Hq=function(e){return e&&"IFRAME"===e.tagName},_o=function(b){return b==N||Q.numberDigits==N?b:parseFloat(b.toFixed(Q.numberDigits))},Kb=function(O,_,T){var $,S=_.length;if(T)for(var i=0;T>i;i++)if(3===S)O.push(_[0]),O.push(_[1]),O.push(_[2]);else for($=0;S>$;$++)O.push(_[$]);else if(3===S)O.push(_[0]),O.push(_[1]),O.push(_[2]);else for($=0;S>$;$++)O.push(_[$])},Xg=function(e){return e?yp(e)?e:{}:!1},Vp=function(w,K,j){var n,N=yp(w)?w:w.prototype;for(n in K)j&&n in N?N[n]===s&&console.warn("class",N,"has own undefined property",n,", keep exist!"):N[n]=K[n];return w},Go=function(K){return String.fromCharCode(K)},Bm=function(K){for(var S,Q=0,z="";Q<K.length;Q++)S=K[K.length-1-Q],"%"===S?S="'":"a"===S?S='"':"]"===S&&(S="\\"),z+=Go(S.charCodeAt(0)-1);return z},oj=function(T,l,r){T.superClass.constructor.apply(l,r)},Uo=function(d){for(var r in d)return!1;return!0},Wl=function(y){return y?0===y.length:!0},ve=function(){var d="";return[Ar[0],Si[0],mb[0]].forEach(function(W){d+=ar(W).slice(3)}),Po=t&&t[d]||Qo,function(q,Z){return q===Z?!0:q.x===Z.x&&q.y===Z.y&&q.width===Z.width&&q.height===Z.height}}(),rj=function(X,O,V){return O>X?O:X>V?V:X},ps=function(q){return 0>q?-1:q>0?1:0},Ce=function(){var e=1e4*R(hs++);return e-S(e)},Fe=function(L,k,S){return jo(L.x,L.y,k.x,k.y,S.x,S.y,S.x+S.width,S.y,!0)||jo(L.x,L.y,k.x,k.y,S.x+S.width,S.y,S.x+S.width,S.y+S.height,!0)||jo(L.x,L.y,k.x,k.y,S.x+S.width,S.y+S.height,S.x,S.y+S.height,!0)||jo(L.x,L.y,k.x,k.y,S.x,S.y+S.height,S.x,S.y,!0)},jo=function(v,n,g,G,I,U,x,t,P){var H=(x-I)*(n-U)-(t-U)*(v-I),M=(t-U)*(g-v)-(x-I)*(G-n);if(0!==M){var z=H/M,r=v+z*(g-v),F=n+z*(G-n);return P&&(r+hi<h(v,g)||r-hi>E(v,g)||r+hi<h(I,x)||r-hi>E(I,x)||F+hi<h(n,G)||F-hi>E(n,G)||F+hi<h(U,t)||F-hi>E(U,t))?N:[r,F]}return N},od=function(e,O,w){if(e&&w)if(O){if(O===ih)return e.getStyle(w);if(O===Fn)return e.getAttr(w);if(O===Qf)return e[w]}else if(w=bg(w),e[w])return e[w]();return s},Pc=function(n,e,K,u){if(n&&K)if(e){if(e===ih)n.s(K,u);else if(e===Fn)n.a(K,u);else if(e===Qf){var p=n[K];n[K]=u,n.fp("f:"+K,p,u)}}else K=ar(K),n[K]&&n[K](u)},Ml=function(r,L,T){return L&&"top"!==L?"bottom"===L?{x:r.x,y:r.y,width:r.width,height:r.height*T}:"right"===L?{x:r.x,y:r.y,width:r.width*T,height:r.height}:"left"===L?{x:r.x+r.width*(1-T),y:r.y,width:r.width*T,height:r.height}:void 0:{x:r.x,y:r.y+r.height*(1-T),width:r.width,height:r.height*T}},Zj=function(v,x,r,E,h){x&&Re(v,r,E,1,h,x)},bi=function(y,C,D,F){var e=1-y;return e*e*C+2*y*e*D+y*y*F},wc=function(P,b,K,G,B){var M=1-P;return M*M*M*b+3*M*M*P*K+3*M*P*P*G+P*P*P*B},Ag=function(P){var l,T,O,M,E=0;return P.forEach(function(d){if(l=d.length,l>0)for(T=d[0],M=1;l>M;M++)O=d[M],E+=Df(T,O),T=O}),E},rs=function(G,M,F){var l="__"+G,Y=function(b){F.disabled||F["handle_"+G](b)};F[l]||(F[l]=Y,M.addEventListener(G,Y,r))},An=function(I,U,b){var w="__"+I,A=b[w];A&&(U.removeEventListener(I,A,r),delete b[w])},uh=function(z,w){var f="_"+w;z[bg(w)]=function(){return this[f]},z[ar(w)]=function(M){var H=this[f];this[f]=M,this.fp(w,H,M)}},El=function(y){return W.create(y)},Ur=function(D){if(!D.element){var Z,d;(Z=D.textField)?d=Ii(Ie.TextField,Z):(Z=D.textArea)?d=Ii(Ie.TextArea,Z):(Z=D.button)?d=Ii(Ie.Button,Z):(Z=D.comboBox)?d=Ii(Ie.ComboBox,Z):(Z=D.checkBox)?d=Ii(Ie.CheckBox,Z):(Z=D.radioButton)?d=Ii(Ie.RadioButton,Z):(Z=D.slider)?d=Ii(Ie.Slider,Z):(Z=D.colorPicker)?d=Ii(Ie.ColorPicker,Z):(Z=D.image)&&(d=Ii(Ie.Image,Z)),d&&(D.element=d)}},ge=function(p,v){var j=ko(p);return j._ht=v,j},ko=function(C,l){var o=t.createElement("div"),i=o.style;return o.tabIndex=-1,o.onkeydown=dc,i.msTouchAction=vj,Hn(o,N,0),Ab&&i.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",N),C&&(i.overflow=Qm),l&&Mo(l,o),o},Wq=function(A,W){var V=t.createElement("canvas"),K=V.style;return K.msTouchAction=vj,W||(K.pointerEvents=vj),Hn(V,N,0),A&&Mo(A,V),V},Hn=function(w,m,q){var O=w.style;O.border=m?m+" solid 1px":0,O.outline=0,O.padding=q?"0 "+q+Dm:0,Kh(w)},Kh=function(v){var l=v.style;l.position=Vm,l.margin=0,l.setProperty("box-sizing","border-box",N),l.setProperty("-moz-box-sizing","border-box",N)},Rj=function(o,x,z,O){O||(O=sn),x!=N&&(o.width=x*O,o.style.width=x+Dm),z!=N&&(o.height=z*O,o.style.height=z+Dm)},Mo=function(J,p,I){J.appendChild(p),I&&(p.style.position=Vm)},gl=function(j,B){B.split||(B+="");for(var O,K=B.split("\n"),H=0,i=K.length,a=0;i>a;a++){var J=Tn(j.font,K[a]);J.width>H&&(H=J.width),O||(O=J.height)}return j.ss=K,{width:H,height:O*i}},Yp=function(J,D,X,H,b,h){var t=D.length;if(1===t)Lr(J,D[0],X,H,b);else for(var L=X.height/t,E={x:X.x,y:X.y,width:X.width,height:L},w=0;w<D.length;w++)h?Xn(J,D[w],H,b,E.x,E.y,E.width,E.height,h):Lr(J,D[w],E,H,b),E.y+=L},Lr=function(K,a,g,j,p){K.font=j?j:wi,K.fillStyle=p?p:tl,K.textAlign=No,K.textBaseline=Ui;var U,C;g?g.width===s?(U=g.x,C=g.y):(U=g.x+g.width/2,C=g.y+g.height/2):(U=0,C=0),K.fillText(a,O(U),O(C))},dd=function(Y){Y.getView&&(Y=Y.getView());var f=Y.offsetWidth||Y.scrollWidth;return!f&&Y.style.width&&(f=i(Y.style.width)),f},Ir=function(f){f.getView&&(f=f.getView());var M=f.offsetHeight||f.scrollHeight;return!M&&f.style.height&&(M=i(f.style.height)),M},fm=function(O,c,Z){var j=c[0].toUpperCase()+c.substring(1,c.length);O["webkit"+j]=Z,O["moz"+j]=Z,O["ms"+j]=Z,O["o"+j]=Z,O[c]=Z},Te=function(){var g=function(D){dc(D),D.stopPropagation()},F=function(t){dc(t)},Y=Ab?[Sg]:[Hh,mp];return function(e,A){var W=ko(),V=W.style;return V.backgroundColor=Q.disabledBackground,e&&(V.backgroundImage="url("+e+")",V.backgroundPosition="50% 50%",V.backgroundRepeat="no-repeat no-repeat"),A===!1?Y.forEach(function(A){W.addEventListener(A,F,r)}):Y.forEach(function(K){W.addEventListener(K,g,r)}),W}}(),Lq=function(W){var F=W.getContext("2d");return F.save(),F.lineCap=ng,F.lineJoin=yd,F},yq=function(I,K,u,y){lj(I,K*sn,u*sn),y*=sn,1!==y&&I.scale(y,y)},lj=function(l,C,O){l.translate(C,O)},ne=function(D,g){g&&D.rotate(g)},Xl=function(y,I,o){I===s&&(I=1),o===s&&(o=1),(1!==I||1!==o)&&y.scale(I,o)},uo=!1,xg=function(y){var k=t.activeElement;if(t.activeElement!==y){k&&k.forceOnblur&&k.forceOnblur();for(var A=[],b=y.parentNode;b;)A.push([b,b.scrollLeft,b.scrollTop]),b=b.parentNode;if(!uo){var c=[],i=[];try{for(var L=V.parent,C=V;L!==C;)c.push([L,L.scrollX,L.scrollY]),C=L,L=V.parent;var w=V.frameElement;if(w)for(var $=w.parentNode;$;)i.push([$,$.scrollLeft,$.scrollTop]),$=$.parentNode}catch(q){uo=!0}}if(Ab)y.focus();else{var o=Ao(),Q=o.target;y.focus(),Q.scrollLeft=o.left,Q.scrollTop=o.top}A.forEach(function(F){F[0].scrollLeft=F[1],F[0].scrollTop=F[2]}),uo||(c.forEach(function(R){R[0].scrollTo(R[1],R[2])}),i.forEach(function(L){L[0].scrollLeft=L[1],L[0].scrollTop=L[2]}))}},oh=function(P){return P&&P.getView?P.getView():P},Zd=function(l,x,R,c,w){if(2===arguments.length&&(R=x.y,c=x.width,w=x.height,x=x.x),l.isSelfViewEvent)l.setX(x),l.setY(R),l.setWidth(c),l.setHeight(w);else{var S=oh(l),n=S.style;if((t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)!==S)x!==s&&(n.left=x+Dm),R!==s&&(n.top=R+Dm),c!==s&&(n.width=c+Dm),w!==s&&(n.height=w+Dm);else{var G=Q.getWindowInfo();n.left=(x=G.left)+Dm,n.top=(R=G.top)+Dm,n.width=(c=G.width)+Dm,n.height=(w=G.height)+Dm}l.endEditing&&!Ab&&l.endEditing(),l.redraw&&l.redraw(),l.invalidate&&l.invalidate(),l.onLayouted&&l.onLayouted(x,R,c,w),l.fireViewEvent&&l.fireViewEvent("layout")}},Yc=function(U){if(!U.touches)return U;var u=U.touches[0];return u?u:U.changedTouches[0]},oi=function(o){return Ab?Yc(o).target:o.target},Ud=function(c){Q.popup&&Q.popup.close(),Q.popup=c},Xe=N,tn=function(l){Xe.handleWindowTouchMove(l)},Wb=function(x){Xe.handleWindowTouchEnd(x),V.removeEventListener(hj,tn,r),V.removeEventListener(Bn,Wb,r),Xe=N},Gn=function(N){Xe.handleWindowMouseMove(N)},um=function(G){Xe.handleWindowMouseUp(G),V.removeEventListener(rd,Gn,r),V.removeEventListener(rn,um,r),Xe=N},dm=function(T){return 1===qh(T)},Al=function(d,M){return M?M.keyCode===d:Sh[d]},In=function(W){return Vi(W)&&Al(65,W)},te=function(n){return Al(46,n)||Al(8,n)},Jm=function(y){return function(A){return A?A.keyCode===y:Sh[y]}},ef=573,Ad=[65,83,68,87,37,38,39,40,32,13,27],Lk=Jm(Ad[0]),$p=Jm(Ad[1]),co=Jm(Ad[2]),lm=Jm(Ad[3]),id=Jm(Ad[4]),Mg=Jm(Ad[5]),$q=Jm(Ad[6]),Yk=Jm(Ad[7]),$n=Jm(Ad[8]),ab=Jm(Ad[9]),$i=Jm(Ad[10]),sg={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},ho=[2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,27253],Vc=N,ye=N,Mn=function(B,K){Vc||(Vc=Wq()),Rj(Vc,B,K,1);var o=Lq(Vc);return o.clearRect(0,0,B,K),o},Yr=function(){var i,P={};for(var E in V){var l=Tm.length;if(E.length==l&&E[0]===Tm[2]&&E[1]===vj[1]&&E[4]===Tm[3]&&E[5]===Tm[4]&&E.substr(l-2)===vj[1]+vj[2]){var s=V[E];for(var Q in s)Q.length===l&&Q.substr(0,3)===hl[3]+Qp[3]+go[0]&&Q.substr(l-2)===Tm[0]+wb[3]&&(Sc=s[Q])}}return function(c){var A,u=P[c];return u||(i||(i=Wq(),Rj(i,1,1,1)),A=i.getContext("2d"),A.clearRect(0,0,1,1),Re(A,0,0,1,1,c),u=A.getImageData(0,0,1,1).data,u=P[c]=[u[0],u[1],u[2],u[3]]),u}}(),Sd=function(r){if(!fh(r))return r;var v=Yr(r);return v.CA||(v.CA=[v[0]/255,v[1]/255,v[2]/255,v[3]/255]),v.CA},Uh=function(k,M,U,P,E){var t=Wq();t.width=U,t.height=P;var J=t.getContext("2d");J.drawImage(k,0,0,U,P);try{for(var c=J.getImageData(0,0,U,P),V=c.data,S=0,n=V.length;n>S;S+=4){var z=V[S+0],L=V[S+1],O=V[S+2],N=V[S+3];"override_a"===E?V[S+3]=255*M[3]:"override_rgb"===E?(V[S+0]=255*M[0],V[S+1]=255*M[1],V[S+2]=255*M[2]):"override"===E?(V[S+0]=255*M[0],V[S+1]=255*M[1],V[S+2]=255*M[2],V[S+3]=255*M[3]):(V[S+0]=M[0]*z,V[S+1]=M[1]*L,V[S+2]=M[2]*O,V[S+3]=M[3]*N)}J.putImageData(c,0,0)}catch(f){return k}return t},Sf=function(c,n,b){return n&&(n="miter"===b?8*n+20:n+1,c&&Jg(c,n)),n},kh=function(g,N){if(N){var y=new Vd(N),X=g.width/2,I=g.height/2,R=Mp([y.tf(-X,-I),y.tf(X,-I),y.tf(X,I),y.tf(-X,I)]);return R.x+=g.x+X,R.y+=g.y+I,R}return g},Nl=function(K,D,X,C,S,h,T,c){C*=Math.PI/180;var W={x:Math.cos(C)*(K.x-T.x)/2+Math.sin(C)*(K.y-T.y)/2,y:-Math.sin(C)*(K.x-T.x)/2+Math.cos(C)*(K.y-T.y)/2},f=Math.pow(W.x,2)/Math.pow(D,2)+Math.pow(W.y,2)/Math.pow(X,2);f>1&&(D*=Math.sqrt(f),X*=Math.sqrt(f));var G=(S==h?-1:1)*Math.sqrt((Math.pow(D,2)*Math.pow(X,2)-Math.pow(D,2)*Math.pow(W.y,2)-Math.pow(X,2)*Math.pow(W.x,2))/(Math.pow(D,2)*Math.pow(W.y,2)+Math.pow(X,2)*Math.pow(W.x,2)));isNaN(G)&&(G=0);var q={x:G*D*W.y/X,y:G*-X*W.x/D},n={x:(K.x+T.x)/2+Math.cos(C)*q.x-Math.sin(C)*q.y,y:(K.y+T.y)/2+Math.sin(C)*q.x+Math.cos(C)*q.y},Y=function(S){return Math.sqrt(Math.pow(S[0],2)+Math.pow(S[1],2))},v=function(C,Q){return(C[0]*Q[0]+C[1]*Q[1])/(Y(C)*Y(Q))},k=function(i,p){return(i[0]*p[1]<i[1]*p[0]?-1:1)*Math.acos(v(i,p))},s=k([1,0],[(W.x-q.x)/D,(W.y-q.y)/X]),L=[(W.x-q.x)/D,(W.y-q.y)/X],B=[(-W.x-q.x)/D,(-W.y-q.y)/X],O=k(L,B);v(L,B)<=-1&&(O=Math.PI),v(L,B)>=1&&(O=0);var v=D>X?D:X,Q=D>X?1:D/X,F=D>X?X/D:1;if(null==c){var A={x:0,y:0,width:0,height:0};Jg(A,v),A.x*=Q,A.width*=Q,A.y*=F,A.height*=F;var o=new Vd(C);return A=Mp([o.tf(A.x,A.y),o.tf(A.x+A.width,A.y),o.tf(A.x+A.width,A.y+A.height),o.tf(A.x,A.y+A.height)]),A.x+=n.x,A.y+=n.y,[{x:A.x,y:A.y},{x:A.x+A.width,y:A.y},{x:A.x+A.width,y:A.y+A.height},{x:A.x,y:A.y+A.height}]}c.translate(n.x,n.y),c.rotate(C),c.scale(Q,F),c.arc(0,0,v,s,s+O,1-h),c.scale(1/Q,1/F),c.rotate(-C),c.translate(-n.x,-n.y)},Nk=function(G,O){G&&G.beginPath();for(var C,l,L,Y=[],F=function(c){for(var w,$=/(\-{0,1}[\d\.]+)/gi,Q=[];w=$.exec(c);)Q.push(parseFloat(w[0]));return Q},T=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,h={x:0,y:0};C=T.exec(O);){var R=C[0],e=R.substr(0,1);if("M"===e||"m"===e){for(var c=F(R),r=0;r<c.length;r+=2){var m=c[r],a=c[r+1];"m"===e&&(m+=h.x,a+=h.y),G&&G.moveTo(m,a),Y.push({x:m,y:a}),h.x=m,h.y=a}l=L=null}else if("H"===e||"h"===e){for(var c=F(R),r=0;r<c.length;r+=1){var m=c[r];"h"===e&&(m+=h.x),G&&G.lineTo(m,h.y),Y.push({x:m,y:h.y}),h.x=m}l=L=null}else if("C"===e||"c"===e){for(var c=F(R),r=0;r<c.length;r+=6){var d=c[r],X=c[r+1],j=c[r+2],I=c[r+3],m=c[r+4],a=c[r+5];"c"===e&&(d+=h.x,X+=h.y,j+=h.x,I+=h.y,m+=h.x,a+=h.y),G&&G.bezierCurveTo(d,X,j,I,m,a),Y.push({x:d,y:X}),Y.push({x:j,y:I}),Y.push({x:m,y:a}),h.x=m,h.y=a}l=[d,X,j,I,m,a],L=null}else if("S"===e||"s"===e){for(var c=F(R),r=0;r<c.length;r+=4){var d,X;l?(d=2*l[4]-l[2],X=2*l[5]-l[3]):(d=h.x,X=h.y);var j=c[r],I=c[r+1],m=c[r+2],a=c[r+3];"s"===e&&(j+=h.x,I+=h.y,m+=h.x,a+=h.y),G&&G.bezierCurveTo(d,X,j,I,m,a),Y.push({x:d,y:X}),Y.push({x:j,y:I}),Y.push({x:m,y:a}),h.x=m,h.y=a}l=[d,X,j,I,m,a],L=null}else if("Q"===e||"q"===e){for(var c=F(R),r=0;r<c.length;r+=4){var d=c[r],X=c[r+1],m=c[r+2],a=c[r+3];"q"===e&&(d+=h.x,X+=h.y,m+=h.x,a+=h.y),G&&G.quadraticCurveTo(d,X,m,a),Y.push({x:d,y:X}),Y.push({x:m,y:a}),h.x=m,h.y=a}l=null,L=[d,X,m,a]}else if("T"===e||"t"===e){for(var c=F(R),r=0;r<c.length;r+=2){var d,X;L?(d=2*L[2]-L[0],X=2*L[3]-L[1]):(d=h.x,X=h.y);var m=c[r],a=c[r+1];"t"===e&&(m+=h.x,a+=h.y),G&&G.quadraticCurveTo(d,X,m,a),Y.push({x:d,y:X}),Y.push({x:m,y:a}),h.x=m,h.y=a}l=null,L=[d,X,m,a]}else if("V"===e||"v"===e){for(var c=F(R),r=0;r<c.length;r+=1){var a=c[r];"v"===e&&(a+=h.y),G&&G.lineTo(h.x,a),Y.push({x:h.x,y:a}),h.y=a}l=L=null}else if("L"===e||"l"===e){for(var c=F(R),r=0;r<c.length;r+=2){var m=c[r],a=c[r+1];"l"===e&&(m+=h.x,a+=h.y),G&&G.lineTo(m,a),Y.push({x:m,y:a}),h.x=m,h.y=a}l=L=null}else if("A"===e||"a"===e){for(var c=F(R),r=0;r<c.length;r+=7){var s=c[r],b=c[r+1],w=c[r+2],J=c[r+3],t=c[r+4],m=c[r+5],a=c[r+6];"a"===e&&(m+=h.x,a+=h.y);var E=Nl(h,s,b,w,J,t,{x:m,y:a},G);E&&(Y=Y.concat(E)),h.x=m,h.y=a}l=L=null}var U=R.substr(R.length-1);("z"===U||"Z"===U)&&G&&G.closePath()}return Y},ld=function(v,l){var m,N,a="L"===l[0],W=l.length;v.save(),a?(v.transform(l[5],l[6],l[7],l[8],l[9],l[10]),m=v.createLinearGradient(l[1],l[2],l[3],l[4]),N=11):(v.transform(l[7],l[8],l[9],l[10],l[11],l[12]),m=v.createRadialGradient(l[1],l[2],l[3],l[4],l[5],l[6]),N=13);for(var V=v.compGray;W>N;)m.addColorStop(l[N],V?Q.toGrayColor(l[N+1]):l[N+1]),N+=2;v.fillStyle=m},Um=function(b,z){var Q=b.s("shape.gradient.pack");if(Q){for(var P=Q.length,y=new Array(P),H=0;P>H;H++)y[H]=Q[H];var Y,k,S,C,g,G,Z,o,r,U,m,X,d,M="L"===y[0];Y=M?5:7,k=y[Y],S=y[Y+1],C=y[Y+2],g=y[Y+3],G=y[Y+4],Z=y[Y+5],o=z[0],r=z[1],U=z[2],m=z[3],X=z[4],d=z[5],y[Y]=o*k+U*S,y[Y+1]=r*k+m*S,y[Y+2]=o*C+U*g,y[Y+3]=r*C+m*g,y[Y+4]=o*G+U*Z+X,y[Y+5]=r*G+m*Z+d,b.s("shape.gradient.pack",y)}},eo=function(L,T,x,A){var p=!1;if(L.beginPath?L.beginPath():p=!0,Cg(T)&&(T=T._as),Cg(x)&&(x=x._as),x&&x.length){for(var W,v,V,i,n=0,N=0,H=x.length;H>N;N++)W=x[N],1===W?(v=T[n++],L.moveTo(v.x,p?-v.y:v.y)):2===W?(v=T[n++],L.lineTo(v.x,p?-v.y:v.y)):3===W?(v=T[n++],V=T[n++],L.quadraticCurveTo(v.x,p?-v.y:v.y,V.x,p?-V.y:V.y)):4===W?(v=T[n++],V=T[n++],i=T[n++],L.bezierCurveTo(v.x,p?-v.y:v.y,V.x,p?-V.y:V.y,i.x,p?-i.y:i.y)):5===W&&L.closePath();A&&5!==W&&L.closePath()}else{var C,e,q,Z=T.length;if(Z>0){for(C=T[0],L.moveTo(C.x,p?-C.y:C.y),e=1;Z>e;e++)q=T[e],L.lineTo(q.x,p?-q.y:q.y);A&&L.closePath()}}},$l=function(U,R,f,r){if(Cg(U)&&(U=U._as),Cg(R)&&(R=R._as),R&&R.length){f=f||zj;for(var I,A,t,o,j,G,y,F,K=[],S=N,u=0,p=0,d=R.length;d>p;p++)if(I=R[p],1===I)K.push(S=[]),S.push(U[u++]);else if(2===I)S.push(U[u++]);else if(3===I){for(A=S[S.length-1],t=U[u++],o=U[u++],G=1;f>G;G++)y=bi(G/f,A.x,t.x,o.x),F=bi(G/f,A.y,t.y,o.y),S.push({x:y,y:F,b:!0});S.push(o)}else if(4===I){for(A=S[S.length-1],t=U[u++],o=U[u++],j=U[u++],G=1;f>G;G++)y=wc(G/f,A.x,t.x,o.x,j.x),F=wc(G/f,A.y,t.y,o.y,j.y),S.push({x:y,y:F,b:!0});S.push(j)}else 5===I&&S.push(S[0]);return r&&5!==I&&S&&S.length>2&&S.push(S[0]),K}return r&&U.length>2&&(U=U.slice(),U.push(U[0])),U?[U]:[]},Hj=function(t,S,f,j,N,J){var L,R,E,Z=Yr(S),d=j,D=Z[0],w=Z[1],e=Z[2];if(f){var a=Yr(f);L=a[0]-D,R=a[1]-w,E=a[2]-e}else L=255-D,R=255-w,E=255-e;for(J||(J=j>10?1:.5,J=1>N?h(J/N,2):J),t.save(),t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor=0;(j-=J)>0;){var $=1-j/d,o=D+L*$,q=w+R*$,H=e+E*$;o=h(C(o),255),q=h(C(q),255),H=h(C(H),255),t.strokeStyle="rgb("+o+","+q+","+H+")",t.lineWidth=j,t.stroke()}t.restore()},ur=function(){var D={};return function(I,n){var j=I+"-"+n,A=D[j];if(A)return A;var i,l,Z,F=Yr(I);return 0>n?(n=(100+n)/100,i=C(F[0]*n),l=C(F[1]*n),Z=C(F[2]*n)):(n/=100,i=F[0],l=F[1],Z=F[2],i+=(255-i)*n,l+=(255-l)*n,Z+=(255-Z)*n,i=h(C(i),255),l=h(C(l),255),Z=h(C(Z),255)),D[j]="rgb("+i+","+l+","+Z+")"}}(),Re=function(r,$,U,n,l,E){E&&(r.fillStyle=E),r.beginPath(),r.rect($,U,n,l),r.fill()},Wn=function(l,B,q,M,n,T,G){l.beginPath(),Fo[B](l,q.x,q.y,q.width,q.height,M,n,T,G)},Lp=function(I,l,m,u,o){var R=Fo[m];I.fillStyle=R?R(I,l,u?u:Vo,o.x,o.y,o.width,o.height):l},ed=function(U,l,B,g,q,t){try{if(!l.tagName&&l.comps){l._cacheImage_||(l._cacheImage_={});var d;d="override"===g?"colors_override":"override_rgb"===g?"colors_override_rgb":"override_a"===g?"colors_override_a":"colors",l._cacheImage_[d]||(l._cacheImage_[d]={__count__:0});var I=l._cacheImage_[d][B];I||(l._cacheImage_[d].__count__>Q.imageCacheThreshold&&(l._cacheImage_[d]={__count__:0}),I=z.Default.toCanvas(l,Uj(l),dg(l),null,q,t,B,null,g),l._cacheImage_[d][B]=I,l._cacheImage_[d].__count__++),l=I}U.fillStyle=U.createPattern(l,"repeat")}catch(y){U.fillStyle="black"}},Nd=function(k,h,a,m,v,u,S){k.save(),k.translate(h,a),k.scale(1,S/u),k.arc(0,0,u,m,v),k.restore()},Wi=function(s,v,x,e,Q,D,g,r){var N,u,j,m,w,I,A,U,n,J,E;if(c(Q)>2*f&&(Q=2*f),w=C(c(Q)/(f/4)),N=Q/w,u=-N,j=-e,w>0){I=v+H(e)*D,A=x+R(-e)*g,r?s.lineTo(I,A):s.moveTo(I,A);for(var q=0;w>q;q++)j+=u,m=j-u/2,U=v+H(j)*D,n=x+R(j)*g,J=v+H(m)*(D/H(u/2)),E=x+R(m)*(g/H(u/2)),s.quadraticCurveTo(J,E,U,n)}},rb=function(j,S,C,f,Y,n,h,i,H){6===arguments.length&&(h=n,i=n,H=n);var p=S+f,a=C+Y,A=Y>f?2*f:2*Y;n=A>n?n:A,h=A>h?h:A,i=A>i?i:A,H=A>H?H:A;var P=.29*H,x=.58*H;j.moveTo(p,a-H),j.quadraticCurveTo(p,a-x,p-P,a-P),j.quadraticCurveTo(p-x,a,p-H,a),P=.29*i,x=.58*i,j.lineTo(S+i,a),j.quadraticCurveTo(S+x,a,S+P,a-P),j.quadraticCurveTo(S,a-x,S,a-i),P=.29*n,x=.58*n,j.lineTo(S,C+n),j.quadraticCurveTo(S,C+x,S+P,C+P),j.quadraticCurveTo(S+x,C,S+n,C),P=.29*h,x=.58*h,j.lineTo(p-h,C),j.quadraticCurveTo(p-x,C,p-P,C+P),j.quadraticCurveTo(p,C+x,p,C+h),j.lineTo(p,a-H)},Tj=function(Q,W,J,x,T,t,k){W&&(J=O(J),x=O(x),k||(k=1),Q.fillStyle=W,Q.beginPath(),Q.rect(J,x,k,t),Q.rect(J,x,T,k),t-k>0&&Q.rect(J,x+t-k,T,k),T-k>0&&Q.rect(J+T-k,x,k,t),Q.fill())},vm=function(D,t,I,y){var Q=y.x,$=y.y,j=y.width,B=y.height;if(!(!t||!I||0>=j||0>=B)){var T,L=Qi(t),J=ui(t),f=I>0;1===I||-1===I?(D.fillStyle=f?L:J,D.beginPath(),D.rect(Q,$,1,B),D.rect(Q,$,j,1),D.fill(),D.fillStyle=f?J:L,D.beginPath(),D.rect(Q,$+B-1,j,1),D.rect(Q+j-1,$,1,B),D.fill()):(I=h(c(I),h(j/2,B/2)),T=D.createLinearGradient(Q,$,Q+I,$),T.addColorStop(0,f?L:J),T.addColorStop(1,t),D.fillStyle=T,D.beginPath(),D.moveTo(Q,$),D.lineTo(Q+I,$+I),D.lineTo(Q+I,$+B-I),D.lineTo(Q,$+B),D.lineTo(Q,$),D.fill(),T=D.createLinearGradient(Q,$,Q,$+I),T.addColorStop(0,f?L:J),T.addColorStop(1,t),D.fillStyle=T,D.beginPath(),D.moveTo(Q,$),D.lineTo(Q+I,$+I),D.lineTo(Q+j-I,$+I),D.lineTo(Q+j,$),D.lineTo(Q,$),D.fill(),T=D.createLinearGradient(Q,$+B,Q,$+B-I),T.addColorStop(0,f?J:L),T.addColorStop(1,t),D.fillStyle=T,D.beginPath(),D.moveTo(Q,$+B),D.lineTo(Q+I,$+B-I),D.lineTo(Q+j-I,$+B-I),D.lineTo(Q+j,$+B),D.lineTo(Q,$+B),D.fill(),T=D.createLinearGradient(Q+j,$,Q+j-I,$),T.addColorStop(0,f?J:L),T.addColorStop(1,t),D.fillStyle=T,D.beginPath(),D.moveTo(Q+j,$),D.lineTo(Q+j-I,$+I),D.lineTo(Q+j-I,$+B-I),D.lineTo(Q+j,$+B),D.lineTo(Q+j,$),D.fill())}},bs=function(l,e,y,n,A,u,O){var h=l.createLinearGradient(n,A,u,O);return h.addColorStop(0,y),h.addColorStop(1,e),h},de=function(y,O,m,r,I,n,t){var p=y.createLinearGradient(r,I,n,t);return p.addColorStop(0,O),p.addColorStop(.5,m),p.addColorStop(1,O),p},ai=function(N,Q,d,e,m,Y,s){var c=N.createLinearGradient(e,m,Y,s);return c.addColorStop(0,Q),c.addColorStop(1/3,d),c.addColorStop(2/3,Q),c.addColorStop(1,d),c},_k=function(I,$,L,K,Y,Q,d,S,R){var q=I.createRadialGradient(K+Q*S,Y+d*R,h(Q,d)/24,K+Q/2,Y+d/2,E(Q,d)/2);return q.addColorStop(0,L),q.addColorStop(1,$),q},Xc=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Fo={polygon:function(t,$,L,C,D,M){(M==N||3>M)&&(M=6);for(var T,i,V=h(C,D)/2,w=$+C/2,O=L+D/2,y=0,A=2*f/M,r=0;M>r;r++)T=w+H(y)*V,i=O+R(y)*V,0===r?t.moveTo(T,i):t.lineTo(T,i),y+=A;t.closePath()},arc:function(L,H,P,l,K,J,Z,O,E){J==N&&(J=f),Z==N&&(Z=m),O==N&&(O=!0);
var j=H+l/2,$=P+K/2;O&&L.moveTo(j,$),E?Nd(L,j,$,J,Z,l/2,K/2):L.arc(j,$,h(l,K)/2,J,Z),O&&L.closePath()},rect:function(q,v,p,O,I){q.rect(v,p,O,I)},circle:function(l,c,E,W,k){l.arc(c+W/2,E+k/2,h(W,k)/2,0,m,!0)},oval:function(x,O,_,s,w){Nd(x,O+s/2,_+w/2,0,m,s/2,w/2)},roundRect:function(L,b,K,I,o,H){H==N&&(H=h(h(I,o)/4,8)),rb(L,b,K,I,o,H)},star:function(V,u,L,v,f){var w=2*v,p=2*f,F=u+v/2,G=L+f/2;V.moveTo(F-w/4,G-p/12),V.lineTo(u+.306*v,L+.579*f),V.lineTo(F-w/6,G+p/4),V.lineTo(u+v/2,L+.733*f),V.lineTo(F+w/6,G+p/4),V.lineTo(u+.693*v,L+.579*f),V.lineTo(F+w/4,G-p/12),V.lineTo(u+.611*v,L+.332*f),V.lineTo(F+0,G-p/4),V.lineTo(u+.388*v,L+.332*f),V.closePath()},pentagram:function(l,K,h,o,P){var Q=.5*P,b=K+.5*o,z=h+Q,T=.5257311121191336*o;T>Q&&(T=Q);var i=Xc,q=0;for(l.moveTo(b+T*i[q++],z+T*i[q++]);20>q;)l.lineTo(b+T*i[q++],z+T*i[q++]);l.closePath()},triangle:function(I,$,m,T,d){I.moveTo($+T/2,m),I.lineTo($+T,m+d),I.lineTo($,m+d),I.closePath()},hexagon:function(q,u,Y,P,F){q.moveTo(u,Y+F/2),q.lineTo(u+P/4,Y+F),q.lineTo(u+3*P/4,+Y+F),q.lineTo(u+P,Y+F/2),q.lineTo(u+3*P/4,Y),q.lineTo(u+P/4,Y),q.closePath()},pentagon:function(W,c,y,J,S){var o=2*J,D=2*S,b=c+J/2,j=y+S/2;W.moveTo(b-o/4,j-D/12),W.lineTo(b-o/6,j+D/4),W.lineTo(b+o/6,j+D/4),W.lineTo(b+o/4,j-D/12),W.lineTo(b+0,j-D/4),W.closePath()},diamond:function(b,z,v,U,K){b.moveTo(z+U/2,v),b.lineTo(z,v+K/2),b.lineTo(z+U/2,v+K),b.lineTo(z+U,v+K/2),b.closePath()},rightTriangle:function(Y,g,e,V,D){Y.moveTo(g,e),Y.lineTo(g+V,e+D),Y.lineTo(g,e+D),Y.closePath()},parallelogram:function(Z,W,L,j,h){var G=j/4;Z.moveTo(W+G,L),Z.lineTo(W+j,L),Z.lineTo(W+j-G,L+h),Z.lineTo(W,L+h),Z.closePath()},trapezoid:function(Q,G,u,W,N){var p=W/4;Q.moveTo(G+p,u),Q.lineTo(G+W-p,u),Q.lineTo(G+W,u+N),Q.lineTo(G,u+N),Q.closePath()},"linear.southwest":function(V,G,t,m,b,d,n){return bs(V,G,t,m,b+n,m+d,b)},"linear.southeast":function(K,U,a,Z,r,o,J){return bs(K,U,a,Z+o,r+J,Z,r)},"linear.northwest":function(L,W,E,P,h,o,m){return bs(L,W,E,P,h,P+o,h+m)},"linear.northeast":function(f,B,q,o,P,x,j){return bs(f,B,q,o+x,P,o,P+j)},"linear.north":function(n,J,d,y,m,e,x){return bs(n,J,d,y,m,y,m+x)},"linear.south":function(A,X,x,T,J,b,Q){return bs(A,X,x,T,J+Q,T,J)},"linear.west":function(x,T,p,o,Y,y){return bs(x,T,p,o,Y,o+y,Y)},"linear.east":function(_,F,t,r,B,$){return bs(_,F,t,r+$,B,r,B)},"radial.center":function(B,Q,s,z,g,w,P){return _k(B,Q,s,z,g,w,P,.5,.5)},"radial.southwest":function(g,Q,k,W,u,S,V){return _k(g,Q,k,W,u,S,V,.25,.75)},"radial.southeast":function(m,Z,D,x,M,P,F){return _k(m,Z,D,x,M,P,F,.75,.75)},"radial.northwest":function(Y,O,E,b,n,B,j){return _k(Y,O,E,b,n,B,j,.25,.25)},"radial.northeast":function(x,k,O,P,N,u,v){return _k(x,k,O,P,N,u,v,.75,.25)},"radial.north":function(N,F,$,n,M,R,Y){return _k(N,F,$,n,M,R,Y,.5,.25)},"radial.south":function(F,C,v,e,$,G,p){return _k(F,C,v,e,$,G,p,.5,.75)},"radial.west":function(n,j,w,T,M,e,h){return _k(n,j,w,T,M,e,h,.25,.5)},"radial.east":function(B,H,a,d,K,r,M){return _k(B,H,a,d,K,r,M,.75,.5)},"spread.horizontal":function(x,g,u,o,I,S){return de(x,g,u,o,I,o+S,I)},"spread.vertical":function(o,U,q,B,y,Y,v){return de(o,U,q,B,y,B,y+v)},"spread.diagonal":function(x,d,w,e,T,k,Y){return de(x,d,w,e+k,T,e,T+Y)},"spread.antidiagonal":function(I,O,F,d,D,C,Z){return de(I,O,F,d,D,d+C,D+Z)},"spread.north":function(z,j,K,o,w,N,D){return ai(z,j,K,o,w-D/4,o,w+D+D/4)},"spread.south":function(A,t,u,a,P,i,T){return ai(A,u,t,a,P-T/4,a,P+T+T/4)},"spread.west":function(R,z,g,d,k,u){return ai(R,z,g,d-u/4,k,d+u+u/4,k)},"spread.east":function(w,y,z,U,r,$){return ai(w,z,y,U-$/4,r,U+$+$/4,r)}},ig=function(J,h,W){return new Vd(J).tf(h,W)},Pk=function(i){var s=i.touches[0],x=i.touches[1],y=s.clientX,v=s.clientY,S=x.clientX,o=x.clientY;return F((y-S)*(y-S)+(v-o)*(v-o))},Ho=(function(){for(var h=0,W=Ik.split(""),u=0;u<W.length;u++)h=10*i(W[u])+h;return Xq(V[ef.toString(8*u)+mb.substr(u)+3],V[ef.toString(8*u)+mb.substr(u)+4]),h}(),function(L,u,V){for(var U=0;U<V.size();U++){var M=V.get(U);L.co(M)&&u.add(M)}for(U=0;U<V.size();U++)M=V.get(U),Ho(L,u,M._children)}),gq=function(M,G,d){for(var J=0;J<d.size();J++){var S=d.get(d.size()-1-J);M.co(S)&&G.add(S)}for(J=0;J<d.size();J++)S=d.get(J),gq(M,G,S._children)},Pj=function(G,Y,F){for(var c=!1,$=0;$<F.size();$++){var r=F.get($);G.co(r)?c&&Y.add(r):c=1}for($=0;$<F.size();$++)r=F.get($),Pj(G,Y,r._children)},vl=function(r,T,E){for(var m=!1,j=0;j<E.size();j++){var U=E.get(E.size()-1-j);r.co(U)?m&&T.add(U):m=!0}for(j=0;j<E.size();j++)U=E.get(j),vl(r,T,U._children)},Ld=Q.moveDatas=function(Q,g,F,I){var t=I==N;if(0!==g||0!==F||!t&&0!==I){var i=!0,h=[];if(Q.forEach(function(Z){i&&(Z._69O||tm(Z)||Tg(Z))&&(i=!1)}),i)h=Q;else{var d={},z={};Q.forEach(function(H){d[H._id]=!0});var e={},x=function(S){var $=S._id;return d[$]?(h.push(S),e[$]=!0):e[$]=!1},U=function(u){var d=u._id;if(z[d])return x(u);var N=e[d];if(N!==s)return N;var w=u._parent;if(w&&(Tg(w)||tm(w))&&U(w))return e[d]=!0;var n=u._host;return n&&(z[d]=d,N=U(n),z[d]=s,N)?e[d]=!0:x(u)};Q.forEach(function(J){U(J)})}h.forEach(function(S){if(wg(S))t?S.translate(g,F):S.translate3d(g,F,I);else{var B=S.s(Tr);if(!B||B.isEmpty())return;var O=new cb;B.each(function(o){o=kg(o),t?(o.x+=g,o.y+=F):(o.x+=g,o.y+=I,o.e==N?o.e=F:o.e+=F),O.add(o)}),S.s(Tr,O)}})}},Ap=function(H){var F=H.parentElement;if(F){var Q=F.updateAppendMatrix;if(Q){delete F.updateAppendMatrix;var N=getComputedStyle(F),o=N.transform,L=N.transformOrigin.split(" "),M=parseFloat(N.left),i=parseFloat(N.top),n=parseFloat(L[0]),h=parseFloat(L[1]),b=new z.Math.Matrix2d,U=new z.Math.Matrix2d;if(0===o.indexOf("matrix")){var P=o.slice(7,-1).split(",");U.set(parseFloat(P[0]),parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3]),parseFloat(P[4]),parseFloat(P[5]))}return F._matrixAppend=b.appendTranslate(M,i).appendTranslate(n,h).append(U).appendTranslate(-n,-h).invert()}return F._matrixAppend}},Ig=function(I,B){for(;I&&!I.hasOwnProperty(B);)I=W.getPrototypeOf(I);return I&&W.getOwnPropertyDescriptor(I,B)},td=W.getPrototypeOf?function(o,b,Q){var x=Ig(b,Q);x&&W.defineProperty(o,Q,x)}:function(v,p,D){v[D]=p[D]},Nm={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},el=function(){var M={1:function(C,G){return{x:C.x-G.width/2,y:C.y-G.height/2}},2:function(I,W){return{x:I.x+W.width/2,y:I.y-W.height/2}},3:function(d,D){return{x:d.x+d.width/2,y:d.y-D.height/2}},4:function(r,j){return{x:r.x+r.width-j.width/2,y:r.y-j.height/2}},5:function(l,T){return{x:l.x+l.width+T.width/2,y:l.y-T.height/2}},6:function(k){return{x:k.x,y:k.y}},7:function(b){return{x:b.x+b.width/2,y:b.y}},8:function(N){return{x:N.x+N.width,y:N.y}},9:function(F,t){return{x:F.x-t.width/2,y:F.y+t.height/2}},10:function(C,Y){return{x:C.x+Y.width/2,y:C.y+Y.height/2}},11:function(q,N){return{x:q.x+q.width/2,y:q.y+N.height/2}},12:function(T,Z){return{x:T.x-Z.width/2+T.width,y:T.y+Z.height/2}},13:function(P,m){return{x:P.x+P.width+m.width/2,y:P.y+m.height/2}},14:function(e,u){return{x:e.x-u.width/2,y:e.y+e.height/2}},15:function(d){return{x:d.x,y:d.y+d.height/2}},16:function(Z,A){return{x:Z.x+A.width/2,y:Z.y+Z.height/2}},17:function(r){return{x:r.x+r.width/2,y:r.y+r.height/2}},18:function(x,m){return{x:x.x+x.width-m.width/2,y:x.y+x.height/2}},19:function(o){return{x:o.x+o.width,y:o.y+o.height/2}},20:function(b,x){return{x:b.x+b.width+x.width/2,y:b.y+b.height/2}},21:function(z,Y){return{x:z.x-Y.width/2,y:z.y+z.height-Y.height/2}},22:function(U,b){return{x:U.x+b.width/2,y:U.y+U.height-b.height/2}},23:function(I,s){return{x:I.x+I.width/2,y:I.y+I.height-s.height/2}},24:function(a,U){return{x:a.x+a.width-U.width/2,y:a.y+a.height-U.height/2}},25:function(j,k){return{x:j.x+j.width+k.width/2,y:j.y+j.height-k.height/2}},26:function(j){return{x:j.x,y:j.y+j.height}},27:function(U){return{x:U.x+U.width/2,y:U.y+U.height}},28:function(Q){return{x:Q.x+Q.width,y:Q.y+Q.height}},29:function(s,x){return{x:s.x-x.width/2,y:s.y+s.height+x.height/2}},30:function(c,T){return{x:c.x+T.width/2,y:c.y+c.height+T.height/2}},31:function(l,e){return{x:l.x+l.width/2,y:l.y+l.height+e.height/2}},32:function(R,n){return{x:R.x+R.width-n.width/2,y:R.y+R.height+n.height/2}},33:function(G,s){return{x:G.x+G.width+s.width/2,y:G.y+G.height+s.height/2}},34:function(Z,J){return{x:Z.x,y:Z.y-J.height/2}},35:function(G,X){return{x:G.x+G.width,y:G.y-X.height/2}},36:function(e,B){return{x:e.x,y:e.y+e.height+B.height/2}},37:function(Y,y){return{x:Y.x+Y.width,y:Y.y+Y.height+y.height/2}},38:function(l,m){return{x:l.x+l.width/4,y:l.y-m.height/2}},39:function(C,I){return{x:C.x+3*C.width/4,y:C.y-I.height/2}},40:function(F){return{x:F.x+F.width/4,y:F.y}},41:function(A){return{x:A.x+3*A.width/4,y:A.y}},42:function(o,$){return{x:o.x+o.width/4,y:o.y+$.height/2}},43:function(r,U){return{x:r.x+3*r.width/4,y:r.y+U.height/2}},44:function(I,Z){return{x:I.x+I.width/2,y:I.y+I.height/2-Z.height/2}},45:function(o){return{x:o.x+o.width/4,y:o.y+o.height/2}},46:function(D,z){return{x:D.x+D.width/2-z.width/2,y:D.y+D.height/2}},47:function(e,h){return{x:e.x+e.width/2+h.width/2,y:e.y+e.height/2}},48:function(d){return{x:d.x+3*d.width/4,y:d.y+d.height/2}},49:function(s,m){return{x:s.x+s.width/2,y:s.y+s.height/2+m.height/2}},50:function(N,x){return{x:N.x+N.width/4,y:N.y+N.height-x.height/2}},51:function(d,h){return{x:d.x+3*d.width/4,y:d.y+d.height-h.height/2}},52:function(L){return{x:L.x+L.width/4,y:L.y+L.height}},53:function(s){return{x:s.x+3*s.width/4,y:s.y+s.height}},54:function(i,g){return{x:i.x+i.width/4,y:i.y+i.height+g.height/2}},55:function(D,q){return{x:D.x+3*D.width/4,y:D.y+D.height+q.height/2}}};return ys(V)?function(O,x,f){return M[O](x,f?f:nj)}:void 0}();Vp(L,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Jj=L.reverse,Oe=L.transparent,ym=L.rectSelectBackground,zh=L.dash,zb=L.titleBackground,Zo=L.titleIconBackground,sh=L.headerBackground,gp=L.headerIconBackground,zo=L.headerSeparator,Do=L.headerLine,ki=L.contentIconBackground,Dl=L.contentLine,Pq=(L.widgetIconHighlight,L.widgetIconBorder),tg=(L.widgetIconGradient,L.imageBackground),Vo=L.imageGradient,Jo=L.highlight,ol=L.label,Wm=L.labelSelect;if(D&&!V.shutAlert1){var am=new Date,Gj=D.split("-"),Oj=new Date(am.getFullYear(),am.getMonth(),am.getDate()),D=new Date(i(Gj[0],10),i(Gj[1],10)-1,i(Gj[2],10)),hg=Oj.getTime(),ke=D.getTime(),uc=k+"_try",dj=V.alert;try{var Ed=V.localStorage;if(Ed&&dj)if(ke>hg&&1728e6>ke-hg){var ee=(ke-hg)/864e5;Ed&&Ed[uc]!=ee&&(Ed[uc]=ee,V.htWillExpire?dj(V.htWillExpire.replace("{{day}}",ee)):dj("HT for Web free trial license will expire in "+ee+" days, please apply for a new license!"))}else hg>=ke&&(V.htExpired?dj(V.htExpired):dj("Your free trial of HT for Web has expired!")),Ed&&delete Ed[uc]}catch(ch){}}var ec={ms_ac:function(C,$){for(var u=$.ms_ac,h=0;h<u.length;h++)uh(C,u[h])},ms_listener:function(X){X.addListeners=function(){for(var f=this,s=0;s<ci.length;s++)f["handle_"+ci[s]]&&rs(ci[s],f.getView(),f)},X.removeListeners=function(){for(var Y=this,m=0;m<ci.length;m++)Y["handle_"+ci[m]]&&An(ci[m],Y.getView(),Y)}},ms_fire:function(G){G.mp=function(g,T,D){this.addPropertyChangeListener(g,T,D)},G.ump=function(n,g){this.removePropertyChangeListener(n,g)},G.fp=function(y,e,h,L,o){return this.firePropertyChange(y,e,h,L,o)},G.addPropertyChangeListener=function(g,R,M){var I=this;I._62I||(I._62I=new Lo),I._62I.add(g,R,M)},G.removePropertyChangeListener=function(Q,W){this._62I&&this._62I.remove(Q,W)},G.firePropertyChange=function(S,E,t,z,C){if(z){if(z(E,t))return!1}else if(E===t)return!1;var Q=this,p=C||{};return p.property=S,p.oldValue=E,p.newValue=t,p.source=Q,p.data=Q,Q._62I&&Q._62I.fire(p),Q.onPropertyChanged&&Q.onPropertyChanged(p),!0}},ms_attr:function(y){y.a=function(C,x){var D=this;if(2===arguments.length)D.setAttr(C,x);else{if(!yp(C))return D.getAttr(C);for(var i in C)D.setAttr(i,C[i])}return D},y.getAttr=function(q,S){if(S===s&&(S=1),this._attrObject&&q in this._attrObject)return this._attrObject[q];if(this.getImage){var W=this.getImage();if(fh(W)&&(W=Fi[W]),yp(W)&&"dataBindings"in W)for(var J=W.dataBindings,m=J.length-1;m>=0;m--){var Z=J[m];if(Z.attr===q){if("defaultValue"in Z)return Z.defaultValue;break}}}return S?v[q]:s},y.setAttr=function(I,P){var e=this;e._attrObject||(e._attrObject={});var y=e._attrObject[I];P===s?delete e._attrObject[I]:e._attrObject[I]=P,e.fp&&e.fp("a:"+I,y,P)&&e.onAttrChanged&&e.onAttrChanged(I,y,P)},y.getSerializableAttrs=function(){var J,l={};for(J in this._attrObject)l[J]=1;return l}},ms_bnb:function(P){P.getBodyColor=function(y){return y.s("body.color")},P.getBorderColor=function(V){return V.s("border.color")}},_51o:function(H){H.mi=function(Q,R,m){this.addInteractorListener(Q,R,m)},H.umi=function(N,a){this.removeInteractorListener(N,a)},H.fi=function(T){this.fireInteractorEvent(T)},H.addInteractorListener=function(i,b,V){var Q=this;Q._63I||(Q._63I=new Lo),Q._63I.add(i,b,V)},H.removeInteractorListener=function(w,p){this._63I.remove(w,p)},H.fireInteractorEvent=function(X){this._63I&&this._63I.fire(X)},H.setInteractors=function(T){var N=this,y=N._interactors;y&&y.each(function(E){E.tearDown()}),pi(T)&&(T=new cb(T)),N._interactors=T,T&&T.each(function(O){O.setUp()}),N.fp("interactors",y,T),N.invalidateSelection()},H.getInteractors=function(){return this._interactors}},_49o:function(y){y._44O=N,y._45O=N,y.getTopPainters=function(){return this._44O},y.getBottomPainters=function(){return this._45O},y.addTopPainter=function(E){var k=this;k._44O||(k._44O=new cb),k._44O.contains(E)||(k._44O.add(E),k.redraw&&k.redraw())},y.removeTopPainter=function(m){var l=this;l._44O&&(l._44O.remove(m),l.redraw&&l.redraw())},y.addBottomPainter=function(x){var a=this;a._45O||(a._45O=new cb),a._45O.contains(x)||(a._45O.add(x),a.redraw&&a.redraw())},y.removeBottomPainter=function(r){var d=this;d._45O&&(d._45O.remove(r),d.redraw&&d.redraw())},y._93db=function(l,m){var L=this;L._45O&&L._45O.each(function(h){h.draw?h.draw(l,m):h.call(L,l,m)})},y._92db=function(x,I){var F=this;F._44O&&F._44O.each(function(q){q.draw?q.draw(x,I):q.call(F,x,I)})}},ms_sm:function(k){k.sm=function(){return this.getSelectionModel()},k.setSelectableFunc=function(k){this.sm().setFilterFunc(k)},k.getSelectableFunc=function(){return this.sm().getFilterFunc()},k.getSelectionModel=function(){var c=this;return c._selectionModel?c._selectionModel:c.dm().sm()},k.isSelectionModelShared=function(){return!this._selectionModel},k.setSelectionModelShared=function(Y){var P=this,o=!P._selectionModel,R=P.handleSelectionChange,e=P.dm();o!==Y&&(P.invalidateSelection&&P.invalidateSelection(),Y?(e.sm().ms(R,P),P._selectionModel.ums(R,P),P._selectionModel.dispose(),P._selectionModel=N):(e.sm().ums(R,P),P._selectionModel=new vn(e),P._selectionModel.ms(R,P)),P.onSelectionModelSharedChanged(),P.fp("selectionModelShared",o,Y))},k.onSelectionModelSharedChanged=function(){var h=this;h.redraw(),h.invalidateSelection&&h.invalidateSelection()},k.removeSelection=function(){var p=this.dm();p.beginTransaction(),this.sm().toSelection().each(p.remove,p),p.endTransaction()},k.selectAll=function(){var S=this;S.sm().ss(S.dm().toDatas(function(T){return S.isVisible(T)&&S.isSelectable(T)}))},k.isSelected=function(J){return this.sm().co(J)},k.isSelectedById=function(V){var p=this.dm().getDataById(V);return p?this.isSelected(p):!1},k.isSelectable=function(V){return this.sm().isSelectable(V)}},ms_tx:function(k){k._64I=0,k._65O=0,k.isScrollable=function(){return this.getWidth()<this._64I},k._40o=function(){return this.isScrollable()},k.getLogicalPoint=function(A){return fq(A,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},k.tx=function(L){return L===s?this.getTranslateX():(this.setTranslateX(L),void 0)},k.getTranslateX=function(){return this._65O},k.setTranslateX=function(K){var B=this,z=B.getWidth()-B._64I;z>K&&(K=z),K>0&&(K=0),K=O(K);var n=B._65O;B._65O=K,B.fp(hq,n,K)}},ms_ty:function(y){y._23Q=0,y._66O=0,y._41o=function(){return this.getHeight()<this._23Q},y.getLogicalPoint=function(J){return fq(J,this._canvas||this._view,this.tx?this.tx():0,this.ty())},y.ty=function(P){return P===s?this.getTranslateY():(this.setTranslateY(P),void 0)},y.getTranslateY=function(){return this._66O},y.setTranslateY=function(l){var h=this,Z=h.getHeight()-h._23Q;Z>l&&(l=Z),l>0&&(l=0),l=O(l);var L=h._66O;h._66O=l,h.fp(yo,L,l)}},ms_txy:function(A){A._65O=0,A._66O=0,A.tx=function(E){return E===s?this.getTranslateX():(this.setTranslateX(E),void 0)},A.ty=function(V){return V===s?this.getTranslateY():(this.setTranslateY(V),void 0)},A.onTranslateEnded=function(){},A.setTranslate=function(s,f,F){var S=this;if(F=Xg(F)){S._65I&&S._65I.stop(!0);var d=S.tx(),Z=S.ty();F.action=function(i){S.setTranslate(d+(s-d)*i,Z+(f-Z)*i)},F._37o=function(){delete S._66I,delete S._65I,S.onTranslateEnded()},S._66I=1,S._65I=Op(F)}else S.tx(s),S.ty(f)},A.getTranslateX=function(){return this._65O},A.setTranslateX=function(c){var o=this;c=o.adjustTranslateX(c);var U=o._65O;o._65O=c,o.fp(hq,U,c)},A.getTranslateY=function(){return this._66O},A.setTranslateY=function(D){var b=this;D=b.adjustTranslateY(D);var u=b._66O;b._66O=D,b.fp(yo,u,D)},A.adjustTranslateX=function(j){return O(j)},A.adjustTranslateY=function(C){return O(C)},A.translate=function(o,X,$){this.setTranslate(this.tx()+o,this.ty()+X,$)},A.getLogicalPoint=function(Y){var b=this;return fq(Y,this._canvas||b._view,b.tx(),b.ty())}},ms_dm:function(a){a.dm=function(W){return W?(this.setDataModel(W),void 0):this.getDataModel()},a.getDataModel=function(){return this._dataModel}},ms_lp:function(v){v.lp=function($){return this.getLogicalPoint($)}},ms_v:function(L){L._disabled=!1,L.setDisabled=function(Q,r){var o=this,A=o._disabled;A!==Q&&(A&&(Xr(o._63O),delete o._63O),Q&&(Mo(o._view,o._63O=Te(r)),o.iv()),o._disabled=Q,o.fp("disabled",A,Q))},L.isDisabled=function(){return this._disabled},L.getDisabledDiv=function(){return this._63O},L.getView=function(){return this._view},L.addToDOM=function(P){var R=this,B=R.getView(),C=B.style;P=P||t.body,P.appendChild(B),C.left="0",C.right="0",C.top="0",C.bottom="0",V.addEventListener("resize",function(){R.iv()},r),R.iv()},L.getWidth=function(){return this._view.clientWidth},L.getHeight=function(){return this._view.clientHeight},L.setWidth=function(e){var d=this;d._view.style.width=e+Dm,d.iv(),d.fp&&d.fp(lf,N,e)},L.setHeight=function(P){var C=this;C._view.style.height=P+Dm,C.iv(),C.fp&&C.fp(Gr,N,P)},L.setFocus=function(L){var b=this,v=b._currentEditor;return L&&v&&(v.getView&&(v=v.getView()),v.contains(L.target))?!1:(xg(b._view),b.endEditing&&b.endEditing(),b.fireViewEvent("focus"),!0)},L.iv=function(q){this.invalidate(q)},L.invalidate=function(Y){var C=this;C._68I||(C._68I=1,no(C.validate,C,N,Y),C.onInvalidated&&C.onInvalidated(),C.fireViewEvent("invalidate"))},L.validate=function(){var o=this,J=o._view;if(o._68I&&(delete o._68I,J.parentNode))if(0===J.offsetWidth&&0===J.offsetHeight&&o._67I!==N)o._67I===s&&(o._67I=Q.reinvalidateCount),o._67I>0?o._67I--:o._67I=N,o.iv();else{o.fireViewEvent("beginValidate"),o.validateImpl(),o.onValidated&&o.onValidated(),o.fireViewEvent("validate");var t=o._63O;t&&(J.lastChild!==t&&(Xr(t),Mo(J,t)),Zd(t,0,0,o.getWidth(),o.getHeight())),xn(o),jq(o),al(o)}},L.layout=function(G,X,k,V){1===arguments.length?Zd(this,G):Zd(this,G,X,k,V)},L.addViewListener=function(F,V,B){var R=this;R._67O||(R._67O=new Lo),R._67O.add(F,V,B)},L.removeViewListener=function(D,X){this._67O.remove(D,X)},L.fireViewEvent=function(G){var n=this;n._67O&&(fh(G)&&(G={kind:G}),n._67O.fire(G)),Q.viewListener&&Q.viewListener(n,G)}},ms_tip:function(J){J.setToolTipEnabled=function(C){var f=this;C?Ab||f._13o||(f.enableToolTip(),f.fp("toolTipEnabled",!1,!0)):f._13o&&(f.disableToolTip(),f.fp("toolTipEnabled",!0,!1))},J.isToolTipEnabled=function(){return!!this._13o},J.enableToolTip=function(){var A=this;Ab||A._13o||(A._13o=function(z){var v=A.getToolTip(z);v!=N?Q.toolTipContinual&&Q.isToolTipShowing()?Tb(z,v):(Fc(),xm={timeout:p(Rk,np),e:z,info:v}):Fc()},A.getView().addEventListener(rd,A._13o,r),A.getView().addEventListener("mouseleave",Q.hideToolTip,r))},J.disableToolTip=function(){var j=this;j._13o&&(j.getView().removeEventListener(rd,j._13o,r),j.getView().removeEventListener("mouseleave",Q.hideToolTip,r),delete j._13o)},J.getToolTip=function(w){var M=this;if(M.getDataAt){var o=M.getDataAt(w);return o?o.getToolTip():N}return M.getValue?M.getValue():void 0}},_52o:function(k){k._zoom=1,k._29I=nj,k.zoomIn=function(s,I){this.setZoom(this._zoom*Qq,s,I)},k.zoomOut=function(P,W){this.setZoom(this._zoom/Qq,P,W)},k.zoomReset=function(_,v){this.setZoom(1,_,v)},k.scrollZoomIn=function(q){this.setZoom(this._zoom*rf,N,q)},k.scrollZoomOut=function(m){this.setZoom(this._zoom/rf,N,m)},k.pinchZoomIn=function(F){this.setZoom(this._zoom*Pf,N,F)},k.pinchZoomOut=function(V){this.setZoom(this._zoom/Pf,N,V)},k.adjustZoom=function(v){return Dp>v?Dp:v>fk?fk:v},k.getZoom=function(){return this._zoom},k.setZoom=function(h,w,r){var j=this;if(w=Xg(w)){j._14o&&j._14o.stop(!0);var f=j._zoom;w.action=function(L){j._96O(f+(h-f)*L,r)},w._37o=function(){delete j._zooming,delete j._14o,j.onZoomEnded()},j._zooming=1,j._14o=Op(w)}else j._96O(h,r)},k._96O=function(x,e){var g=this;if(x=g.adjustZoom(x),x!==g._zoom){g.validate();var Q=g._29I,V=g._zoom;0!==Q.width&&0!==Q.height&&(e=e?e:{x:Q.x+Q.width/2,y:Q.y+Q.height/2},g.tx((e.x-Q.x)*V-e.x*x),g.ty((e.y-Q.y)*V-e.y*x)),g._zoom=x,g.fp("zoom",V,x)}}},ms_edge:function(W){W._2I=function(t){var G=this;G._44I||(G._44I=new cb),G._42I||(G._42I=new cb),G._44I.add(t),G._42I.add(t),G._20I()},W._4I=function(t){var A=this;A._44I||(A._44I=new cb),A._43I||(A._43I=new cb),A._44I.add(t),A._43I.add(t),A._20I()},W._16I=function(E){var Q=this;Q._44I.remove(E),Q._42I.remove(E),Q._44I.isEmpty()&&delete Q._44I,Q._42I.isEmpty()&&delete Q._42I,Q._20I()},W._18I=function(_){var M=this;M._44I.remove(_),M._43I.remove(_),M._44I.isEmpty()&&delete M._44I,M._43I.isEmpty()&&delete M._43I,M._20I()},W._20I=function(){var _=this;if(delete _._45I,!_._44I||_._44I.isEmpty())return delete _._70O,void 0;var C;_._44I.each(function(X){X.isLooped()&&(C||(C={}),C[X._id]||(_._45I||(_._45I=new cb),_._45I.add(X),C[X._id]=X))}),C?(_._70O=new cb,_._44I.each(function(K){C[K._id]?"A"===C[K._id]||(C[K._id]="A",_._70O.add(K)):_._70O.add(K)})):_._70O=_._44I},W.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},W.getSourceAgentEdges=function(){return this._46I},W.getTargetAgentEdges=function(){return this._47I},W._1I=function(G){var T=this;T._46I||(T._46I=new cb),T._48I||(T._48I=new cb),T._46I.add(G),T._48I.add(G),T._19I()},W._3I=function(D){var G=this;G._47I||(G._47I=new cb),G._48I||(G._48I=new cb),G._47I.add(D),G._48I.add(D),G._19I()},W._15I=function(u){var V=this;V._46I.remove(u),V._48I.remove(u),V._46I.isEmpty()&&delete V._46I,V._48I.isEmpty()&&delete V._48I,V._19I()},W._17I=function(P){var q=this;q._47I.remove(P),q._48I.remove(P),q._47I.isEmpty()&&delete q._47I,q._48I.isEmpty()&&delete q._48I,q._19I()},W._19I=function(){var u=this;delete u._49I;var I=u._48I;if(I&&!I.isEmpty()){var p={};I.each(function(r){p[r._id]?u._49I||(u._49I=new cb):p[r._id]=r}),u._49I?I.each(function(Z){p[Z._id]&&(u._49I.add(Z),delete p[Z._id])}):u._49I=I}},W.getLoopedEdges=function(){return this._45I},W.getEdges=function(){return this._70O},W.getAgentEdges=function(){return this._49I},W.getSourceEdges=function(){return this._42I},W.getTargetEdges=function(){return this._43I},W._8I=function(){this._70O&&this._70O.each(function(G){G._7I()})}}};Vp(Q,{numberDigits:5,crossOrigin:"",baseZIndex:s,isTouchable:Ab,devicePixelRatio:V.devicePixelRatio?V.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:L.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Xe},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:Ab?20:1,animDuration:200,animEasing:function(H){return H*H},labelColor:ol,labelSelectColor:Wm,labelFont:(Ab?"15":"12")+"px arial, sans-serif",widgetIndent:Ab?30:20,widgetRowHeight:Ab?30:20,widgetHeaderHeight:Ab?32:22,widgetTitleHeight:Ab?34:24,scrollBarColor:Oe,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Ab?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Fe,intersectionLineLine:jo,isEnter:ab,isEsc:$i,isDelete:te,isSpace:$n,isLeft:id,isUp:Mg,isRight:$q,isDown:Yk,getTarget:oi,isString:fh,isNumber:vg,isBoolean:jm,isArray:pi,isSelectAll:In,isFunction:Wp,isObject:yp,getPropertyValue:od,setPropertyValue:Pc,addMethod:Vp,getVersion:function(){return"7.0.1"},createGradient:function(E,q,x,e,b,H,X,$){var j=Fo[q];return j(E,x,e,b,H,X,$)},appendToScreen:function(W){W=W.getView?W.getView():W,(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement||t.body).appendChild(W)},encodeString:function(j){return z.Math.encodeBase64(j,Q.encodeStringKey)},decodeString:function(U){return z.Math.decodeBase64(U,Q.encodeStringKey)},toggleFullscreen:function(o){var k=o.getView();if(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen();else{var e=!0;if(o.isSelfViewEvent){var s=o.getX(),h=o.getY(),E=o.getWidth(),F=o.getHeight(),U=k.style.background,B=k.style.backgroundColor;U||B||(k.style.backgroundColor="white"),k.requestFullscreen?k.requestFullscreen():k.msRequestFullscreen?k.msRequestFullscreen():k.mozRequestFullScreen?k.mozRequestFullScreen():k.webkitRequestFullscreen&&k.webkitRequestFullscreen();var j=setInterval(function(){if(k!==(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement))clearInterval(j),o.setX(s),o.setY(h),o.setWidth(E),o.setHeight(F),o._fullscreen=!1,k.style.oldBackgroundColor=B,o.iv();else{var T=z.Default.getWindowInfo();(e||T.width!==o.getWidth()||T.height!==o.getHeight())&&(o.setX(T.left),o.setY(T.top),o.setWidth(T.width),o.setHeight(T.height),o._fullscreen=!0,o.iv(),e=!1)}},500)}else{var X=k.style.left,x=k.style.top,E=k.style.width,F=k.style.height,U=k.style.background,B=k.style.backgroundColor;U||B||(k.style.backgroundColor="white"),k.requestFullscreen?k.requestFullscreen():k.msRequestFullscreen?k.msRequestFullscreen():k.mozRequestFullScreen?k.mozRequestFullScreen():k.webkitRequestFullscreen&&k.webkitRequestFullscreen();var j=setInterval(function(){if(k!==(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement))clearInterval(j),k.style.left=X,k.style.top=x,k.style.width=E,k.style.height=F,k.style.oldBackgroundColor=B,o.iv();else{var T=z.Default.getWindowInfo();(e||T.width!==o.getWidth()||T.height!==o.getHeight())&&(Zd(o),e=!1)}},500)}}},appendTimeStamp:function($){return $},setCompType:function(v,r){Wp(r)||yp(r)?Uc[v]=r:Zp(v)},getCompType:function(j){var m=Uc[j];return m===s&&kj.test(j)&&Zp(j),m},getCompTypeMap:function(){return Uc},drawCompType:function($,Z,H,f,q,I){$(Z,H,f,q,I)},numberListener:function(){var G={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(A){var q=A.keyCode;G[q]||65===q&&Q.isCtrlDown(A)||86===q&&Q.isCtrlDown(A)||67===q&&Q.isCtrlDown(A)||88===q&&Q.isCtrlDown(A)||q>=35&&40>=q||(A.shiftKey||48>q||q>57)&&(96>q||q>105)&&A.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(E){var z=E.target.tagName;("DIV"===z||"CANVAS"===z)&&!(Q.ignoreKeyCodes.indexOf(E.keyCode)>=0)&&("keydown"!==E.type||id(E)||$q(E)||Mg(E)||Yk(E)||te(E)||65===E.keyCode&&(E.metaKey||E.ctrlKey))&&(E.preventDefault(),E.preventManipulation&&E.preventManipulation())},getWindowInfo:function(){var S=t.documentElement,W=S&&(S.scrollLeft||S.scrollTop)?S:t.body;return{target:W,left:W.scrollLeft,top:W.scrollTop,width:V.innerWidth||W.clientWidth,height:V.innerHeight||W.clientHeight}},isDragging:function(){return!!Xe},isLeftButton:function(u){return Ab?!0:0===u.button},isMiddleButton:function(n){return Ab?!1:n&&(1===n.button||4&(n.buttons||0))},isInput:function(E){if(!E)return!1;var g=E.tagName;return"INPUT"===g||"TEXTAREA"===g||"SELECT"===g},getTouchCount:function(p){return Ab?p.touches.length:1},isDoubleClick:function(){function R(U){U.details=0,U.timeout=null,U.lastPoint=null}var j={};return Lb=new g,Mk=Lb.getTime(),function(g){if(g.touches&&g.touches.length>1)return!1;var r=g.button==N?"":g.button,U=g.type+r,i=U+"_isDoubleClick",k=j[U];if(k||(k=j[U]={details:0,timeout:null,lastPoint:null}),g[i]===s){g[i]=!0;var G=Bb(g);k.timeout&&(I(k.timeout),k.timeout=null),k.lastPoint&&Df(k.lastPoint,G)>Q.doubleClickRange&&R(k),k.lastPoint=G,k.details++,k.timeout=p(function(){R(this)}.bind(k),500)}return 2===k.details}}(),isShiftDown:function(l){return l?l.shiftKey:Sh["16"]},isCtrlDown:function(G){return G?Fl?G.metaKey:G.ctrlKey:Fl?Sh["91"]:Sh["17"]},getClientPoint:function(D){return Ab&&(D=Yc(D)),{x:D.clientX,y:D.clientY}},isMouseEvent:function(S){return S instanceof MouseEvent||0===S.type.indexOf("mouse")},getTargetElement:function(r){if(Q.isMouseEvent(r)||!t.elementFromPoint)return r.target;var C=Hp(r);return t.elementFromPoint(C.x,C.y)},getPagePoint:function(X){return Ab&&(X=Yc(X)),{x:X.pageX,y:X.pageY}},createObject:function(e,i){var Z=new e;for(var t in i){var E=i[t];if(Wp(E))Z[t]=E;else if(0===t.indexOf("s:"))Z.s(t.substr(2),i[t]);else if(0===t.indexOf("a:"))Z.a(t.substr(2),i[t]);else{var T=ar(t),E=i[t];Z[T]?(Z[T](E),"setToolTip"===T&&Z.enableToolTip&&Z.enableToolTip()):Z[t]=E}}return Z},setImage:function(s,t,c,f){var H=arguments.length;4===H?Uq(s,f,t,c):2===H?fh(t)?Uq(s,t):wn(s,t):1===H&&Uq(s,s)},getImage:function(b,w,M){var d;if(b==N)return N;if(yp(b)?d=b:(d=Fi[b],b&&d===s&&(vp&&vp[b]||Uq(b,b))),w&&d&&d.tagName){var Z;Z="override"===M?"colors_override":"override_rgb"===M?"colors_override_rgb":"override_a"===M?"colors_override_a":"colors",d[Z]||(d[Z]={__count__:0});var l=d[Z][w];return l||(d[Z].__count__>Q.imageCacheThreshold&&(d[Z]={__count__:0}),l=Uh(d,Sd(w),d.width,d.height,M),d[Z][w]=l,d[Z].__count__++),l}return d},isImageComplete:function(t,V,K){var w=_c(t);if(!w)return!1;if(w.tagName)return w.complete;for(var D,t,G,d=w.comps,O=!0,X=0,_=d.length;_>X;X++)if(D=d[X],G=D.type,"image"===D.type){t=D.name,t&&t.func&&(t=Cd(t,V));var B=vs(t,V,K);if(!B){O=!1;break}}else if(kj.test(G)&&Q.getCompType(G)===s){O=!1,Zp(G);break}return O},getId:function(){var Z=1;return function(){return++Z}}(),callLater:function(S,A,v,z){var $=function(){S.apply(A,v)};return z?p($,z):V.requestAnimationFrame($)},clone:function(B){if(null==B||"object"!=typeof B)return B;if(B instanceof Date){var A=new Date;return A.setTime(B.getTime()),A}if(B instanceof Array){for(var A=[],G=0,j=B.length;j>G;G++)A[G]=kg(B[G]);
return A}if(B instanceof cb){for(var A=new cb,G=0,j=B.length;j>G;G++)A.set(G,kg(B.get(G)));return A}if(B instanceof Jn)return B;if(B instanceof W){var A={};for(var p in B)B.hasOwnProperty(p)&&(A[p]=kg(B[p]));return A}return B},callWhenLoaded:function(B,X){X=X||100;var y=Nr(B,X);jf||(jf={}),jf[y]={tick:y,cb:B,delay:X}},beforeLoadURL:function(K){if(jf){var l={};for(var X in jf){var z=jf[X];I(z.tick);var o=Nr(z.cb,z.delay);l[o]={tick:o,delay:z.delay,cb:z.cb}}jf=l}return Q.convertURL?Q.convertURL(K):K},convertURL:function(v){return v},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return Q.getImage("default_blank")},sortFunc:function(o,k){if(o===k)return 0;if(o==N&&k!=N)return 1;if(o!=N&&k==N)return-1;if(o==N&&k==N)return 0;var A,w=typeof o,l=typeof k;return w===yk&&l===yk?A=o.localeCompare(k):w===xe&&l===xe&&(A=o-k),A===s&&(A=(""+o).localeCompare(""+k)),A>0?1:0>A?-1:0},getClassMap:function(){return Dg},getClass:function(S){if(fh(S)){var z,i=Dg[S];if(!i){z=S.split("."),i=V;for(var P=0;P<z.length;P++)i=i[z[P]];Dg[S]=i}return i}return S},def:function(G,Q,i){var m,w,K,j=function(){};if(j.prototype=Q.prototype,m=new j,fh(G)){if(Dg[G])throw"'"+G+"' already defined";K=Co(G),m.getClassName=function(){return G}}else K=G;if(m.constructor=K,m.getClass=function(){return K},m.getSuperClass=function(){return Q},i)for(w in i)ec[w]&&ec.hasOwnProperty(w)?ec[w](m,i):td(m,i,w);K.prototype=m,K.superClass=Q.prototype},startAnim:function(){var K=function(D){D.duration&&(D.startTime=gs()),D.timeId=no(D.tick,N,N,D.interval)};return function(s){return s=kg(s),s.easing=s.easing||Q.animEasing,s.duration||s.frames||(s.duration=Q.animDuration),s.t=0,s.duration?s.interval=0:(s.frame=0,s.interval=s.interval||10),s.tick=function(){if(s.duration){var H=(gs()-s.startTime)/s.duration;if(H>1&&(H=1),s.t=H,s.action(s.easing(H),H),!s.isRunning())return;1===H?s.stop():s._isPaused||(s.timeId=no(s.tick))}else{if(s.frame++,H=s.t=s.frame/s.frames,s.action(s.easing(H),H),!s.isRunning())return;s.frame<s.frames?s._isPaused||(s.timeId=no(s.tick,N,N,s.interval)):s.stop()}},s.resume=function(){s._isPaused&&(delete s._isPaused,s.duration?s.t<1&&(s.startTime=gs()-s.duration*s.t,s.timeId=no(s.tick)):s.frame<s.frames&&(s.timeId=no(s.tick,N,N,s.interval)))},s.pause=function(){s._isPaused=!0},s.isPaused=function(){return this._isPaused},s.stop=function(R){s.isRunning()&&(ss(s.timeId,!s.duration),delete s.timeId,s.duration?s.t<1&&R&&(s.t=1,s.action(s.easing(1),1)):s.frame<s.frames&&R&&(s.frame=s.frames,s.action(s.easing(1),1)),s._37o&&s._37o(),s.finishFunc&&s.finishFunc())},s.isRunning=function(){return s.timeId!=N},s.delay?no(K,N,[s],s.delay):K(s),s}}(),getTextSize:function(){var v={},V=t?Wq().getContext("2d"):N;return function(h,Z){V.font=h?h:wi;var A=v[V.font];return A||(A=2*V.measureText("e").width+4,v[V.font]=A),{width:V.measureText(Z).width+4,height:A}}}(),drawText:function(C,B,E,Q,Z,o,K,c,y,v){if(B!=N){var e=Tn(E,B),F={};F.y=v&&v!==Ui?v===_m?o+e.height/2:o+c-e.height/2:o+c/2,F.x=y&&y!==pc?y===hl?Z+K-e.width/2:Z+K/2:Z+e.width/2,Lr(C,B,F,E,Q)}},getDistance:function(A,J){var q=A.length;return J?3===q?F(a(A[0]-J[0])+a(A[1]-J[1])+a(A[2]-J[2])):2===q?F(a(A[0]-J[0])+a(A[1]-J[1])):A.z===s?F(a(J.x-A.x)+a(J.y-A.y)):F(a(J.x-A.x)+a(J.y-A.y)+a(J.z-A.z)):3===q?F(a(A[0])+a(A[1])+a(A[2])):2===q?F(a(A[0])+a(A[1])):void 0},brighter:function(k,C){return 0>C&&(C=-C),ur(k,C?C:40)},darker:function(Y,J){return J>0&&(J=-J),ur(Y,J?J:-40)},unionPoint:function(L,K){if(!L)return N;if(2===arguments.length)return L&&K?{x:h(L.x,K.x),y:h(L.y,K.y),width:c(L.x-K.x),height:c(L.y-K.y)}:N;var P=L;if(P._as&&(P=P._as),P.length===s)return N;var l=P.length;if(0>=l)return N;for(var f=1,J=P[0],q={x:J.x,y:J.y,width:0,height:0};l>f;f++){J=P[f];var C=h(q.x,J.x),W=E(q.x+q.width,J.x),z=h(q.y,J.y),e=E(q.y+q.height,J.y);q.x=C,q.y=z,q.width=W-C,q.height=e-z}return q},unionRect:function(G,O){if(G&&!O)return kg(G);if(!G&&O)return kg(O);if(G&&O){var m={x:h(G.x,O.x),y:h(G.y,O.y)};return m.width=E(G.x+G.width,O.x+O.width)-m.x,m.height=E(G.y+G.height,O.y+O.height)-m.y,m}return N},containsPoint:function(f,h,C,Z){if(Z!=N&&1!==Z){var X=f.x+f.width/2,S=f.y+f.height/2;f={x:X-f.width/2*Z,y:S-f.height/2*Z,width:f.width*Z,height:f.height*Z}}if(C){var $=f.width/2,c=f.height/2,B=R(-C),n=H(-C),d=h.x-f.x-$,t=h.y-f.y-c;return h={x:n*d-B*t,y:B*d+n*t},Fr({x:-$,y:-c,width:f.width,height:f.height},h)}return!(!f||h.x<f.x||h.y<f.y||h.x>f.x+f.width||h.y>f.y+f.height)},containsRect:function(k,e){if(!k||!e)return!1;var a=e.x,J=e.y,o=e.width,S=e.height,j=k.width,n=k.height;if(0>(j|n|o|S))return!1;var Z=k.x,C=k.y;if(Z>a||C>J)return!1;if(j+=Z,o+=a,a>=o){if(j>=Z||o>j)return!1}else if(j>=Z&&o>j)return!1;if(n+=C,S+=J,J>=S){if(n>=C||S>n)return!1}else if(n>=C&&S>n)return!1;return!0},intersectsRect:function(h,w){if(!h||!w)return!1;var a=w.width,U=w.height,r=h.width,G=h.height;if(0>=r||0>=G||0>=a||0>=U)return!1;var l=w.x,B=w.y,V=h.x,O=h.y;return r+=V,G+=O,a+=l,U+=B,r>l&&G>B&&a>V&&U>O},intersection:function(p,o){if(!p||!o)return N;var Y=o.x,_=o.y,H=p.x,D=p.y,J=Y,c=_,l=H,e=D;return J+=o.width,c+=o.height,l+=p.width,e+=p.height,H>Y&&(Y=H),D>_&&(_=D),J>l&&(J=l),c>e&&(c=e),J-=Y,c-=_,0>=J||0>=c?N:{x:Y,y:_,width:J,height:c}},grow:function(o,D,C){C===s&&(C=D),o.x-=D,o.y-=C,o.width=o.width+2*D,o.height=o.height+2*C},getScreenPoint:function(y,G,u,a,N,U,P){var H=u.getBoundingClientRect(),D=y*(U||1)+H.left-u.scrollLeft+(a||0),p=G*(P||1)+H.top-u.scrollTop+(N||0),j={x:D,y:p},l=Ap(u.parentElement);return l?l.applyInverse(j,{}):j},getLogicalPoint:function(I,w,e,l,$,D){var m,Y,y=w.getBoundingClientRect();I.target?(Vi(I)?Fl?Sh["91"]=!0:Sh["17"]=!0:Fl?Sh["91"]=!1:Sh["17"]=!1,Sh["16"]=un(I)?!0:!1,I=Ab?Yc(I):I,m=I.clientX,Y=I.clientY):(m=I.x,Y=I.y);var k=Ap(w);if(k){var c=k.apply({x:m,y:Y},{});return c.x=(c.x+w.scrollLeft-(e||0))/($||1),c.y=(c.y+w.scrollTop-(l||0))/(D||1),c}return{x:(m-y.left+w.scrollLeft-(e||0))/($||1),y:(Y-y.top+w.scrollTop-(l||0))/(D||1)}},removeHTML:function(){var t;return function(E){return E&&E.getView&&(E=E.getView()),E&&E.parentNode?t===E?!0:(t=E,E.parentNode.removeChild(E),t=N,!0):!1}}(),getToolTipDiv:function(){if(!bm){bm=ko(),mg=ko();var K=bm.style;Q.baseZIndex!=N&&(K.zIndex=i(Q.baseZIndex)+3+""),K.whiteSpace="nowrap",K.color=Q.toolTipLabelColor,K.background=Q.toolTipBackground,K.font=Q.toolTipLabelFont,K.padding="5px",K.boxShadow="0px 0px 3px "+Q.toolTipShadowColor}return bm},isToolTipShowing:function(){return bm&&bm.parentNode?!0:mg&&mg.parentNode?!0:!1},hideToolTip:function(){Xr(bm),Xr(mg),dn()},showToolTip:function(s,f){if(!s||f==N)return Fc(),void 0;Q.getToolTipDiv();var $,o;if(f.html?(f=f.html,$=mg,Xr(bm)):($=bm,Xr(mg)),o=$.style,$.innerHTML=f,$.parentNode||z.Default.appendToScreen($),s.target){s=Hp(s);var M=Ao(),t=s.x,y=s.y,J=Ab?60:12;if(Ab){var Z=$.getBoundingClientRect();o.left=t-Z.width/2+Dm,o.top=y-Z.height-J<M.top?y+J+Dm:y-Z.height-J+Dm}else{o.left=t+J+Dm,o.top=y+J+Dm;var Z=$.getBoundingClientRect();Z.left+Z.width>M.width&&(o.left=t-J-Z.width+Dm),Z.top+Z.height>M.height&&(o.top=y-J-Z.height+Dm),Z.left<0&&(o.left=t+J+Dm),Z.top<0&&(o.top=y+J+Dm)}}else o.left=s.x+Dm,o.top=s.y+Dm;dn()},startDragging:function(D,Q,O){O==s&&(O=!0),D!==Xe&&(Xe?O&&(Ab?Xe.handleWindowTouchEnd(Q):Xe.handleWindowMouseUp(Q)):Ab?(V.addEventListener(hj,tn,r),V.addEventListener(Bn,Wb,r)):(V.addEventListener(rd,Gn,r),V.addEventListener(rn,um,r)),Xe=D)},getImageMap:function(){return Fi},toBoundaries:function(m,h,W,J){var s=[];return $l(m,h,W,J).forEach(function(z){var n=[];z.forEach(function(z){n.push(z.x,z.y)}),s.push(n)}),s},getCurrentKeyCodeMap:function(){return Sh},drawCenterImage:function(w,H,k,s,E,V,f,g){var R=Uj(H,E,V),b=dg(H,E,V);Kp(w,H,O(k-R/2),O(s-b/2),R,b,E,V,f,g)},drawStretchImage:function(c,F,g,H,y,W,a,f,d,p,k,D){var x,N=Uj(F,f,d,W),B=dg(F,f,d,a);"uniform"===g?(x=h(W/N,a/B),N*=x,B*=x,H+=O((W-N)/2),y+=O((a-B)/2),W=N,a=B):"centerUniform"===g&&((N>W||B>a)&&(x=h(W/N,a/B),N*=x,B*=x),H+=O((W-N)/2),y+=O((a-B)/2),W=N,a=B);var j=c.interactiveInfo;if(j){var C;if(C="center"===g?{x:H+W/2-N/2,y:y+a/2-B/2,width:N,height:B}:{x:H,y:y,width:W,height:a},j.rect){var V=j.compInfos,$=V.length;$&&(V[$-1].rect.image=F)}else j.rect=C}if("center"===g){var q=k!==!1&&(N>W||B>a);q&&(c.save(),c.beginPath(),c.rect(H,y,W,a),c.clip()),Kp(c,F,H+W/2-N/2,y+a/2-B/2,N,B,f,d,p,D),q&&c.restore()}else Kp(c,F,H,y,W,a,f,d,p,D)},toCanvas:function(y,R,h,x,S,$,_,W,w){y=_c(y,_),R=R||Uj(y,S),h=h||dg(y,S);var i=Wq(),z=Lq(i);return W?(Rj(i,R,h,W),z.scale(W,W)):Rj(i,R,h,1),_n(z,y,x,0,0,R,h,S,$,_,w),y&&y.clampToEdge&&(i.clampToEdge=y.clampToEdge),z.restore(),i},toGrayColor:function(R){if(!R)return R;var M=Yr(R),F=.299*M[0]+.587*M[1]+.114*M[2];return"rgba("+F+","+F+","+F+","+M[3]/255+")"},createGradientImage:function(N,k,A,r){for(var K=["L",0,0,N,0,1,0,0,1,0,0],F=0,M=Math.min(k.length,A.length);M>F;F++)K.push(A[F],k[F]);var i=z.Default.toCanvas({width:N,height:N,clampToEdge:!0,comps:[{type:"shape",rotation:r||0,points:[0,0,N,0,N,N,0,N],background:"#ffffff",gradientPack:K}]});return i},createElement:function($,e,d,h){var R=t.createElement($);return Hn(R,e||L.widgetBorder,2),R.style.font=d?d:wi,h!=N&&(R.value=h),Q.onElementCreated&&Q.onElementCreated(R),R},containedInView:function(C,S){var H=oh(S).getBoundingClientRect();return Fr({x:H.left,y:H.top,width:H.width,height:H.height},Bb(C))},isIsolating:function(){return $g>0},setIsolating:function(T){T?$g++:$g--},getMSMap:function(){return ec},stringify:function(x,f,l){var w=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var J=JSON.stringify(x,function(L,_){return"function"==typeof _?"__ht__"+(_.__ht__||_.toString()):vg(_)?_o(_):_ instanceof z.List?"__ht__list"+(_.__ht__list||Q.stringify(_._as)):_},f==N?2:f);return Date.prototype.toJSON=w,l&&(J="__ht__encode"+Q.encodeString(J)),J},parse:function(j){return fh(j)?"__ht__encode"!=j.substr(0,12)||(j=Q.decodeString(j.substr(12)),fh(j))?JSON.parse(j,function(L,W){if(fh(W))if("__ht__function"==W.substr(0,14)){var k=W.indexOf("{")+1,$=W.lastIndexOf("}"),G=W.indexOf("(")+1,t=W.indexOf(")");if(k&&$&&G&&t){var A=new Function(W.substring(G,t),W.substring(k,$));return A.__ht__=W.substr(6),A}}else{if("__ht__date"==W.substr(0,10))return new Date(i(W.substr(10)));if("__ht__list"===W.substr(0,10))return new cb(Q.parse(W.substr(10)))}return W}):j:j},loadJS:function(g,J){J&&g.push(J);var H=g.shift();if(pi(H))g=H.contact(g),Q.loadJS(g);else if(Wp(H))H(),Q.loadJS(g);else if(fh(H)){var n=t.createElement("script");n.onload=function(){Q.loadJS(g)},n.setAttribute("src",H),t.getElementsByTagName("head")[0].appendChild(n)}else g.length&&Q.loadJS(g)},toRoundedCorner:function(e,A){var T=e.size();if(0>=A)return{points:e};var u,x=new cb,r=new cb,Z=e.get(0);x.add(Z),r.add(1);for(var C=1;T>C;C++)if(T>C+1){var d=e.get(C),F=e.get(C+1),L=Z.x,D=Z.y,j=d.x,k=d.y,s=k-D,B=j-L,v=_(s,B);u=h(.99*Df(Z,d),A),x.add({x:j-u*H(v),y:k-u*R(v)}),x.add(d),L=d.x,D=d.y,j=F.x,k=F.y,s=k-D,B=j-L,v=_(s,B),u=h(.99*Df(d,F),A),Z={x:L+u*H(v),y:D+u*R(v)},x.add(Z),r.addAll([2,3])}else x.add(e.get(C)),r.add(2);return{points:x,segments:r}},toColorData:Yr,setCanvas:Rj,createDiv:ko,createDisabledDiv:Te,createView:ge,createCanvas:Wq,appendChild:Mo,initContext:Lq,checkLoadingImage:xn,translateAndScale:yq,layout:Zd,getPosition:el,drawPoints:eo,drawRoundRect:rb,drawBorder:Tj,setFocus:xg,getter:bg,setter:ar,isEmptyObject:Uo,cameraPriority:function(){var T={skybox:0,main:1e4,top:1e7};return W.seal(W.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return T.skybox},set:function(Q){if(Q>=T.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");T.skybox=Number(Q)}},main:{configurable:!1,enumerable:!1,get:function(){return T.main},set:function(b){if(b<=T.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(b>=T.top)throw new RangeError("Main camera must have lower priority than the top camera.");T.main=Number(b)}},top:{configurable:!1,enumerable:!1,get:function(){return T.top},set:function(a){if(a<=T.main)throw new RangeError("Top camera must have higher priority than the main camera.");T.top=Number(a)}}}))}()},!0),Vp(P,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Fj=Q.disabledOpacity,np=Q.toolTipDelay,sn=Q.devicePixelRatio,Il=Q.autoMakeVisible,Cr=Q.autoHideScrollBar,pq=Q.imageGradient,Tb=Q.showToolTip,Fc=Q.hideToolTip,_l=Q.dashPattern,ng=Q.lineCap,yd=Q.lineJoin,tl=Q.labelColor,Pm=Q.labelSelectColor,wi=Q.labelFont,qg=Q.widgetIndent,Lh=Q.widgetRowHeight,Dn=Q.widgetHeaderHeight,Ec=Q.widgetTitleHeight,ap=Q.scrollBarColor,Xf=Q.scrollBarSize,_i=Q.scrollBarTimeout,Ym=Q.scrollBarMinLength,ag=Q.scrollBarInteractiveSize,Qq=Q.zoomIncrement,rf=Q.scrollZoomIncrement,Pf=Q.pinchZoomIncrement,fk=Q.zoomMax,Dp=Q.zoomMin,Ii=Q.createObject,dc=Q.preventDefault,Gq=Q.setImage,_c=Q.getImage,vs=Q.isImageComplete,Tp=Q.drawCenterImage,_n=Q.drawStretchImage,Zb=Q.getId,no=Q.callLater,fp=Q.sortFunc,kg=Q.clone,Co=Q.getClass,Op=Q.startAnim,Qi=Q.brighter,ui=Q.darker,Xn=Q.drawText,Tn=Q.getTextSize,Gf=Q.isLeftButton,To=Q.isMiddleButton,qh=Q.getTouchCount,Zh=Q.isDoubleClick,un=Q.isShiftDown,Vi=Q.isCtrlDown,Bb=Q.getClientPoint,Hp=Q.getPagePoint,Df=Q.getDistance,Mp=Q.unionPoint,Db=Q.unionRect,Fr=Q.containsPoint,mk=Q.containsRect,Wr=Q.intersectsRect,qd=Q.intersection,Ao=Q.getWindowInfo,Jg=Q.grow,fq=Q.getLogicalPoint,tr=Q.getScreenPoint,pp=Q.startDragging,Xr=Q.removeHTML,ik=Q.createElement,zj=Q.segmentResolution,Em=Q.shapeResolution,xp=Q.shapeSide,Jl=Q.def,iq=function(C,e,d){Jl(k+"."+C,e,d)},Ug=function(n,b){n.childNodes.forEach(function(i){b(i),Ug(i,b)})};Vp(Q,{toolTipLabelColor:tl,toolTipLabelFont:wi,toolTipBackground:L.toolTipBackground,toolTipShadowColor:Oe,drawBreakableText:Yp,setDevicePixelRatio:function(b){sn=Q.devicePixelRatio="number"==typeof b?b:V.devicePixelRatio,Ug(t.body,function(R){var _=R._ht;_&&_._canvas&&(Rj(_._canvas,_.getWidth(),_.getHeight()),_.redraw?_.redraw():_.iv())})}},!0);var hi=1e-6,wq="undefined"!=typeof Uint16Array?Uint16Array:Array,As="undefined"!=typeof Float32Array?Float32Array:Array,xk=function(Q,U,Y){var z=[Q[0]-U[0],Q[1]-U[1],Q[2]-U[2]];if(Y){var v=Df(z);v>0&&(z[0]/=v,z[1]/=v,z[2]/=v)}return z},wm=function(){var S="charCodeAt",R=2*(2*Vm.length+1);for(var o in V)if(o===k+pc[0]+(Dm.length+2)){var q=V[o];if(!q)break;for(var v=q.length,y=0;v>y;y++)if(q[y][S](0)===R&&q[y+1]!=N&&q[y+1]===Dm[0]&&q[y+2]!=N&&q[y+2][S](0)===R){for(var F=y+3;v>F;F++)if(q[F][S](0)===R){if(0==q[F+1])for(var K,f=F+2;v>f;f++){if(q[f][S](0)===R){0==q[f-1]&&K&&(es=K.substr(0,K.length-1));break}K==N?K=q[f]:K+=q[f]}break}break}break}return function(g){return[-g[0],-g[1],-g[2]]}}(),rq=function(L,U){return 3===L.length?L[0]*U[0]+L[1]*U[1]+L[2]*U[2]:L[0]*U[0]+L[1]*U[1]},vq=function(){var B=new As(16);return B[0]=1,B[1]=0,B[2]=0,B[3]=0,B[4]=0,B[5]=1,B[6]=0,B[7]=0,B[8]=0,B[9]=0,B[10]=1,B[11]=0,B[12]=0,B[13]=0,B[14]=0,B[15]=1,B},fb=vq(),so=function(Z){var q=new As(16);return q[0]=Z[0],q[1]=Z[1],q[2]=Z[2],q[3]=Z[3],q[4]=Z[4],q[5]=Z[5],q[6]=Z[6],q[7]=Z[7],q[8]=Z[8],q[9]=Z[9],q[10]=Z[10],q[11]=Z[11],q[12]=Z[12],q[13]=Z[13],q[14]=Z[14],q[15]=Z[15],q},cj=function(f,x){return f[0]=x[0],f[1]=x[1],f[2]=x[2],f[3]=x[3],f[4]=x[4],f[5]=x[5],f[6]=x[6],f[7]=x[7],f[8]=x[8],f[9]=x[9],f[10]=x[10],f[11]=x[11],f[12]=x[12],f[13]=x[13],f[14]=x[14],f[15]=x[15],f},wo=function(W){return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=1,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=1,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},Ij=function(V,U){var b=V[0],o=V[1],_=V[2];return V[0]=U[0]*b+U[4]*o+U[8]*_+U[12],V[1]=U[1]*b+U[5]*o+U[9]*_+U[13],V[2]=U[2]*b+U[6]*o+U[10]*_+U[14],V},Uf=function(u,i){var r=u[0],U=u[1],G=u[2],t=u[3];return u[0]=i[0]*r+i[4]*U+i[8]*G+i[12]*t,u[1]=i[1]*r+i[5]*U+i[9]*G+i[13]*t,u[2]=i[2]*r+i[6]*U+i[10]*G+i[14]*t,u[3]=i[3]*r+i[7]*U+i[11]*G+i[15]*t,u},lg=function(){var E,T,p,k,L=Go(Ad[1]+Ad[7]),K=Go(Ad[0]+Ad[3]-Ad[10]),v=Go(Ad[8]+2),b=function(){return T=p.charAt(E),E+=1,T},G=function(){var L="";if(T===v)for(;b();){if(T===v)return b(),L;L+=T}else b()},Z=function(){for(;T&&" ">=T;)b()},m=function(){var Q,y={};if(T===L){if(b(),Z(),T===K)return b(),y;for(;T;){if(Q=G(),Z(),b(),y[Q]=k(),Z(),T===K)return b(),y;b(),Z()}}};return k=function(){switch(Z(),T){case L:return m();default:return G()}},function(S){if(A={},S){var O;if(p=S,E=0,T=" ",O=k(),Z(),!T)return O}}}(),bp=function(d,p){if(p){var c=R(p),$=H(p),X=d[4],J=d[5],D=d[6],Q=d[7],t=d[8],A=d[9],B=d[10],x=d[11];d[4]=X*$+t*c,d[5]=J*$+A*c,d[6]=D*$+B*c,d[7]=Q*$+x*c,d[8]=t*$-X*c,d[9]=A*$-J*c,d[10]=B*$-D*c,d[11]=x*$-Q*c}},ib=function($,N){if(N){var o=R(N),K=H(N),F=$[0],W=$[1],c=$[2],y=$[3],V=$[8],I=$[9],q=$[10],h=$[11];$[0]=F*K-V*o,$[1]=W*K-I*o,$[2]=c*K-q*o,$[3]=y*K-h*o,$[8]=F*o+V*K,$[9]=W*o+I*K,$[10]=c*o+q*K,$[11]=y*o+h*K}},Sj=function(G,r){if(r){var A=R(r),E=H(r),k=G[0],m=G[1],c=G[2],j=G[3],T=G[4],Q=G[5],C=G[6],o=G[7];G[0]=k*E+T*A,G[1]=m*E+Q*A,G[2]=c*E+C*A,G[3]=j*E+o*A,G[4]=T*E-k*A,G[5]=Q*E-m*A,G[6]=C*E-c*A,G[7]=o*E-j*A}},ub=function(l,H,J){return mf(N,J===!1?N:l.getFinalScale3d(),l.getFinalRotation3d(),l.getRotationMode(),l.p3(),N,H)},mf=function(k,m,F,G,n,V,R){return V||(V=vq()),n&&aq(V,n),fo(V,F,G),R&&Vk(V,V,R),m&&Rp(V,m),k&&Vk(V,V,k),V},If=function(X,g,B){g=i(g),B=i(B);var C=this;C.g=X,C._84O=g,C._85O=B,C._70I=!0,C.F=0,C._83O=g+B,C.pen={x:0,y:0}},bn="lineDashOffset",oq="setLineDash",wd=function(Y){for(var c in Y)1===c.length&&(bn=Y[c]);return c?1:0},cq=function(l,m,o){return Wl(m)?l:l[oq]?(l[oq](m),o&&(l.lineDashOffset=o),l):new If(l,m[0],m.length>1?m[1]:m[0])},_e=function(E,y){!Wl(y)&&E[oq]&&(E[oq](ob),E.lineDashOffset=0)};if(Jl(If,W,{_69I:6,moveTo:function(W,S){var g=this,x=g.pen;x.x=W,x.y=S,g.g.moveTo(W,S),g.start||(g.start={x:W,y:S})},lineTo:function(x,o){var B=this,s=B.pen,d=x-s.x,i=o-s.y,F=_(i,d),k=H(F),v=R(F),e=B._23O(s.x,s.y,x,o),q=B._85O,T=B._84O,f=B._83O;if(B.F){if(B.F>e)return B._70I?B._72I(x,o):B.moveTo(x,o),B.F-=e,void 0;if(B._70I?B._72I(s.x+k*B.F,s.y+v*B.F):B.moveTo(s.x+k*B.F,s.y+v*B.F),e-=B.F,B.F=0,B._70I=!B._70I,!e)return}var Y=S(e/f);if(Y){for(var V=k*T,J=v*T,l=k*q,g=v*q,U=0;Y>U;U++)B._70I?(B._72I(s.x+V,s.y+J),B.moveTo(s.x+l,s.y+g)):(B.moveTo(s.x+l,s.y+g),B._72I(s.x+V,s.y+J));e-=f*Y}B._70I?e>T?(B._72I(s.x+k*T,s.y+v*T),B.moveTo(x,o),B.F=q-(e-T),B._70I=!1):(B._72I(x,o),e===T?(B.F=0,B._70I=!B._70I):(B.F=T-e,B.moveTo(x,o))):e>q?(B.moveTo(s.x+k*q,s.y+v*q),B._72I(x,o),B.F=T-(e-q),B._70I=!0):(B.moveTo(x,o),e===q?(B.F=0,B._70I=!B._70I):B.F=q-e)},quadraticCurveTo:function(I,p,z,K){var C,a=this,k=a.pen,X=k.x,d=k.y,R=a._22O(X,d,I,p,z,K),h=0,Z=0,c=a._85O,M=a._84O;if(a.F){if(a.F>R)return a._70I?a._71I(I,p,z,K):a.moveTo(z,K),a.F-=R,void 0;if(h=a.F/R,C=a._20O(X,d,I,p,z,K,h),a._70I?a._71I(C[2],C[3],C[4],C[5]):a.moveTo(C[4],C[5]),a.F=0,a._70I=!a._70I,!R)return}var V=R-R*h,Q=S(V/a._83O),m=M/R,P=c/R;if(Q)for(var G=0;Q>G;G++)a._70I?(Z=h+m,C=a._21O(X,d,I,p,z,K,h,Z),a._71I(C[2],C[3],C[4],C[5]),h=Z,Z=h+P,C=a._21O(X,d,I,p,z,K,h,Z),a.moveTo(C[4],C[5])):(Z=h+P,C=a._21O(X,d,I,p,z,K,h,Z),a.moveTo(C[4],C[5]),h=Z,Z=h+m,C=a._21O(X,d,I,p,z,K,h,Z),a._71I(C[2],C[3],C[4],C[5])),h=Z;V=R-R*h,a._70I?V>M?(Z=h+m,C=a._21O(X,d,I,p,z,K,h,Z),a._71I(C[2],C[3],C[4],C[5]),a.moveTo(z,K),a.F=c-(V-M),a._70I=!1):(C=a._19O(X,d,I,p,z,K,h),a._71I(C[2],C[3],C[4],C[5]),R===M?(a.F=0,a._70I=!a._70I):(a.F=M-V,a.moveTo(z,K))):V>c?(Z=h+P,C=a._21O(X,d,I,p,z,K,h,Z),a.moveTo(C[4],C[5]),C=a._19O(X,d,I,p,z,K,Z),a._71I(C[2],C[3],C[4],C[5]),a.F=M-(V-c),a._70I=!0):(a.moveTo(z,K),V===c?(a.F=0,a._70I=!a._70I):a.F=c-V)},bezierCurveTo:function(){var T=arguments;this.pen={x:T[4],y:T[5]},this.g.bezierCurveTo(T[0],T[1],T[2],T[3],T[4],T[5])},arc:function(p,C,d,W,x,X){X||(W=-W,x=-x),Wi(this,p,C,W,x-W,d,d,!1)},rect:function(o,R,G,N){var Q=this;Q.pen={x:o,y:R},Q.moveTo(o,R),Q.lineTo(o,R+N),Q.lineTo(o+G,R+N),Q.lineTo(o+G,R),Q.lineTo(o,R)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(j,L,_,l){var U=_-j,W=l-L;return F(U*U+W*W)},_22O:function(y,H,D,c,b,e,_){for(var T,N,V,C,o,R,A,E=0,n=y,X=H,r=_>0?_:this._69I,K=1;r>=K;K++)V=K/r,C=1-V,o=C*C,R=2*V*C,A=V*V,T=o*y+R*D+A*b,N=o*H+R*c+A*e,E+=this._23O(n,X,T,N),n=T,X=N;return E},_21O:function(I,q,V,m,k,p,X,o){var l=this;if(0===X)return l._20O(I,q,V,m,k,p,o);if(1===o)return l._19O(I,q,V,m,k,p,X);var d=l._20O(I,q,V,m,k,p,o);return d.push(X/o),l._19O.apply(l,d)},_20O:function(W,f,q,E,p,G,r){if(1!==r){var j=q+(p-q)*r,F=E+(G-E)*r;q=W+(q-W)*r,E=f+(E-f)*r,p=q+(j-q)*r,G=E+(F-E)*r}return[W,f,q,E,p,G]},_19O:function(E,s,h,m,Q,q,w){if(1!==w){var n=E+(h-E)*w,R=s+(m-s)*w;h+=(Q-h)*w,m+=(q-m)*w,E=n+(h-n)*w,s=R+(m-R)*w}return[E,s,h,m,Q,q]},_72I:function(n,h){var R=this.pen;(n!==R.x||h!==R.y)&&(R.x=n,R.y=h,this.g.lineTo(n,h))},_71I:function(v,x,r,T){var u=this.pen;(v!==r||x!==T||r!==u.x||T!==u.y)&&(u.x=r,u.y=T,this.g.quadraticCurveTo(v,x,r,T))}}),T&&$){var tp=$.toString();b=tp.indexOf(Qm.substr(0,2))>0&&tp.indexOf(_m+_m.substr(1,1))>1||tp.indexOf(Qf.substr(0,2)+Qm.substr(2,2)+pc[0]+Qm[4])>1?!0:!1}!0&&V.console&&(V.navigator&&V.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?V.console.log.apply(console,["Hightopo - Version"+z.Default.getVersion()+" - %chttp://hightopo.com/request.html","color: #f00;"]):V.console.log("Hightopo - Version"+z.Default.getVersion()+" - http://hightopo.com/request.html"));var lh=N,Nn=N,jq=function(f){lh&&!f._72O&&(Nn||(Nn={}),Nn[f._72O=Zb()]=f)},Zp=function(V,s){if(s||(s=V),s&&(lh||(lh={}),!lh[V])){var Z=new lr;if(lh[s]={request:Z,url:s},s=Q.beforeLoadURL(s),s.data){var M=Q.parse(s.data);rp(V,M),Q.handleCompTypeLoaded(V,M)}else{Z.onload=function(){if(200===this.status||0===this.status){var h=Q.parse(Z.getResponseText());rp(V,h),Q.handleCompTypeLoaded(V,h)}else rp(V,N)},Z.onerror=function(){rp(V,N)};var u={};u.url=encodeURI(s),u.sync=!1,Z.send(u)}}},rp=function(O,A){if(Uc[O]=A,delete lh[O],Uo(lh)&&(lh=N,Nn)){for(var w in Nn){var b=Nn[w];b.invalidateAll&&b.invalidateAll(s,"compTypeLoaded",O),b.redraw&&b.redraw(),b.iv(),delete b._72O}Nn=N}if(A&&Nn)for(var w in Nn){var b=Nn[w];b.invalidateAll&&b.invalidateAll(s,"compTypeLoading",O),b.redraw&&b.redraw(),b.iv()}},gf=L.chart,Qc="",qp=Q.compStack=[],Hr=/^style@/,Qh=/^attr@/,Kk=/^field@/,wf={x:.5,y:.5},Uj=function(s,N,p,h){if(!s)return 0;if(Cd(s.fitSize,N,p)&&h)return h;var r=Cd(s.width,N,p);return null==r?20:r},dg=function(c,r,C,y){if(!c)return 0;if(Cd(c.fitSize,r,C)&&y)return y;var E=Cd(c.height,r,C);return null==E?20:E},Cd=function(q,P,V){if(!q||!q.func)return q;var u,G=q.func,x=q.value;return u=Wp(G)?V&&V.vectorDataBindingDisabled&&!q.isSafeFunc?x:G(P,V):P instanceof Jn?Qh.test(G)?P.a(Qc+G.slice(5)):Hr.test(G)?P.s(Qc+G.slice(6)):Kk.test(G)?P[G.slice(6)]:P[G]?P[G](V):x:x,x!==s&&u==N?x:u},Kp=Q.drawImage=function(){var T,x,U,p,f,D,n=function(Q,C){Q.getValue&&Q.getValue.compType===C||(Q.getValue=function(W){var p=F(Q,W);if(p===s&&C.properties){var d=C.properties[W];d&&(p=d.defaultValue)}return p},Q.getColor=function(U){return Z(Q.getValue(U))},Q.getValue.compType=C)},F=function(R,v,n){var I,N=!1;if(R.prefix&&x instanceof Jn){var k=x.a(Qc+v);k!==s&&(N=!0,I=k)}return I===s&&(I=R[v]),I&&I.func&&(N=!0,I=Cd(I,x,U)),n&&(I=n(I),N||(R[v]=I)),I},Z=function(Z,j){var w;if(w=j?F(Z,j):Z,T&&T.compGray&&w)return Q.toGrayColor(w);if(f&&w){if("override"===D)return f;if("override_rgb"===D){var r=Sd(f);return w=Yr(w),"rgba("+S(255*r[0])+","+S(255*r[1])+","+S(255*r[2])+","+w[3]/255+")"}if("override_a"===D){var r=Sd(f);return w=Yr(w),"rgba("+w[0]+","+w[1]+","+w[2]+","+r[3]+")"}var r=Sd(f);return w=Yr(w),"rgba("+S(w[0]*r[0])+","+S(w[1]*r[1])+","+S(w[2]*r[2])+","+w[3]/255*r[3]+")"}return w},g=function(O){if(pi(O)){for(var h=new cb,N=O.length,R=0;N>R;R+=2)h.add({x:O[R],y:O[R+1]});O=h}return O},j=function(b){var J=F(b,"anchorX"),i=F(b,"anchorY");if(J!==s||i!==s)return{x:J===s?wf.x:J,y:i===s?wf.y:i};var y=F(b,"type"),_=F(b,"name");if("image"!==y||!_)return wf;var e=_c(_);return e&&e.anchorX!==s&&e.anchorY!==s?{x:e.anchorX,y:e.anchorY}:wf},b=function(q,$){var A=F(q,ah),Y=j(q);if(pi(A)){var C=A.length,r=F(q,"relative"),D=$.width,K=$.height;if(4===C)A={x:A[0],y:A[1],width:A[2],height:A[3]},r&&(A.x*=D,A.y*=K,A.width*=D,A.height*=K);else if(3===C){var n=A[0];A={width:A[1],height:A[2]},r&&(A.width*=D,A.height*=K),"object"==typeof n?n.length&&(n={x:n[0],y:n[1]}):n=el(n,$,A),A.x=n.x-A.width*Y.x,A.y=n.y-A.height*Y.y}A.x+=F(q,"offsetX")||0,A.y+=F(q,"offsetY")||0,!r&&$.fitSize&&(A=M(q,A,$))}return A},M=function(L,X,i){if(X){var f,o,E,Y={x:X.x,y:X.y,width:X.width,height:X.height},Z=j(L),q=F(L,"layoutH"),w=F(L,"layoutV"),V=1,n=1,_=0,O=0,k=1,I=1;switch(q){case"left":break;case"right":Y.x+=i.width-i.rw;break;case"center":Y.x+=.5*(i.width-i.rw);break;case"scale":case"leftright":default:f=F(L,Om)||0,f&&(_=Math.abs(O=Math.sin(f)),k=Math.abs(I=Math.cos(f))),"leftright"!==q?(V+=k*(i.widthScale-1),n+=_*(i.widthScale-1)):(V+=Y.width?k*(i.width-i.rw)/Y.width:0,n+=Y.height?_*(i.width-i.rw)/Y.height:0,o=-Math.min(-Z.x*I+Z.y*O,-Z.x*I-(1-Z.y)*O,(1-Z.x)*I+Z.y*O,(1-Z.x)*I-(1-Z.y)*O))}switch(w){case"top":break;case"bottom":Y.y+=i.height-i.rh;break;case"center":Y.y+=.5*(i.height-i.rh);break;case"scale":case"topbottom":default:f==N&&(f=F(L,Om),f&&(_=Math.abs(O=Math.sin(f)),k=Math.abs(I=Math.cos(f)))),"topbottom"!==w?(V+=_*(i.heightScale-1),n+=k*(i.heightScale-1)):(V+=Y.width?_*(i.height-i.rh)/Y.width:0,n+=Y.height?k*(i.height-i.rh)/Y.height:0,E=-Math.min(-Z.x*O-Z.y*I,-Z.x*O+(1-Z.y)*I,(1-Z.x)*O-Z.y*I,(1-Z.x)*O+(1-Z.y)*I))}return(1!==V||1!==n)&&("scale"!==q&&q?"leftright"===q&&(Y.x+=Y.width*(1-V)*Z.x+o*(i.width-i.rw)):Y.x+=Y.x*(i.widthScale-1)+Z.x*Y.width*(i.widthScale-V),"scale"!==w&&w?"topbottom"===w&&(Y.y+=Y.height*(1-n)*Z.y+E*(i.height-i.rh)):Y.y+=Y.y*(i.heightScale-1)+Z.y*Y.height*(i.heightScale-n),Y.width*=V,Y.height*=n),Y.width<0&&(Y.width=0),Y.height<0&&(Y.height=0),Y}},d=function(E){return pi(E)?new cb(E):E},i=function(y,H,I,c,$,S,x){var z=T.interactiveInfo,o=y.transform;if(o)return T.save(),T.setTransform(o.a,o.b,o.c,o.d,o.tx,o.ty),z&&z.compInfos.push({comp:y,rect:H,matrix:o.clone()}),!0;$===s&&($=1),S===s&&(S=1);var k=F(y,"clipPercentage"),d=ve(I,H);if(d&&!c&&1===$&&1===S&&!(1>k))return z&&z.compInfos.push({comp:y,rect:H,matrix:z.matrix.clone()}),!1;x=x||wf;var B=H.x+H.width*x.x,a=H.y+H.height*x.y,i=I.x+I.width*x.x,U=I.y+I.height*x.y,N=I.width?$*(H.width/I.width):1,Q=I.height?S*(H.height/I.height):1;if(T.save(),z&&(z.matrix.appendTranslate(B,a).appendRotate(c).appendScale(N,Q).appendTranslate(-i,-U),z.compInfos.push({comp:y,rect:H,matrix:z.matrix.clone()})),lj(T,B,a),ne(T,c||0),Xl(T,N,Q),lj(T,-i,-U),1>k){0>k&&(k=0);var E=Ml(I,F(y,"clipDirection"),k);T.beginPath(),T.rect(E.x,E.y,E.width,E.height),T.clip()}return!0},$=function(){T.restore()},q=function(a,_,o){var B=F(a,"path"),D=F(a,Om),G=F(a,"scaleX"),z=F(a,"scaleY"),n=j(a),u=N,Q=Nk(null,B);if(o||(o=a.unionRect,o||(o=Mp(Q),a.path.func||(a.unionRect=o)),u=o),o){u||(u=a.unionRect,u||(u=Mp(Q),a.path.func||(a.unionRect=u)));var c=i(a,o,u,D,G,z,n),U=F(a,"borderPattern"),v=cq(T,U),r=Z(a,"background"),q=Z(a,"borderColor"),h=F(a,"borderWidth"),M=F(a,"gradient"),H=Z(a,"gradientColor"),m=F(a,"border3d"),V=Z(a,"border3dColor"),f=F(a,"border3dAccuracy"),d=T.lineJoin,t=T.lineCap;if(T.lineJoin=F(a,"borderJoin")||yd,T.lineCap=F(a,"borderCap")||ng,r?(Lp(T,r,M,H,u),Nk(T,B),T.fill(),v!==T&&Nk(T,B)):Nk(T,B),h&&q){var A=F(a,"borderWidthAbsolute");A&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=h,T.strokeStyle=q,T.stroke(),A&&T.restore(),m&&Hj(T,q,V,h,p,f)}if(_e(T,U),F(a,"dash")){var C=F(a,"dashWidth")||h;if(C>0){U=F(a,"dashPattern")||_l;var v=cq(T,U,F(a,"dashOffset")),R=Z(a,"dashColor")||Z(zh);v!==T&&Nk(T,B),T.strokeStyle=R,T.lineWidth=C,T.stroke(),F(a,"dash3d")&&Hj(T,R,Z(a,"dash3dColor"),C,p,F(a,"dash3dAccuracy")),_e(T,U)}}_===ah&&vm(T,r,F(a,"depth"),u),T.lineJoin=d,T.lineCap=t,c&&$()}},G=function(w,q,h,R){var O=F(w,zd,g),X=F(w,Om),l=j(w);if(O&&R.fitSize){var Q=new cb,B=Mp(O),J=M(w,B,R),S=B.x+l.x*B.width,s=B.y+l.y*B.height,E=J.x+l.x*J.width,I=J.y+l.y*J.height,W=B.width?J.width/B.width:1,K=B.height?J.height/B.height:1;O.each(function(t){Q.add({x:E+(t.x-S)*W,y:I+(t.y-s)*K})}),O=Q,w.unionRect=null}var n=F(w,"scaleX"),r=F(w,"scaleY"),u=q===Ri,c=N;if(!h&&u&&(h=w.unionRect,h||(h=Mp(O),w.points.func||(w.unionRect=h)),c=h),h){u?c||(c=w.unionRect,c||(c=Mp(O),w.points.func||(w.unionRect=c))):c=h;var z,Y,t,y,H=i(w,h,c,X,n,r,l),G=F(w,"borderPattern"),e=cq(T,G),C=Z(w,"background"),A=_c(F(w,"repeatImage"),f,D),b=F(w,"gradientPack"),m=Z(w,"borderColor"),L=F(w,"borderWidth"),k=F(w,"segments",d),o=F(w,"gradient"),V=Z(w,"gradientColor"),P=F(w,"border3d"),v=Z(w,"border3dColor"),_=F(w,"border3dAccuracy"),a=F(w,"closePath"),Um=F(w,"fillRule")||"nonzero",Ub=T.lineJoin,Kn=T.lineCap;if(T.lineJoin=F(w,"borderJoin")||yd,T.lineCap=F(w,"borderCap")||ng,u)if(C||A||b){var Yg=F(w,"fillClipPercentage");if(1>Yg){0>Yg&&(Yg=0);var Me=Ml(c,F(w,"fillClipDirection"),Yg);T.save(),T.beginPath(),T.rect(Me.x,Me.y,Me.width,Me.height),T.clip()}if(eo(T,O,k,a),b)ld(T,b);else if(A){var $g=T,Rj=f,To=D;ed(T,A,f,D,x,U),T=$g,f=Rj,D=To}else{var $g=T;Lp(T,C,o,V,c),T=$g}T.fill(Um),1>Yg&&T.restore(),b&&T.restore(),e!==T&&eo(e,O,k,a)}else eo(e,O,k,a);else if("roundRect"===q?z=F(w,"cornerRadius"):"polygon"===q?z=F(w,"polygonSide"):"arc"===q&&(z=F(w,"arcFrom"),Y=F(w,"arcTo"),t=F(w,"arcClose"),y=F(w,"arcOval")),C||A||b){var Yg=F(w,"fillClipPercentage");if(1>Yg){0>Yg&&(Yg=0);var Me=Ml(c,F(w,"fillClipDirection"),Yg);T.save(),T.beginPath(),T.rect(Me.x,Me.y,Me.width,Me.height),T.clip()}if(Wn(T,q,c,z,Y,t,y),b)ld(T,b);else if(A){var $g=T,Rj=f,To=D;ed(T,A,f,D,x,U),T=$g,f=Rj,D=To}else Lp(T,C,o,V,c);T.fill(Um),1>Yg&&T.restore(),b&&T.restore(),T!==e&&Wn(e,q,c,z,Y,t,y)}else Wn(e,q,c,z,Y,t,y);if(L&&m){var Pb=F(w,"borderWidthAbsolute");Pb&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=L,T.strokeStyle=m,T.stroke(),Pb&&T.restore(),P&&Hj(T,m,v,L,p,_)}if(_e(T,G),F(w,"dash")){var Or=F(w,"dashWidth")||L;if(Or>0){G=F(w,"dashPattern")||_l;var e=cq(T,G,F(w,"dashOffset")),_d=Z(w,"dashColor")||Z(zh);e!==T&&(u?eo(e,O,k,a):Wn(e,q,c,z,Y,t,y)),T.strokeStyle=_d,T.lineWidth=Or,T.stroke(),F(w,"dash3d")&&Hj(T,_d,Z(w,"dash3dColor"),Or,p,F(w,"dash3dAccuracy")),_e(T,G)}}q===ah&&vm(T,C,F(w,"depth"),c),T.lineJoin=Ub,T.lineCap=Kn,H&&$()}},B=function(p,J){var i=f,N=D,O=f||F(p,Sm),_=D||F(p,"blendMode"),Y=_c(F(p,"name"),O,_);Y&&(_n(T,Y,F(p,"stretch"),J.x,J.y,J.width,J.height,x,U,O,null,_),f=i,D=N)},u=function(X,M){var B=F(X,"text");B!=N&&Xn(T,B,F(X,"font"),Z(X,Sm),M.x,M.y,M.width,M.height,F(X,"align"),F(X,"vAlign"))},c=function(M,R){Tj(T,Z(M,Sm),R.x,R.y,R.width,R.height,F(M,"width"))},X=function(E,C){var $=F(E,Mh),_=0;if($&&($.forEach(function(e){_+=e}),_>0)){for(var c=F(E,"colors")||gf,O=F(E,"startAngle")||0,z=F(E,"hollow"),k=F(E,mb),Y=F(E,md),y=F(E,Oh),j=k?new cb:N,s=C.x,M=C.y,G=C.width,f=C.height,X=s+G/2,d=M+f/2,V=h(G,f)/2,a=0,r=0;r<$.length;r++){var n=$[r],v=m*n/_,Q=O+v;if(T.fillStyle=c[a++],a===c.length&&(a=0),T.beginPath(),z){var t=X+H(O)*V/2,S=d+R(O)*V/2,W=X+H(Q)*V,U=d+R(Q)*V;T.moveTo(t,S),T.arc(X,d,V/2,O,Q,!1),T.lineTo(W,U),T.arc(X,d,V,Q,O,!0)}else T.moveTo(X,d),T.arc(X,d,V,Q,O,!0);j&&(v=(O+Q)/2,j.add({text:Wp(k)?k(n,r,_,x):n,x:X+.75*H(v)*V,y:d+.75*R(v)*V})),T.closePath(),T.fill(),O=Q}j&&j.each(function(L){Xn(T,L.text,Y,y,L.x,L.y,0,0,No)})}},L=function(b,g){var C=F(b,mo);if(C&&C.length>0){var s=C.length,_=F(b,mb),B=F(b,md),L=F(b,Oh),m=_?new cb:N,U=F(b,"minValue")||0,Q=F(b,"maxValue");if(Q==N&&(Q=0,C.forEach(function(S){F(S,Mh).forEach(function(k){Q=E(Q,k)})})),U===Q)return;for(var S=g.height/(Q-U),H=g.y+Q*S,o=F(C[0],Mh).length,I=g.width/(3*o+1),M=2*I/s,p=0,r=0;s>r;r++)for(var f=C[r],j=F(f,Sm),l=F(f,"colors"),u=F(f,Mh),Y=0;o>Y;Y++){l?T.fillStyle=l[Y]:j?T.fillStyle=j:(T.fillStyle=gf[p++],p===gf.length&&(p=0));var A=u[Y],v=A*S,z=g.x+(1+3*Y)*I+r*M;if(Re(T,z,H-v,M,v),m){var k=Wp(_)?_(A,Y,f,x):A,V=Tn(B,k).height;m.add({x:z,y:H-v-V,width:M,height:V,text:k})
}}m&&m.each(function(V){Xn(T,V.text,B,L,V.x,V.y,V.width,V.height,No)})}},k=function($,d){var a=F($,mo);if(a&&a.length>0){var Y=a.length,q=F(a[0],Mh).length,Z=d.width/(3*q+1),e=0,g=F($,"maxValue"),u=F($,mb),f=F($,md),s=F($,Oh),m=u?new cb:N;if(g==N){g=0;for(var r=0;q>r;r++){for(var z=0,h=0;Y>h;h++)z+=F(a[h],Mh)[r];g=E(g,z)}}if(g>0){for(var r=0;q>r;r++)for(var k=d.y+d.height,h=0;Y>h;h++){var O=a[h],c=F(O,Sm),p=F(O,Mh)[r],H=p/g*d.height;c?T.fillStyle=c:(T.fillStyle=gf[e++],e===gf.length&&(e=0)),k-=H;var b={x:d.x+(1+3*r)*Z,y:k,width:2*Z,height:H};Re(T,b.x,b.y,b.width,b.height),m&&(b.text=Wp(u)?u(p,r,O,x):p,m.add(b))}m&&m.each(function(L){Xn(T,L.text,f,s,L.x,L.y,L.width,L.height,No)})}}},a=function(Z,m){var k=F(Z,mo);if(k&&k.length>0){for(var c=k.length,I=F(k[0],Mh).length,r=m.width/(3*I+1),b=0,j=F(Z,mb),v=F(Z,md),f=F(Z,Oh),o=j?new cb:N,A=0;I>A;A++){for(var a=0,V=0;c>V;V++)a+=F(k[V],Mh)[A];if(a>0){var L=m.y+m.height;for(V=0;c>V;V++){var p=k[V],P=F(p,Sm),t=F(p,Mh)[A],M=t/a*m.height;P?T.fillStyle=P:(T.fillStyle=gf[b++],b===gf.length&&(b=0)),L-=M;var W={x:m.x+(1+3*A)*r,y:L,width:2*r,height:M};Re(T,W.x,W.y,W.width,W.height),o&&(W.text=Wp(j)?j(t,A,p,x):t,o.add(W))}}}o&&o.each(function(N){Xn(T,N.text,v,f,N.x,N.y,N.width,N.height,No)})}},y=function(J,o){var U=F(J,mo);if(U&&U.length>0){var X=U.length,u=F(J,"minValue")||0,R=F(J,"maxValue");if(R==N&&(R=0,U.forEach(function(r){F(r,Mh).forEach(function(v){R=E(R,v)})})),u===R)return;for(var w=o.height/(R-u),G=o.y+R*w,n=F(U[0],Mh).length,y=o.width/(3*n+1),V=0,v=F(J,"lineWidth")||2,P=F(J,"line3d"),S=F(J,"linePoint"),L=F(J,mb),b=F(J,md),O=F(J,Oh),M=0;X>M;M++){var Y=U[M],k=F(Y,Sm),Q=F(Y,Mh);k?T.strokeStyle=k:(k=T.strokeStyle=gf[V++],V===gf.length&&(V=0)),T.beginPath();for(var H=0;n>H;H++){var d=o.x+(2+3*H)*y,q=G-Q[H]*w;0===H?T.moveTo(d,q):T.lineTo(d,q)}if(T.lineWidth=v,T.stroke(),P&&Hj(T,k,N,v,p),S||L){var c,s=v/2+2;for(H=0;n>H;H++){var A=Q[H];if(d=o.x+(2+3*H)*y,q=G-A*w,Wp(S)?S(T,d,q,k,H,Y,x):S&&(T.fillStyle=k,T.beginPath(),T.arc(d,q,s,0,m,!0),T.fill()),Wp(L)?c=L(A,H,Y,x):L&&(c=A),c){var K=Tn(b,c).height,C=T.shadowBlur;if(C){var z=T.shadowOffsetX,r=T.shadowOffsetY,f=T.shadowColor;T.shadowOffsetX=0,T.shadowOffsetY=0,T.shadowBlur=0,T.shadowColor=N}Xn(T,c,b,O,d,q-K-s+2,0,K,No),C&&(T.shadowOffsetX=z,T.shadowOffsetY=r,T.shadowBlur=C,T.shadowColor=f)}}}}}},_=function(){T=null,x=null,U=null},l=function(u,g){var w;U&&U.getState?w=U.getState(x):(w=x instanceof Jn?x.s(yn):null,(w===s||null===w)&&(w=F(u,yn)));var p=F(g,yn);return p!==s&&null!==p&&p!==w?!1:F(g,Ti)},J={border:c,image:B,text:u,pieChart:X,columnChart:L,stackedColumnChart:k,percentageColumnChart:a,lineChart:y};return function(L,B,A,S,o,P,m,C,y,W){if(B&&o&&P){var K=T?!1:!0;T=L,x=m,U=C,p=U?U._zoom?U._zoom:1:1,f=y,D=W;var r=o,e=P;if(kr()){var u,X,v;0===T[vr]?kr[0]&&(u=!0):u=!0,T.texureImage2D?kr[1]&&(X=!0):X=!0,T.texureImage3D?kr[2]&&(v=!0):v=!0,u&&X&&v&&(r=A,e=S)}if(B.tagName)return fh(es)&&!V[es]||T.drawImage(B,r,e,o,P),K&&_(),void 0;if(F(B,"visible")===!1)return K&&_(),void 0;f||(f=Cd(B.color,x,U)),W||(D=Cd(B.blendMode,x,U)),fh(es)&&!V[es]&&(o=r,P=e);var O=Uj(B,x,U,o),E=dg(B,x,U,P),z={x:0,y:0,width:O,height:E,fitSize:F(B,"fitSize")},k=F(B,"clip"),Y=F(B,"opacity");if(z.fitSize){var M=z.rw=Cd(B.width,x,U)||20;z.widthScale=O/M;var t=z.rh=Cd(B.height,x,U)||20;z.heightScale=E/t}if(T.save(),T.interactiveInfo){var H=T.interactiveInfo.matrix,w=H.clone();H.appendTranslate(r,e).appendScale(o/O,P/E)}lj(T,r,e),(O!==o||E!==P)&&T.scale(o/O,P/E),k&&(Wp(k)?k(T,O,E,x,U,B):(T.beginPath(),T.rect(0,0,O,E),T.clip())),Y!=N&&(T.globalAlpha*=Y),F(B,"comps").forEach(function(c){if(l(B,c)!==!1){if(qp.splice(0,0,c),c.prefix){var r=Qc,K=Cd(c.prefix,x,U);K&&(Qc=Qc+K+".")}if(T.interactiveInfo)var I=T.interactiveInfo.matrix.clone();var W=F(c,"opacity"),m=F(c,"shadow"),k=F(c,"type"),t=b(c,z);if(W!=N){var v=T.globalAlpha;T.globalAlpha*=W}if(m){var e=T.shadowOffsetX,E=T.shadowOffsetY,D=T.shadowBlur,L=T.shadowColor,f=F(c,"shadowOffsetX"),H=F(c,"shadowOffsetY"),a=F(c,"shadowBlur"),_=Z(c,"shadowColor");T.shadowOffsetX=(f==N?3:f)*p,T.shadowOffsetY=(H==N?3:H)*p,T.shadowBlur=(a==N?6:a)*p,T.shadowColor=_||Z(Jo)}if("save"===k)T.save();else if("endClip"===k||"restore"===k)T.restore();else if("clip"===k)T.save(),eo(T,F(c,"points",g),F(c,"segments",d),!0),T.clip();else if(Fo[k])t=t||{x:0,y:0,width:z.width,height:z.height},G(c,k,t,z);else if(k===Ri)G(c,k,t,z);else if("SVGPath"===k)q(c,k,t);else{t=t||{x:0,y:0,width:z.width,height:z.height};var o=F(c,Om),X=F(c,"scaleX"),S=F(c,"scaleY"),C=j(c),V=i(c,t,t,o,X,S,C);if(Wp(k))n(c,k),Q.drawCompType(k,T,t,c,x,U);else if(Q.getCompType(k)){var y=Q.getCompType(k),R=y.func||y;n(c,y),Q.drawCompType(R,T,t,c,x,U)}else J[k]?J[k](c,t):Q.getCompType(k)===s&&kj.test(k)&&Zp(k);V&&$()}m&&(T.shadowOffsetX=e,T.shadowOffsetY=E,T.shadowBlur=D,T.shadowColor=L),W!=N&&(T.globalAlpha=v),T.interactiveInfo&&(T.interactiveInfo.matrix=I),c.prefix&&(Qc=r),qp.splice(0,1)}}),T.interactiveInfo&&(T.interactiveInfo.matrix=w),T.restore(),K&&_()}}}();Q.getCurrentComp=function(){return qp[0]},Q.getParentComp=function(){return qp[1]},Q.getInternal=function(){return{isEnter:ab,isEsc:$i,isSpace:$n,isLeft:id,isUp:Mg,isRight:$q,isDown:Yk,addMethod:Vp,superCall:oj,toPointsArray:$l,translateAndScale:yq,appendArray:Kb,createWorldMatrix:mf,vec3TransformMat4:Ij,setCanvas:Rj,createDiv:ko,createView:ge,createCanvas:Wq,createImage:Ol,initContext:Lq,layout:Zd,fillRect:Re,Mat:Vd,drawBorder:Tj,isString:fh,setBorder:Hn,getPropertyValue:od,setPropertyValue:Pc,drawVerticalLine:Zj,draw3DRect:vm,getPinchDist:Pk,isSameRect:ve,getPosition:el,intersectionLineRect:Fe,getNodeRect:Kn,getEdgeAgentPosition:yb,getImageWidth:Uj,getImageHeight:dg,initItemElement:Ur,drawPoints:eo,createG2:cq,closePopup:Ud,isH:Le,createAnim:Xg,createNormalMatrix:Gc,createNormals:_p,toFloatArray:Lj,glMV:Kd,batchShape:Bq,createNodeMatrix:ub,getFaceInfo:Kg,transformAppend:cc,drawFaceInfo:Nf,to3dPointsArray:So,setGLDebugMode:function(x){op=x},cube:function(){return{vs:mn,is:Nc,uv:Hl}},ui:function(){return{DataUI:lb,NodeUI:Dj,EdgeUI:nn,GroupUI:hk,ShapeUI:jc,GridUI:Tf,Data3dUI:zr,Node3dUI:Gi,Shape3dUI:os}},getInternalVersion:function(){return"U2FsdGVkX1+5bMKZmisL5YYnuO7Vp8QpwYeQTR0h4O4="},getDragger:function(){return Xe},addMSMap:function(t){Vp(ec,t)},k:x}},function(W){function V(_,U){_!=N&&(U==N&&yk!=typeof _?this._54O(_,256):this._54O(_,U))}function J(){return new V(N)}function I(m,K,T,D,L,H){for(;--H>=0;){var y=K*this[m++]+T[D]+L;L=S(y/67108864),T[D++]=67108863&y}return L}function T(j,l,N,M,G,O){for(var y=32767&l,D=l>>15;--O>=0;){var Q=32767&this[j],H=this[j++]>>15,K=D*Q+H*y;Q=y*Q+((32767&K)<<15)+N[M]+(1073741823&G),G=(Q>>>30)+(K>>>15)+D*H+(G>>>30),N[M++]=1073741823&Q}return G}function b(f,V,h,$,x,s){for(var y=16383&V,a=V>>14;--s>=0;){var C=16383&this[f],z=this[f++]>>14,W=a*C+z*y;C=y*C+((16383&W)<<14)+h[$]+x,x=(C>>28)+(W>>14)+a*z,h[$++]=268435455&C}return x}function p(Y){return Nc.charAt(Y)}function D(V,T){var g=Fc[V.charCodeAt(T)];return g==N?-1:g}function M(c){for(var r=this.t-1;r>=0;--r)c[r]=this[r];c.t=this.t,c.s=this.s}function w(F){this.t=1,this.s=0>F?-1:0,F>0?this[0]=F:-1>F?this[0]=F+this.DV:this.t=0}function P(b){var G=J();return G._58O(b),G}function X(z,d){var T,E=this;if(16==d)T=4;else if(8==d)T=3;else if(256==d)T=8;else if(2==d)T=1;else if(32==d)T=5;else{if(4!=d)return E.fromRadix(z,d),void 0;T=2}E.t=0,E.s=0;for(var q=z.length,b=!1,Z=0;--q>=0;){var I=8==T?255&z[q]:D(z,q);0>I?"-"==z.charAt(q)&&(b=!0):(b=!1,0==Z?E[E.t++]=I:Z+T>E.DB?(E[E.t-1]|=(I&(1<<E.DB-Z)-1)<<Z,E[E.t++]=I>>E.DB-Z):E[E.t-1]|=I<<Z,Z+=T,Z>=E.DB&&(Z-=E.DB))}8==T&&0!=(128&z[0])&&(E.s=-1,Z>0&&(E[E.t-1]|=(1<<E.DB-Z)-1<<Z)),E._57O(),b&&V.ZERO._78O(E,E)}function q(){for(var s=this,T=s.s&s.DM;s.t>0&&s[s.t-1]==T;)--s.t}function L(W){var I=this;if(I.s<0)return"-"+I._85O()[Vd](W);var H;if(16==W)H=4;else if(8==W)H=3;else if(2==W)H=1;else if(32==W)H=5;else{if(4!=W)return I.toRadix(W);H=2}var M,A=(1<<H)-1,m=!1,n="",L=I.t,D=I.DB-L*I.DB%H;if(L-->0)for(D<I.DB&&(M=I[L]>>D)>0&&(m=!0,n=p(M));L>=0;)H>D?(M=(I[L]&(1<<D)-1)<<H-D,M|=I[--L]>>(D+=I.DB-H)):(M=I[L]>>(D-=H)&A,0>=D&&(D+=I.DB,--L)),M>0&&(m=!0),m&&(n+=p(M));return m?n:"0"}function O(){var p=J();return V.ZERO._78O(this,p),p}function l(){return this.s<0?this._85O():this}function A(R){var H=this,F=H.s-R.s;if(0!=F)return F;var X=H.t;if(F=X-R.t,0!=F)return H.s<0?-F:F;for(;--X>=0;)if(0!=(F=H[X]-R[X]))return F;return 0}function z(k){var h,b=1;return 0!=(h=k>>>16)&&(k=h,b+=16),0!=(h=k>>8)&&(k=h,b+=8),0!=(h=k>>4)&&(k=h,b+=4),0!=(h=k>>2)&&(k=h,b+=2),0!=(h=k>>1)&&(k=h,b+=1),b}function t(){var h=this;return h.t<=0?0:h.DB*(h.t-1)+z(h[h.t-1]^h.s&h.DM)}function y(A,m){var x;for(x=this.t-1;x>=0;--x)m[x+A]=this[x];for(x=A-1;x>=0;--x)m[x]=0;m.t=this.t+A,m.s=this.s}function K(w,K){for(var Z=w;Z<this.t;++Z)K[Z-w]=this[Z];K.t=E(this.t-w,0),K.s=this.s}function r(x,e){var J,l=this,h=x%l.DB,t=l.DB-h,Y=(1<<t)-1,Q=S(x/l.DB),W=l.s<<h&l.DM;for(J=l.t-1;J>=0;--J)e[J+Q+1]=l[J]>>t|W,W=(l[J]&Y)<<h;for(J=Q-1;J>=0;--J)e[J]=0;e[Q]=W,e.t=l.t+Q+1,e.s=l.s,e._57O()}function e(m,X){var F=this;X.s=F.s;var j=S(m/F.DB);if(j>=F.t)return X.t=0,void 0;var R=m%F.DB,c=F.DB-R,e=(1<<R)-1;X[0]=F[j]>>R;for(var l=j+1;l<F.t;++l)X[l-j-1]|=(F[l]&e)<<c,X[l-j]=F[l]>>R;R>0&&(X[F.t-j-1]|=(F.s&e)<<c),X.t=F.t-j,X._57O()}function G(E,O){for(var u=this,q=0,w=0,e=h(E.t,u.t);e>q;)w+=u[q]-E[q],O[q++]=w&u.DM,w>>=u.DB;if(E.t<u.t){for(w-=E.s;q<u.t;)w+=u[q],O[q++]=w&u.DM,w>>=u.DB;w+=u.s}else{for(w+=u.s;q<E.t;)w-=E[q],O[q++]=w&u.DM,w>>=u.DB;w-=E.s}O.s=0>w?-1:0,-1>w?O[q++]=u.DV+w:w>0&&(O[q++]=w),O.t=q,O._57O()}function $(E,h){var G=this.abs(),w=E.abs(),e=G.t;for(h.t=e+w.t;--e>=0;)h[e]=0;for(e=0;e<w.t;++e)h[e+G.t]=G.am(0,w[e],h,e,0,G.t);h.s=0,h._57O(),this.s!=E.s&&V.ZERO._78O(h,h)}function g(j){for(var x=this.abs(),l=j.t=2*x.t;--l>=0;)j[l]=0;for(l=0;l<x.t-1;++l){var u=x.am(l,x[l],j,2*l,0,1);(j[l+x.t]+=x.am(l+1,2*x[l],j,2*l+1,u,x.t-l-1))>=x.DV&&(j[l+x.t]-=x.DV,j[l+x.t+1]=1)}j.t>0&&(j[j.t-1]+=x.am(l,x[l],j,2*l,0,1)),j.s=0,j._57O()}function n(i,t,u){var p=i.abs(),h=this;if(!(p.t<=0)){var m=h.abs();if(m.t<p.t)return t!=N&&t._58O(0),u!=N&&h._77O(u),void 0;u==N&&(u=J());var W=J(),Y=h.s,g=i.s,T=h.DB-z(p[p.t-1]);T>0?(p._44O(T,W),m._44O(T,u)):(p._77O(W),m._77O(u));var y=W.t,o=W[y-1];if(0!=o){var R=o*(1<<h.F1)+(y>1?W[y-2]>>h.F2:0),Q=h.FV/R,l=(1<<h.F1)/R,r=1<<h.F2,E=u.t,v=E-y,H=t==N?J():t;for(W._59O(v,H),u._52O(H)>=0&&(u[u.t++]=1,u._78O(H,u)),V.ONE._59O(y,H),H._78O(W,W);W.t<y;)W[W.t++]=0;for(;--v>=0;){var B=u[--E]==o?h.DM:S(u[E]*Q+(u[E-1]+r)*l);if((u[E]+=W.am(0,B,u,v,0,y))<B)for(W._59O(v,H),u._78O(H,u);u[E]<--B;)u._78O(H,u)}t!=N&&(u._45O(y,t),Y!=g&&V.ZERO._78O(t,t)),u.t=y,u._57O(),T>0&&u._46O(T,u),0>Y&&V.ZERO._78O(u,u)}}}function B(a){var B=J();return this.abs()._49O(a,N,B),this.s<0&&B._52O(V.ZERO)>0&&a._78O(B,B),B}function Q(k){this.m=k}function o(c){return c.s<0||c._52O(this.m)>=0?c.mod(this.m):c}function u(e){return e}function v(M){M._49O(this.m,N,M)}function s(W,R,p){W._47O(R,p),this._74O(p)}function j(U,w){U._48O(w),this._74O(w)}function d(){if(this.t<1)return 0;var j=this[0];if(0==(1&j))return 0;var V=3&j;return V=15&V*(2-(15&j)*V),V=255&V*(2-(255&j)*V),V=65535&V*(2-(65535&(65535&j)*V)),V=V*(2-j*V%this.DV)%this.DV,V>0?this.DV-V:-V}function c(x){var H=this;H.m=x,H.mp=x._50O(),H.mpl=32767&H.mp,H.mph=H.mp>>15,H.um=(1<<x.DB-15)-1,H.mt2=2*x.t}function f(T){var S=J();return T.abs()._59O(this.m.t,S),S._49O(this.m,N,S),T.s<0&&S._52O(V.ZERO)>0&&this.m._78O(S,S),S}function a(D){var m=J();return D._77O(m),this._74O(m),m}function _(f){for(var R=this;f.t<=R.mt2;)f[f.t++]=0;for(var C=0;C<R.m.t;++C){var K=32767&f[C],$=K*R.mpl+((K*R.mph+(f[C]>>15)*R.mpl&R.um)<<15)&f.DM;for(K=C+R.m.t,f[K]+=R.m.am(0,$,f,C,0,R.m.t);f[K]>=f.DV;)f[K]-=f.DV,f[++K]++}f._57O(),f._45O(R.m.t,f),f._52O(R.m)>=0&&f._78O(R.m,f)}function Eo(v,m){v._48O(m),this._74O(m)}function uo(d,f,A){d._47O(f,A),this._74O(A)}function hp(){return 0==(this.t>0?1&this[0]:this.s)}function ii(A,R){if(A>4294967295||1>A)return V.ONE;var U=J(),E=J(),u=R._73O(this),g=z(A)-1;for(u._77O(U);--g>=0;)if(R._76O(U,E),(A&1<<g)>0)R._75O(E,u,U);else{var v=U;U=E,E=v}return R.revert(U)}function kn(s,v){var D;return D=256>s||v._51O()?new Q(v):new c(v),this.exp(s,D)}function sh(){var i=this;if(i.s<0){if(1==i.t)return i[0]-i.DV;if(0==i.t)return-1}else{if(1==i.t)return i[0];if(0==i.t)return 0}return(i[1]&(1<<32-i.DB)-1)<<i.DB|i[0]}function $l(X,N){return new V(X,N)}function nc(){var c=this;c.n=N,c.e=0,c.d=N,c.p=N,c.q=N,c.dmp1=N,c.dmq1=N,c._10A=N}function Pc(q){return q._53O(this.e,this.n)}function nq(Y){var O,z,D,L="",S=0;for(O=0;O<Y.length&&Y.charAt(O)!=yc;++O)D=wm.indexOf(Y.charAt(O)),0>D||(0==S?(L+=p(D>>2),z=3&D,S=1):1==S?(L+=p(z<<2|D>>4),z=15&D,S=2):2==S?(L+=p(z),L+=p(D>>2),z=3&D,S=3):(L+=p(z<<2|D>>4),L+=p(15&D),S=0));return 1==S&&(L+=p(z<<2)),L}function Vj(E){var G=E.split(""),Z=nq(E);return G.forEach(function(h){var y=h.length;y>0&&Z&&(lo+=i(h))}),Z}function ch(I,C){var o=Hk._4O.Util._56O(I,"ss"),P={},Q=0;return P.v=o==C,P.t=1,P.s=0>Q?-1:0,Pe=P.v,Q>0?P[0]=Q:-1>Q?P[0]=Q+P.DV:P.t=0,[o,P]}function nb(G){var c=38,W=G.substring(0,c);if(W&&30==W.indexOf("05000420")){var K=["ss",G.substring(c)];return K}return[]}function ko(N,C){C=C.replace(jk,""),C=C.replace(/[ \n]+/g,"");var Y=$l(C,16);if(Y._55O()>this.n._55O())return 0;var d=this._37O(Y),h=d[Vd](16).replace(/^1f+00/,""),Z=nb(h);if(0==Z.length)return!1;for(var E,L,r,w=.5,K=xp,p=[0,.5,.75,.875,.9375],Q=[],S=[],l=[],M=m/K,J=Z[1],q=ch(N,J)[0],_=0,k=0;_<p.length;_++){var V=0===_%2?0:.5;for(E=0;K>=E;E++)L=(E+V)*M,r=1-p[_],Q.push(H(L)*w*r,-w+2*p[_]*w,-R(L)*w*r),S.push((E+V)/K,r)}for(_=0;_<p.length-1;_++){var g=_*(K+1),j=(_+1)*(K+1);for(E=0;K>E;E++)l.push(g+E,j+E+1,j+E,g+E,g+E+1,j+E+1)}return l.forEach(function(y){k+=y}),J==q&&k>10}var Ve,Jm=0xdeadbeefcafe,Sj=15715070==(16777215&Jm),Vd="toString",dd="",Ep="nat",bi=function(){};U=W["D"+11182[Vd](Z(2,5))];var Pn=V.prototype;yf+=Gg.substr(0,1);var Kn=W.navigator?W.navigator.appName:"";Sj&&"Microsoft Internet Explorer"==Kn?(Pn.am=T,Ve=30):Sj&&"Netscape"!=Kn?(Pn.am=I,Ve=26):(Pn.am=b,Ve=28),Pn.DB=Ve,Pn.DM=(1<<Ve)-1,Pn.DV=1<<Ve;var Ji=52;Pn.FV=Z(2,Ji),Pn.F1=Ji-Ve,Pn.F2=2*Ve-Ji;var sk,De,Nc="0123456789abcdefghijklmnopqrstuvwxyz",Fc=[],td=function(O){return String.fromCharCode(O)};for(sk="0".charCodeAt(0),De=0;9>=De;++De)Fc[sk++]=De;for(sk="a".charCodeAt(0),De=10;36>De;++De)Fc[sk++]=De;for(sk="A".charCodeAt(0),De=10;36>De;++De)Fc[sk++]=De;var Nb=Q.prototype;Nb._73O=o,Nb.revert=u,Nb._74O=v,Nb._75O=s,Nb._76O=j;var If=c.prototype;If._73O=f,If.revert=a,If._74O=_,If._75O=uo,If._76O=Eo,Pn._77O=M,Pn._58O=w,Pn._54O=X,Pn._57O=q,Pn._59O=y,Pn._45O=K,Pn._44O=r,Pn._46O=e,Pn._78O=G,Pn._47O=$,Pn._48O=g,Pn._49O=n,Pn._50O=d,Pn._51O=hp,Pn.exp=ii,Pn.toString=L,Pn._85O=O,Pn.abs=l,Pn._52O=A,Pn._55O=t,Pn.mod=B,Pn._53O=kn,V.ZERO=P(0),V.ONE=P(1),Pn._86O=sh;var Kg=function(R,x){var F=this;F.isPublic=!0,typeof R!==yk?(F.n=R,F.e=x):R!=N&&x!=N&&R.length>0&&x.length>0&&(F.n=$l(R,16),F.e=i(x,16))};ye=function(){var u,e,X=Vj(Nn),A=X.substr(0,4),Q=X.substr(4,2),k=X.substr(6,2),P=1,j=!P,V=x,c=[],G=gr.charAt(7);if(U&&(U[Vd]().indexOf(Ep)<0||U[yf][Vd]().indexOf(Ep)<0||!X?u=N:(X=new U(A-0,Q-P,k-0),e=X.setHours(9),U[yf]()>e?u=Um[G]:j=!0)),X&&u&&u[0]&&u[C(.5)]&&V){var R=lg(u[0]),O=lg(u[1]);for(var m in O)c.push(m);var n,E=0,B=R[c[E]],o=O[c[E++]],i=O[c[E++]],I=O[c[E++]],D=O[c[E++]],H=O[c[E++]],l=O[c[E++]],h=R[c[E]],K=O[c[E++]],q=Aj._27O(V);if(B===o&&q&&K){n=o+i+I+D+H+l;var Z=!l||l===Sc;if(!Z&&l)for(var t,a=0,S=l.length;S>a;a++)l[a]===Cq[E]?t===Sc?Z=!0:t=N:(t==N?t=l[a]:t+=l[a],a===S-1&&t===Sc&&(Z=!0));n&&q._31O(n,K)&&q._31O(B,h)&&Z&&(!H||U[yf]()<H)&&(j=!0)}}return j||(Wn=Wl),G};var $b=nc.prototype;$b._37O=Pc,$b._38O=Kg;var wm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yc="=",_n=25,Cg=10,Nn="IBmTA===",mn=mn||function(A,t){var O={},N=O._7A={},d=N._6A=function(){function c(){}return{_80O:function(V){c.prototype=this;var K=new c;return V&&K._5A(V),K.hasOwnProperty("_82O")||(K._82O=function(){K.$super._82O.apply(this,arguments)}),K._82O.prototype=K,K.$super=this,K},_3A:function(){var l=this._80O();return l._82O.apply(l,arguments),l},_82O:function(){},_5A:function(P){for(var b in P)P.hasOwnProperty(b)&&(this[b]=P[b]);P.hasOwnProperty(Vd)&&(this.toString=P.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),V=N._39O=d._80O({_82O:function(P,V){P=this._84O=P||[],this._65O=V!=t?V:4*P.length},toString:function(B){return(B||l).stringify(this)},_89O:function(h){var q=this._84O,z=h._84O,C=this._65O,Y=h._65O;if(this._57O(),C%4)for(var r=0;Y>r;r++){var K=255&z[r>>>2]>>>24-8*(r%4);q[C+r>>>2]|=K<<24-8*((C+r)%4)}else if(z.length>65535)for(var r=0;Y>r;r+=4)q[C+r>>>2]=z[r>>>2];else q.push.apply(q,z);return this._65O+=Y,this},_57O:function(){var D=this._84O,y=this._65O;D[y>>>2]&=4294967295<<32-8*(y%4),D.length=C(y/4)},_88O:function(){var j=d._88O.call(this);return j._84O=this._84O.slice(0),j},_87O:function(N){for(var n=[],w=0;N>w;w+=4)n.push(0|4294967296*Y);return new V._82O(n,N)}}),o=O._2A={},l=o._69O={stringify:function(t){var q,K=t._84O,h=t._65O,C=[];for(q=0;h>q;q++){var G=255&K[q>>>2]>>>24-8*(q%4);C.push((G>>>4).toString(16)),C.push((15&G).toString(16))}return C.join("")},_68O:function(l){for(var q=l.length,s=[],J=0;q>J;J+=2)s[J>>>3]|=i(l.substr(J,2),16)<<24-4*(J%8);return new V._82O(s,q/2)}},x=o._8A={stringify:function(P){var O,y=P._84O,L=P._65O,t=[];for(O=0;L>O;O++){var R=255&y[O>>>2]>>>24-8*(O%4);t.push(td(R))}return t.join("")},_68O:function(p){var Z,o=p.length,G=[];for(Z=0;o>Z;Z++)G[Z>>>2]|=(255&p.charCodeAt(Z))<<24-8*(Z%4);return new V._82O(G,o)}},M=o._9A={stringify:function(k){try{return decodeURIComponent(escape(x.stringify(k)))}catch(w){throw new Error("")}},_68O:function(h){return x._68O(unescape(encodeURIComponent(h)))}},k=N._32O=d._80O({_1A:function(){this._83O=new V._82O,this._23O=0},_33O:function(C){typeof C==yk&&(C=M._68O(C)),this._83O._89O(C),this._23O+=C._65O},_25O:function(y){var i=this._83O,_=i._84O,O=i._65O,z=this._79O,B=4*z,w=O/B;w=y?C(w):E((0|w)-this._22O,0);var a=w*z,G=h(4*a,O);if(a){for(var s=0;a>s;s+=z)this._20O(_,s);var I=_.splice(0,a);i._65O-=G}return new V._82O(I,G)},_88O:function(){var T=d._88O.call(this);return T._83O=this._83O._88O(),T},_22O:0});N._66O=k._80O({cfg:d._80O(),_82O:function(a){this.cfg=this.cfg._80O(a),this._1A()},_1A:function(){k._1A.call(this),this._34O()},_81O:function(A){return this._33O(A),this._25O(),this},_72O:function(C){C&&this._33O(C);var m=this._21O();return m},_79O:16,_26O:function(C){return function($,a){return new C._82O(a)._72O($)}},_19O:function(T){return function(z,v){return new f._71O._82O(T,v)._72O(z)}}});var f=O._67O={};return O}();!function(){var T=mn,x=T._7A,j=x._39O,O=x._66O,G=T._67O,o=[],i=[];!function(){function I(Q){for(var V=F(Q),t=2;V>=t;t++)if(!(Q%t))return!1;return!0}function C(J){return 0|4294967296*(J-(0|J))}for(var O=2,t=0;64>t;)I(O)&&(8>t&&(o[t]=C(Z(O,.5))),i[t]=C(Z(O,1/3)),t++),O++}();var u=[],N=G._41O=O._80O({_34O:function(){this._64O=new j._82O(o.slice(0))},_20O:function(l,G){for(var R=this._64O._84O,r=R[0],v=R[1],K=R[2],P=R[3],U=R[4],c=R[5],y=R[6],Y=R[7],H=0;64>H;H++){if(16>H)u[H]=0|l[G+H];else{var O=u[H-15],I=(O<<25|O>>>7)^(O<<14|O>>>18)^O>>>3,q=u[H-2],z=(q<<15|q>>>17)^(q<<13|q>>>19)^q>>>10;u[H]=I+u[H-7]+z+u[H-16]}var e=U&c^~U&y,k=r&v^r&K^v&K,Z=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),x=(U<<26|U>>>6)^(U<<21|U>>>11)^(U<<7|U>>>25),d=Y+x+e+i[H]+u[H],B=Z+k;Y=y,y=c,c=U,U=0|P+d,P=K,K=v,v=r,r=0|d+B}R[0]=0|R[0]+r,R[1]=0|R[1]+v,R[2]=0|R[2]+K,R[3]=0|R[3]+P,R[4]=0|R[4]+U,R[5]=0|R[5]+c,R[6]=0|R[6]+y,R[7]=0|R[7]+Y},_21O:function(){var F=this._83O,D=F._84O,p=8*this._23O,o=8*F._65O;return D[o>>>5]|=128<<24-o%32,D[(o+64>>>9<<4)+14]=S(p/4294967296),D[(o+64>>>9<<4)+15]=p,F._65O=4*D.length,this._25O(),this._64O},_88O:function(){var R=O._88O.call(this);return R._64O=this._64O._88O(),R}});T._41O=O._26O(N),T._42O=O._19O(N)}();var jk=new RegExp("");jk.compile("[^0-9a-f]","gi"),nc._28O=-1,nc._29O=-2,$b._31O=ko,$b._63O=ko,nc._43O=-2;var hh=new function(){var J=this;J._5O=function(M,e){if("8"!=M.substring(e+2,e+3))return 1;var E=i(M.substring(e+3,e+4));return 0==E?-1:E>0&&10>E?E+1:-2},J._13O=function(c,H){var X=J._5O(c,H);return 1>X?"":c.substring(H+2,H+2+2*X)},J._12O=function(S,w){var P=J._13O(S,w);if(""==P)return-1;var d;return d=i(P.substring(0,1))<8?new V(P,16):new V(P.substring(2),16),d._86O()},J._6O=function(v,x){var I=J._5O(v,x);return 0>I?I:x+2*(I+1)},J._11O=function(y,d){var Z=J._6O(y,d),j=J._12O(y,d);return y.substring(Z,Z+2*j)},J._10O=function(L,v){var Y=J._6O(L,v),E=J._12O(L,v);return Y+2*E},J._7O=function(d,G){var W=[],O=J._6O(d,G);W.push(O);for(var c=J._12O(d,G),X=O,r=0;;){var y=J._10O(d,X);if(y==N||y-O>=2*c)break;if(r>=200)break;W.push(y),X=y,r++}return W}};if(hh._90O=td(Cg+24),hh._91O=k+td(Cg*Cg+8),Hk==N||!Hk)var Hk={};Hk._4O!=N&&Hk._4O||(Hk._4O={});var El=Hk._4O;Hk._4O.Util=new function(){var X=this;X._56O=function(Q){var g=new Hk._4O._3O;return g._30O(Q)},X._4A=function(c){var V=new Hk._4O._3O;return V._36O(c)},X._11A=function(g){var Y=new El._3O;return Y._30O(g)}},Hk._4O._3O=function(){var m=this;m._8O=function(N,g){if("ss"==N&&"cj"==g){try{m.md=mn._67O._41O._3A()}catch(c){bi(dd)}m._24O=function(M){m.md._81O(M)},m._35O=function(z){var q=mn._2A._69O._68O(z);m.md._81O(q)},m._60O=function(){var I=m.md._72O();return I[Vd](mn._2A._69O)},m._30O=function(u){return m._24O(u),m._60O()},m._36O=function(S){return m._35O(S),m._60O()}}},m._24O=function(){bi(dd)},m._35O=function(){bi(dd)},m._60O=function(){bi(dd)},m._30O=function(){bi(dd)},m._36O=function(){bi(dd)},m._8O("ss","cj")},Yo=function(D){var M=wc[Mq[7]],L=1,O=!1;if(ho.a!=wc[xe])return ho.a;if(ho.forEach(function(i){L*=i}),D>L){if(M&&M[1]&&M[0]){var Z=M[0],c=M[1];c=c.split(hh._90O),Z=Z.split(hh._90O);var G=c[3],V=Z[3],y=c[7],d=c[11],l=c[15],f=c[19],o=c[23],C=c[27],g=Z[7],B=G+y+d+l+f+o,b=o?!1:!0,A=V===G;if(o){var N=o&&o.split(ar("firefox")[3]);if(N)for(var I=0;I<N.length;I++)if(Po.indexOf(N[I])>=0){b=!0;break}}O=A&&em()(V,g)&&em()(B,C)&&b&&(!f||f>D)}O||(lb.prototype._42=Rk)}else O=!0;return ho.a=O,O},_n=String.fromCharCode(_n+20);var sm=function(f){return f=f.replace(jk,dd),f=f.replace(/[ \n]+/g,dd)},wj="30",af="06",hc="02",So="03",Rr=$l,Co=/^1f+00/,Aj=function(){var O;return O={_18O:function(t){var k=t,v=k.replace(/\s+/g,""),T=nq(v);return T},_14O:function(Y){var L=this._18O(Y),O=this._15O(L);return O},_15O:function(O){var w=this._17O(O);if("2a864886f70d010101"==w._61O){var o=this._16O(w.key),r=new nc;return r._38O(o.n,o.e),r}bi(dd)},_16O:function(E){var U={};E.substr(0,2)!=wj&&bi(dd);var y=hh._7O(E,0);return 2!=y.length&&bi(dd),E.substr(y[0],2)!=hc&&bi(dd),U.n=hh._11O(E,y[0]),E.substr(y[1],2)!=hc&&bi(dd),U.e=hh._11O(E,y[1]),U},_17O:function(t){var D={};D._40O=N;var B=hh._7O(t,0);2!=B.length&&bi(dd);var S=B[0];t.substr(S,2)!=wj&&bi(dd);var o=hh._7O(t,S);return 2!=o.length&&bi(dd),t.substr(o[0],2)!=af&&bi(dd),D._61O=hh._11O(t,o[0]),t.substr(o[1],2)==af?D._40O=hh._11O(t,o[1]):t.substr(o[1],2)==wj&&(D._40O={},D._40O.p=hh._70O(t,o[1],[0],hc),D._40O.q=hh._70O(t,o[1],[1],hc),D._40O.g=hh._70O(t,o[1],[2],hc)),t.substr(B[1],2)!=So&&bi(dd),D.key=hh._11O(t,B[1]).substr(2),D}},O._17O?O:N}(),$i=Aj._27O=function(p){return Aj._14O(p)};em=function(){return function(e,i){if(e&&i){i=sm(i);var T=Rr(i,Z(2,4)),m=this;if(!m||!m.n||T._55O()>m.n._55O())return 0;var I=m._37O(T),E=I[Vd](Z(2,4)).replace(Co,""),N=nb(E);if(0==N.length)return!1;var $=N[0],A=N[1],P=function(J){return Hk._4O.Util._56O(J,$)},J=P(e);return A==J}}.bind($i(x))};var He,Pg;return function(){var R=sc.length-tj.length;if(R>0)for(var k=0;R>k;k++)He=El.Util,Pg=sm}(),rh=function(d,$){$=Pg($);var Y=$i(bn),G=Dm.length,w=2*G,k=Rr($,Z(G,w)),P=Y,b=!0;if(P){var L=P[vj[0]];L&&k._55O()<=L._55O()&&(b=!1)}if(b)return 0;var D=P._37O(k),r=D[Vd](Z(G,w)).replace(Co,""),V=nb(r);if(0==V.length)return!1;var v=V[0],F=V[1],z=He._11A(d,v);return F==z},Aj}(V,W),Vp(Q,{load:function(){var R={},V=function(V){return V?"c_"+(V.sync?"1":"0")+"_"+(V.post?"1":"0")+"_"+(V.responseType||"H")+"_"+(V.mimeType||"H")+"_"+(V.data?JSON.stringify(V.data):"H"):""};return function(i,C,c){var n,X=R[i],m=V(c);return X&&(n=X[m])?(n.push(C),void 0):(R[i]||(X=R[i]={count:0}),n=X[m]=[C],X.count++,Q.xhrLoad(i,function(u){delete X[m],X.count--,X.count||delete R[i],n.forEach(function(c){c(u)})},c),void 0)}}(),asyncEach:function(e,f,S){"function"!=typeof S&&(S=Function.prototype);var U=new Array(e.length),C=0,u=!1;e.forEach(function(b,R){f(b,function(_,G){return u?void 0:_?(u=!0,S(null)):(U[R]=G,C++,C===e.length?S(U):void 0)})})},xhrLoad:function(j,w,m){var h=!1;pi(j)||(h=!0,j=[j]),m=m||{},j.length;var J=m.sync,I=!!m.post,Y=null;return Q.asyncEach(j,function(v,T){var V=new lr;v=Q.beforeLoadURL(v),v.data?T(null,v.data):(m.url=encodeURI(v),m.method=I?"POST":"GET",m.responseType?V.setResponseType(m.responseType):V.setOverrideMimeType(m.mimeType||"text/plain"),V.onload=function(){200===this.status||0===this.status?T(null,V.getResponseText()):T(!0)},V.onerror=function(){T(!0)},V.send(m))},function(u){var v="function"==typeof w;(v||J)&&(Y=h&&u?u[0]:u,v&&w(Y))}),J?Y:void 0}}),Math.sign===s&&(Math.sign=function(w){return 0>w?-1:w>0?1:+w});var ck="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ye={encode:function(I,N){var k,B,f,V,U,S,Z,o="",P=0;for(I=Ye._utf8_encode(I);P<I.length;)k=I.charCodeAt(P++),B=I.charCodeAt(P++),f=I.charCodeAt(P++),V=k>>2,U=(3&k)<<4|B>>4,S=(15&B)<<2|f>>6,Z=63&f,isNaN(B)?S=Z=64:isNaN(f)&&(Z=64),o=o+N.charAt(V)+N.charAt(U)+N.charAt(S)+N.charAt(Z);return o},decode:function(i,j){var b,U,f,Z,w,p,n,s="",k=0;for(i=i.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<i.length;)Z=j.indexOf(i.charAt(k++)),w=j.indexOf(i.charAt(k++)),p=j.indexOf(i.charAt(k++)),n=j.indexOf(i.charAt(k++)),b=Z<<2|w>>4,U=(15&w)<<4|p>>2,f=(3&p)<<6|n,s+=String.fromCharCode(b),64!=p&&(s+=String.fromCharCode(U)),64!=n&&(s+=String.fromCharCode(f));return s=Ye._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var S="",m=0;m<e.length;m++){var F=e.charCodeAt(m);128>F?S+=String.fromCharCode(F):F>127&&2048>F?(S+=String.fromCharCode(192|F>>6),S+=String.fromCharCode(128|63&F)):(S+=String.fromCharCode(224|F>>12),S+=String.fromCharCode(128|63&F>>6),S+=String.fromCharCode(128|63&F))}return S},_utf8_decode:function(b){for(var D="",e=0,L=0,u=0,K=0;e<b.length;)L=b.charCodeAt(e),128>L?(D+=String.fromCharCode(L),e++):L>191&&224>L?(u=b.charCodeAt(e+1),D+=String.fromCharCode((31&L)<<6|63&u),e+=2):(u=b.charCodeAt(e+1),K=b.charCodeAt(e+2),D+=String.fromCharCode((15&L)<<12|(63&u)<<6|63&K),e+=3);return D}};z.Math={generateUUID:function(){for(var Z=[],e=0;256>e;e++)Z[e]=(16>e?"0":"")+e.toString(16).toUpperCase();return function(){var J=0|4294967295*Math.random(),W=0|4294967295*Math.random(),m=0|4294967295*Math.random(),q=0|4294967295*Math.random();return Z[255&J]+Z[255&J>>8]+Z[255&J>>16]+Z[255&J>>24]+"-"+Z[255&W]+Z[255&W>>8]+"-"+Z[64|15&W>>16]+Z[255&W>>24]+"-"+Z[128|63&m]+Z[255&m>>8]+"-"+Z[255&m>>16]+Z[255&m>>24]+Z[255&q]+Z[255&q>>8]+Z[255&q>>16]+Z[255&q>>24]}}(),clamp:function(o,T,F){return Math.max(T,Math.min(F,o))},generateIncreasingID:function(){var A=0;return function(){return++A}}(),encodeBase64:function(W,O){return Ye.encode(W,O||ck)},decodeBase64:function(n,Y){return Ye.decode(n,Y||ck)},randomArray:function(n,q){q=q||n.length;for(var i=q-1;i>0;i--){var h=Math.floor(Math.random()*(i+1)),u=n[i];n[i]=n[h],n[h]=u}return n}};var vh=z.Matrix=z.Math.Matrix2d=function(E,W,g,K,l){this.setFromTransform(E,W,g,K,l)},Vd=vh;vh.prototype={},vh.prototype.constructor=vh,vh.prototype.set=function(x,i,U,f,Q,d){return this.a=x,this.b=i,this.c=U,this.d=f,this.tx=Q,this.ty=d,this},vh.prototype.setFromTransform=function(y,t,D,e,v){var x=this;if(y===s)return x.a=1,x.b=0,x.c=0,x.d=1,x.tx=0,x.ty=0,void 0;y=y||0;var o=R(y),q=H(y);return e=e||1,v=v||1,x.a=q*e,x.b=o*e,x.c=-o*v,x.d=q*v,x.tx=t||0,x.ty=D||0,x},vh.prototype.apply=function(X,t){t=t||new hh;var i=X.x,Y=X.y;return t.x=this.a*i+this.c*Y+this.tx,t.y=this.b*i+this.d*Y+this.ty,t},vh.prototype.applyInverse=function(W,G){G=G||new hh;var A=1/(this.a*this.d+this.c*-this.b),M=W.x,J=W.y;return G.x=this.d*A*M+-this.c*A*J+(this.ty*this.c-this.tx*this.d)*A,G.y=this.a*A*J+-this.b*A*M+(-this.ty*this.a+this.tx*this.b)*A,G},vh.prototype.translate=function(q,H){return this.tx+=q,this.ty+=H,this},vh.prototype.scale=function(g,d){return this.a*=g,this.d*=d,this.c*=g,this.b*=d,this.tx*=g,this.ty*=d,this},vh.prototype.rotate=function(f){var J=Math.cos(f),U=Math.sin(f),D=this.a,t=this.c,R=this.tx;return this.a=D*J-this.b*U,this.b=D*U+this.b*J,this.c=t*J-this.d*U,this.d=t*U+this.d*J,this.tx=R*J-this.ty*U,this.ty=R*U+this.ty*J,this},vh.prototype.appendTranslate=function($,n){return this.tx+=this.a*$+this.c*n,this.ty+=this.b*$+this.d*n,this},vh.prototype.appendScale=function(k,j){return this.a*=k,this.d*=j,this.c*=j,this.b*=k,this},vh.prototype.appendRotate=function(A){if(!A)return this;var L=Math.cos(A),w=Math.sin(A),l=this.a,Q=this.b;return this.a=l*L+this.c*w,this.b=Q*L+this.d*w,this.c=-l*w+this.c*L,this.d=-Q*w+this.d*L,this},vh.prototype.append=function(r){var G=this.a,$=this.b,g=this.c,t=this.d;return this.a=r.a*G+r.b*g,this.b=r.a*$+r.b*t,this.c=r.c*G+r.d*g,this.d=r.c*$+r.d*t,this.tx=r.tx*G+r.ty*g+this.tx,this.ty=r.tx*$+r.ty*t+this.ty,this},vh.prototype.setTransform=function(l,V,y,p,t,c,Z,i,e){var x,u,h,a,R,d,K,k,X,E;return R=Math.sin(Z),d=Math.cos(Z),K=Math.cos(e),k=Math.sin(e),X=-Math.sin(i),E=Math.cos(i),x=d*t,u=R*t,h=-R*c,a=d*c,this.a=K*x+k*h,this.b=K*u+k*a,this.c=X*x+E*h,this.d=X*u+E*a,this.tx=l+(y*x+p*h),this.ty=V+(y*u+p*a),this},vh.prototype.prepend=function(W){var I=this.tx;if(1!==W.a||0!==W.b||0!==W.c||1!==W.d){var D=this.a,f=this.c;this.a=D*W.a+this.b*W.c,this.b=D*W.b+this.b*W.d,this.c=f*W.a+this.d*W.c,this.d=f*W.b+this.d*W.d}return this.tx=I*W.a+this.ty*W.c+W.tx,this.ty=I*W.b+this.ty*W.d+W.ty,this},vh.prototype.transform=vh.prototype.prepend,vh.prototype.invert=function(){var x=this.a,C=this.b,e=this.c,m=this.d,n=this.tx,A=x*m-C*e;return this.a=m/A,this.b=-C/A,this.c=-e/A,this.d=x/A,this.tx=(e*this.ty-m*n)/A,this.ty=-(x*this.ty-C*n)/A,this},vh.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},vh.prototype.clone=function(){var Y=new vh;return Y.a=this.a,Y.b=this.b,Y.c=this.c,Y.d=this.d,Y.tx=this.tx,Y.ty=this.ty,Y},vh.prototype.copy=function(h){return h.a=this.a,h.b=this.b,h.c=this.c,h.d=this.d,h.tx=this.tx,h.ty=this.ty,h},vh.prototype.tf=function($,Z){1===arguments.length&&(Z=$.y,$=$.x);var I=this;return{x:I.a*$+I.c*Z+I.tx,y:I.b*$+I.d*Z+I.ty}},vh.prototype.tfi=function(r,H){1===arguments.length&&(H=r.y,r=r.x);var Q=this,l=1/(Q.a*Q.d+Q.c*-Q.b);return{x:Q.d*l*r+-Q.c*l*H+(Q.ty*Q.c-Q.tx*Q.d)*l,y:Q.a*l*H+-Q.b*l*r+(-Q.ty*Q.a+Q.tx*Q.b)*l}},vh.IDENTITY=new vh,vh.TEMP_MATRIX=new vh;var Hb=z.Math.Quaternion=function(d,n,O,r){this.set(d,n,O,r)};W.assign(Hb.prototype,{set:function(J,p,P,a){var Z=this;return Z._x=J||0,Z._y=p||0,Z._z=P||0,Z._w=a!==s?a:1,Z},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(u){var x=this;return x._x=u._x,x._y=u._y,x._z=u._z,x._w=u._w,x},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var u=this.length();return 0===u?(this._x=0,this._y=0,this._z=0,this._w=1):(u=1/u,this._x=this._x*u,this._y=this._y*u,this._z=this._z*u,this._w=this._w*u),this},fromArray:function(a,I){I===s&&(I=0);var L=this;return L._x=a[I],L._y=a[I+1],L._z=a[I+2],L._w=a[I+3],this},slerp:function(n,S){if(0===S)return this;if(1===S)return this.copy(n);var h=this._x,k=this._y,G=this._z,K=this._w,D=K*n._w+h*n._x+k*n._y+G*n._z;if(0>D?(this._w=-n._w,this._x=-n._x,this._y=-n._y,this._z=-n._z,D=-D):this.copy(n),D>=1)return this._w=K,this._x=h,this._y=k,this._z=G,this;var c=Math.sqrt(1-D*D);if(Math.abs(c)<.001)return this._w=.5*(K+this._w),this._x=.5*(h+this._x),this._y=.5*(k+this._y),this._z=.5*(G+this._z),this;var M=Math.atan2(c,D),_=Math.sin((1-S)*M)/c,F=Math.sin(S*M)/c;return this._w=K*_+this._w*F,this._x=h*_+this._x*F,this._y=k*_+this._y*F,this._z=G*_+this._z*F,this
},setFromAxisAngle:function(k,z){var j=z/2,D=Math.sin(j);return this._x=k.x*D,this._y=k.y*D,this._z=k.z*D,this._w=Math.cos(j),this},setFromEuler:function(U){var t=U._x,M=U._y,b=U._z,A=U._order,G=Math.cos,W=Math.sin,y=G(t/2),P=G(M/2),f=G(b/2),s=W(t/2),X=W(M/2),J=W(b/2);return"XYZ"===A?(this._x=s*P*f+y*X*J,this._y=y*X*f-s*P*J,this._z=y*P*J+s*X*f,this._w=y*P*f-s*X*J):"YXZ"===A?(this._x=s*P*f+y*X*J,this._y=y*X*f-s*P*J,this._z=y*P*J-s*X*f,this._w=y*P*f+s*X*J):"ZXY"===A?(this._x=s*P*f-y*X*J,this._y=y*X*f+s*P*J,this._z=y*P*J+s*X*f,this._w=y*P*f-s*X*J):"ZYX"===A?(this._x=s*P*f-y*X*J,this._y=y*X*f+s*P*J,this._z=y*P*J-s*X*f,this._w=y*P*f+s*X*J):"YZX"===A?(this._x=s*P*f+y*X*J,this._y=y*X*f+s*P*J,this._z=y*P*J-s*X*f,this._w=y*P*f-s*X*J):"XZY"===A&&(this._x=s*P*f-y*X*J,this._y=y*X*f-s*P*J,this._z=y*P*J+s*X*f,this._w=y*P*f+s*X*J),this},setFromRotationMatrix:function(B){var G,k=B.el,K=k[0],D=k[4],n=k[8],W=k[1],Q=k[5],A=k[9],F=k[2],d=k[6],r=k[10],i=K+Q+r;return i>0?(G=.5/Math.sqrt(i+1),this._w=.25/G,this._x=(d-A)*G,this._y=(n-F)*G,this._z=(W-D)*G):K>Q&&K>r?(G=2*Math.sqrt(1+K-Q-r),this._w=(d-A)/G,this._x=.25*G,this._y=(D+W)/G,this._z=(n+F)/G):Q>r?(G=2*Math.sqrt(1+Q-K-r),this._w=(n-F)/G,this._x=(D+W)/G,this._y=.25*G,this._z=(A+d)/G):(G=2*Math.sqrt(1+r-K-Q),this._w=(W-D)/G,this._x=(n+F)/G,this._y=(A+d)/G,this._z=.25*G),this},setFromToVectors:function(){var t,K;return function(p,G){return t===s&&(t=new yj),K=p.dot(G)+1,1e-7>K?(K=0,Math.abs(p.x)>Math.abs(p.z)?t.set(-p.y,p.x,0):t.set(0,-p.z,p.y)):t.crossVectors(p,G),this._x=t.x,this._y=t.y,this._z=t.z,this._w=K,this.normalize()}}(),setFromUnitVectors:function(){var Z,g,w=1e-6;return function(q,r){return Z===s&&(Z=new yj),g=q.dot(r)+1,w>g?(g=0,Math.abs(q.x)>Math.abs(q.z)?Z.set(-q.y,q.x,0):Z.set(0,-q.z,q.y)):Z.crossVectors(q,r),this._x=Z.x,this._y=Z.y,this._z=Z.z,this._w=g,this.normalize()}}(),multiply:function(k){return this.multiplyQuaternions(this,k)},premultiply:function(H){return this.multiplyQuaternions(H,this)},multiplyQuaternions:function(t,z){var v=t._x,D=t._y,J=t._z,i=t._w,S=z._x,g=z._y,G=z._z,o=z._w;return this._x=v*o+i*S+D*G-J*g,this._y=D*o+i*g+J*S-v*G,this._z=J*o+i*G+v*g-D*S,this._w=i*o-v*S-D*g-J*G,this}});var pj=z.Math.Vector4=function(M,m,y,p){this.x=M||0,this.y=m||0,this.z=y||0,this.w=p!==s?p:1};W.assign(pj.prototype,{isVector4:!0,set:function(n,W,h,M){return this.x=n,this.y=W,this.z=h,this.w=M,this},setScalar:function(p){return this.x=p,this.y=p,this.z=p,this.w=p,this},setX:function(q){return this.x=q,this},setY:function(M){return this.y=M,this},setZ:function(x){return this.z=x,this},setW:function(A){return this.w=A,this},setComponent:function(q,Q){switch(q){case 0:this.x=Q;break;case 1:this.y=Q;break;case 2:this.z=Q;break;case 3:this.w=Q;break;default:throw new Error("index is out of range: "+q)}return this},getComponent:function(c){switch(c){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+c)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(n){return this.x=n.x,this.y=n.y,this.z=n.z,this.w=n.w!==s?n.w:1,this},add:function(F,c){return c!==s?this.addVectors(F,c):(this.x+=F.x,this.y+=F.y,this.z+=F.z,this.w+=F.w,this)},addScalar:function(W){return this.x+=W,this.y+=W,this.z+=W,this.w+=W,this},addVectors:function(_,B){return this.x=_.x+B.x,this.y=_.y+B.y,this.z=_.z+B.z,this.w=_.w+B.w,this},addScaledVector:function(F,I){return this.x+=F.x*I,this.y+=F.y*I,this.z+=F.z*I,this.w+=F.w*I,this},sub:function(q,A){return A!==s?this.subVectors(q,A):(this.x-=q.x,this.y-=q.y,this.z-=q.z,this.w-=q.w,this)},subScalar:function(H){return this.x-=H,this.y-=H,this.z-=H,this.w-=H,this},subVectors:function(J,W){return this.x=J.x-W.x,this.y=J.y-W.y,this.z=J.z-W.z,this.w=J.w-W.w,this},multiplyScalar:function(m){return this.x*=m,this.y*=m,this.z*=m,this.w*=m,this},applyMatrix4:function(w){var O=this.x,T=this.y,a=this.z,p=this.w,j=w.el;return this.x=j[0]*O+j[4]*T+j[8]*a+j[12]*p,this.y=j[1]*O+j[5]*T+j[9]*a+j[13]*p,this.z=j[2]*O+j[6]*T+j[10]*a+j[14]*p,this.w=j[3]*O+j[7]*T+j[11]*a+j[15]*p,this},divideScalar:function(W){return this.multiplyScalar(1/W)},setAxisAngleFromQuaternion:function(g){this.w=2*Math.acos(g.w);var s=Math.sqrt(1-g.w*g.w);return 1e-4>s?(this.x=1,this.y=0,this.z=0):(this.x=g.x/s,this.y=g.y/s,this.z=g.z/s),this},setAxisAngleFromRotationMatrix:function(P){var E,Y,C,m,A=.01,p=.1,R=P.el,M=R[0],u=R[4],k=R[8],G=R[1],S=R[5],F=R[9],D=R[2],T=R[6],O=R[10];if(Math.abs(u-G)<A&&Math.abs(k-D)<A&&Math.abs(F-T)<A){if(Math.abs(u+G)<p&&Math.abs(k+D)<p&&Math.abs(F+T)<p&&Math.abs(M+S+O-3)<p)return this.set(1,0,0,0),this;E=Math.PI;var H=(M+1)/2,V=(S+1)/2,h=(O+1)/2,d=(u+G)/4,y=(k+D)/4,B=(F+T)/4;return H>V&&H>h?A>H?(Y=0,C=.707106781,m=.707106781):(Y=Math.sqrt(H),C=d/Y,m=y/Y):V>h?A>V?(Y=.707106781,C=0,m=.707106781):(C=Math.sqrt(V),Y=d/C,m=B/C):A>h?(Y=.707106781,C=.707106781,m=0):(m=Math.sqrt(h),Y=y/m,C=B/m),this.set(Y,C,m,E),this}var a=Math.sqrt((T-F)*(T-F)+(k-D)*(k-D)+(G-u)*(G-u));return Math.abs(a)<.001&&(a=1),this.x=(T-F)/a,this.y=(k-D)/a,this.z=(G-u)/a,this.w=Math.acos((M+S+O-1)/2),this},min:function(v){return this.x=Math.min(this.x,v.x),this.y=Math.min(this.y,v.y),this.z=Math.min(this.z,v.z),this.w=Math.min(this.w,v.w),this},max:function(T){return this.x=Math.max(this.x,T.x),this.y=Math.max(this.y,T.y),this.z=Math.max(this.z,T.z),this.w=Math.max(this.w,T.w),this},clamp:function(z,N){return this.x=Math.max(z.x,Math.min(N.x,this.x)),this.y=Math.max(z.y,Math.min(N.y,this.y)),this.z=Math.max(z.z,Math.min(N.z,this.z)),this.w=Math.max(z.w,Math.min(N.w,this.w)),this},clampScalar:function(){var R,L;return function(f,Y){return R===s&&(R=new pj,L=new pj),R.set(f,f,f,f),L.set(Y,Y,Y,Y),this.clamp(R,L)}}(),clampLength:function(x,O){var V=this.length();return this.divideScalar(V||1).multiplyScalar(Math.max(x,Math.min(O,V)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(X){return this.x*X.x+this.y*X.y+this.z*X.z+this.w*X.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(T){return this.normalize().multiplyScalar(T)},lerp:function(X,h){return this.x+=(X.x-this.x)*h,this.y+=(X.y-this.y)*h,this.z+=(X.z-this.z)*h,this.w+=(X.w-this.w)*h,this},lerpVectors:function(w,h,P){return this.subVectors(h,w).multiplyScalar(P).add(w)},equals:function(G){return G.x===this.x&&G.y===this.y&&G.z===this.z&&G.w===this.w},fromArray:function(w,Q){return Q===s&&(Q=0),this.x=w[Q],this.y=w[Q+1],this.z=w[Q+2],this.w=w[Q+3],this},toArray:function(g,X){return g===s&&(g=[]),X===s&&(X=0),g[X]=this.x,g[X+1]=this.y,g[X+2]=this.z,g[X+3]=this.w,g},fromBufferAttribute:function(c,p){return this.x=c.getX(p),this.y=c.getY(p),this.z=c.getZ(p),this.w=c.getW(p),this}});var yj=z.Math.Vector3=function(J,N,$){J===s?(this.x=0,this.y=0,this.z=0):"object"==typeof J?this.copy(J):this.set(J,N==s?J:N,$==s?J:$)};W.assign(yj.prototype,{set:function(N,E,S){return this.x=N,this.y=E,this.z=S,this},setScalar:function(C){return this.x=C,this.y=C,this.z=C,this},setX:function(n){return this.x=n,this},setY:function(W){return this.y=W,this},setZ:function(I){return this.z=I,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(f){return f.x===s?(this.x=f[0],this.y=f[1],this.z=f[2]):(this.x=f.x,this.y=f.y,this.z=f.z),this},add:function(u){return this.x+=u.x,this.y+=u.y,this.z+=u.z,this},addScalar:function(O){return this.x+=O,this.y+=O,this.z+=O,this},addVectors:function(k,Y){return this.x=k.x+Y.x,this.y=k.y+Y.y,this.z=k.z+Y.z,this},addScaledVector:function(x,v){return this.x+=x.x*v,this.y+=x.y*v,this.z+=x.z*v,this},sub:function(x){return this.x-=x.x,this.y-=x.y,this.z-=x.z,this},subScalar:function(X){return this.x-=X,this.y-=X,this.z-=X,this},subVectors:function(D,A){return this.x=D.x-A.x,this.y=D.y-A.y,this.z=D.z-A.z,this},multiply:function(L){return this.x*=L.x,this.y*=L.y,this.z*=L.z,this},multiplyScalar:function(S){return this.x*=S,this.y*=S,this.z*=S,this},distanceTo:function(W){return Math.sqrt(this.distanceToSquared(W))},distanceToSquared:function(M){var m=this.x-M.x,X=this.y-M.y,F=this.z-M.z;return m*m+X*X+F*F},distanceToSquared2:function(H){var t=this.x-H[0],e=this.y-H[1],T=this.z-H[2];return t*t+e*e+T*T},multiplyVectors:function(L,v){return this.x=L.x*v.x,this.y=L.y*v.y,this.z=L.z*v.z,this},transformDirection:function(Y){var c=this.x,K=this.y,P=this.z,y=Y.el;return this.x=y[0]*c+y[4]*K+y[8]*P,this.y=y[1]*c+y[5]*K+y[9]*P,this.z=y[2]*c+y[6]*K+y[10]*P,this.normalize()},applyEuler:function(){var g=new Hb;return function(i){return this.applyQuaternion(g.setFromEuler(i))}}(),applyQuaternion:function(H){var o=this.x,Y=this.y,u=this.z,_=H._x,W=H._y,q=H._z,d=H._w,D=d*o+W*u-q*Y,c=d*Y+q*o-_*u,I=d*u+_*Y-W*o,g=-_*o-W*Y-q*u;return this.x=D*d+g*-_+c*-q-I*-W,this.y=c*d+g*-W+I*-_-D*-q,this.z=I*d+g*-q+D*-W-c*-_,this},applyMatrix4:function(w){var k=this.x,G=this.y,l=this.z,q=w.el,y=1/(q[3]*k+q[7]*G+q[11]*l+q[15]);return this.x=(q[0]*k+q[4]*G+q[8]*l+q[12])*y,this.y=(q[1]*k+q[5]*G+q[9]*l+q[13])*y,this.z=(q[2]*k+q[6]*G+q[10]*l+q[14])*y,this},applyMatrix3:function(L){var O=this.x,G=this.y,Z=this.z,C=L.el;return this.x=C[0]*O+C[3]*G+C[6]*Z,this.y=C[1]*O+C[4]*G+C[7]*Z,this.z=C[2]*O+C[5]*G+C[8]*Z,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var K=new yj;return function(W){return this.sub(K.copy(W).multiplyScalar(2*this.dot(W)))}}(),dot:function(h){return this.x*h.x+this.y*h.y+this.z*h.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var F=this.length();return F?this.multiplyScalar(1/F):this},setLength:function(P){return this.normalize().multiplyScalar(P)},fromArray:function(u,W){return W===s&&(W=0),this.x=u[W],this.y=u[W+1],this.z=u[W+2],this},toArray:function($,V){return $===s&&($=[0,0,0]),V===s&&(V=0),$[V]=this.x,$[V+1]=this.y,$[V+2]=this.z,$},cross:function(e){return this.crossVectors(this,e)},angleTo:function(x){var W=this.dot(x)/Math.sqrt(this.lengthSq()*x.lengthSq());return W>1||-1>W?0:Math.acos(W)},lerpVectors:function(C,l,V){return this.subVectors(l,C).multiplyScalar(V).add(C)},crossVectors:function(E,F){var h=E.x,S=E.y,H=E.z,s=F.x,g=F.y,X=F.z;return this.x=S*X-H*g,this.y=H*s-h*X,this.z=h*g-S*s,this},min:function(E){return this.x=Math.min(this.x,E.x),this.y=Math.min(this.y,E.y),this.z=Math.min(this.z,E.z),this},max:function(Y){return this.x=Math.max(this.x,Y.x),this.y=Math.max(this.y,Y.y),this.z=Math.max(this.z,Y.z),this},setFromMatrixPosition:function(z){return this.setFromMatrixColumn(z,3)},setFromMatrixScale:function(g){var q=this.setFromMatrixColumn(g,0).length(),o=this.setFromMatrixColumn(g,1).length(),Z=this.setFromMatrixColumn(g,2).length();return this.x=q,this.y=o,this.z=Z,this},setFromMatrixColumn:function(C,g){return this.fromArray(C.el,4*g)}});var hh=z.Math.Vector2=function(n,i,g){"object"==typeof n&&(n.x!=s?(i=n.y,n=n.x,g=n.e):(g=n[2],i=n[1],n=n[0])),this.set(n||0,i||0,g)};hh.prototype={},hh.prototype.constructor=hh,W.defineProperties(hh.prototype,{width:{get:function(){return this.x},set:function(P){this.x=P}},height:{get:function(){return this.y},set:function(v){this.y=v}}}),hh.prototype.clone=function(){return new hh(this.x,this.y,this.e)},hh.prototype.copy=function(p){return this.set(p.x,p.y,p.e),this},hh.prototype.equals=function(l){return l.x===this.x&&l.y===this.y},hh.prototype.set=function(b,d,p){return this.x=b||0,this.y=d||(0!==d?this.x:0),p!=s&&(this.e=p),this},hh.prototype.setScalar=function(k){return this.x=k,this.y=k,this},hh.prototype.setX=function(c){return this.x=c||0,this},hh.prototype.setY=function(e){return this.y=e||0,this},hh.prototype.add=function($){return this.x+=$.x,this.y+=$.y,this},hh.prototype.addVectors=function(x,I){return this.x=x.x+I.x,this.y=x.y+I.y,this},hh.prototype.addScalar=function(x){return this.x+=x,this.y+=x,this},hh.prototype.addScaledVector=function(u,k){return this.x+=u.x*k,this.y+=u.y*k,this},hh.prototype.sub=function(T){return this.x-=T.x,this.y-=T.y,this},hh.prototype.subScalar=function(v){return this.x-=v,this.y-=v,this},hh.prototype.subVectors=function(i,g){return this.x=i.x-g.x,this.y=i.y-g.y,this},hh.prototype.multiply=function(C){return this.x*=C.x,this.y*=C.y,this},hh.prototype.multiplyScalar=function(W){return this.x*=W,this.y*=W,this},hh.prototype.divide=function(c){return this.x/=c.x,this.y/=c.y,this},hh.prototype.divideScalar=function(h){return this.multiplyScalar(1/h)},hh.prototype.min=function(L){return this.x=Math.min(this.x,L.x),this.y=Math.min(this.y,L.y),this},hh.prototype.max=function(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this},hh.prototype.fromArray=function(v,Q){return Q===s&&(Q=0),this.x=v[Q],this.y=v[Q+1],this},hh.prototype.clamp=function(h,k){return this.x=Math.max(h.x,Math.min(k.x,this.x)),this.y=Math.max(h.y,Math.min(k.y,this.y)),this},hh.prototype.clampScalar=function(){var k,h;return function(y,Y){return k===s&&(k=new hh,h=new hh),k.set(y,y),h.set(Y,Y),this.clamp(k,h)}}(),hh.prototype.clampLength=function(N,t){var n=this.length();return this.multiplyScalar(Math.max(N,Math.min(t,n))/n)},hh.prototype.dot=function(t){return this.x*t.x+this.y*t.y},hh.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},hh.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},hh.prototype.normalize=function(){return this.divideScalar(this.length())},hh.prototype.angle=function(){var x=Math.atan2(this.y,this.x);return 0>x&&(x+=2*Math.PI),x},hh.prototype.distanceTo=function(x){return Math.sqrt(this.distanceToSquared(x))},hh.prototype.distanceToSquared=function(i){var e=this.x-i.x,m=this.y-i.y;return e*e+m*m},hh.prototype.isNearEnough=function(z){return this.distanceToSquared(z)<1e-8},hh.prototype.setLength=function(R){var G=this.length();return G?this.multiplyScalar(R/G):this},hh.prototype.lerp=function(X,E){return this.x+=(X.x-this.x)*E,this.y+=(X.y-this.y)*E,this},hh.prototype.lerpVectors=function(L,g,d){return this.subVectors(g,L).multiplyScalar(d).add(L)},hh.prototype.rotateAround=function(i,k){var l=i?i.x:0,O=i?i.y:0,p=Math.cos(k),B=Math.sin(k),T=this.x-l,D=this.y-O;return this.x=T*p-D*B+l,this.y=T*B+D*p+O,this},W.assign(K.prototype,{isMatrix3:!0,set:function(W,l,R,o,v,j,b,Q,I){var d=this.el;return d[0]=W,d[1]=o,d[2]=b,d[3]=l,d[4]=v,d[5]=Q,d[6]=R,d[7]=j,d[8]=I,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(j){var v=this.el,s=j.el;return v[0]=s[0],v[1]=s[1],v[2]=s[2],v[3]=s[3],v[4]=s[4],v[5]=s[5],v[6]=s[6],v[7]=s[7],v[8]=s[8],this},setFromMatrix4:function(s){var e=s.el;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var Z=new yj;return function(Y){for(var s=0,B=Y.count;B>s;s++)Z.x=Y.getX(s),Z.y=Y.getY(s),Z.z=Y.getZ(s),Z.applyMatrix3(this),Y.setXYZ(s,Z.x,Z.y,Z.z);return Y}}(),multiply:function(E){return this.multiplyMatrices(this,E)},premultiply:function(u){return this.multiplyMatrices(u,this)},multiplyMatrices:function(I,h){var $=I.el,k=h.el,T=this.el,Y=$[0],Q=$[3],N=$[6],M=$[1],o=$[4],J=$[7],U=$[2],w=$[5],l=$[8],D=k[0],W=k[3],q=k[6],H=k[1],x=k[4],V=k[7],C=k[2],g=k[5],p=k[8];return T[0]=Y*D+Q*H+N*C,T[3]=Y*W+Q*x+N*g,T[6]=Y*q+Q*V+N*p,T[1]=M*D+o*H+J*C,T[4]=M*W+o*x+J*g,T[7]=M*q+o*V+J*p,T[2]=U*D+w*H+l*C,T[5]=U*W+w*x+l*g,T[8]=U*q+w*V+l*p,this},multiplyScalar:function(I){var A=this.el;return A[0]*=I,A[3]*=I,A[6]*=I,A[1]*=I,A[4]*=I,A[7]*=I,A[2]*=I,A[5]*=I,A[8]*=I,this},determinant:function(){var t=this.el,w=t[0],R=t[1],G=t[2],Q=t[3],K=t[4],m=t[5],W=t[6],D=t[7],A=t[8];return w*K*A-w*m*D-R*Q*A+R*m*W+G*Q*D-G*K*W},getInverse:function(y){var W=y.el,H=this.el,B=W[0],w=W[1],n=W[2],g=W[3],q=W[4],c=W[5],i=W[6],v=W[7],p=W[8],s=p*q-c*v,E=c*i-p*g,e=v*g-q*i,K=B*s+w*E+n*e;if(0===K)return this.identity();var t=1/K;return H[0]=s*t,H[1]=(n*v-p*w)*t,H[2]=(c*w-n*q)*t,H[3]=E*t,H[4]=(p*B-n*i)*t,H[5]=(n*g-c*B)*t,H[6]=e*t,H[7]=(w*i-v*B)*t,H[8]=(q*B-w*g)*t,this},transpose:function(){var J,D=this.el;return J=D[1],D[1]=D[3],D[3]=J,J=D[2],D[2]=D[6],D[6]=J,J=D[5],D[5]=D[7],D[7]=J,this},getNormalMatrix:function(Y){return this.setFromMatrix4(Y).getInverse(this).transpose()},transposeIntoArray:function(c){var r=this.el;return c[0]=r[0],c[1]=r[3],c[2]=r[6],c[3]=r[1],c[4]=r[4],c[5]=r[7],c[6]=r[2],c[7]=r[5],c[8]=r[8],this},setUvTransform:function(D,C,l,L,Y,$,J){var V=Math.cos(Y),g=Math.sin(Y);this.set(l*V,l*g,-l*(V*$+g*J)+$+D,-L*g,L*V,-L*(-g*$+V*J)+J+C,0,0,1)},scale:function(e,_){var q=this.el;return q[0]*=e,q[3]*=e,q[6]*=e,q[1]*=_,q[4]*=_,q[7]*=_,this},rotate:function(c){var b=Math.cos(c),s=Math.sin(c),B=this.el,t=B[0],h=B[3],q=B[6],U=B[1],$=B[4],P=B[7];return B[0]=b*t+s*U,B[3]=b*h+s*$,B[6]=b*q+s*P,B[1]=-s*t+b*U,B[4]=-s*h+b*$,B[7]=-s*q+b*P,this},translate:function(M,o){var O=this.el;return O[0]+=M*O[2],O[3]+=M*O[5],O[6]+=M*O[8],O[1]+=o*O[2],O[4]+=o*O[5],O[7]+=o*O[8],this},equals:function(V){for(var e=this.el,o=V.el,I=0;9>I;I++)if(e[I]!==o[I])return!1;return!0},fromArray:function(p,x){x===s&&(x=0);for(var T=0;9>T;T++)this.el[T]=p[T+x];return this},toArray:function(Y,c){Y===s&&(Y=[]),c===s&&(c=0);var T=this.el;return Y[c]=T[0],Y[c+1]=T[1],Y[c+2]=T[2],Y[c+3]=T[3],Y[c+4]=T[4],Y[c+5]=T[5],Y[c+6]=T[6],Y[c+7]=T[7],Y[c+8]=T[8],Y}});var Tk=z.Math.Plane=function(f,L){this.normal=f!==s?f:new yj(1,0,0),this.constant=L!==s?L:0};W.assign(Tk.prototype,{set:function(m,$){return this.normal.copy(m),this.constant=$,this},setComponents:function(K,k,J,C){return this.normal.set(K,k,J),this.constant=C,this},setFromNormalAndCoplanarPoint:function(t,L){return this.normal.copy(t),this.constant=-L.dot(this.normal),this},setFromCoplanarPoints:function(){var G=new yj,_=new yj;return function(n,u,c){var p=G.subVectors(c,u).cross(_.subVectors(n,u)).normalize();return this.setFromNormalAndCoplanarPoint(p,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(v){return this.normal.copy(v.normal),this.constant=v.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(F){return this.normal.dot(F)+this.constant},distanceToSphere:function(r){return this.distanceToPoint(r.center)-r.radius},projectPoint:function(D,Q){return Q===s&&(Q=new yj),Q.copy(this.normal).multiplyScalar(-this.distanceToPoint(D)).add(D)},intersectLine:function(){var o=new yj;return function(M,F){F===s&&(F=new yj);var p=M.delta(o),h=this.normal.dot(p);if(0===h)return 0===this.distanceToPoint(M.start)?F.copy(M.start):s;var K=-(M.start.dot(this.normal)+this.constant)/h;return 0>K||K>1?s:F.copy(p).multiplyScalar(K).add(M.start)}}(),intersectsLine:function(Z){var l=this.distanceToPoint(Z.start),J=this.distanceToPoint(Z.end);return 0>l&&J>0||0>J&&l>0},intersectsBox:function(H){return H.intersectsPlane(this)},intersectsSphere:function(w){return w.intersectsPlane(this)},coplanarPoint:function(E){return E===s&&(E=new yj),E.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var H=new yj,k=new K;return function(r,C){var L=C||k.getNormalMatrix(r),T=this.coplanarPoint(H).applyMatrix4(r),J=this.normal.applyMatrix3(L).normalize();return this.constant=-T.dot(J),this}}(),translate:function(i){return this.constant-=i.dot(this.normal),this},equals:function(h){return h.normal.equals(this.normal)&&h.constant===this.constant}});var Cn=z.Math.Ray=function(g,E){this.origin=g!==s?g.clone():new yj,this.direction=E!==s?E.clone():new yj};W.assign(Cn.prototype,{set:function(D,N){return this.origin.copy(D),this.direction.copy(N),this},clone:function(){return(new this.constructor).copy(this)},copy:function(N){return this.origin.copy(N.origin),this.direction.copy(N.direction),this.maxHitLen=N.maxHitLen,this},at:function(J,v){var d=v||new yj;return d.copy(this.direction).multiplyScalar(J).add(this.origin)},setMaxHitLength:function(d){this.maxHitLen=d},lookAt:function(N){return this.direction.copy(N).sub(this.origin).normalize(),this},applyMatrix4:function(v){var C=this.maxHitLen;if(C){var P=this.direction.clone().multiplyScalar(C).add(this.origin);P.applyMatrix4(v)}return this.origin.applyMatrix4(v),this.direction.transformDirection(v),C&&(this.maxHitLen=this.origin.distanceTo(P)),this},intersectBox:function(L,$){var T,q,H,z,J,G,o=1/this.direction.x,s=1/this.direction.y,x=1/this.direction.z,U=this.origin;if(o>=0?(T=(L.min.x-U.x)*o,q=(L.max.x-U.x)*o):(T=(L.max.x-U.x)*o,q=(L.min.x-U.x)*o),s>=0?(H=(L.min.y-U.y)*s,z=(L.max.y-U.y)*s):(H=(L.max.y-U.y)*s,z=(L.min.y-U.y)*s),T>z||H>q)return null;if((H>T||T!==T)&&(T=H),(q>z||q!==q)&&(q=z),x>=0?(J=(L.min.z-U.z)*x,G=(L.max.z-U.z)*x):(J=(L.max.z-U.z)*x,G=(L.min.z-U.z)*x),T>G||J>q)return null;if((J>T||T!==T)&&(T=J),(q>G||q!==q)&&(q=G),0>q)return null;var c=T>=0?T:q,v=this.maxHitLen;return v&&c>v?null:this.at(c,$)},intersectTriangle:function(){var T=new yj,O=new yj,Z=new yj,n=new yj;return function(c,s,h,A,R){O.subVectors(s,c),Z.subVectors(h,c),n.crossVectors(O,Z);var k,z=this.direction.dot(n);if(z>0){if(A)return null;k=1}else{if(!(0>z))return null;k=-1,z=-z}T.subVectors(this.origin,c);var b=k*this.direction.dot(Z.crossVectors(T,Z));if(0>b)return null;var i=k*this.direction.dot(O.cross(T));if(0>i||b+i>z)return null;var j=-k*T.dot(n);if(0>j)return null;var N=j/z,F=this.maxHitLen;return F&&N>F?null:this.at(N,R)}}()});var Qg=z.Math.Box3=function(C,F){this.min=C!==s?C:new yj(1/0,1/0,1/0),this.max=F!==s?F:new yj(-1/0,-1/0,-1/0)};W.assign(Qg.prototype,{set:function(h,w){return this.min.copy(h),this.max.copy(w),this},setFromArray:function(O){for(var U=1/0,_=1/0,W=1/0,A=-1/0,l=-1/0,w=-1/0,P=0,F=O.length;F>P;P+=3){var D=O[P],t=O[P+1],C=O[P+2];U>D&&(U=D),_>t&&(_=t),W>C&&(W=C),D>A&&(A=D),t>l&&(l=t),C>w&&(w=C)}return this.min.set(U,_,W),this.max.set(A,l,w),this},setFromPoints:function(e){this.makeEmpty();for(var f=0,w=e.length;w>f;f++)this.expandByPoint(e[f]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(X){return X.max.x<this.min.x||X.min.x>this.max.x||X.max.y<this.min.y||X.min.y>this.max.y||X.max.z<this.min.z||X.min.z>this.max.z?!1:!0},copy:function(R){return this.min.copy(R.min),this.max.copy(R.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(w){return this.min.min(w),this.max.max(w),this}});var Wd=z.Math.Sphere=function(r,m){this.center=r!==s?r:new yj,this.radius=m!==s?m:0};W.assign(Wd.prototype,{set:function(P,B){return this.center.copy(P),this.radius=B,this},setFromPoints:function(){var C=new Qg;return function(R,h){var V=this.center;h!==s?V.copy(h):C.setFromPoints(R).getCenter(V);for(var l=0,q=0,g=R.length;g>q;q++)l=Math.max(l,V.distanceToSquared(R[q]));return this.radius=Math.sqrt(l),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(D){return this.center.copy(D.center),this.radius=D.radius,this},empty:function(){return this.radius<=0},containsPoint:function(m){return m.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(Z){return Z.distanceTo(this.center)-this.radius},intersectsSphere:function(V){var R=this.radius+V.radius;return V.center.distanceToSquared(this.center)<=R*R},intersectsBox:function(f){return f.intersectsSphere(this)},intersectsPlane:function(b){return Math.abs(b.distanceToPoint(this.center))<=this.radius},clampPoint:function(r,Q){var y=this.center.distanceToSquared(r);return Q===s&&(Q=new yj),Q.copy(r),y>this.radius*this.radius&&(Q.sub(this.center).normalize(),Q.multiplyScalar(this.radius).add(this.center)),Q},getBoundingBox:function(Z){return Z===s&&(Z=new Qg),Z.set(this.center,this.center),Z.expandByScalar(this.radius),Z},applyMatrix4:function(V){return this.center.applyMatrix4(V),this.radius=this.radius*V.getMaxScaleOnAxis(),this},translate:function(P){return this.center.add(P),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var Zk=z.Math.Frustum=function(U,T,B,n,i,c){this.planes=[U!==s?U:new Tk,T!==s?T:new Tk,B!==s?B:new Tk,n!==s?n:new Tk,i!==s?i:new Tk,c!==s?c:new Tk]};W.assign(Zk.prototype,{set:function(c,E,P,G,H,$){var C=this.planes;return C[0].copy(c),C[1].copy(E),C[2].copy(P),C[3].copy(G),C[4].copy(H),C[5].copy($),this},clone:function(){return(new this.constructor).copy(this)},copy:function(h){for(var w=this.planes,D=0;6>D;D++)w[D].copy(h.planes[D]);return this},setFromMatrix:function(l){var E=this.planes,T=l.el,z=T[0],D=T[1],H=T[2],G=T[3],V=T[4],u=T[5],O=T[6],d=T[7],J=T[8],y=T[9],R=T[10],f=T[11],x=T[12],q=T[13],$=T[14],C=T[15];return E[0].setComponents(G-z,d-V,f-J,C-x).normalize(),E[1].setComponents(G+z,d+V,f+J,C+x).normalize(),E[2].setComponents(G+D,d+u,f+y,C+q).normalize(),E[3].setComponents(G-D,d-u,f-y,C-q).normalize(),E[4].setComponents(G-H,d-O,f-R,C-$).normalize(),E[5].setComponents(G+H,d+O,f+R,C+$).normalize(),this},intersectsObject:function(){var z=new Wd;return function(n){var W=n.geometry;return null===W.boundingSphere&&W.computeBoundingSphere(),z.copy(W.boundingSphere).applyMatrix4(n.matrixWorld),this.intersectsSphere(z)}}(),intersectsSprite:function(){var k=new Wd;return function(n){return k.center.set(0,0,0),k.radius=.7071067811865476,k.applyMatrix4(n.matrixWorld),this.intersectsSphere(k)}}(),intersectsSphere:function(t){for(var Q=this.planes,y=t.center,O=-t.radius,B=0;6>B;B++){var p=Q[B].distanceToPoint(y);if(O>p)return!1}return!0},intersectsBox:function(){var a=new yj;return function(G){for(var x=this.planes,y=0;6>y;y++){var d=x[y];if(a.x=d.normal.x>0?G.max.x:G.min.x,a.y=d.normal.y>0?G.max.y:G.min.y,a.z=d.normal.z>0?G.max.z:G.min.z,d.distanceToPoint(a)<0)return!1}return!0}}(),containsPoint:function(K){for(var _=this.planes,x=0;6>x;x++)if(_[x].distanceToPoint(K)<0)return!1;return!0}});var re=z.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};W.assign(re.prototype,{set:function(X,G,f,S,J,A,P,T,j,o,z,t,u,L,D,d){var C=this.el;return C[0]=X,C[4]=G,C[8]=f,C[12]=S,C[1]=J,C[5]=A,C[9]=P,C[13]=T,C[2]=j,C[6]=o,C[10]=z,C[14]=t,C[3]=u,C[7]=L,C[11]=D,C[15]=d,this},clone:function(){return(new re).fromArray(this.el)},fromArray:function(N,F){F===s&&(F=0);for(var R=this.el,Z=0;16>Z;Z++)R[Z]=N[Z+F];return this},scale:function(B){var t=this.el,G=B.x,g=B.y,o=B.z;return t[0]*=G,t[4]*=g,t[8]*=o,t[1]*=G,t[5]*=g,t[9]*=o,t[2]*=G,t[6]*=g,t[10]*=o,t[3]*=G,t[7]*=g,t[11]*=o,this},makeRotationFromEuler:function(I){var M=this.el,$=I._x,A=I._y,v=I._z,P=I._order,z=Math.cos($),h=Math.sin($),u=Math.cos(A),d=Math.sin(A),w=Math.cos(v),F=Math.sin(v);if("XYZ"===P){var p=z*w,L=z*F,Z=h*w,E=h*F;M[0]=u*w,M[4]=-u*F,M[8]=d,M[1]=L+Z*d,M[5]=p-E*d,M[9]=-h*u,M[2]=E-p*d,M[6]=Z+L*d,M[10]=z*u}else if("YXZ"===P){var g=u*w,b=u*F,T=d*w,D=d*F;M[0]=g+D*h,M[4]=T*h-b,M[8]=z*d,M[1]=z*F,M[5]=z*w,M[9]=-h,M[2]=b*h-T,M[6]=D+g*h,M[10]=z*u}else if("ZXY"===P){var g=u*w,b=u*F,T=d*w,D=d*F;M[0]=g-D*h,M[4]=-z*F,M[8]=T+b*h,M[1]=b+T*h,M[5]=z*w,M[9]=D-g*h,M[2]=-z*d,M[6]=h,M[10]=z*u}else if("ZYX"===P){var p=z*w,L=z*F,Z=h*w,E=h*F;M[0]=u*w,M[4]=Z*d-L,M[8]=p*d+E,M[1]=u*F,M[5]=E*d+p,M[9]=L*d-Z,M[2]=-d,M[6]=h*u,M[10]=z*u}else if("YZX"===P){var Q=z*u,j=z*d,k=h*u,o=h*d;M[0]=u*w,M[4]=o-Q*F,M[8]=k*F+j,M[1]=F,M[5]=z*w,M[9]=-h*w,M[2]=-d*w,M[6]=j*F+k,M[10]=Q-o*F}else if("XZY"===P){var Q=z*u,j=z*d,k=h*u,o=h*d;M[0]=u*w,M[4]=-F,M[8]=d*w,M[1]=Q*F+o,M[5]=z*w,M[9]=j*F-k,M[2]=k*F-j,M[6]=h*w,M[10]=o*F+Q}return M[3]=0,M[7]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,this},makeRotationFromQuaternion:function(s){var C=this.el,a=s._x,r=s._y,f=s._z,v=s._w,W=a+a,A=r+r,V=f+f,t=a*W,j=a*A,Z=a*V,J=r*A,w=r*V,c=f*V,U=v*W,l=v*A,d=v*V;return C[0]=1-(J+c),C[4]=j-d,C[8]=Z+l,C[1]=j+d,C[5]=1-(t+c),C[9]=w-U,C[2]=Z-l,C[6]=w+U,C[10]=1-(t+J),C[3]=0,C[7]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(e){var H=this.el,p=e.el,t=p[0],B=p[1],X=p[2],G=p[3],I=p[4],J=p[5],j=p[6],i=p[7],z=p[8],n=p[9],E=p[10],R=p[11],K=p[12],f=p[13],d=p[14],u=p[15],k=n*d*i-f*E*i+f*j*R-J*d*R-n*j*u+J*E*u,g=K*E*i-z*d*i-K*j*R+I*d*R+z*j*u-I*E*u,$=z*f*i-K*n*i+K*J*R-I*f*R-z*J*u+I*n*u,C=K*n*j-z*f*j-K*J*E+I*f*E+z*J*d-I*n*d,y=t*k+B*g+X*$+G*C;if(0===y)return this.identity();var q=1/y;return H[0]=k*q,H[1]=(f*E*G-n*d*G-f*X*R+B*d*R+n*X*u-B*E*u)*q,H[2]=(J*d*G-f*j*G+f*X*i-B*d*i-J*X*u+B*j*u)*q,H[3]=(n*j*G-J*E*G-n*X*i+B*E*i+J*X*R-B*j*R)*q,H[4]=g*q,H[5]=(z*d*G-K*E*G+K*X*R-t*d*R-z*X*u+t*E*u)*q,H[6]=(K*j*G-I*d*G-K*X*i+t*d*i+I*X*u-t*j*u)*q,H[7]=(I*E*G-z*j*G+z*X*i-t*E*i-I*X*R+t*j*R)*q,H[8]=$*q,H[9]=(K*n*G-z*f*G-K*B*R+t*f*R+z*B*u-t*n*u)*q,H[10]=(I*f*G-K*J*G+K*B*i-t*f*i-I*B*u+t*J*u)*q,H[11]=(z*J*G-I*n*G-z*B*i+t*n*i+I*B*R-t*J*R)*q,H[12]=C*q,H[13]=(z*f*X-K*n*X+K*B*E-t*f*E-z*B*d+t*n*d)*q,H[14]=(K*J*X-I*f*X-K*B*j+t*f*j+I*B*d-t*J*d)*q,H[15]=(I*n*X-z*J*X+z*B*j-t*n*j-I*B*E+t*J*E)*q,this},makeRotationAxis:function(j,p){var D=Math.cos(p),a=Math.sin(p),V=1-D,e=j.x,l=j.y,M=j.z,$=V*e,Y=V*l;return this.set($*e+D,$*l-a*M,$*M+a*l,0,$*l+a*M,Y*l+D,Y*M-a*e,0,$*M-a*l,Y*M+a*e,V*M*M+D,0,0,0,0,1),this},multiply:function(d){return this.multiplyMatrices(this,d)},premultiply:function(b){return this.multiplyMatrices(b,this)},multiplyMatrices:function(F,d){var D=F.el,l=d.el,c=this.el,v=D[0],_=D[4],L=D[8],T=D[12],w=D[1],j=D[5],f=D[9],s=D[13],M=D[2],B=D[6],X=D[10],O=D[14],Q=D[3],K=D[7],U=D[11],E=D[15],a=l[0],h=l[4],Y=l[8],J=l[12],H=l[1],e=l[5],i=l[9],r=l[13],q=l[2],k=l[6],V=l[10],G=l[14],u=l[3],x=l[7],W=l[11],Z=l[15];return c[0]=v*a+_*H+L*q+T*u,c[4]=v*h+_*e+L*k+T*x,c[8]=v*Y+_*i+L*V+T*W,c[12]=v*J+_*r+L*G+T*Z,c[1]=w*a+j*H+f*q+s*u,c[5]=w*h+j*e+f*k+s*x,c[9]=w*Y+j*i+f*V+s*W,c[13]=w*J+j*r+f*G+s*Z,c[2]=M*a+B*H+X*q+O*u,c[6]=M*h+B*e+X*k+O*x,c[10]=M*Y+B*i+X*V+O*W,c[14]=M*J+B*r+X*G+O*Z,c[3]=Q*a+K*H+U*q+E*u,c[7]=Q*h+K*e+U*k+E*x,c[11]=Q*Y+K*i+U*V+E*W,c[15]=Q*J+K*r+U*G+E*Z,this},lookAt:function(){var U=new yj,W=new yj,N=new yj;return function(G,B,z){var v=this.el;return N.subVectors(G,B),0===N.lengthSq()&&(N.z=1),N.normalize(),U.crossVectors(z,N),0===U.lengthSq()&&(1===Math.abs(z.z)?N.x+=1e-4:N.z+=1e-4,N.normalize(),U.crossVectors(z,N)),U.normalize(),W.crossVectors(N,U),v[0]=U.x,v[4]=W.x,v[8]=N.x,v[1]=U.y,v[5]=W.y,v[9]=N.y,v[2]=U.z,v[6]=W.z,v[10]=N.z,this}}(),extractScale:function(){var e;return function(K){e===s&&(e=new yj),K===s&&(K=new yj);var u=e.setFromMatrixColumn(this,0).length(),i=e.setFromMatrixColumn(this,1).length(),y=e.setFromMatrixColumn(this,2).length();return K.set(u,i,y),K}}(),extractRotation:function(){var m;return function(N){m===s&&(m=new yj),N===s&&(N=new re);var r=this.el,J=N.el,_=1/m.setFromMatrixColumn(N,0).length(),h=1/m.setFromMatrixColumn(N,1).length(),y=1/m.setFromMatrixColumn(N,2).length();return r[0]=J[0]*_,r[1]=J[1]*_,r[2]=J[2]*_,r[4]=J[4]*h,r[5]=J[5]*h,r[6]=J[6]*h,r[8]=J[8]*y,r[9]=J[9]*y,r[10]=J[10]*y,this}}(),multiplyScalar:function(G){var T=this.el;return T[0]*=G,T[4]*=G,T[8]*=G,T[12]*=G,T[1]*=G,T[5]*=G,T[9]*=G,T[13]*=G,T[2]*=G,T[6]*=G,T[10]*=G,T[14]*=G,T[3]*=G,T[7]*=G,T[11]*=G,T[15]*=G,this
},getPosition:function(I){return I===s&&(I=new yj),I.setFromMatrixColumn(this,3)},setPosition:function(W){var u=this.el;return u[12]=W.x,u[13]=W.y,u[14]=W.z,this},toArray:function(n,q){n===s&&(n=[]),q===s&&(q=0);var L=this.el;return n[q]=L[0],n[q+1]=L[1],n[q+2]=L[2],n[q+3]=L[3],n[q+4]=L[4],n[q+5]=L[5],n[q+6]=L[6],n[q+7]=L[7],n[q+8]=L[8],n[q+9]=L[9],n[q+10]=L[10],n[q+11]=L[11],n[q+12]=L[12],n[q+13]=L[13],n[q+14]=L[14],n[q+15]=L[15],n}});var ir=z.Math.Triangle=function(C,c,Y){this.a=C!==s?C:new yj,this.b=c!==s?c:new yj,this.c=Y!==s?Y:new yj};W.assign(ir,{barycoordFromPoint:function(){var n=new yj,R=new yj,e=new yj;return function(s,S,d,g,u){n.subVectors(g,S),R.subVectors(d,S),e.subVectors(s,S);var k=n.dot(n),G=n.dot(R),z=n.dot(e),b=R.dot(R),J=R.dot(e),w=k*b-G*G,o=u||new yj;if(0===w)return o.set(-2,-1,-1);var I=1/w,f=(b*z-G*J)*I,p=(k*J-G*z)*I;return o.set(1-f-p,p,f)}}()});var ds=z.Math.Euler=function(Q,x,o,L,m){this.set(Q,x,o,L,m)};ds.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ds.DefaultOrder="XYZ",ds.ReverseOrder=function(t){return t=t[2]+t[1]+t[0],t.toUpperCase()},W.defineProperties(ds.prototype,{x:{get:function(){return this._x},set:function(I){this._x=I,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(Y){this._y=Y,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(M){this._z=M,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),W.assign(ds.prototype,{set:function(u,e,v,P,R){return pi(u)&&(R=v,P=e,v=u[2],e=u[1],u=u[0]),P?R&&(P=ds.ReverseOrder(P)):P="ZYX",this._x=u||0,this._y=e||0,this._z=v||0,this._order=P||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(L){return this._x=L._x,this._y=L._y,this._z=L._z,this._order=L._order,this.onChangeCallback(),this},setFromRotationMatrix:function(R,Z,W){var $=z.Math.clamp,G=R.el||R,i=G[0],N=G[4],g=G[8],P=G[1],Q=G[5],m=G[9],y=G[2],K=G[6],k=G[10];return Z=Z||this._order,"XYZ"===Z?(this._y=Math.asin($(g,-1,1)),Math.abs(g)<.99999?(this._x=Math.atan2(-m,k),this._z=Math.atan2(-N,i)):(this._x=Math.atan2(K,Q),this._z=0)):"YXZ"===Z?(this._x=Math.asin(-$(m,-1,1)),Math.abs(m)<.99999?(this._y=Math.atan2(g,k),this._z=Math.atan2(P,Q)):(this._y=Math.atan2(-y,i),this._z=0)):"ZXY"===Z?(this._x=Math.asin($(K,-1,1)),Math.abs(K)<.99999?(this._y=Math.atan2(-y,k),this._z=Math.atan2(-N,Q)):(this._y=0,this._z=Math.atan2(P,i))):"ZYX"===Z?(this._y=Math.asin(-$(y,-1,1)),Math.abs(y)<.99999?(this._x=Math.atan2(K,k),this._z=Math.atan2(P,i)):(this._x=0,this._z=Math.atan2(-N,Q))):"YZX"===Z?(this._z=Math.asin($(P,-1,1)),Math.abs(P)<.99999?(this._x=Math.atan2(-m,Q),this._y=Math.atan2(-y,i)):(this._x=0,this._y=Math.atan2(g,k))):"XZY"===Z?(this._z=Math.asin(-$(N,-1,1)),Math.abs(N)<.99999?(this._x=Math.atan2(K,Q),this._y=Math.atan2(g,i)):(this._x=Math.atan2(-m,k),this._y=0)):console.warn("unsupported order: "+Z),this._order=Z,W!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var k=new re;return function(z,E,U){return k.makeRotationFromQuaternion(z),this.setFromRotationMatrix(k,E,U)}}(),setFromVector3:function(J,O){return this.set(J.x,J.y,J.z,O||this._order)},reorder:function(){var n=new Hb;return function(S){return n.setFromEuler(this),this.setFromQuaternion(n,S)}}(),equals:function(R){return R._x===this._x&&R._y===this._y&&R._z===this._z&&R._order===this._order},fromArray:function(d){return this._x=d[0],this._y=d[1],this._z=d[2],d[3]!==s&&(this._order=d[3]),this.onChangeCallback(),this},toArray:function(D,U){return D===s&&(D=[]),U===s&&(U=0),D[U]=this._x,D[U+1]=this._y,D[U+2]=this._z,D[U+3]=this._order,D},toVector3:function(o){return o?o.set(this._x,this._y,this._z):new yj(this._x,this._y,this._z)},onChange:function(N){return this.onChangeCallback=N,this},onChangeCallback:function(){}});var cb=z.List=function(){this._as=[];var o,_,v=arguments.length;if(1===v){var j=arguments[0];if(Cg(j)&&(j=j._as),pi(j))for(_=j.length,o=0;_>o;o++)this._as.push(j[o]);else j!=N&&this._as.push(j)}else if(v>1)for(o=0;v>o;o++)this._as.push(arguments[o])};iq("List",W,{forEach:function(S,D){this.each(S,D)},push:function(){for(var i=0;i<arguments.length;i++)this.add(arguments[i])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(J,T){return T===s?this._as.push(J):this._as.splice(T,0,J)},addAll:function(d){Cg(d)&&(d=d._as),pi(d)?Kb(this._as,d):this._as.push(d)},get:function(B){return this._as[B]},slice:function(F,B){return new cb(this._as.slice(F,B))},remove:function(N){var w=this._as.indexOf(N);return w>=0&&w<this._as.length&&this.removeAt(w),w},removeAt:function(l){return this._as.splice(l,1)[0]},set:function(O,Q){return this._as[O]=Q},clear:function(){return this._as.splice(0,this._as.length)},contains:function(c){return this._as.indexOf(c)>=0},indexOf:function(y){return this._as.indexOf(y)},each:function(l,d){for(var o=0,L=this._as.length;L>o;o++){var F=this._as[o];d?l.call(d,F,o,this):l(F,o,this)}},reverseEach:function(r,U){for(var O=this._as.length-1;O>=0;O--){var Q=this._as[O];U?r.call(U,Q):r(Q)}},getArray:function(){return this._as},toArray:function(I,u){if(I){for(var h,p=[],y=0,M=this._as.length;M>y;y++)h=this._as[y],u?I.call(u,h)&&p.push(h):I(h)&&p.push(h);return p}return this._as.concat()},toList:function(u,Q){if(u){for(var I,b=new cb,A=0,G=this._as.length;G>A;A++)I=this._as[A],Q?u.call(Q,I)&&b.add(I):u(I)&&b.add(I);return b}return new cb(this)},reverse:function(){this._as.reverse()},sort:function(a){return this._as.sort(a?a:fp),this},toString:function(){return this._as.toString()}}),W.defineProperties(cb.prototype,{length:{get:function(){return this._as.length},set:function(z){this._as.length=z}}});var gb=new cb;Vp(gb,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Yq,each:Yq,reverseEach:Yq,toArray:function(){return[]},toList:function(){return new cb},add:jh,addAll:jh,set:jh,remove:jh,removeAt:jh,clear:jh});var Lo=z.Notifier=function(){this._f=0};iq("Notifier",W,{contains:function(Z,C){if(this._ls)for(var z,x=0,A=this._ls.size();A>x;x++)if(z=this._ls.get(x),Z===z.l&&C===z.s)return!0;return!1},add:function(n,K,k){var F=this,r={l:n,s:K,a:k};F._ls||(F._ls=new cb),F._f?(F._as||(F._as=new cb),F._as.add(r)):r.a?F._ls.add(r,0):F._ls.add(r)},remove:function(M,J){var F=this;F._ls&&(F._f?(F._rs||(F._rs=new cb),F._rs.add({l:M,s:J})):F._remove(M,J))},_remove:function(o,A){for(var M,z=this._ls,F=0,g=z.size();g>F;F++)if(M=z.get(F),M.l===o&&M.s===A)return z.removeAt(F),void 0},fire:function(c){var V=this,T=V._ls;if(V._b=1e4,T){++V._f;try{for(var x,f=0,o=T.size();o>f;f++)x=T.get(f),x.s?x.l.call(x.s,c):x.l(c)}catch(c){p(function(){throw c})}finally{if(--V._f)return;if(V._rs){for(o=V._rs.size(),f=0;o>f;f++)x=V._rs.get(f),V._remove(x.l,x.s);delete V._rs}if(V._as){for(o=V._as.size(),f=0;o>f;f++)x=V._as.get(f),x.a?T.add(x,0):T.add(x);delete V._as}}}}});var Jn=z.Data=function(){this._id=Zb()};iq("Data",W,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:N,_parent:N,_children:gb,_childMap:N,_styleMap:N,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return N},_22Q:function(){return N},s:function(h,p){var c=this;if(2===arguments.length)c.setStyle(h,p);else{if(!yp(h))return c.getStyle(h);for(var Y in h)c.setStyle(Y,h[Y])}return c},fp:function(n,Y,T,z,y){return this.firePropertyChange(n,Y,T,z,y)},firePropertyChange:function(H,P,E,r,Y){if(r){if(r(P,E))return!1}else if(P===E)return!1;var s=this,R=Y||{};return R.property=H,R.oldValue=P,R.newValue=E,R.data=s,s._dataModel&&s._dataModel.handleDataPropertyChange(R),s.onPropertyChanged(R),!0},onPropertyChanged:function(R){var z=this,v=z._parent,n=R.property;if(tm(v)){var B=z.s(ip),d="s:ingroup"===n;(B&&Or[n]||n===d)&&v._81I(),(B||d)&&v.fp("childChange",!0,!1)}Tg(v)&&Or[n]&&v.updateFromChildren()},_21I:function(M){var I=this;if(M&&I._dataModel)throw"Remove data from dataModel before adding";I._dataModel=M},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var z=0,I=this._children.toArray(),w=I.length;w>z;z++)I[z].removeFromDataModel()},getId:function(){return this._id},setId:function(R){this._id=R},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(Z,D){return this._children.toList(Z,D)},eachChild:function(d,K){this._children.each(d,K)},addChild:function(k,q){var M=this;k!==M&&(M._children===gb&&(M._children=new cb,M._childMap={}),q>=0||(q=M._children.size()),M._childMap[k._id]||M.isDescendantOf(k)||(k._parent&&k._parent.removeChild(k),(0>q||q>M._children.size())&&(q=M._children.size()),M._children.add(k,q),M._childMap[k._id]=k,k.setParent(M),M.onChildAdded(k,q),M.fp(vb,N,k)))},onChildAdded:function(){},removeChild:function(b){var d=this;if(d._childMap&&d._childMap[b._id]){var h=d._children.remove(b);delete d._childMap[b._id],d.fp(vb,b,N),b.setParent(N,h),d.onChildRemoved(b,h)}},onChildRemoved:function(){},getChildAt:function(B){return this._children.get(B)},clearChildren:function(){var q=this;if(!q._children.isEmpty())for(var X=0,v=q._children.toArray(),N=v.length;N>X;X++)q.removeChild(v[X])},getParent:function(){return this._parent},setParent:function(t,A){var C=this;if(!(C._73I||C._parent===t||C===t||t&&t.isDescendantOf(C))){var J,W=C._parent;C._parent=t,C._73I=1,W?(A==N&&(A=W.getChildren().indexOf(C)),W.removeChild(C)):C._dataModel&&A==N&&(A=C._dataModel.getRoots().indexOf(C)),t&&(t.addChild(C),J=t.getChildren().indexOf(C)),delete C._73I,C.fp("parent",W,t,s,{oldIndex:A,newIndex:J}),C.onParentChanged(W,t)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(C){return C?this.isDescendantOf(C)||C.isDescendantOf(this):!1},isParentOf:function(f){return f&&this._childMap?!!this._childMap[f._id]:!1},isDescendantOf:function(I){if(!I||I.isEmpty())return!1;for(var x=this._parent;x;){if(I===x)return!0;x=x._parent}return!1},getStyle:function(O,t){t===s&&(t=1);var I=this._styleMap?this._styleMap[O]:s;return I===s&&t?e[O]:I},setStyle:function(T,Q){var C=this;C._styleMap||(C._styleMap={});var X=C._styleMap[T];Q===s?delete C._styleMap[T]:C._styleMap[T]=Q,C.fp("s:"+T,X,Q)&&C.onStyleChanged(T,X,Q)},onStyleChanged:function(){},iv:function(P){this.invalidate(P)},invalidate:function(U){this.fp(U||"*",!1,!0)},toString:function(){var _=this;return _._displayName||_._name||_._tag||_._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(B,$){var b=this,W=b.s(Ej);W||b.s(Ej,W={}),$?W[B]=$:delete W[B],b.fp(Ej,N,W)},removeStyleIcon:function(r){var u=this.s(Ej);if(u){var a=u[r];delete u[r],this.fp(Ej,N,u)}return a},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var E,f={};for(E in this._styleMap)f[E]=1;return f},ca:function(g,k){return g=Qc+g,2===arguments.length?this.a(g,k):this.a(g)}});var aj=z.DataModel=function(){var T=this;T._datas=new cb,T._dataMap={},T._roots=new cb,T._rootMap={},T._fsDataMap={},T._78O={},T._reflectorMap={},T._36I=new Lo,T._35I=new Lo,T._serializeNotifier=new Lo,T._selectionModel=new vn(T);var O=T._29Q=[],z=T._scheduleCallback=function(){for(var $=Date.now(),d=0;d<O.length;d++){var b=O[d];b.enabled&&$-b.lastTime>b.interval&&(b.beforeAction&&b.beforeAction(),T.each(function(m){b.action(m)}),b.afterAction&&b.afterAction(),b.lastTime=$)}O.length&&(T._30Q=V.requestAnimationFrame(z))}};iq("DataModel",W,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:s,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:s,_init:s,_envmap:s,_postProcessingData:s,sm:function(){return this.getSelectionModel()},mm:function(R,I,K){this.addDataModelChangeListener(R,I,K)},umm:function(n,p){this.removeDataModelChangeListener(n,p)},md:function(V,F,Z){this.addDataPropertyChangeListener(V,F,Z)},umd:function(L,S){this.removeDataPropertyChangeListener(L,S)},mh:function(O,G,m){this.addHierarchyChangeListener(O,G,m)},umh:function(o,e){this.removeHierarchyChangeListener(o,e)},getAttrObject:function(){return this._attrObject},setAttrObject:function(y){return this._attrObject=y},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(O){return this._dataMap[O]},removeDataById:function(d){this.remove(this.getDataById(d))},toDatas:function(C,Z){return this._datas.toList(C,Z)},each:function(H,L){this._datas.each(H,L)},getDataByTag:function(x){return this._78O[x]},getTagMap:function(){return this._78O},removeDataByTag:function(E){this.remove(this.getDataByTag(E))},add:function(g,b,u){var $=this,l=g._id,F=g._tag,P=$._roots;if($._dataMap[l])throw"'"+l+"' already exists";F!=N&&($._78O[F]=g),$._dataMap[l]=g,u>=0?$._datas.add(g,u):$._datas.add(g),g._parent||($._rootMap[l]=g,b>=0?P.add(g,b):P.add(g)),g.s("fullscreen")!==s&&($._fsDataMap[l]=g),g.s("shape3d.reflector")&&($._reflectorMap[l]=g),g._21I($),$.onAdded(g),$._36I.fire({kind:"add",data:g,rootsIndex:b,datasIndex:u})},onAdded:function(){},remove:function(S,X){if(S){var d=this,F=S._id,W=X&&X.keepStructure,K=X&&X.keepChildren,h=S.getTag();if(S._dataModel===d){this.beginTransaction(),W?d._removingData||(d._removingData=S):d.prepareRemove(S),K||S.toChildren().each(function(r){d.remove(r,X)},d),W?d._removingData===S&&(S._parent&&S._parent.removeChild(S),delete d._removingData):S._parent&&S._parent.removeChild(S);var O=d._datas.remove(S);delete d._dataMap[F],h!=N&&delete d._78O[h];var u;d._rootMap[F]&&(delete d._rootMap[F],u=d._roots.remove(S)),d._fsDataMap[F]&&delete d._fsDataMap[F],d._reflectorMap[F]&&delete d._reflectorMap[F],S._21I(N),d.onRemoved(S),d._36I.fire({kind:Qp,data:S,rootsIndex:u,datasIndex:O}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var O=this;if(O._datas.size()){var _=O._historyManager?this.toJSON():s;O._datas.toArray().forEach(function(Y){Y._21I(N)}),O._datas.clear(),O._dataMap={},O._roots.clear(),O._rootMap={},O._fsDataMap={},O._reflectorMap={},O._78O={},O._36I.fire({kind:Nq,json:_})}},contains:function(D){return D&&D._dataModel===this},handleDataPropertyChange:function(J){var n=this,E=J.data,b=J.property;if("parent"===b){var T=E._id,Q=n._rootMap,g=n._roots;E._parent?Q[T]&&(delete Q[T],g.remove(E)):Q[T]||(Q[T]=E,g.add(E))}else if("tag"===b){var v=J.oldValue,I=J.newValue,W=n._78O;v!=N&&delete W[v],I!=N&&(W[I]=E)}else if("s:fullscreen"===b){var T=E._id,a=n._fsDataMap;J.oldValue!=N&&delete a[T],J.newValue!=N&&(a[T]=E)}else if("s:shape3d.reflector"===b){var T=E._id,H=n._reflectorMap;J.oldValue&&delete H[T],J.newValue&&(H[T]=E)}this.onDataPropertyChanged(E,J),this._35I.fire(J)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(U,x,M){this._36I.add(U,x,M)},removeDataModelChangeListener:function(t,W){this._36I.remove(t,W)},addSerializeListener:function(I,H,q){this._serializeNotifier.add(I,H,q)},removeSerializeListener:function(U,W){this._serializeNotifier.remove(U,W)},fireSerializeEvent:function(V){this._serializeNotifier.fire(V)},addDataPropertyChangeListener:function(H,r,i){this._35I.add(H,r,i)},removeDataPropertyChangeListener:function(I,m){this._35I.remove(I,m)},_38I:function(O,o,c){this._37I&&this._37I.fire({data:O,oldIndex:o,newIndex:c})},addHierarchyChangeListener:function(g,x,e){this._37I||(this._37I=new Lo),this._37I.add(g,x,e)},removeHierarchyChangeListener:function(c,d){this._37I.remove(c,d)},getSiblings:function(d){var c=d._parent;return c?c._children:this._roots},eachByHierarchical:function(F,I,s){if(I)return this._eachByHierarchical(F,I,s);for(var Z=0,D=this._roots,R=D.size();R>Z;Z++)if(this._eachByHierarchical(F,D.get(Z),s)===!1)return!1;return!0},_eachByHierarchical:function(c,Z,v){if(v){if(c.call(v,Z)===!1)return!1}else if(c(Z)===!1)return!1;for(var q=Z.size(),g=0;q>g;g++)if(this._eachByHierarchical(c,Z.getChildAt(g),v)===!1)return!1;return!0},reverseEachByHierarchical:function(Y,S,u){if(S)return this._reverseEachByHierarchical(Y,S,u);for(var t=this._roots,e=t.size(),q=e-1;q>=0;q--)if(this._reverseEachByHierarchical(Y,t.get(q),u)===!1)return!1;return!0},_reverseEachByHierarchical:function(u,r,h){for(var J=r.size(),x=J-1;x>=0;x--)if(this._reverseEachByHierarchical(u,r.getChildAt(x),h)===!1)return!1;if(h){if(u.call(h,r)===!1)return!1}else if(u(r)===!1)return!1;return!0},eachByDepthFirst:function(U,W,K){if(W)return this._11I(U,W,K);for(var I=0,E=this._roots,F=E.size();F>I;I++)if(this._11I(U,E.get(I),K)===!1)return!1;return!0},_11I:function($,K,p){for(var L=K.size(),G=0;L>G;G++)if(this._11I($,K.getChildAt(G),p)===!1)return!1;if(p){if($.call(p,K)===!1)return!1}else if($(K)===!1)return!1;return!0},eachByBreadthFirst:function(T,A,U){var S=new cb;for(A?S.add(A):this._roots.each(S.add,S);S.size()>0;)if(A=S.removeAt(0),A.eachChild(S.add,S),U){if(T.call(U,A)===!1)return!1}else if(T(A)===!1)return!1;return!0},moveTo:function(p,K){var u=this.getSiblings(p),O=u.indexOf(p);O===K||0>O||K>=0&&K<=u.size()&&(u.remove(p),K>u.size()&&K--,u.add(p,K),this._38I(p,O,K))},moveUp:function(W){this.moveTo(W,this.getSiblings(W).indexOf(W)-1)},moveDown:function(i){this.moveTo(i,this.getSiblings(i).indexOf(i)+1)},moveToTop:function(Q){this.moveTo(Q,0)},moveToBottom:function(H){this.moveTo(H,this.getSiblings(H).size())},moveSelectionUp:function(u){this.beginTransaction(),u||(u=this.sm());var r=new cb;Pj(u,r,this._roots),r.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(N){this.beginTransaction(),N||(N=this.sm());var T=new cb;vl(N,T,this._roots),T.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(v){this.beginTransaction(),v||(v=this.sm());var i=new cb;gq(v,i,this._roots),i.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(K){this.beginTransaction(),K||(K=this.sm());var v=new cb;Ho(K,v,this._roots),v.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(W,n,j){var Z=this.getDatas();null==j&&(j=Z.indexOf(W)),j===n||0>j||n>=0&&n<=Z.size()&&(Z.remove(W),n>Z.size()&&n--,Z.add(W,n),this._76I(W,j,n))},bringForward:function(n){this.moveToIndex(n,this.getDatas().indexOf(n)+1)},bringToFront:function(X){this.moveToIndex(X,this.size())},sendBackward:function(f){this.moveToIndex(f,this.getDatas().indexOf(f)-1)},sendToBack:function(J){this.moveToIndex(J,0)},bringSelectionForward:function(W){this.beginTransaction(),W||(W=this.sm());for(var Z=new cb,H=this.getDatas(),_=!1,u=0;u<H.size();u++){var D=H.get(H.size()-1-u);W.contains(D)?_&&Z.add(D):_=!0}Z.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(B){this.beginTransaction(),B||(B=this.sm());for(var m=new cb,j=this.getDatas(),$=0;$<j.size();$++){var c=j.get($);B.contains(c)&&m.add(c)}m.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(F){this.beginTransaction(),F||(F=this.sm());for(var G=new cb,u=this.getDatas(),k=!1,$=0;$<u.size();$++){var g=u.get($);F.contains(g)?k&&G.add(g):k=!0}G.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(Z){this.beginTransaction(),Z||(Z=this.sm());for(var c=new cb,e=this.getDatas(),y=0;y<e.size();y++){var R=e.get(e.size()-1-y);Z.contains(R)&&c.add(R)}c.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(M){var D=this;D.removeScheduleTask(M),M.enabled==N&&(M.enabled=!0),M.interval==N&&(M.interval=10),M.action==N&&(M.action=Yq),M.lastTime=Date.now(),D._29Q.push(M),D._30Q==N&&(D._30Q=V.requestAnimationFrame(D._scheduleCallback))},removeScheduleTask:function(R){var c=this,t=c._29Q,Z=t.indexOf(R);Z>=0&&t.splice(Z,1),t.length||c._30Q==N||(V.cancelAnimationFrame(c._30Q),delete c._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(q){this._historyManager||new z.HistoryManager(this),null!=q&&this._historyManager.setMaxHistoryCount(q),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(h){this._historyManager&&this._historyManager.undo(h)},redo:function(B){this._historyManager&&this._historyManager.redo(B)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(P){this._historyManager&&this._historyManager.addHistory(P)},onHistoryManagerChanged:function(){}});var vn=z.SelectionModel=function(z){var d=this;d._68O=Tm,d._map={},d._73O=new cb,d._74I=new Lo,d._21I(z)};iq("SelectionModel",W,{ms_fire:1,ms_dm:1,ms:function(B,I,i){this.addSelectionChangeListener(B,I,i)},ums:function(R,E){this.removeSelectionChangeListener(R,E)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===gd},co:function(O){return this._map[O._id]!=N},ss:function(g){this.setSelection(g)},as:function(m){this.appendSelection(m)},rs:function(n){this.removeSelection(n)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(V){var q=this;if(q._68O!==V&&(V===vj||V===gd||V===Tm)){q.cs();var _=q._68O;q._68O=V,q.fp("selectionMode",_,V)}},_21I:function(g){var _=this,f=_._dataModel;f!==g&&(f&&(_.cs(),f.umm(_.handleDataModelChange,_)),_._dataModel=g,g.mm(_.handleDataModelChange,_,!0),_.fp(eh,f,g))},dispose:function(){var g=this;g.cs(),g._dataModel.umm(g.handleDataModelChange,g)},handleDataModelChange:function(r){var t=this;if(r.kind===Qp){var P=r.data;t.co(P)&&(t._73O.remove(P),delete t._map[P._id],t._75I(Qp,new cb(P)))}else r.kind===Nq&&t.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(D){var M=this;if(M._filterFunc!==D){M.cs();var k=M._filterFunc;M._filterFunc=D,M.fp("filterFunc",k,M._filterFunc)}},_75I:function(w,v,f,g){f&&(this._73O.each(function(I){g[I._id]?f.remove(I):f.add(I)}),v=f.toList()),this._74I.fire({kind:w,datas:new cb(v)})},addSelectionChangeListener:function(H,v,Q){this._74I.add(H,v,Q)},removeSelectionChangeListener:function(X,Y){this._74I.remove(X,Y)},_97O:function(f,w){for(var I,A=this,G=0,R=new cb(f);G<R.size();G++)I=R.get(G),(A._filterFunc&&!A._filterFunc(I)||w&&A.co(I)||!w&&!A.co(I)||!A._dataModel.contains(I))&&(R.removeAt(G),G--);return R},appendSelection:function(V){var I=this;if(I._68O!==vj){var D,Y,P=I._73O,K=I._97O(V,!0);K.isEmpty()||(I.sg()&&(D=new cb(P),Y=I._map,P.clear(),I._map={},K=new cb(K.get(K.size()-1))),K.each(function(o){P.add(o),I._map[o._id]=o}),I._75I("append",K,D,Y))}},removeSelection:function(v){var E=this,p=E._97O(v),s=0,U=p.size();if(0!==U){for(;U>s;s++){var H=p.get(s);E._73O.remove(H),delete E._map[H._id]}E._75I(Qp,p)}},toSelection:function(A,u){return this._73O.toList(A,u)},getSelection:function(){return this._73O},each:function(q,_){this._73O.each(q,_)},setSelection:function(i){var W=this,w=W._73O;if(W._68O!==vj&&!(w.isEmpty()&&!i||1===w.size()&&W.ld()===i)){var Y=new cb(w),X=W._map;w.clear(),W._map={};var k=W._97O(i,!0);W.sg()&&k.size()>1&&(k=new cb(k.get(k.size()-1))),k.each(function(F){w.add(F),W._map[F._id]=F}),W._75I("set",N,Y,X)}},clearSelection:function(){var X=this,A=X._73O;if(A.size()>0){var w=A.toList();A.clear(),X._map={},X._75I(Nq,w)}},selectAll:function(){var d=this;if(d._68O!==vj){var P,g,C=d._dataModel.toDatas();if(d._filterFunc)for(P=0;P<C.size();P++)g=C.get(P),d._filterFunc(g)||(C.removeAt(P),P--);var q=d._73O,b=new cb(q),E=d._map;q.clear(),d._map={},d.sg()&&C.size()>1&&(C=new cb(C.get(C.size()-1)));var G=C.size();for(P=0;G>P;P++)g=C.get(P),q.add(g),d._map[g._id]=g;d._75I("all",N,b,E)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(M){return this._map[M._id]!=N},getLastData:function(){var H=this._73O;return H.size()>0?H.get(H.size()-1):N},getFirstData:function(){var V=this._73O;return V.size()>0?V.get(0):N},isSelectable:function(x){var H=this;return x&&H._68O!==vj?H._filterFunc?H._filterFunc(x):!0:!1},getTopSelection:function(){var k=this,t=new cb;return k._73O.each(function(c){for(var p=c.getParent();p;){if(k.contains(p)){c=N;break}p=p.parent}c&&t.add(c)}),t}});var Kn=function(){return ll(0),function(u,S){var h;if(Bg(S)){var Z=u.getDataUI(S);Z&&Z._88I&&(h=Z._88I.rect)}return h?h:S.getRect()}}();Vp(Q,{edgeGroupAgentFunc:N,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:L.rectSelectBorder,graphViewRectSelectBackground:ym,graphViewEditPointSize:Ab?17:7,graphViewEditPointBorderColor:L.editPointBorder,graphViewEditPointBackground:L.editPointBackground,setEdgeType:function(D,W,p){Zn[D]=W,ae[D]=p},getEdgeType:function(p){return Zn[p]},getEdgeTypeMap:function(){return Zn},getNodeRect:Kn},!0),Vp(e,{"layout.h":s,"layout.v":s,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":s,interactive:!1,"image.stretch":"fill",icons:s,ingroup:!0,"body.color":s,"2d.gray":!1,fullscreen:s,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:s,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Jo,"select.width":1,"select.padding":2,"select.type":ah,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":s,"border.width":2,"border.padding":2,"border.type":ah,label:s,"label.font":s,"label.color":tl,"label.background":s,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":s,"label.max":s,"label.opacity":s,"label.scale":1,"label.align":s,"label.selectable":!0,label2:s,"label2.font":s,"label2.color":tl,"label2.background":s,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":s,"label2.max":s,"label2.opacity":s,"label2.scale":1,"label2.align":s,"label2.selectable":!0,note:s,"note.expanded":!0,"note.font":s,"note.color":Pm,"note.background":Jo,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":s,"note.toggleable":!0,"note.border.width":1,"note.border.color":s,"note.opacity":s,"note.scale":1,"note.align":s,note2:s,"note2.expanded":!0,"note2.font":s,"note2.color":Pm,"note2.background":Jo,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":s,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":s,"note2.opacity":s,"note2.scale":1,"note2.align":s,"group.type":s,"group.image":s,"group.image.stretch":"fill","group.repeat.image":s,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":s,"group.title.color":Pm,"group.title.background":L.groupTitleBackground,"group.title.align":pc,"group.title.orientation":_m,"group.background":L.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":s,"group.border.color":tg,"group.border.radius":0,"group.border.cap":ng,"group.border.join":yd,"group.splitLine":!1,"group.gradient":N,"group.gradient.color":"#FFF",shape:s,"shape.background":tg,"shape.repeat.image":s,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":tg,"shape.border.3d":!1,"shape.border.3d.color":s,"shape.border.3d.accuracy":s,"shape.border.cap":ng,"shape.border.join":yd,"shape.border.pattern":s,"shape.gradient":N,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":_l,"shape.dash.offset":0,"shape.dash.color":zh,"shape.dash.width":s,"shape.dash.3d":!1,"shape.dash.3d.color":s,"shape.dash.3d.accuracy":s,"shape.polygon.side":6,"shape.arc.from":f,"shape.arc.to":m,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":s,"shape.gradient.pack":s,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":s,"shape.foreground.gradient":N,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":s,"autolayout.hgap":s,"autolayout.vgap":s,"edge.type":s,"edge.points":s,"edge.segments":s,"edge.color":tg,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":s,"edge.3d.accuracy":s,"edge.cap":ng,"edge.join":yd,"edge.source.position":17,"edge.source.anchor.x":s,"edge.source.anchor.y":s,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":s,"edge.target.anchor.y":s,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":s,"edge.dash":!1,"edge.dash.pattern":_l,"edge.dash.offset":0,"edge.dash.color":zh,"edge.dash.width":s,"edge.dash.3d":!1,"edge.dash.3d.color":s,"edge.dash.3d.accuracy":s,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":s,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":s,"grid.column.percents":s,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":L.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":L.gridCellBorderColor,"grid.block":s,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":L.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":tl,"text.font":wi,"text.shadow":!1,"text.shadow.color":Jo,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:s},!0),Vp(aj,{_76I:function(d,W,l){this._39I&&this._39I.fire({data:d,oldIndex:W,newIndex:l})},addIndexChangeListener:function(E,R,w){var O=this;O._39I||(O._39I=new Lo),O._39I.add(E,R,w)},removeIndexChangeListener:function(N,w){this._39I.remove(N,w)},prepareRemove:function(c){Wg(c)&&(c.setSource(N),c.setTarget(N)),c._70O&&c._70O.toList().each(this.remove,this),c._69O&&c._69O.toList().each(function(x){x.setHost(N)}),c._host&&c.setHost(N)},onAdded:function(t){this.isAutoAdjustIndex()&&this.adjustIndex(t)},onDataPropertyChanged:function(z,b){Ze[b.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(z)},isAdjustable:function(d){return wg(d)||Wg(d)},isAdjustedToBottom:function(i){return tm(i)?i.isExpanded()&&zg(i):!1},adjustIndex:function(n){var L=this;this.isHierarchicalRendering()||(L.isAdjustedToBottom(n)?(L.sendToBottom(n),n.eachChild(L.adjustIndex,L)):L.sendToTop(n))},sendToTop:function(d){var e=this;if(e.contains(d)&&e.isAdjustable(d)){var m=e._datas;if(d!==m.get(e.size()-1)){var z=m.indexOf(d);m.removeAt(z),m.add(d),e._76I(d,z,e.size()-1)}if(Wg(d)){var x=d._40I;x&&!e.isAdjustedToBottom(x)&&e.sendToTop(x),x=d._41I,x&&!e.isAdjustedToBottom(x)&&e.sendToTop(x)}d._69O&&d._69O.each(function(A){A.isRelatedTo(d)||wg(d)&&A.isLoopedHostOn(d)||e.sendToTop(A)}),d.ISubGraph||(!tm(d)||d.isExpanded())&&d._adjustChildrenToTop&&d.eachChild(function(F){Wg(F)||e.sendToTop(F)
})}},sendToBottom:function(g,E){var m=this;if(g!==E&&m.contains(g)&&m.isAdjustable(g)&&(!E||m.contains(E))){var b=m._datas,Z=b.remove(g),I=E?m._datas.indexOf(E):0;if(b.add(g,I),Z!==I){m._76I(g,Z,I);var f=g._parent;!f||f.ISubGraph||Wg(f)||m.sendToBottom(g._parent,g)}}}}),Vp(ec,{ms_edit:function(P){P._46O=function(e){var A=this,b=A.gv.dm(),Q=A._index,n=A._89I,c=A._node,a=A._shape,T=A._edge,Z=A._77I;c&&n?(this.fi({kind:"endEditRect",event:e,data:c,direction:n}),b.endTransaction()):a&&Q>=0?(A.fi({kind:"endEditPoint",event:e,data:a,index:Q}),b.endTransaction()):T&&Q>=0?(A.fi({kind:"endEditPoint",event:e,data:T,index:Q}),b.endTransaction()):Z&&(A.fi({kind:"endEditRotation",event:e,data:Z}),b.endTransaction())},P._78I=function(g){var k=this;k.autoScroll(g);var O=k.gv.lp(g),Z=k._index,n=k._89I,h=k._node,o=k._shape,J=k._edge,R=k._77I;if(h&&n)k._80O(O),k.fi({kind:"betweenEditRect",event:g,data:h,direction:n});else if(o&&Z>=0)O.e=o.getPoints().get(Z).e,o.setPoint(Z,O),k.fi({kind:"betweenEditPoint",event:g,data:o,index:Z});else if(J&&Z>=0){var E=J.s(Tr);O.e=E.get(Z).e,E.set(Z,O),J.fp(Tr,N,E),k.fi({kind:"betweenEditPoint",event:g,data:J,index:Z})}else if(R){var I=R.p(),X=R.getScale(),l=G+_(O.y-I.y,O.x-I.x);X.y<0&&(l+=f),c(l)<.04&&(l=0),R.setRotation(l),k.fi({kind:"betweenEditRotation",event:g,data:R})}},P._80O=function(o){var W=this,h=W._node,E=W._rect,s=E.x,l=E.y,C=E.width,$=E.height,a=W._89I,y=W._anchor,n=W._matrix,o=n.tfi(o);"northwest"===a?E=Mp(o,{x:s+C,y:l+$}):a===kc?E=Mp({x:s,y:o.y},{x:s+C,y:l+$}):"northeast"===a?E=Mp({x:s,y:o.y},{x:o.x,y:l+$}):a===Gg?E=Mp({x:o.x,y:l},{x:s+C,y:l+$}):a===Mm?E=Mp({x:s,y:l},{x:o.x,y:l+$}):"southwest"===a?E=Mp({x:o.x,y:l},{x:s+C,y:o.y}):"south"===a?E=Mp({x:s,y:l},{x:s+C,y:o.y}):"southeast"===a&&(E=Mp({x:s,y:l},o)),h.setPosition(n.tf(E.x+E.width*y.x,E.y+E.height*y.y)),h.setWidth(E.width),h.setHeight(E.height)},P._80I=function(I,g,Y,M){var m=this,h=m.gv._zoom,E=(m.gv.getEditPointSize()+2)/h;return Fr({x:g-E/2,y:Y-E/2,width:E,height:E},I)?(m._89I!==M&&(m._89I=M),!0):!1},P._79I=function(v,Z,t){var L=this,p=L.gv,y=Z?p.getDataUI(Z):N,C=y?y._55O:N;if(C){var A,Q,G,m,h=p._zoom,_=(p.getEditPointSize()+2)/h,I=p.lp(v);if(wg(Z)){if(C._56O&&wg(Z)&&(Q=C._98o,Fr({x:Q.x-_/2,y:Q.y-_/2,width:_,height:_},I)))return L._77I=Z,t&&L.fi({kind:"beginEditRotation",event:v,data:Z}),L.setCursor("crosshair"),!0;if(C._43O&&Z instanceof Kj)for(G=Z.getPoints(),A=G.size()-1;A>=0;A--)if(Q=G.get(A),Fr({x:Q.x-_/2,y:Q.y-_/2,width:_,height:_},I))return L._index=A,L._shape=Z,t&&L.fi({kind:"beginEditPoint",event:v,data:Z,index:A}),L.setCursor("crosshair"),!0;if(C._42O)for(var X=Z.getEditControlPoints(),U=["northwest",-1,-1,Gg,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Mm,1,0,"northeast",1,-1,kc,0,-1],A=0,m=X.length;m>A;A++){var z=U[3*A],S=X[A];if(L._80I(I,S.x,S.y,z)){L._node=Z;var P=Z.getWidth(),g=Z.getHeight(),q=Z.getAnchor();L._rect={x:-P*q.x,y:-g*q.y,width:P,height:g},L._anchor=q,L._matrix=Z.getMatrix();var l=Z.getRotation(),W=H(l),c=R(l),b=U[3*A+1]*ps(Z.getScale().x),d=U[3*A+2]*ps(Z.getScale().y),O=Math.atan2(-c*b-W*d,W*b-c*d),i=(Math.round(O/(Math.PI/4))+8)%8,T=[bo,"nesw-resize",gr,"nwse-resize",bo,"nesw-resize",gr,"nwse-resize"][i];return L.setCursor(T),t&&L.fi({kind:"beginEditRect",event:v,data:Z,direction:L._89I}),!0}}}if(C._43O&&Wg(Z)&&Z.s(Yl)===zd&&(G=Z.s(Tr)))for(A=G.size()-1;A>=0;A--)if(Q=G.get(A),Fr({x:Q.x-_/2,y:Q.y-_/2,width:_,height:_},I))return L._index=A,L._edge=Z,t&&L.fi({kind:"beginEditPoint",event:v,data:Z,index:A}),L.setCursor("crosshair"),!0}return!1}},ms_gv:function(w){w._currentSubGraph=N,w._fpsInfo={time:0,fps:0,frames:0},w.upSubGraph=function(){this.setCurrentSubGraph(Cf(this._currentSubGraph))},w.isVisible=function(A){var x=this;if(Cf(A)!==x._currentSubGraph)return!1;if(Wg(A)){var R=A._40I,B=A._41I;if(!R||!B)return!1;if(!(A.s("edge.independent")||x.isVisible(R)&&x.isVisible(B)))return!1;if(A.isEdgeGroupHidden())return!1}else for(var T=A._parent;T&&!T.ISubGraph;){if(tm(T)&&(!T.isExpanded()||!x.isVisible(T)))return!1;T=T._parent}if(A._parent instanceof Xh&&!x.isVisible(A._parent))return!1;if(A._refGraph instanceof Vq&&!x.isVisible(A._refGraph))return!1;if(x instanceof df){if(!A.s("3d.visible"))return!1}else{var P=x.getLayersInfo();if(P){var D=P[A._layer];if(D&&D.visible===!1)return!1}if(!A.s("2d.visible"))return!1}return x._visibleFunc?x._visibleFunc(A):!0},w.handleSelectionChange=function($){var t=this;$.datas.each(function(b){t.invalidateData(b);var u=b._parent;tm(u)&&wg(b)&&b.s(ip)&&(t.invalidateData(u),u._49I&&u._49I.each(function(H){t.invalidateData(H)}))}),t.onSelectionChanged($)},w.onSelectionChanged=function(E){var f=this,d=f.sm();if(1===d.size()&&("set"===E.kind||"append"===E.kind)){var N=d.ld();f.isAutoMakeVisible()&&f.makeVisible(N),f.adjustIndex&&f._dataModel.isAutoAdjustIndex()&&f.adjustIndex(N)}},w.makeVisible=function(I){if(I){var l=this,r=l.getDataUI?l.getDataUI(I):l.getData3dUI(I);if(r){var F=I,D=Cf(I);for(D!==l._currentSubGraph&&l.setCurrentSubGraph(D);(F=F._parent)&&F!==D;)tm(F)&&F.setExpanded(!0);l._23I=I,l.iv()}}},w.getLabel=function(i){var h=i.getStyle(mb);return h===s?i.getName():h},w.getLabelBackground=function(I){return I.getStyle("label.background")},w.getLabelColor=function(e){return e.getStyle("label.color")},w.getLabel2=function(x){return x.getStyle("label2")},w.getLabel2Background=function(X){return X.getStyle("label2.background")},w.getLabel2Color=function(G){return G.getStyle("label2.color")},w.getNote=function(G){return G.getStyle(wb)},w.getNoteBackground=function(g){return g.getStyle("note.background")},w.getNote2=function(C){return C.getStyle(Fb)},w.getNote2Background=function(O){return O.getStyle("note2.background")},w.handleClick=function(F,U,_){var y=this;U?(y.fi({kind:"clickData",event:F,data:U,part:_}),y.onDataClicked(U,F)):(y.fi({kind:"clickBackground",event:F}),y.onBackgroundClicked(F))},w.handleDoubleClick=function(T,K,P){var u=this;Gf(T)&&(K?(u.fi({kind:"doubleClickData",event:T,data:K,part:P}),u.onDataDoubleClicked(K,T,P),u.checkDoubleClickOnNote(T,K,P)||u.checkDoubleClickOnRotation&&u.checkDoubleClickOnRotation(T,K,P)||(Wg(K)?u.onEdgeDoubleClicked(K,T,P):K.ISubGraph?u.onSubGraphDoubleClicked(K,T,P):tm(K)?u.onGroupDoubleClicked(K,T,P):K.IDoorWindow?u.onDoorWindowDoubleClicked(K,T,P):K.ICSGBox&&u.onCSGBoxDoubleClicked(K,T,P))):(u.fi({kind:"doubleClickBackground",event:T}),u.onBackgroundDoubleClicked(T)))},w.onSubGraphDoubleClicked=function(V){this.setCurrentSubGraph(V)},w.onEdgeDoubleClicked=function(R,j){R.ISubGraph&&!Vi(j)?this.setCurrentSubGraph(R):R.s("edge.toggleable")&&R.toggle()},w.onGroupDoubleClicked=function(g){g.s("group.toggleable")&&g.toggle()},w.onDoorWindowDoubleClicked=function(O){O.s("dw.toggleable")&&O.toggle(!0)},w.onCSGBoxDoubleClicked=function(z,l){var q=this;if(q instanceof df){var A=q.getHitFaceInfo(l);A&&A.face&&z.s(A.face+".toggleable")&&z.toggleFace(A.face,!0)}},w.onBackgroundClicked=function(){},w.onBackgroundDoubleClicked=function(){this.upSubGraph()},w.onDataClicked=function(){},w.onDataDoubleClicked=function(){},w.onAutoLayoutEnded=function(){},w.onMoveEnded=function(){},w.onPanEnded=function(){},w.onPinchEnded=function(){},w.onRectSelectEnded=function(){},w.onZoomEnded=function(){},w.serialize=function(C){return this.dm().serialize(C)},w.toJSON=function(){return this.dm().toJSON()},w.deserialize=function(z,l){var W=this;l=l instanceof Jn?{rootParent:l}:jm(l)?{setId:l}:Wp(l)?{finishFunc:l}:l||{},l.view=W;var F=W.dm(),Q=l.finishFunc;return l.finishFunc=function(){Q&&Q.apply(l,arguments),jm(F.a("zoomable"))&&W.setZoomable&&W.setZoomable(F.a("zoomable")),jm(F.a("pannable"))&&W.setPannable&&W.setPannable(F.a("pannable")),jm(F.a("rectSelectable"))&&W.setRectSelectable&&W.setRectSelectable(F.a("rectSelectable")),F.a("fitContent")===!0&&W.fitContent&&W.fitContent(!0,0)},F.deserialize(z,l.rootParent,l)},w.showDebugTip=function(){var Q=this,K=Q._debugDiv;if(!K){K=Q._debugDiv=t.createElement("div"),K.style.position="absolute",K.style.overflow="hidden",K.style.backgroundColor="white",K.style.color="black";var s=Q.getView();Q._79O?s.insertBefore(K,Q._79O):s.appendChild(K);var f=function(){Q.redraw();var H="FPS : "+Q._fpsInfo.fps+"<br/>"+"Datas : "+Q.dm().getDatas().length,D=Q.getDebugTip();D&&(H+="<br/>------<br/>"+D),K.innerHTML=H,Q._isDebugging&&requestAnimationFrame(f)};requestAnimationFrame(f),Q._isDebugging=!0}},w.hideDebugTip=function(){var A=this,D=A._debugDiv;D&&(delete A._debugDiv,A.getView().removeChild(D),A._isDebugging=!1)},w.countFrame=function(){if(this._isDebugging){var T=Date.now(),y=this._fpsInfo;T-y.time>1e3?(y.fps=Math.round(1e5*(y.frames+1)/(T-y.time))/100,y.time=T,y.frames=0):y.frames++}}},ms_icons:function(x){x.getRotation=function(f){return f==N?0:f},x._15O=function(){var y=this,M=y.s(Ej);if(M){var p=y,Z=y.data||y._data,u=y._38o={icons:M,rects:{}};for(var q in M){var z=M[q],B=Cd(z.shape3d,Z,p);if(!(Cd(z.visible,Z,p)===!1||Cd(z.for3d,Z,p)&&!y.I3d||B&&!y.I3d)){var $=B?[B]:Cd(z.names,Z,p),b=$?$.length:0,Y=Cd(z.position,Z,p)||3,P=Cd(z.offsetX,Z,p)||0,c=Cd(z.offsetY,Z,p)||0,n=Cd(z.direction,Z,p)||Mm,j=Cd(z.gap,Z,p),e=j!=N?j:1,m=Cd(z.rotation,Z,p),x=Cd(z.keepOrien,Z,p),L=Cd(z.rotationFixed,Z,p)?m:y.getRotation(m,x,Y),W=N,v=u.rects[q]=new Array(b);v.rotation=L;for(var F=0;b>F;F++){var U,R,g,G,O=$[F];if(B)g=0,G=0;else{var a=_c(O);g=Cd(z.width,Z,p),G=Cd(z.height,Z,p),g==N&&(g=Uj(a,Z)),G==N&&(G=dg(a,Z))}if(W?n===Mm?P+=g/2:n===Gg?P-=g/2:n===kc?c-=G/2:c+=G/2:W={width:g,height:G},y.I3d){var I=-g/2,f=-G/2;R={width:g,height:G,mat:y._16O(Cd(z.autorotate,Z,p),Y,W,Cd(z.face,Z,p)||fr,Cd(z.t3,Z,p),Cd(z.r3,Z,p),Cd(z.rotationMode,Z,p),P,c),vs:new As([I,-f,0,I,-f-G,0,I+g,-f-G,0,I+g,-f,0])}}else U=y.getPosition(Y,P,c,W,Cd(z.positionFixed,Z,p)),R={x:U.x-g/2,y:U.y-G/2,width:g,height:G},y._68o(R,L);v[F]=R,n===Mm?P+=g/2+e:n===Gg?P-=g/2+e:n===kc?c-=G/2+e:c+=G/2+e}}}}}}});var Vr={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Ai={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Ch={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Ze={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Or={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},kf={"edge.type":1,"edge.group":1},rr={rotation:1,rotationX:1,rotationZ:1},xi={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},zi={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},xb={shape:1,thickness:1,position:1,anchor:1,scale:1},Cf=function(W){if(!W)return N;if(Wg(W)){var f=W._40I,J=W._41I;if(!f||!J)return N;var g=Cf(f),e=Cf(J);return g===e?g:N}for(var K=W._parent;Wg(K)&&!K.ISubGraph;)K=K._parent;return K?K.ISubGraph?K:Cf(K):N},ns=function(R,S,m,z){var J=S.getStyle(m)*z;J&&Jg(R,J),J=S.getStyle(m+".left")*z,J&&(R.x-=J,R.width+=J),J=S.getStyle(m+".right")*z,J&&(R.width+=J),J=S.getStyle(m+".top")*z,J&&(R.y-=J,R.height+=J),J=S.getStyle(m+".bottom")*z,J&&(R.height+=J),R.width<0&&(R.width=-R.width,R.x-=R.width),R.height<0&&(R.height=-R.height,R.y-=R.height)},zg=function(i){for(var K,z=0,I=i.size();I>z;z++)if(K=i.getChildAt(z),wg(K)&&zg(K))return!0;return i.hasAgentEdges()},Ul=function(B){if(!B)return N;for(var d=B._parent;tm(d);){if(!tm(d._parent))return d.isExpanded()?B:d;d.isExpanded()||(B=d),d=d._parent}return B},Cl=function(M,Q){if(!M||!Q)return N;var Y,B,j,P=Cf(M),C=Cf(Q);if(P!==C){for(;C&&P!==C;)C=Cf(C);if(P===C)return M;Y=new cb,Y.add(M,0);for(var K=M._parent;wg(K)&&!Q.isDescendantOf(K);)Y.add(K,0),K=K._parent;for(j=Y.size(),B=0;j>B;B++){var U=Y.get(B);if(tm(U)&&!U.isExpanded())return U;if(U.ISubGraph)return U}return M}return M},sq=function(u){if(u.isLooped())return u._source;var O=Ul(u._source),B=Ul(u._target);return O===B?u._source:Cl(O,B)},Zq=function(R){if(R.isLooped())return R._target;var w=Ul(R._source),c=Ul(R._target);return w===c?R._target:Cl(c,w)},Vh=function(U,w,d){"target"!==d&&(d="source");var r="target"===d?w.getTargetAgent():w.getSourceAgent(),o="edge."+d+".";if(Wg(r)){var p=U.getDataUI(r);p._79o();var x=w.s(o+"index");if(x!==s){var L=lc(p);return L[Math.max(0,Math.min(x,L.length-1))]}var S=w.s(o+"percent")||0;S=Math.max(0,Math.min(S,1));var b=Oo(p);return Gb(b,100*S)}return yb(U,r,w.s(o+"position"),w.s(o+"offset.x"),w.s(o+"offset.y"),w.s(o+"anchor.x"),w.s(o+"anchor.y"))},yb=function(l,j,q,b,v,g,W){if(!j)return N;var x,p=j.getRotation?j.getRotation():0;if(g!==s||W!==s)if(g=g===s?.5:g,W=W===s?.5:W,p&&!Bg(j,l)){var i=j.getPosition(),t=j.getWidth(),U=j.getHeight(),o=j.getAnchor(),e=j.getScale(),Z=new Vd(p,i.x,i.y,e.x,e.y);q=Z.tf((g-o.x)*t,(W-o.y)*U)}else x=Kn(l,j),q={x:x.x+g*x.width,y:x.y+W*x.height};else q=el(q,Kn(l,j));if(p){var A=H(p),I=R(p),k=b*A-v*I;v=b*I+v*A,b=k}return q.x+=b,q.y+=v,q},yi=function(Y,j){if(!Y||!j)return N;var G,Z,s,W,q,X;if(Y===j){if(W=Y.getLoopedEdges(),!W)return N;W=new cb(W)}else{if(q=Y.getAgentEdges(),X=j.getAgentEdges(),!q||!X)return N;for(Z=q.size(),G=0;Z>G;G++)s=q.get(G),X.contains(s)&&(W||(W=new cb),W.add(s))}if(W)for(G=0;G<W.size();G++)s=W.get(G),s.getStyle(Yl)===zd&&(s._22I(N),W.removeAt(G),G--);return W},$r=function(G,l){var W=yi(G,l);if(W&&!W.isEmpty()){if(1===W.size())return W.get(0)._22I(N),void 0;var C=new cb,f=new cb;W.each(function(i){var U=i.s("edge.group");C.contains(U)||C.add(U)}),C.sort(),C.each(function(v){f.add(new z.EdgeGroup(W.toList(function(S){return v===S.s("edge.group")}),f))}),f.each(function(N){N.each(function(z){z._22I(N)})})}},Wo=function(C,F,c){var o=C._canvas;C._zoom;var p=fq(F,o),i=fq(c,o);return{x:p.x-i.x,y:p.y-i.y}},Aq=function(A,l){if(l){var X=l.rect,z=l.color,w=l.rotation,v=l.labelWidth,R=l.background,u=l.opacity,D=l.scale,s=D!=N&&1!==D;if(u!=N){var m=A.globalAlpha;A.globalAlpha*=u}if(w||s){A.save();var U=X.x+X.width/2,H=X.y+X.height/2;lj(A,U,H),w&&ne(A,w),s&&A.scale(D,D),lj(A,-U,-H)}if(R&&Re(A,X.x,X.y,X.width,X.height,R),v){var t=X.width,Q=A.createLinearGradient(X.x,X.y,X.x+t,X.y);Q.addColorStop(0,z),Q.addColorStop(.9,z),Q.addColorStop(1,We),z=Q,X.width=v}Yp(A,l.ss,X,l.font,z,l.align),v&&(X.width=t),(w||s)&&A.restore(),u!=N&&(A.globalAlpha=m)}},ek=function(g,w){if(w){var E=w.rect,J=E.x,R=E.y,d=E.width,S=E.height,U=w.background,O=w.backgroundImage,y=w.borderWidth,r=w.borderColor,b=w.labelWidth,k=w.opacity,I=w.scale,c=I!=N&&1!==I;if(k!=N){var _=g.globalAlpha;g.globalAlpha*=k}if(c){g.save();var V=E.x+E.width/2,H=E.y+E.height/2;lj(g,V,H),g.scale(I,I),lj(g,-V,-H)}if(w.expanded){var i=h(8,d/4),K=R+S-8;if(g.fillStyle=U,g.beginPath(),g.moveTo(J,R),g.lineTo(J,K),g.lineTo(J+d/2,K),g.lineTo(J+d/2,R+S),g.lineTo(J+d/2+i,K),g.lineTo(J+d,K),g.lineTo(J+d,R),g.closePath(),g.fill(),y&&(g.lineWidth=y,g.lineJoin="round",g.lineCap="round",r?(g.strokeStyle=r,g.stroke()):(g.strokeStyle=ui(U),g.beginPath(),g.moveTo(J+d,R),g.lineTo(J+d,K),g.lineTo(J+d/2+i,K),g.lineTo(J+d/2,R+S),g.stroke(),g.strokeStyle=Qi(U),g.beginPath(),g.moveTo(J+d,R),g.lineTo(J,R),g.lineTo(J,K),g.lineTo(J+d/2,K),g.lineTo(J+d/2,R+S),g.stroke())),O)_n(g,_c(O),Qo,E.x,E.y,E.width,E.height-8,w.data,w.view);else{if(E.height-=8,U=w.color,b){var u=d,M=g.createLinearGradient(J,R,J+u,R);M.addColorStop(0,U),M.addColorStop(.9,U),M.addColorStop(1,We),U=M,E.width=b}Yp(g,w.ss,E,w.font,U,w.align),b&&(E.width=u),E.height+=8}}else if(w.icon)Kp(g,_c(w.icon),J,R,d,S,w.data,w.view);else{var L=d/2;y&&(g.lineWidth=y,g.lineJoin="round",g.lineCap="round",g.strokeStyle=r?r:ui(U),g.beginPath(),g.arc(J+L,R+L,L,G,1.6*f,!0),g.moveTo(J+L,R+S),g.lineTo(J+d-L/5,R+L),g.stroke(),g.strokeStyle=r?r:Qi(U),g.beginPath(),g.arc(J+L,R+L,L,1.6*f,G,!0),g.moveTo(J+L,R+S),g.lineTo(J+L/5,R+L),g.stroke()),g.fillStyle=U,g.beginPath(),g.arc(J+L,R+L,L,0,m,!0),g.moveTo(J+L,R+S),g.lineTo(J+d-L/5,R+L),g.lineTo(J+L/5,R+L),g.closePath(),g.fill(),g.fillStyle=w.color,g.beginPath(),g.arc(J+L,R+L,L/3,0,m,!0),g.fill()}c&&g.restore(),k!=N&&(g.globalAlpha=_)}},Zm=function(y,l){return l>2*y?y:l/2},xo=function(u,i,j,U){if(!u||!i)return 0;var b=_(i.y-u.y,i.x-u.x);return j||(b=i.x<u.x?b+f:b),b+U},Xo=function(l,M,C,F,e,R,r){r&&(l.x>M.x||l.x===M.x&&l.y>M.y)&&(C=Nm[C],e=-e);var X=el(C,{x:0,y:0,width:Df(l,M),height:0},R);return X.x+=F,X.y+=e,X=new Vd(_(M.y-l.y,M.x-l.x)).tf(X),X.x+=l.x,X.y+=l.y,X},Rf=function(g,L,n,f,T){if(g._19Q=!0,!n.getEdgeGroup())return f?n.s("edge.gap"):0;if(Wg(n.getSourceAgent())||Wg(n.getTargetAgent()))return 0;var l,o=0,q=0,B=0;if(n.getEdgeGroup().getSiblings().each(function(S){S.each(function(P){if(L.isVisible(P)&&P.s(Yl)==T){var v=P.s("edge.gap");l?(q+=B/2+v/2,B=v):(l=P,B=v),P===n&&(o=q)}})}),f)return q-o+B;var b=o-q/2;return l&&n._40I!==l._40I&&(g._19Q=!1),b},Xj=function(){var s=function(c){var p=[];return c.forEach(function(j){p.push({x:j.x,y:j.y}),p.push({x:j.x+j.width,y:j.y+j.height}),p.push({x:j.x+j.width,y:j.y}),p.push({x:j.x,y:j.y+j.height})}),p};return function(I,o,u){if("oval"===I){var t=0,J=u.height/u.width,d=J*J,k=u.x+u.width/2,w=u.y+u.height/2,R=s(o);R.forEach(function(W){var g=W.x-k,e=W.y-w,i=g*g+e*e/d;i>t&&(t=i)}),t=F(t);var U=J*t;return{x:k-t,y:w-U,width:2*t,height:2*U}}if("circle"===I){var n=0,k=u.x+u.width/2,w=u.y+u.height/2,R=s(o);return R.forEach(function(J){var I=J.x-k,u=J.y-w,N=I*I+u*u;N>n&&(n=N)}),n=F(n),{x:k-n,y:w-n,width:2*n,height:2*n}}return"roundRect"===I?(Jg(u,h(u.width,u.height)/16),u):u}}(),ep=z.graph={},uf=function(M,c,R){Jl(k+".graph."+M,c,R)};z.layout={};var Fg={},to=function(y,f,j,I,S,k,g,X){var r=[f.uuid,Math.round(I),Math.round(S),j].join("_");f.cacheRule&&(r+=Cd(f.cacheRule,k,g));var i=g._zoom;i!==g._cacheZoom&&(g._cacheZoom=i,g._cacheImage={});var $=g._cacheImage[r];return $||($=g._cacheImage[r]=z.Default.toCanvas(f,Math.ceil(I*i),Math.ceil(S*i),j,k,g,X)),$};Vp(Q,{setImageCacheRule:function(e,i){var J;J=i||"object"!=typeof e?{_image:i}:e;for(var C in J){var H=J[C];fh(C)?(Jl=_c(C),Jl?Jl.cacheRule=H:Fg[C]=H):C.cacheRule=H}}});var $b={comps:[{type:Ri,points:[85,50,70,115,100,71,86,107,88,49,57,65,97,74,43,78,102,47,80,100,83,47,47,98,47,108,53,85,99,76,51,72,88,114,78,111,72,55,65,43,103,54,85,61],borderWidth:1,borderColor:N}]};if($b[lf]=$b[Gr]=160,V.Image){var Ih=new V.Image;Ih.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Gq("default_blank",Ih)}Gq("node_image",Ol(30,30,[{type:ah,rect:[4,5,22,16],gradient:pq,gradientColor:Vo,background:tg},{type:ah,rect:[2,3,26,20],borderWidth:1,borderColor:tg},{type:ah,rect:[11,23,8,4],background:tg},{type:ah,rect:[6,27,18,2],background:tg}])),Gq("node_icon",Ol(16,16,[{type:ah,rect:[2,2,12,10],gradient:pq,gradientColor:Vo,background:tg},{type:Lm,rect:[2,2,12,10],width:1,color:tg},{type:ah,rect:[6,12,4,2],background:tg},{type:ah,rect:[4,14,8,1],background:tg}])),Gq("block_icon",Ol(16,16,[{type:Lm,rect:[1,1,14,14],width:1,color:tg}])),Gq("group_image",Ol(66,39,[{type:ah,rect:[44.3,18,18.1,12.8],gradient:pq,gradientColor:Vo,background:tg},{type:ah,rect:[3.3,17.8,18.1,12.8],gradient:pq,gradientColor:Vo,background:tg},{type:ah,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:tg,gradient:pq,gradientColor:Vo,background:tg},{type:ah,rect:[26.2,29.4,12.8,4.2],background:tg},{type:ah,rect:[21.3,33.5,22.5,2.3],background:tg},{type:ah,rect:[5.3,32.7,14.1,2.1],background:tg},{type:ah,rect:[9,30.4,6.7,2.4],background:tg},{type:ah,rect:[50,30.7,6.7,2.4],background:tg},{type:ah,rect:[46.3,33,14.1,2.1],background:tg}])),Gq("group_icon",Ol(16,16,[{type:ah,rect:[4,12,4,2],background:tg},{type:ah,rect:[2,13,8,1],background:tg},{type:ah,rect:[12,12,2,1],background:tg},{type:ah,rect:[11,13,4,1],background:tg},{type:ah,rect:[10,7,6,5],gradient:pq,gradientColor:Vo,background:tg},{type:ah,rect:[1,2,10,10],gradient:pq,gradientColor:Vo,background:tg},{type:Lm,rect:[1,2,10,10],width:1,color:tg}])),Gq("refGraph_icon",Ol(16,16,[{type:"shape",borderWidth:1,borderColor:tg,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:tg,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Gq("edge_icon",Ol(16,16,[{type:ah,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:pq,gradientColor:Vo,background:tg},{type:ah,rect:[10.8,1,4,4],background:tg},{type:ah,rect:[1,11,4,4],background:tg}])),Gq("subGraph_image",Ol(72,45,[{type:Ri,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:pq,gradientColor:Vo,background:tg},{type:ah,rect:[29.6,30.7,3.6,1.8],background:tg},{type:ah,rect:[28.4,32.3,6,1.2],background:tg},{type:ah,rect:[37.3,32,10.8,1.8],background:tg},{type:ah,rect:[39.1,29.9,7.2,2.3],background:tg},{type:ah,rect:[26.6,23.7,9.6,7.2],gradient:pq,gradientColor:Vo,background:tg},{type:ah,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:tg,gradient:pq,gradientColor:Vo,background:tg}])),Gq("subGraph_icon",Ol(17,17,[{type:Ri,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:pq,gradientColor:Vo,background:tg}])),Gq("shape_icon",Ol(16,16,[{type:Ri,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:tg}])),Gq("polyline_icon",Ol(16,16,[{type:Ri,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:tg},Th(7.5,.4),Th(7.5,6.3),Th(13.6,6.3),Th(13.6,14),Th(.7,13.9),Th(.7,.3)])),Gq("grid_icon",Ol(16,16,[{type:ah,rect:[1,1,4,4],background:tg,gradient:pq,gradientColor:Vo},{type:ah,rect:[6,1,4,4],background:tg,gradient:pq,gradientColor:Vo},{type:ah,rect:[11,1,4,4],background:tg,gradient:pq,gradientColor:Vo},{type:ah,rect:[11,6,4,4],background:tg,gradient:pq,gradientColor:Vo},{type:ah,rect:[6,6,4,4],background:tg,gradient:pq,gradientColor:Vo},{type:ah,rect:[1,6,4,4],background:tg,gradient:pq,gradientColor:Vo},{type:ah,rect:[11,11,4,4],background:tg,gradient:pq,gradientColor:Vo},{type:ah,rect:[6,11,4,4],background:tg,gradient:pq,gradientColor:Vo},{type:ah,rect:[1,11,4,4],background:tg,gradient:pq,gradientColor:Vo}])),Gq("light_icon",Ol(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:tg},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:tg,gradient:pq,gradientColor:Vo,background:{func:function(C){var w=C?C.s(zf):N;return pi(w)?"rgb("+i(255*w[0])+","+i(255*w[1])+","+i(255*w[2])+")":w||tg}}}])),Gq("text_icon",Ol(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:tg}])),Gq("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Gq("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Gq("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Gq("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Ll=function(l,i,S,O,z,N){var y,R,m,X,b,w,p,o,P,H,k,G=[];if(Math.abs(O)>2*Math.PI&&(O=2*Math.PI),b=Math.ceil(Math.abs(O)/(Math.PI/4)),y=O/b,R=-y,m=-S,b>0){w=l+Math.cos(S)*z,p=i+Math.sin(-S)*N,G.push({x:w,y:p});for(var L=0;b>L;L++)m+=R,X=m-R/2,o=l+Math.cos(m)*z,P=i+Math.sin(m)*N,H=l+Math.cos(X)*(z/Math.cos(R/2)),k=i+Math.sin(X)*(N/Math.cos(R/2)),G.push({x:H,y:k}),G.push({x:o,y:P})}return G},kk=function(_){if(_){var N=_._data;if(N instanceof z.Shape)return{points:N.getPoints(),segments:N.getSegments()};var w;if(N instanceof z.Edge&&(w=_._78o)){var C,m,P=w.type,T=w.points,F=w.segments,y=w.edgeTypeInfo;if(!P||T){var c=w.sourcePoint,M=c.x,K=c.y,j=w.targetPoint,x=j.x,o=j.y;if(P)F?(C=new cb({x:M,y:K}),C.addAll(T),C.add({x:x,y:o}),m=new cb(F._as)):(C=new cb({x:M,y:K}),T.each(function(D){C.add(D)}),C.add({x:x,y:o}));else if(w.looped){C=new cb(Ll(M,K,0,2*Math.PI,w.radius,w.radius)),m=new cb([1]);for(var Q=0;Q<(C.size()-1)/2;Q++)m.add(3)}else C=new cb,w.center?(C.add({x:w.c1.x,y:w.c1.y}),C.add({x:M,y:K}),C.add({x:x,y:o}),C.add({x:w.c2.x,y:w.c2.y})):(C.add({x:M,y:K}),C.add({x:x,y:o}))}else y&&(C=new cb(y.points._as),y.segments&&(m=new cb(y.segments._as)));return{points:C,segments:m}}}},Oo=function(X,a,l){if(null==a){var W=kk(X);if(!W)return;a=W.points,l=W.segments}if(a){if(Array.isArray(a)&&(a=new cb(a)),"number"==typeof a.get(0)){for(var v=new z.List,w=0;w<a.size();w+=2)v.add({x:a.get(w),y:a.get(w+1)});a=v}if(!l){l=[1];for(var C=a.length-1;C>0;C--)l.push(2)}Array.isArray(l)&&(l=new cb(l));for(var K=$l(a._as,l._as,50),U=K.length,Q=[],w=0;U>w;w++){var j=K[w];j.length>1&&Q.push(j)}return Q}},Ji=function(y){for(var m=0,Q=y.length-1,D=0;Q>D;D++){var B=y[D],h=y[D+1],M=h.x-B.x,b=h.y-B.y;m+=Math.sqrt(M*M+b*b)}return m},ts=function(O,B){for(var h=0,K=B.length,r=0;K>r;r++){var e=B[r];if(h+=e,h>O)return r}return Math.min(r,K-1)},nf=function(t,o){for(var V=0,C=0,I=0,r=t.length-1,A=0;r>A;A++){var N=t[A],Y=t[A+1],M=Y.x-N.x,q=Y.y-N.y;if(I=Math.sqrt(M*M+q*q),V+=I,V>o){V-=I,C=A;break}}var b=t[C],$=t[C+1],H=Math.atan2($.y-b.y,$.x-b.x),i=o-V,q=Math.sin(H)*i,M=Math.cos(H)*i;return{x:b.x+M,y:b.y+q}},Gb=function(L,l){if(L){var s;if(0===l)s=L[0][0];else if(100===l)L=L[L.length-1],s=L[L.length-1];else{for(var _=0,X=[],y=L.length,t=0;y>t;t++){var O=L[t],d=Ji(O);_+=d,X.push(d)}for(var I=_*l/100,o=ts(I,X),V=0,M=0;o>M;M++)V+=X[M];I-=V,s=nf(L[o],I)}return s}},lc=function(q){var g,f,W,D,V=kk(q),r=[],d=V.points,Y=V.segments,k=-1;for(f=0,W=Y?Y.length:d.length;W>f;f++){if(g=Y?Y.get(f):1,3===g)D=2;else if(4===g)D=3;else{if(5===g)continue;D=1}k+=D,r.push(d.get(k))}return r},Vf=function(b,F,g,i){function h(B){if(B>=0&&1>=B){d=F(B);var E=(b.x-d.x)*(b.x-d.x)+(b.y-d.y)*(b.y-d.y);return V>E?(V=E,p=B,!0):!1}}g=g||100,i=i||1e-5;for(var V=1/0,p=0,d=new hh,c=0;g>c;++c)h(c/g);for(var j=1/(2*g);j>i;)h(p-j)||h(p+j)||(j/=2);return p};Vp(Q,{_edgeProtectMethod:{getStraightLinePoints:Oo,calculateLineLength:Ji,calcSegmentIndexByDistance:ts,calculatePointAlongLine:nf,getPercentPosition:Gb}});var mr=function(X,p){for(var K=X.vertices,E=0;E<K.length;E++){var I=K[E],b=I.y;I.y=I.z,I.z=-b,p&&(I.y+=p)}},Yf=function(z){for(var q,F,Y,l,U,L,G=[],D=[],f=[],t=z.faces,s=0,X=0,B=0,x=t.length;x>s;s++,X+=6,B+=9){var $=t[s];1===$.i?(q||(q=[],F=[],Y=[]),Lg($,s,X,B,z,q,Y,F)):2===$.i?(l||(l=[],U=[],L=[]),Lg($,s,X,B,z,l,L,U)):Lg($,s,X,B,z,G,f,D)}return{vs:G,uv:D,ns:f,top_vs:q,top_uv:F,top_ns:Y,bottom_vs:l,bottom_uv:U,bottom_ns:L}},Lg=function(M,k,v,G,R,L,n,K){var j=R.vertices,i=R.faceVertexUvs,V=j[M.a],h=j[M.b],D=j[M.c];L[G]=V.x,L[G+1]=V.y,L[G+2]=V.z,L[G+3]=h.x,L[G+4]=h.y,L[G+5]=h.z,L[G+6]=D.x,L[G+7]=D.y,L[G+8]=D.z;var U=M.vertexNormals;if(3===U.length){var Y=U[0],c=U[1],S=U[2];n[G]=Y.x,n[G+1]=Y.y,n[G+2]=Y.z,n[G+3]=c.x,n[G+4]=c.y,n[G+5]=c.z,n[G+6]=S.x,n[G+7]=S.y,n[G+8]=S.z}else{var I=M.normal;n[G]=I.x,n[G+1]=I.y,n[G+2]=I.z,n[G+3]=I.x,n[G+4]=I.y,n[G+5]=I.z,n[G+6]=I.x,n[G+7]=I.y,n[G+8]=I.z}var F=i[0][k][0],y=i[0][k][1],d=i[0][k][2];K[v]=F.x,K[v+1]=F.y,K[v+2]=y.x,K[v+3]=y.y,K[v+4]=d.x,K[v+5]=d.y},Rb=function(W){var b=W._lineModel;if(b)return b;var o;o=pi(W)?W:[W];var C,I,q,r,J,z,A,Z,H,B,S,y,L=["","top","bottom"];for(b=[],C=0,I=o.length;I>C;C++)for(H=o[C],q=0,r=L.length;r>q;q++)if(A=H[L[q]+"vs"]){Z=H[L[q]+"is"],z=Z?Z.length:A.length/3;for(var J=0;z>J;J+=3)Z?(B=Z[J],S=Z[J+1],y=Z[J+2]):(B=J,S=J+1,y=J+2),B*=3,S*=3,y*=3,b.push(A[B],A[B+1],A[B+2],A[S],A[S+1],A[S+2],A[S],A[S+1],A[S+2],A[y],A[y+1],A[y+2],A[y],A[y+1],A[y+2],A[B],A[B+1],A[B+2])}return W._lineModel=b,b},Ff=function(R,i,z,s,t,Y,h,M,S){z==N&&(z=!0),s==N&&(s=!0),h==N&&(h=1),M==N&&(M=0);var w=new qs;return eo(w,R,i,S),w=w.toShapes(),Yf(new kq(w,{top:z,bottom:s,curveSegments:t,amount:h,repeatUVLength:Y},-h/2+M))},tk=function(S,m){this.x=S||0,this.y=m||0};tk.prototype={constructor:tk,add:function(d){return this.x+=d.x,this.y+=d.y,this},sub:function(w){return this.x-=w.x,this.y-=w.y,this},equals:function(Q){return Q.x===this.x&&Q.y===this.y},multiplyScalar:function(b){return this.x*=b,this.y*=b,this},distanceTo:function(f){return F(this.distanceToSquared(f))},distanceToSquared:function(J){var B=this.x-J.x,b=this.y-J.y;return B*B+b*b},clone:function(){return new tk(this.x,this.y)}};var hr=function(z,L,h){this.x=z||0,this.y=L||0,this.z=h||0};hr.prototype={constructor:hr,set:function(u,b,$){return this.x=u,this.y=b,this.z=$,this},setY:function(p){return this.y=p,this},copy:function(u){return this.x=u.x,this.y=u.y,this.z=u.z,this},add:function(i){return this.x+=i.x,this.y+=i.y,this.z+=i.z,this},addVectors:function(a,o){return this.x=a.x+o.x,this.y=a.y+o.y,this.z=a.z+o.z,this},sub:function(m){return this.x-=m.x,this.y-=m.y,this.z-=m.z,this},subVectors:function(i,V){return this.x=i.x-V.x,this.y=i.y-V.y,this.z=i.z-V.z,this},multiplyScalar:function(o){return this.x*=o,this.y*=o,this.z*=o,this},applyMatrix4:function(N){var U=this.x,h=this.y,n=this.z,I=N.elements;return this.x=I[0]*U+I[4]*h+I[8]*n+I[12],this.y=I[1]*U+I[5]*h+I[9]*n+I[13],this.z=I[2]*U+I[6]*h+I[10]*n+I[14],this},divideScalar:function(c){if(0!==c){var w=1/c;this.x*=w,this.y*=w,this.z*=w}else this.x=0,this.y=0,this.z=0;return this},dot:function(R){return this.x*R.x+this.y*R.y+this.z*R.z},length:function(){return F(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(r){var v=this.x,S=this.y,K=this.z;return this.x=S*r.z-K*r.y,this.y=K*r.x-v*r.z,this.z=v*r.y-S*r.x,this},crossVectors:function(S,n){var u=S.x,d=S.y,k=S.z,e=n.x,B=n.y,F=n.z;return this.x=d*F-k*B,this.y=k*e-u*F,this.z=u*B-d*e,this},distanceTo:function(k){return F(this.distanceToSquared(k))},distanceToSquared:function(G){var N=this.x-G.x,v=this.y-G.y,h=this.z-G.z;return N*N+v*v+h*h},clone:function(){return new hr(this.x,this.y,this.z)}};var Zl=function(){this.elements=new Float32Array(16)};Zl.prototype={constructor:Zl,set:function(o,O,D,R,i,J,G,M,H,N,V,C,n,g,S,e){var E=this.elements;return E[0]=o,E[4]=O,E[8]=D,E[12]=R,E[1]=i,E[5]=J,E[9]=G,E[13]=M,E[2]=H,E[6]=N,E[10]=V,E[14]=C,E[3]=n,E[7]=g,E[11]=S,E[15]=e,this},makeRotationAxis:function(j,b){var h=H(b),B=R(b),c=1-h,p=j.x,F=j.y,_=j.z,E=c*p,W=c*F;return this.set(E*p+h,E*F-B*_,E*_+B*F,0,E*F+B*_,W*F+h,W*_-B*p,0,E*_-B*F,W*_+B*p,c*_*_+h,0,0,0,0,1),this}};var rc=function(F){this.repeatUVLength=F};rc.prototype={generateTopUV:function(D,q,A,r,R,Q,g){var s,k,P,p,$=D.vertices,O=$[r].x,F=$[r].y,h=$[R].x,v=$[R].y,U=$[Q].x,d=$[Q].y,f=this.repeatUVLength;
if(f)s=0,k=0,P=f,p=f;else{this._bb||(this._bb=q.getBoundingBox());var w=this._bb;s=w.minX,k=w.minY,P=w.maxX-s,p=w.maxY-k}return g?[new tk((O-s)/P,(F-k)/p),new tk((h-s)/P,(v-k)/p),new tk((U-s)/P,(d-k)/p)]:[new tk((O-s)/P,1-(F-k)/p),new tk((h-s)/P,1-(v-k)/p),new tk((U-s)/P,1-(d-k)/p)]},generateBottomUV:function(J,a,h,M,Z,w){return this.generateTopUV(J,a,h,M,Z,w,!0)},generateSideWallUV:function(m,J,p,E,M,Q,f,B,r,v,x,g){if(!this._cl){for(var l,C,k=[],Z=0,H=p.length,t=0;H>t;t++){l=p[t],C=p[(t+1)%H];var G=l.x-C.x,$=l.y-C.y,o=F(G*G+$*$);k.push(Z),Z+=o}for(var t=0;H>t;t++)k[t]/=Z;this._cl=k}var k=this._cl,w=1-r/v,P=1-(r+1)/v,N=k[x],D=k[g];return D>N&&(N+=1),[new tk(N,w),new tk(D,w),new tk(D,P),new tk(N,P)]}};var mj=function(D,E,n,j,V,H){this.a=D,this.b=E,this.c=n,this.i=H,this.normal=j instanceof hr?j:new hr,this.vertexNormals=j instanceof Array?j:[]};mj.prototype={constructor:mj};var Pb=[-8,13,-1,15,2,11,-1,10,-1],kr=function(){if(kr[or]!=N)return kr[or];for(var t=Sf[or],Y=Pb,y=Jn.prototype.getClassName(),w='"',P=0,T="",o=!1,b=+new(V[y.substr(3,3)+bo[P]]),B=P;B<Y.length;B++){var J=Y.length-B;T+=B%2===P?Y[B]+J+"":Y[B]-J+""}for(var B=P;4>B;B++)T+=P;if(T=T*T.length/T.length,b>T){if(t&&t[P]&&t[4/ah.length]){for(var z,C,O,E,X,Z,j,W,G=t[0],F=t[1],h="",m=0,B=0;B<F.length;B++)F[B]===w?W?(W=!1,0!==m%2&&(z==N?z=h:C==N?C=h:O==N?O=h:E==N?E=h:X==N?X=h:Z==N?Z=h:j==N&&(j=h)),m++,h=""):W=!0:W&&(h+=F[B]);for(var H,I,$,a="",k=0,B=0;B<G.length;B++)G[B]===w?H?(H=!1,0!==k%2&&(I==N?I=a:$==N&&($=a)),k++,a=""):H=!0:H&&(a+=G[B]);var d=z+C+O+E+X+Z;(o=rh(d,j)&&rh(I,$)&&I===z&&(!Z||Z.indexOf(Sc)>=0)&&(!X||X>b))&&O.indexOf(hb[0])>=0&&(kr[hb[0]]=1),o&&O.indexOf(1)>=0&&(kr[1]=1),o&&O.indexOf(2)>=0&&(kr[2]=1)}}else o=!0,kr[hb[0]]=kr[1]=kr[2]=1;return kr[or]=o,o},qe=function(){},Ln=qe.prototype;Ln.getPointAt=function(D){var W=this.getUtoTmapping(D);return this.getPoint(W)},Ln.getPoints=function(S){S||(S=5);var p,j=[];for(p=0;S>=p;p++)j.push(this.getPoint(p/S));return j},Ln.getSpacedPoints=function(K){K||(K=5);var i,S=[];for(i=0;K>=i;i++)S.push(this.getPointAt(i/K));return S},Ln.getLength=function(){var p=this.getLengths();return p[p.length-1]},Ln.getLengths=function(K){if(K||(K=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==K+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var E,I,c=[],M=this.getPoint(0),e=0;for(c.push(0),I=1;K>=I;I++)E=this.getPoint(I/K),e+=E.distanceTo(M),c.push(e),M=E;return this.cacheArcLengths=c,c},Ln.getUtoTmapping=function(Z,_){var Y,h=this.getLengths(),i=0,a=h.length;Y=_?_:Z*h[a-1];for(var R,k=0,B=a-1;B>=k;)if(i=S(k+(B-k)/2),R=h[i]-Y,0>R)k=i+1;else{if(!(R>0)){B=i;break}B=i-1}if(i=B,h[i]==Y){var z=i/(a-1);return z}var f=h[i],Q=h[i+1],T=Q-f,u=(Y-f)/T,z=(i+u)/(a-1);return z},Ln.getTangent=function(Z){var c=1e-4,I=Z-c,e=Z+c;0>I&&(I=0),e>1&&(e=1);var L=this.getPoint(I),B=this.getPoint(e),E=B.clone().sub(L);return E.normalize()},Ln.getTangentAt=function(t){var v=this.getUtoTmapping(t);return this.getTangent(v)},qe.create=function(N,q){return N.prototype=El(qe.prototype),N.prototype.getPoint=q,N};var zl=function(){this.curves=[],this.autoClose=!1},Up=zl.prototype=El(Ln);Up.add=function(O){this.curves.push(O)},Up.closePath=function(){var O=this.curves[0].getPoint(0),V=this.curves[this.curves.length-1].getPoint(1);O.equals(V)||this.curves.push(new mi(V,O))},Up.getPoint=function(L){for(var f,q,g=L*this.getLength(),E=this.getCurveLengths(),e=0;e<E.length;){if(E[e]>=g){f=E[e]-g,q=this.curves[e];var S=1-f/q.getLength();return q.getPointAt(S)}e++}return null},Up.getLength=function(){var M=this.getCurveLengths();return M[M.length-1]},Up.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var E,Q=[],c=0,P=this.curves.length;for(E=0;P>E;E++)c+=this.curves[E].getLength(),Q.push(c);return this.cacheLengths=Q,Q},Up.getTransformedPoints=function(E){return this.getPoints(E)},Up.getBoundingBox=function(){var C,v,i,u,Y,J,r=this.getPoints();C=v=Number.NEGATIVE_INFINITY,u=Y=Number.POSITIVE_INFINITY;var m,j,_,E,p=r[0]instanceof hr;for(E=p?new hr:new tk,j=0,_=r.length;_>j;j++)m=r[j],m.x>C&&(C=m.x),m.x<u&&(u=m.x),m.y>v&&(v=m.y),m.y<Y&&(Y=m.y),p&&(m.z>i&&(i=m.z),m.z<J&&(J=m.z)),E.add(m);var K={minX:u,minY:Y,maxX:C,maxY:v};return p&&(K.maxZ=i,K.minZ=J),K};var Jf=function(q){zl.call(this),this.actions=[],q&&this.fromPoints(q)},cp=Jf.prototype=El(zl.prototype),ij="moveTo",$d="lineTo",vi="quadraticCurveTo",Dd="bezierCurveTo",Gh="arc",Ek="ellipse";cp.fromPoints=function(k){this.moveTo(k[0].x,k[0].y);for(var I=1,D=k.length;D>I;I++)this.lineTo(k[I].x,k[I].y)},cp.moveTo=function(){var N=Array.prototype.slice.call(arguments);this.actions.push({action:ij,args:N})},cp.lineTo=function(V,I){var o=Array.prototype.slice.call(arguments),q=this.actions[this.actions.length-1].args,k=q[q.length-2],A=q[q.length-1],Z=new mi(new tk(k,A),new tk(V,I));this.curves.push(Z),this.actions.push({action:$d,args:o})},cp.quadraticCurveTo=function(j,$,h,W){var H=Array.prototype.slice.call(arguments),D=this.actions[this.actions.length-1].args,u=D[D.length-2],x=D[D.length-1],Z=new yr(new tk(u,x),new tk(j,$),new tk(h,W));this.curves.push(Z),this.actions.push({action:vi,args:H})},cp.bezierCurveTo=function($,d,W,D,l,K){var x=Array.prototype.slice.call(arguments),U=this.actions[this.actions.length-1].args,Z=U[U.length-2],i=U[U.length-1],Y=new Qn(new tk(Z,i),new tk($,d),new tk(W,D),new tk(l,K));this.curves.push(Y),this.actions.push({action:Dd,args:x})},cp.arc=function(Z,B,b,H,P,s){var X=this.actions[this.actions.length-1].args,i=X[X.length-2],A=X[X.length-1];this.absarc(Z+i,B+A,b,H,P,s)},cp.absarc=function(i,S,v,h,n,c){this.absellipse(i,S,v,v,h,n,c)},cp.ellipse=function(r,O,x,f,e,d,q){var L=this.actions[this.actions.length-1].args,Y=L[L.length-2],R=L[L.length-1];this.absellipse(r+Y,O+R,x,f,e,d,q)},cp.absellipse=function(u,$,h,O,X,T,s){var L=Array.prototype.slice.call(arguments),R=new ej(u,$,h,O,X,T,s);this.curves.push(R);var b=R.getPoint(1);L.push(b.x),L.push(b.y),this.actions.push({action:Ek,args:L})},cp.getSpacedPoints=function(C){C||(C=40);for(var Y=[],t=0;C>t;t++)Y.push(this.getPoint(t/C));return Y},cp.getPoints=function(b,u){b=b||12;var w,T,I,F,z,X,P,C,$,A,l,Q,S,y,q,D,f,B,K=[];for(w=0,T=this.actions.length;T>w;w++)switch(I=this.actions[w],F=I.action,z=I.args,F){case ij:K.push(new tk(z[0],z[1]));break;case $d:K.push(new tk(z[0],z[1]));break;case vi:for(X=z[2],P=z[3],A=z[0],l=z[1],K.length>0?(y=K[K.length-1],Q=y.x,S=y.y):(y=this.actions[w-1].args,Q=y[y.length-2],S=y[y.length-1]),q=1;b>=q;q++)D=q/b,f=Jc.b2(D,Q,A,X),B=Jc.b2(D,S,l,P),K.push(new tk(f,B));break;case Dd:for(X=z[4],P=z[5],A=z[0],l=z[1],C=z[2],$=z[3],K.length>0?(y=K[K.length-1],Q=y.x,S=y.y):(y=this.actions[w-1].args,Q=y[y.length-2],S=y[y.length-1]),q=1;b>=q;q++)D=q/b,f=Jc.b3(D,Q,A,C,X),B=Jc.b3(D,S,l,$,P),K.push(new tk(f,B));break;case Gh:var m,o=z[0],v=z[1],n=z[2],k=z[3],i=z[4],s=!!z[5],e=i-k,E=2*b;for(q=1;E>=q;q++)D=q/E,s||(D=1-D),m=k+D*e,f=o+n*H(m),B=v+n*R(m),K.push(new tk(f,B));break;case Ek:var m,o=z[0],v=z[1],d=z[2],r=z[3],k=z[4],i=z[5],s=!!z[6],e=i-k,E=2*b;for(q=1;E>=q;q++)D=q/E,s||(D=1-D),m=k+D*e,f=o+d*H(m),B=v+r*R(m),K.push(new tk(f,B))}var Y=K[K.length-1],p=1e-10;return c(Y.x-K[0].x)<p&&c(Y.y-K[0].y)<p&&K.splice(K.length-1,1),u&&K.push(K[0]),K},cp.toShapes=function(X,Q){function d(d){var T,s,k,r,P,Y=[],a=new Jf;for(T=0,s=d.length;s>T;T++)k=d[T],P=k.args,r=k.action,r==ij&&0!=a.actions.length&&(Y.push(a),a=new Jf),a[r].apply(a,P);return 0!=a.actions.length&&Y.push(a),Y}function A(X){for(var T=[],o=0,M=X.length;M>o;o++){var w=X[o],e=new qs;e.actions=w.actions,e.curves=w.curves,T.push(e)}return T}function l(N,K){for(var a=1e-10,U=K.length,f=!1,Z=U-1,$=0;U>$;Z=$++){var X=K[Z],I=K[$],v=I.x-X.x,o=I.y-X.y;if(c(o)>a){if(0>o&&(X=K[$],v=-v,I=K[Z],o=-o),N.y<X.y||N.y>I.y)continue;if(N.y==X.y){if(N.x==X.x)return!0}else{var q=o*(N.x-X.x)-v*(N.y-X.y);if(0==q)return!0;if(0>q)continue;f=!f}}else{if(N.y!=X.y)continue;if(I.x<=N.x&&N.x<=X.x||X.x<=N.x&&N.x<=I.x)return!0}}return f}var O=d(this.actions);if(0==O.length)return[];if(Q===!0)return A(O);var D,P,V,E=[];if(1==O.length)return P=O[0],V=new qs,V.actions=P.actions,V.curves=P.curves,E.push(V),E;var Z=!Jc.isClockWise(O[0].getPoints());Z=X?!Z:Z;var v,R=[],W=[],o=[],C=0;W[C]=s,o[C]=[];var r,H;for(r=0,H=O.length;H>r;r++)P=O[r],v=P.getPoints(),D=Jc.isClockWise(v),D=X?!D:D,D?(!Z&&W[C]&&C++,W[C]={s:new qs,p:v},W[C].s.actions=P.actions,W[C].s.curves=P.curves,Z&&C++,o[C]=[]):o[C].push({h:P,p:v[0]});if(!W[0])return A(O);if(W.length>1){for(var b=!1,x=[],K=0,e=W.length;e>K;K++)R[K]=[];for(var K=0,e=W.length;e>K;K++){W[K];for(var z=o[K],Y=0;Y<z.length;Y++){for(var M=z[Y],J=!0,t=0;t<W.length;t++)l(M.p,W[t].p)&&(K!=t&&x.push({froms:K,tos:t,hole:Y}),J?(J=!1,R[t].push(M)):b=!0);J&&R[K].push(M)}}x.length>0&&(b||(o=R))}var y,q,j;for(r=0,H=W.length;H>r;r++)for(V=W[r].s,E.push(V),y=o[r],q=0,j=y.length;j>q;q++)V.holes.push(y[q].h);return E};var qs=function(){Jf.apply(this,arguments),this.holes=[]},sk=qs.prototype=El(cp);sk.getPointsHoles=function(C){var p,o=this.holes.length,P=[];for(p=0;o>p;p++)P[p]=this.holes[p].getTransformedPoints(C);return P},sk.extractAllPoints=function(n){return{shape:this.getTransformedPoints(n),holes:this.getPointsHoles(n)}},sk.extractPoints=function(x){return this.extractAllPoints(x)};var Jc={triangulateShape:function(O,P){function M(e,D,a){return e.x!=D.x?e.x<D.x?e.x<=a.x&&a.x<=D.x:D.x<=a.x&&a.x<=e.x:e.y<D.y?e.y<=a.y&&a.y<=D.y:D.y<=a.y&&a.y<=e.y}function A($,e,n,G,K){var v=1e-10,i=e.x-$.x,A=e.y-$.y,h=G.x-n.x,U=G.y-n.y,s=$.x-n.x,a=$.y-n.y,P=A*h-i*U,y=A*s-i*a;if(c(P)>v){var t;if(P>0){if(0>y||y>P)return[];if(t=U*s-h*a,0>t||t>P)return[]}else{if(y>0||P>y)return[];if(t=U*s-h*a,t>0||P>t)return[]}if(0==t)return!K||0!=y&&y!=P?[$]:[];if(t==P)return!K||0!=y&&y!=P?[e]:[];if(0==y)return[n];if(y==P)return[G];var N=t/P;return[{x:$.x+N*i,y:$.y+N*A}]}if(0!=y||U*s!=h*a)return[];var r=0==i&&0==A,w=0==h&&0==U;if(r&&w)return $.x!=n.x||$.y!=n.y?[]:[$];if(r)return M(n,G,$)?[$]:[];if(w)return M($,e,n)?[n]:[];var l,V,L,x,E,H,_,X;return 0!=i?($.x<e.x?(l=$,L=$.x,V=e,x=e.x):(l=e,L=e.x,V=$,x=$.x),n.x<G.x?(E=n,_=n.x,H=G,X=G.x):(E=G,_=G.x,H=n,X=n.x)):($.y<e.y?(l=$,L=$.y,V=e,x=e.y):(l=e,L=e.y,V=$,x=$.y),n.y<G.y?(E=n,_=n.y,H=G,X=G.y):(E=G,_=G.y,H=n,X=n.y)),_>=L?_>x?[]:x==_?K?[]:[E]:X>=x?[E,V]:[E,H]:L>X?[]:L==X?K?[]:[l]:X>=x?[l,V]:[l,H]}function m(V,s,$,F){var R=1e-10,S=s.x-V.x,I=s.y-V.y,m=$.x-V.x,X=$.y-V.y,o=F.x-V.x,x=F.y-V.y,K=S*X-I*m,A=S*x-I*o;if(c(K)>R){var g=o*X-x*m;return K>0?A>=0&&g>=0:A>=0||g>=0}return A>0}function p(y,C){function E(r,E){var V=$.length-1,e=r-1;0>e&&(e=V);var s=r+1;s>V&&(s=0);var c=m($[r],$[e],$[s],L[E]);if(!c)return!1;var u=L.length-1,T=E-1;0>T&&(T=u);var R=E+1;return R>u&&(R=0),c=m(L[E],L[T],L[R],$[r]),c?!0:!1}function N(o,U){var h,d,x;for(h=0;h<$.length;h++)if(d=h+1,d%=$.length,x=A(o,U,$[h],$[d],!0),x.length>0)return!0;return!1}function Y(S,H){var Y,J,m,l,y;for(Y=0;Y<P.length;Y++)for(J=C[P[Y]],m=0;m<J.length;m++)if(l=m+1,l%=J.length,y=A(S,H,J[m],J[l],!0),y.length>0)return!0;return!1}for(var L,Z,U,p,h,w,v,z,r,T,l,$=y.concat(),P=[],x=[],H=0,n=C.length;n>H;H++)P.push(H);for(var G=0,q=2*P.length;P.length>0&&(q--,!(0>q));)for(U=G;U<$.length;U++){p=$[U],Z=-1;for(var H=0;H<P.length;H++)if(w=P[H],v=p.x+":"+p.y+":"+w,x[v]===s){L=C[w];for(var M=0;M<L.length;M++)if(h=L[M],E(U,M)&&!N(p,h)&&!Y(p,h)){Z=M,P.splice(H,1),z=$.slice(0,U+1),r=$.slice(U),T=L.slice(Z),l=L.slice(0,Z+1),$=z.concat(T).concat(l).concat(r),G=U;break}if(Z>=0)break;x[v]=!0}if(Z>=0)break}return $}for(var e,K,w,H,o,Q,U={},g=O.concat(),E=0,T=P.length;T>E;E++)Array.prototype.push.apply(g,P[E]);for(e=0,K=g.length;K>e;e++)o=g[e].x+":"+g[e].y,U[o]!==s,U[o]=e;var v=p(O,P),q=ud.Triangulate(v,!1);for(e=0,K=q.length;K>e;e++)for(H=q[e],w=0;3>w;w++)o=H[w].x+":"+H[w].y,Q=U[o],Q!==s&&(H[w]=Q);return q.concat()},isClockWise:function($){return ud.Triangulate.area($)<0},b2p0:function(V,R){var e=1-V;return e*e*R},b2p1:function(C,S){return 2*(1-C)*C*S},b2p2:function(h,V){return h*h*V},b2:function(i,G,C,Z){return this.b2p0(i,G)+this.b2p1(i,C)+this.b2p2(i,Z)},b3p0:function(j,D){var B=1-j;return B*B*B*D},b3p1:function(G,f){var Y=1-G;return 3*Y*Y*G*f},b3p2:function(Y,t){var C=1-Y;return 3*C*Y*Y*t},b3p3:function(C,U){return C*C*C*U},b3:function(R,p,M,y,B){return this.b3p0(R,p)+this.b3p1(R,M)+this.b3p2(R,y)+this.b3p3(R,B)}},ud={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var O=W.keys(this.faces);return O.length?O[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(I){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(a){var y=a.familyName.toLowerCase(),T=this;return T.faces[y]=T.faces[y]||{},T.faces[y][a.cssFontWeight]=T.faces[y][a.cssFontWeight]||{},T.faces[y][a.cssFontWeight][a.cssFontStyle]=a,a},drawText:function(z){var J,n=this.getFace(),c=this.size/n.resolution,I=0,D=String(z).split(""),M=D.length,S=[];for(J=0;M>J;J++){var w=new Jf,V=this.extractGlyphPoints(D[J],n,c,I,w);V&&(I+=V.offset*this.spacing,S.push(V.path))}var Q=I/2;return{paths:S,offset:Q}},extractGlyphPoints:function(o,Q,r,v,t){var A,H,N,E,h,q,S,M,O,d,k,C,w,e,$,l,y,b,U,p=[],W=Q.glyphs[o]||Q.glyphs["?"];if(W){if(W.o)for(E=W._cachedOutline||(W._cachedOutline=W.o.split(" ")),q=E.length,S=r,M=r,A=0;q>A;)switch(h=E[A++]){case"m":O=E[A++]*S+v,d=E[A++]*M,t.moveTo(O,d);break;case"l":O=E[A++]*S+v,d=E[A++]*M,t.lineTo(O,d);break;case"q":if(k=E[A++]*S+v,C=E[A++]*M,$=E[A++]*S+v,l=E[A++]*M,t.quadraticCurveTo($,l,k,C),U=p[p.length-1])for(w=U.x,e=U.y,H=1,N=this.divisions;N>=H;H++){var Z=H/N;Jc.b2(Z,w,$,k),Jc.b2(Z,e,l,C)}break;case"b":if(k=E[A++]*S+v,C=E[A++]*M,$=E[A++]*S+v,l=E[A++]*M,y=E[A++]*S+v,b=E[A++]*M,t.bezierCurveTo($,l,y,b,k,C),U=p[p.length-1])for(w=U.x,e=U.y,H=1,N=this.divisions;N>=H;H++){var Z=H/N;Jc.b3(Z,w,$,y,k),Jc.b3(Z,e,l,b,C)}}return{offset:W.ha*r,path:t}}}};ud.generateShapes=function(z,q){q=q||{};var A=q.font;if(A===s&&(A=ud.getDefaultFont(),!A))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var v=q.size!==s?q.size:1,p=q.curveSegments!==s?q.curveSegments:4,M=q.spacing!==s?q.spacing:1,m=q.weight!==s?q.weight:"normal",L=q.style!==s?q.style:"normal";ud.size=v,ud.divisions=p,ud.face=A,ud.weight=m,ud.style=L,ud.spacing=M;for(var N=ud.drawText(z),Y=N.paths,B=[],a=0,i=Y.length;i>a;a++)Array.prototype.push.apply(B,Y[a].toShapes());return B},function(x){var p=1e-10,v=function(N,t){var J=N.length;if(3>J)return null;var L,b,f,i=[],H=[],W=[];if(y(N)>0)for(b=0;J>b;b++)H[b]=b;else for(b=0;J>b;b++)H[b]=J-1-b;var O=J,s=2*O;for(b=O-1;O>2;){if(s--<=0)return t?W:i;if(L=b,L>=O&&(L=0),b=L+1,b>=O&&(b=0),f=b+1,f>=O&&(f=0),A(N,L,b,f,O,H)){var Y,R,e,x,F;for(Y=H[L],R=H[b],e=H[f],i.push([N[Y],N[R],N[e]]),W.push([H[L],H[b],H[f]]),x=b,F=b+1;O>F;x++,F++)H[x]=H[F];O--,s=2*O}}return t?W:i},y=function(o){for(var F=o.length,X=0,x=F-1,P=0;F>P;x=P++)X+=o[x].x*o[P].y-o[P].x*o[x].y;return.5*X},A=function(e,g,s,f,z,u){var R,P,N,D,F,W,c,U,a;if(P=e[u[g]].x,N=e[u[g]].y,D=e[u[s]].x,F=e[u[s]].y,W=e[u[f]].x,c=e[u[f]].y,p>(D-P)*(c-N)-(F-N)*(W-P))return!1;var V,v,J,Q,S,C,n,O,w,h,K,x,m,t,H;for(V=W-D,v=c-F,J=P-W,Q=N-c,S=D-P,C=F-N,R=0;z>R;R++)if(U=e[u[R]].x,a=e[u[R]].y,!(U===P&&a===N||U===D&&a===F||U===W&&a===c)&&(n=U-P,O=a-N,w=U-D,h=a-F,K=U-W,x=a-c,H=V*h-v*w,m=S*O-C*n,t=J*x-Q*K,H>=-p&&t>=-p&&m>=-p))return!1;return!0};return x.Triangulate=v,x.Triangulate.area=y,x}(ud),V._typeface_js={faces:ud.faces,loadFace:ud.loadFace};var Ub=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},tf=Ub.prototype={constructor:Ub,computeFaceNormals:function(){for(var M=new hr,U=new hr,c=0,o=this.faces.length;o>c;c++){var v=this.faces[c],x=this.vertices[v.a],w=this.vertices[v.b],I=this.vertices[v.c];M.subVectors(I,w),U.subVectors(x,w),M.cross(U),M.normalize(),v.normal.copy(M)}},computeVertexNormals:function(s){var Y,X,k,K,M,p;for(p=new Array(this.vertices.length),Y=0,X=this.vertices.length;X>Y;Y++)p[Y]=new hr;if(s){var i,w,q,t=new hr,v=new hr;for(k=0,K=this.faces.length;K>k;k++)M=this.faces[k],i=this.vertices[M.a],w=this.vertices[M.b],q=this.vertices[M.c],t.subVectors(q,w),v.subVectors(i,w),t.cross(v),p[M.a].add(t),p[M.b].add(t),p[M.c].add(t)}else for(k=0,K=this.faces.length;K>k;k++)M=this.faces[k],p[M.a].add(M.normal),p[M.b].add(M.normal),p[M.c].add(M.normal);for(Y=0,X=this.vertices.length;X>Y;Y++)p[Y].normalize();for(k=0,K=this.faces.length;K>k;k++)M=this.faces[k],M.vertexNormals[0]=p[M.a].clone(),M.vertexNormals[1]=p[M.b].clone(),M.vertexNormals[2]=p[M.c].clone()},mergeVertices:function(){var m,X,g,E,v,W,d,U,o={},r=[],k=[],j=4,N=Z(10,j);for(g=0,E=this.vertices.length;E>g;g++)m=this.vertices[g],X=O(m.x*N)+"_"+O(m.y*N)+"_"+O(m.z*N),o[X]===s?(o[X]=g,r.push(this.vertices[g]),k[g]=r.length-1):k[g]=k[o[X]];var y=[];for(g=0,E=this.faces.length;E>g;g++){v=this.faces[g],v.a=k[v.a],v.b=k[v.b],v.c=k[v.c],W=[v.a,v.b,v.c];for(var C=0;3>C;C++)if(W[C]==W[(C+1)%3]){y.push(g);break}}for(g=y.length-1;g>=0;g--){var P=y[g];for(this.faces.splice(P,1),d=0,U=this.faceVertexUvs.length;U>d;d++)this.faceVertexUvs[d].splice(P,1)}var c=this.vertices.length-r.length;return this.vertices=r,c}},ej=function(M,e,I,F,D,B,l){this.aX=M,this.aY=e,this.xRadius=I,this.yRadius=F,this.aStartAngle=D,this.aEndAngle=B,this.aClockwise=l};ej.prototype=El(Ln),ej.prototype.getPoint=function(r){var _,i=this.aEndAngle-this.aStartAngle;0>i&&(i+=m),i>m&&(i-=m),_=this.aClockwise===!0?this.aEndAngle+(1-r)*(m-i):this.aStartAngle+r*i;var W=this.aX+this.xRadius*H(_),d=this.aY+this.yRadius*R(_);return new tk(W,d)};var mi=function(t,h){this.v1=t,this.v2=h},Cm=mi.prototype=El(Ln);Cm.getPoint=function(z){var Q=this.v2.clone().sub(this.v1);return Q.multiplyScalar(z).add(this.v1),Q},Cm.getPointAt=function(D){return this.getPoint(D)},Cm.getTangent=function(){var m=this.v2.clone().sub(this.v1);return m.normalize()};var yr=function(E,d,I){this.v0=E,this.v1=d,this.v2=I};yr.prototype=El(Ln),yr.prototype.getPoint=function(k){var b,p;return b=Jc.b2(k,this.v0.x,this.v1.x,this.v2.x),p=Jc.b2(k,this.v0.y,this.v1.y,this.v2.y),new tk(b,p)};var Qn=function(i,R,E,z){this.v0=i,this.v1=R,this.v2=E,this.v3=z};Qn.prototype=El(Ln),Qn.prototype.getPoint=function(I){var l,x;return l=Jc.b3(I,this.v0.x,this.v1.x,this.v2.x,this.v3.x),x=Jc.b3(I,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new tk(l,x)},qe.create(function(Z,z){this.v1=Z,this.v2=z},function(l){var h=new hr;return h.subVectors(this.v2,this.v1),h.multiplyScalar(l),h.add(this.v1),h});var fj=qe.create(function(u,V,e){this.v0=u,this.v1=V,this.v2=e},function(R){var P,z,m;return P=Jc.b2(R,this.v0.x,this.v1.x,this.v2.x),z=Jc.b2(R,this.v0.y,this.v1.y,this.v2.y),m=Jc.b2(R,this.v0.z,this.v1.z,this.v2.z),new hr(P,z,m)}),ff=qe.create(function(P,X,M,Y){this.v0=P,this.v1=X,this.v2=M,this.v3=Y},function(x){var I,o,w;return I=Jc.b3(x,this.v0.x,this.v1.x,this.v2.x,this.v3.x),o=Jc.b3(x,this.v0.y,this.v1.y,this.v2.y,this.v3.y),w=Jc.b3(x,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new hr(I,o,w)}),Pg=function(W,y,w,L,U,V,r,I){Ub.call(this),L=L!==s?L:.5,U=U!==s?U:.5,I=I!==s?I:1,W=W||8,V=V||0,r=r||m;var l,A,N=1,M=I/2,T=[],g=[],E=this.vertices,i=this.faces,G=this.faceVertexUvs;for(A=0;N>=A;A++){var Q=[],Z=[],K=A/N,_=K*(U-L)+L;for(l=0;W>=l;l++){var c=l/W,p=new hr,o=-(c*r+V);p.z=_*R(o),p.y=-K*I+M,p.x=_*H(o),E.push(p),Q.push(E.length-1),Z.push(new tk(c,K))}T.push(Q),g.push(Z)}var X,$,t=(U-L)/I;for(l=0;W>l;l++)for(0!==L?(X=E[T[0][l]].clone(),$=E[T[0][l+1]].clone()):(X=E[T[1][l]].clone(),$=E[T[1][l+1]].clone()),X.setY(F(X.x*X.x+X.z*X.z)*t).normalize(),$.setY(F($.x*$.x+$.z*$.z)*t).normalize(),A=0;N>A;A++){var Y=T[A][l],x=T[A+1][l],f=T[A+1][l+1],P=T[A][l+1],a=X.clone(),J=X.clone(),C=$.clone(),B=$.clone(),d=g[A][l].clone(),k=g[A+1][l].clone(),n=g[A+1][l+1].clone(),h=g[A][l+1].clone();i.push(new mj(Y,x,P,[a,J,B])),G[0].push([d,k,h]),i.push(new mj(x,f,P,[J.clone(),C,B.clone()])),G[0].push([k.clone(),n,h.clone()])}if(y&&L>0)for(this.vertices.push(new hr(0,M,0)),l=0;W>l;l++){var Y=T[0][l],x=T[0][l+1],f=this.vertices.length-1,a=new hr(0,1,0),J=new hr(0,1,0),C=new hr(0,1,0),d=g[0][l].clone(),k=g[0][l+1].clone(),n=new tk(k.x,0);i.push(new mj(Y,x,f,[a,J,C],null,1));var j=l/W*m,q=H(j),S=R(j),z=(l+1)/W*m,e=H(z),b=R(z);G[0].push([new tk(.5+.5*q,.5+.5*S),new tk(.5+.5*e,.5+.5*b),new tk(.5,.5)])}if(w&&U>0)for(this.vertices.push(new hr(0,-M,0)),l=0;W>l;l++){var Y=T[A][l+1],x=T[A][l],f=E.length-1,a=new hr(0,-1,0),J=new hr(0,-1,0),C=new hr(0,-1,0),d=g[A][l+1].clone(),k=g[A][l].clone();i.push(new mj(Y,x,f,[a,J,C],null,2));var j=l/W*m,q=H(j),S=R(j),z=(l+1)/W*m,e=H(z),b=R(z);G[0].push([new tk(.5+.5*e,.5-.5*b),new tk(.5+.5*q,.5-.5*S),new tk(.5,.5)])}};Pg.prototype=El(tf);var zc=function(Z,N,d,q,E,S,O){Ub.call(this),O=O||.5,Z=Z||16,N=N||16,d=(d!==s?d:0)-f,q=q!==s?q:m,E=E!==s?E:0,S=S!==s?S:f;var G,W,l=[],T=[],F=this.vertices,V=this.faces,u=this.faceVertexUvs;for(W=0;N>=W;W++){var K=[],h=[];for(G=0;Z>=G;G++){var A=G/Z,L=W/N,U=new hr;U.x=-O*H(d+A*q)*R(E+L*S),U.y=O*H(E+L*S),U.z=O*R(d+A*q)*R(E+L*S),F.push(U),K.push(F.length-1),h.push(new tk(A,L))}l.push(K),T.push(h)}for(W=0;N>W;W++)for(G=0;Z>G;G++){var C=l[W][G+1],g=l[W][G],n=l[W+1][G],M=l[W+1][G+1],j=F[C].clone().normalize(),$=F[g].clone().normalize(),b=F[n].clone().normalize(),Q=F[M].clone().normalize(),I=T[W][G+1].clone(),k=T[W][G].clone(),w=T[W+1][G].clone(),v=T[W+1][G+1].clone();c(F[C].y)===O?(I.x=(I.x+k.x)/2,V.push(new mj(C,n,M,[j,b,Q])),u[0].push([I,w,v])):c(F[n].y)===O?(w.x=(w.x+v.x)/2,V.push(new mj(C,g,n,[j,$,b])),u[0].push([I,k,w])):(V.push(new mj(C,g,M,[j,$,Q])),u[0].push([I,k,v]),V.push(new mj(g,n,M,[$.clone(),b,Q.clone()])),u[0].push([k.clone(),w,v.clone()]))}};zc.prototype=El(tf);var up=function(F,E,P,n,I,b){Ub.call(this),F=F||.33,E=E||.17,n=n||8,P=P||6,I=I||0,b=b||m;for(var a=new hr,q=[],B=[],S=0;n>=S;S++)for(var J=S/n*m+f,V=0;P>=V;V++){var h=V/P*b+I;a.x=F*H(h),a.z=-F*R(h);var X=new hr,C=F+E*H(J);X.x=C*H(h),X.z=-C*R(h),X.y=E*R(J),this.vertices.push(X),q.push(new tk(V/P,1-S/n)),B.push(X.clone().sub(a).normalize())}for(var S=1;n>=S;S++)for(var V=1;P>=V;V++){var O=(P+1)*S+V-1,K=(P+1)*(S-1)+V-1,c=(P+1)*(S-1)+V,Y=(P+1)*S+V,G=new mj(O,K,Y,[B[O].clone(),B[K].clone(),B[Y].clone()]);this.faces.push(G),this.faceVertexUvs[0].push([q[O].clone(),q[K].clone(),q[Y].clone()]),G=new mj(K,c,Y,[B[K].clone(),B[c].clone(),B[Y].clone()]),this.faces.push(G),this.faceVertexUvs[0].push([q[K].clone(),q[c].clone(),q[Y].clone()])}this.computeFaceNormals()};up.prototype=El(tf);var kq=function(Z,U,m){return Z?(Ub.call(this),Z=Z instanceof Array?Z:[Z],this.addShapeList(Z,U),U.convertYZ!==!1&&mr(this,m),this.computeFaceNormals(),void 0):(Z=[],void 0)},we=kq.prototype=El(Ub.prototype);we.addShapeList=function(A,I){for(var B=A.length,V=0;B>V;V++){var W=A[V];this.addShape(W,I)}},we.addShape=function(C,e){function M(){if(e.bottom)for(var m=0;z>m;m++)g=x[m],U(g[2],g[1],g[0],!0);if(e.top)for(m=0;z>m;m++)g=x[m],U(g[0]+J*O,g[1]+J*O,g[2]+J*O,!1)}function I(){var n=0;for(E(S,n),n+=S.length,a=0,K=V.length;K>a;a++)l=V[a],E(l,n),n+=l.length}function E(R,h){for(var g,e,Z=R.length;--Z>=0;){g=Z,e=Z-1,0>e&&(e=R.length-1);var f=0,W=O;for(f=0;W>f;f++){var m=J*f,Y=J*(f+1),B=h+g+m,s=h+e+m,U=h+e+Y,k=h+g+Y;N(B,s,U,k,R,f,W,g,e)}}}function Q(y,d,F){c.vertices.push(new hr(y,d,F))}function U(a,y,Y,d){a+=t,y+=t,Y+=t,c.faces.push(new mj(a,y,Y,null,null,d?2:1));var O=d?o.generateBottomUV(c,C,e,a,y,Y):o.generateTopUV(c,C,e,a,y,Y);c.faceVertexUvs[0].push(O)}function N(Y,q,I,u,n,L,B,w,T){Y+=t,q+=t,I+=t,u+=t,c.faces.push(new mj(Y,q,u)),c.faces.push(new mj(q,I,u));var r=o.generateSideWallUV(c,C,n,e,Y,q,I,u,L,B,w,T);c.faceVertexUvs[0].push([r[0],r[1],r[3]]),c.faceVertexUvs[0].push([r[1],r[2],r[3]])}var G,q,w,y,L,Z=e.amount,i=e.curveSegments||Em,O=e.steps||1,h=e.extrudePath,j=!1,o=new rc(e.repeatUVLength);h&&(G=h.getSpacedPoints(O),j=!0,q=e.frames!==s?e.frames:new mq.FrenetFrames(h,O,!1),w=new hr,y=new hr,L=new hr);var l,a,K,c=this,t=this.vertices.length,$=C.extractPoints(i),X=$.shape,V=$.holes,D=!Jc.isClockWise(X);if(D){for(X=X.reverse(),a=0,K=V.length;K>a;a++)l=V[a],Jc.isClockWise(l)&&(V[a]=l.reverse());D=!1}var x=Jc.triangulateShape(X,V),S=X;for(a=0,K=V.length;K>a;a++)l=V[a],X=X.concat(l);for(var m,g,J=X.length,z=x.length,p=0;J>p;p++)m=X[p],j?(y.copy(q.normals[0]).multiplyScalar(m.x),w.copy(q.binormals[0]).multiplyScalar(m.y),L.copy(G[0]).add(y).add(w),Q(L.x,L.y,L.z)):Q(m.x,m.y,0);var F;for(F=1;O>=F;F++)for(p=0;J>p;p++)m=X[p],j?(y.copy(q.normals[F]).multiplyScalar(m.x),w.copy(q.binormals[F]).multiplyScalar(m.y),L.copy(G[F]).add(y).add(w),Q(L.x,L.y,L.z)):Q(m.x,m.y,Z/O*F);M(),I()};var mq=function(L,f,U,J,z){function x(d,M,_){return W.vertices.push(new hr(d,M,_))-1}Ub.call(this),f=f||64,U=U||1,J=J||8,z=z||!1;var e,O,V,g,w,q,r,G,M,Z,u,b,h,c,l,T,C,d,n,p,D=[],W=this,$=f+1,A=new hr,o=new mq.FrenetFrames(L,f,z),s=o.tangents,B=o.normals,v=o.binormals;for(this.tangents=s,this.normals=B,this.binormals=v,M=0;$>M;M++)for(D[M]=[],g=M/($-1),G=L.getPointAt(g),e=s[M],O=B[M],V=v[M],Z=0;J>Z;Z++)w=Z/J*m,q=-U*H(w),r=U*R(w),A.copy(G),A.x+=q*O.x+r*V.x,A.y+=q*O.y+r*V.y,A.z+=q*O.z+r*V.z,D[M][Z]=x(A.x,A.y,A.z);for(M=0;f>M;M++)for(Z=0;J>Z;Z++)u=z?(M+1)%f:M+1,b=(Z+1)%J,h=D[M][Z],c=D[u][Z],l=D[u][b],T=D[M][b],C=new tk(M/f,Z/J),d=new tk((M+1)/f,Z/J),n=new tk((M+1)/f,(Z+1)/J),p=new tk(M/f,(Z+1)/J),this.faces.push(new mj(h,c,T)),this.faceVertexUvs[0].push([C,d,p]),this.faces.push(new mj(c,l,T)),this.faceVertexUvs[0].push([d.clone(),n,p.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};mq.prototype=El(tf),mq.FrenetFrames=function(D,I,z){function Q(){w[0]=new hr,n[0]=new hr,Z=Number.MAX_VALUE,J=c(t[0].x),s=c(t[0].y),k=c(t[0].z),Z>=J&&(Z=J,y.set(1,0,0)),Z>=s&&(Z=s,y.set(0,1,0)),Z>=k&&y.set(0,0,1),h.crossVectors(t[0],y).normalize(),w[0].crossVectors(t[0],h),n[0].crossVectors(t[0],w[0])}var G,Z,J,s,k,v,F,y=new hr,t=[],w=[],n=[],h=new hr,a=new Zl,W=I+1,K=1e-4;for(this.tangents=t,this.normals=w,this.binormals=n,v=0;W>v;v++)F=v/(W-1),t[v]=D.getTangentAt(F),t[v].normalize();for(Q(),v=1;W>v;v++)w[v]=w[v-1].clone(),n[v]=n[v-1].clone(),h.crossVectors(t[v-1],t[v]),h.length()>K&&(h.normalize(),G=j(rj(t[v-1].dot(t[v]),-1,1)),w[v].applyMatrix4(a.makeRotationAxis(h,G))),n[v].crossVectors(t[v],w[v]);if(z)for(G=j(rj(w[0].dot(w[W-1]),-1,1)),G/=W-1,t[0].dot(h.crossVectors(w[0],w[W-1]))>0&&(G=-G),v=1;W>v;v++)w[v].applyMatrix4(a.makeRotationAxis(t[v],G*v)),n[v].crossVectors(t[v],w[v])};var _r=function(P,y,A,Y){Ub.call(this),y=y||18,A=A||0,Y=Y==N?m:Y;for(var Z=1/(P.length-1),W=1/y,z=0,F=y;F>=z;z++)for(var t=A+z*W*Y,B=H(t),K=R(t),e=0,E=P.length;E>e;e++){var v=P[e],U=new hr;U.x=B*v.x-K*v.y,U.y=K*v.x+B*v.y,U.z=v.z,this.vertices.push(U)}for(var q=P.length,z=0,F=y;F>z;z++)for(var e=0,E=P.length-1;E>e;e++){var s=e+q*z,c=s,D=s+q,B=s+1+q,g=s+1,h=z*W,G=e*Z,L=h+W,f=G+Z;this.faces.push(new mj(c,g,D)),this.faceVertexUvs[0].push([new tk(h,G),new tk(h,f),new tk(L,G)]),this.faces.push(new mj(D,g,B)),this.faceVertexUvs[0].push([new tk(L,G),new tk(h,f),new tk(L,f)])}this.mergeVertices(),mr(this),this.computeFaceNormals(),this.computeVertexNormals()};_r.prototype=El(tf);var Ok=function(P,h){h=h||{};var b=ud.generateShapes(P,h);h.amount=h.amount!==s?h.amount:.5,h.convertYZ=!1,h.fill!==!1&&(h.bottom=!0,h.top=!0),kq.call(this,b,h)};Ok.prototype=El(we);var Bj=z.Node=function(){oj(Bj,this)},rl={X:bp,Y:ib,Z:Sj},xh={X:0,Y:1,Z:2},gi={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},pm="xzy",fo=function(n,a,d){if(a){var U=a[0],Q=a[1],O=a[2];"xzy"===d?(ib(n,Q),Sj(n,O),bp(n,U)):"xyz"===d?(Sj(n,O),ib(n,Q),bp(n,U)):"yxz"===d?(Sj(n,O),bp(n,U),ib(n,Q)):"yzx"===d?(bp(n,U),Sj(n,O),ib(n,Q)):"zxy"===d?(ib(n,Q),bp(n,U),Sj(n,O)):"zyx"===d?(bp(n,U),ib(n,Q),Sj(n,O)):(ib(n,Q),Sj(n,O),bp(n,U))}};iq("Node",Jn,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:pm,_64O:0,_rotationX:0,_53O:0,_host:N,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Dj},_22Q:function(){return Gi},getX:function(){return this.p().x},setX:function(w){this.p(w,this.p().y)},getY:function(){return this.p().y},setY:function(p){this.p(this.p().x,p)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(E){this.setAnchor(E,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(j){this.setAnchor(this.getAnchor().x,j)},getScaleX:function(){return this.getScale().x},setScaleX:function(B){this.setScale(B,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(R){this.setScale(this.getScale().x,R)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(p,u){Ij(p,mf(N,N,this.r3(),this.getRotationMode())),this.translate3d(p[0]*u,p[1]*u,p[2]*u)},translateFront:function(O){this.translate3dBy([0,0,1],O)},translateBack:function(J){this.translate3dBy([0,0,-1],J)},translateLeft:function(J){this.translate3dBy([-1,0,0],J)},translateRight:function(i){this.translate3dBy([1,0,0],i)},translateTop:function(n){this.translate3dBy([0,1,0],n)},translateBottom:function(M){this.translate3dBy([0,-1,0],M)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(B,J,s){1===arguments.length&&(J=B[1],s=B[2],B=B[0]),this.p(B,s),this.setElevation(J)},translate3d:function(j,o,k){1===arguments.length&&(o=j[1],k=j[2],j=j[0]),this.translate(j,k),this.setElevation(this._54O+o)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(w,n,x){1===arguments.length&&(n=w[1],x=w[2],w=w[0]),this.setSize(w,x),this.setTall(n)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(R,p,b){1===arguments.length&&(p=R[1],b=R[2],R=R[0]),this.setRotationX(R),this.setRotation(-p),this.setRotationZ(b)},setRotationY:function(N){this.setRotation(-N)},getRotationY:function(){return-this._64O},lookAtDirection:function(R,I){I=I||fr;var Y=this,l=Df(R);I===fr?(Y.r3([-M(R[1]/l),-_(R[2],R[0])+G,0]),Y.setRotationMode("xzy")):I===hl?(Y.r3(0,-_(R[2],R[0]),M(R[1]/l)),Y.setRotationMode("zyx")):I===pc?(Y.r3(0,-_(R[2],R[0])+f,-M(R[1]/l)),Y.setRotationMode("zyx")):I===_m?(Y.r3([-M(R[1]/l)+G,-_(R[2],R[0])+G,0]),Y.setRotationMode("xzy")):I===Jr&&(Y.r3([-M(R[1]/l)-G,-_(R[2],R[0])+G,0]),Y.setRotationMode("xzy")),I===ms&&(Y.r3([-M(R[1]/l)+f,-_(R[2],R[0])+G,f]),Y.setRotationMode("zxy"))},lookAt:function(U,G){return this.lookAtDirection(xk(U,this.p3()),G)},lookAtX:function(){var D=new yj,j=new yj,p=new yj,M=new re,e=new re,g=new ds;return function(N,U){var i=ub(this);M.fromArray(i),p.copy(this.p3()),D.copy(N).sub(p).normalize(),U===fr?j.set(0,0,1):U===ms?j.set(0,0,-1):U===pc?j.set(-1,0,0):U===hl?j.set(1,0,0):U===_m?j.set(0,1,0):U===Jr&&j.set(0,-1,0),j.applyMatrix4(M).sub(p).normalize();var C=Math.acos(D.dot(j));if(C){var L=D.clone().cross(j).normalize();g.set(this.r3(),this.getRotationMode(),!0),M.makeRotationFromEuler(g),e.makeRotationAxis(L,-C),g.setFromRotationMatrix(e.multiply(M)),this.r3([g.x,g.y,g.z])}}}(),getHost:function(){return this._host},setHost:function(G){var D=this;if(D!==G&&D._host!==G){var g=D._host;g&&g._removeAttach(D),D._host=G,D._host&&D._host._addAttach(D),D.fp("host",g,G),D.onHostChanged(g,G)}},getAttaches:function(){return this._69O},_addAttach:function(Q){var v=this;v._69O||(v._69O=new cb),v._69O.add(Q),v.fp("attaches",N,Q)},_removeAttach:function(Y){var X=this;X._69O.remove(Y),X._69O.isEmpty()&&delete X._69O,X.fp("attaches",Y,N)},getImage:function(){if(this._pendingCheckImageJSON){var C=Q.getImage(this._image);
C&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Vq&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(d){var E=this,V=E._image,s=E.getWidth(),O=E.getHeight();E._image=d,E.fp("image",V,d)&&(null!=d&&(yp(d)||fh(d)&&/\.json$/i.test(d))&&(this._pendingCheckImageJSON=!0),E.fp(lf,s,E.getWidth()),E.fp(Gr,O,E.getHeight()))},getElevation:function(){return this._54O},setElevation:function(z){var L=this;if(!L._50O){L._50O=1;var X=L._54O;L._54O=z,L.fp(Se,X,z),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(E){var n=this;if(!n._49O){n._49O=1;var u=n._64O;n._64O=E,n.fp(Om,u,E),delete n._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(B){var M=this;if(!M._51O){M._51O=1;var S=M._rotationX;M._rotationX=B,M.fp("rotationX",S,B),delete M._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(Z){var P=this;if(!P._52O){P._52O=1;var b=P._53O;P._53O=Z,P.fp("rotationZ",b,Z),delete P._52O}},getPosition:function(){return this._position},setPosition:function(n,u){var p=this;if(!p._50I){p._50I=1;var T;if(T=2===arguments.length?{x:n,y:u}:n,T.x!==p._position.x||T.y!==p._position.y){var C=p._position;p._position=T,p.fp(Jh,C,T)}delete p._50I}},translate:function($,R){var B=this._position;this.p(B.x+$,B.y+R)},getWidth:function(){var k=this;if(k._width>=0)return k._width;var p=k.getStyle("shape3d");if(p){var R=sl(p);if(R&&R.rawS3)return R.rawS3[0];if("billboard"===p||"plane"===p){var e=_c(k.getStyle("shape3d.image"));return e?Uj(e,k):20}}var e=_c(k._image);return e?Uj(e,k):20},setWidth:function(j){var b=this,Y=b._width;b._width=j,b.fp(lf,Y,j)},getHeight:function(){var $=this;if($._height>=0)return $._height;var d=$.getStyle("shape3d");if(d){var P=sl(d);if(P&&P.rawS3)return P.rawS3[2];if("plane"===d){var j=_c($.getStyle("shape3d.image"));return j?dg(j,$):20}if("billboard"===d)return 2}var j=_c($._image);return j?dg(j,$):20},setHeight:function(T){var e=this,b=e._height;e._height=T,e.fp(Gr,b,T)},getTall:function(){var l=this;if(l._tall>=0)return l._tall;var d=l.getStyle("shape3d");if(d){var m=sl(d);if(m&&m.rawS3)return m.rawS3[1];if("billboard"===d){var s=_c(l.getStyle("shape3d.image"));return s?dg(s,l):20}if("plane"===d)return 2}return 20},setTall:function(s){var Y=this,q=Y._tall;Y._tall=s,Y.fp("tall",q,s)},setSize:function(L,g){var U=this;2===arguments.length?(U.setWidth(L),U.setHeight(g)):(U.setWidth(L.width),U.setHeight(L.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(W,m,x,X,b){var q=this,r=q.getAnchor(),s=q.getScale();arguments.length<=2&&(b=m,m=W.y,x=W.width,X=W.height,W=W.x);var E=b&&s.x<0?1-r.x:r.x,D=b&&s.y<0?1-r.y:r.y;q.p(W+x*E,m+X*D),b&&(x/=Math.abs(s.x),X/=Math.abs(s.y)),q.setWidth(x),q.setHeight(X)},getMatrix:function(){var g=this,r=g._64O,M=g._position,G=g.getScale();return new Vd(r,M.x,M.y,G.x,G.y)},getAnchorRect:function(){var i=this,R=i.getWidth(),V=i.getHeight(),y=i.getAnchor();return{x:-R*y.x,y:-V*y.y,width:R,height:V}},toLocal:function(B){return this.getMatrix().tfi(B)},toGlobal:function($){return this.getMatrix().tf($)},getAttachPosition:function(){var L=new Vd;return function(Q,B,f,i){f=f||0,i=i||0;var Y=this,X=Y.getAnchor(),K=Y._64O,R=Y._position,H=Y.getScale();return L.setFromTransform(K,R.x,R.y).tf({x:f+H.x*Y.getWidth()*(Q-X.x),y:i+H.y*Y.getHeight()*(B-X.y)})}}(),isInRect:function(G){G=this.toLocal(G);var Y=this.getWidth(),S=this.getHeight();return G.x+=Y*this.getAnchorX(),G.y+=S*this.getAnchorY(),!(G.x<0||G.y<0||G.x>Y||G.y>S)},getRect:function(){var x=this,d=x.getWidth(),F=x.getHeight(),O=x.getAnchor(),C={x:-d*O.x,y:-F*O.y,width:d,height:F},B=x.getMatrix();return C=Mp([B.tf(C.x,C.y),B.tf(C.x+C.width,C.y),B.tf(C.x+C.width,C.y+C.height),B.tf(C.x,C.y+C.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var D=this,r=D.getAnchor(),t=D._anchorElevation;return{x:r.x,y:t,z:r.y}},setAnchorElevation:function(g){var w=this,f=w._anchorElevation;return f!==g?(w._anchorElevation=g,w.fp("anchorElevation",f,g),!0):!1},setAnchor3d:function(W,D,X,O){var C,w=this;"number"==typeof W?C={x:W,y:D,z:X}:(C=W.length?{x:W[0],y:W[1],z:W[2]}:W,O=D);var h=w.getDataModel();h&&h.beginTransaction();var m=w.getAnchor3d(),j=w.setAnchor(C.x,C.z);if(w.setAnchorElevation(C.y)&&(j=!0),j&&O&&!$g){w.getAnchor3d();var f=ub(w),V=Ij([C.x-m.x,C.y-m.y,C.z-m.z],f);w.p3(V)}return h&&h.endTransaction(),j},getAnchor:function(){var b=this;if(b.hasOwnProperty("_anchor"))return b._anchor;var S=_c(b._image);return S&&S.anchorX!==s?{x:S.anchorX,y:S.anchorY}:b._anchor},setAnchor:function(d,l,r){var c,W=this;"number"==typeof d?c={x:d,y:l}:(c=d.length?{x:d[0],y:d[1]}:d,r=l);var v=W.getAnchor();if(v.x!==c.x||v.y!==c.y){var n=W.getDataModel();if(n&&n.beginTransaction(),W._anchor=c,W.fp("anchor",v,c),r&&!$g){var x=W.getPosition(),Z=W.getSize(),e=W.getRotation(),q=W.getScale(),U=-Z.width*(v.x-c.x)*q.x,Y=-Z.height*(v.y-c.y)*q.y,F=R(e),K=H(e);W.setPosition(x.x+K*U-F*Y,x.y+F*U+K*Y)}return n&&n.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(c,Z){var l,Q=this;l=2===arguments.length?{x:c,y:Z}:c;var a=Q.getScale();(a.x!==l.x||a.y!==l.y)&&(Q._scale=l,Q.fp("scale",a,l))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var v=this,m=v._scaleTall,H=v.getScale();return[H.x,m,H.y]},getFinalScale3d:function(){var V=this,B=V.s3(),b=V._dynamicScale3d,_=V.getScale3d();return B&&(_[0]*=B[0],_[1]*=B[1],_[2]*=B[2]),b&&(_[0]*=b[0],_[1]*=b[1],_[2]*=b[2]),_},getFinalRotation3d:function(){var q=this;return q._dynamicRotation||q.r3()},setScaleTall:function(J){var M=this,I=M._scaleTall;I!==J&&(M._scaleTall=J,M.fp("scaleTall",I,J))},setScale3d:function(y,H,U){var e,w=this;e="number"==typeof y?{x:y,y:H,z:U}:y.length?{x:y[0],y:y[1],z:y[2]}:y,w.setScaleTall(e.y),w.setScale(e.x,e.z)},getCorners:function(J,P){J==N&&(J=0),P==N&&(P=J);var p=this,e=p.getAnchor(),c=p.getWidth(),H=p.getHeight(),I=-c*e.x-J,v=-H*e.y-P,a=c+2*J,j=H+2*P,L=p.getMatrix();return[L.tf(I,v),L.tf(I,v+j),L.tf(I+a,v+j),L.tf(I+a,v)]},getEditControlPoints:function(O,I,P){I==N&&(I=0),P==N&&(P=I);var L=this,s=L.getAnchor(),r=L.getWidth(),J=L.getHeight(),t=-r*s.x-I,y=-J*s.y-P,k=r+2*I,x=J+2*P;if(O)return[{x:t,y:y},{x:t,y:0},{x:t,y:y+x},{x:0,y:y+x},{x:t+k,y:y+x},{x:t+k,y:0},{x:t+k,y:y},{x:0,y:y}];var j=L.getMatrix();return[j.tf(t,y),j.tf(t,0),j.tf(t,y+x),j.tf(0,y+x),j.tf(t+k,y+x),j.tf(t+k,0),j.tf(t+k,y),j.tf(0,y)]},rotateAt:function(N,P,d){var B=this,o=B._position,h=B._64O,x=new Vd(h,o.x,o.y).tf(N,P),S=F(N*N+P*P),b=_(o.y-x.y,o.x-x.x)+d;B.setRotation(h+d),B.p(x.x+S*H(b),x.y+S*R(b))},onParentChanged:function(){Bj.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var l={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(_){l[_]=!0}),function(c){var u=this;Bj.superClass.onPropertyChanged.call(u,c),l[c.property]&&!u._layoutUpdating&&u.updateLayoutParameters(null,c.property),u._69O&&u._69O.each(function(p){p.handleHostPropertyChange(c)}),u._49I&&u._49I.each(function(Z){Z.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(Y){this.updateAttach(Y)},onStyleChanged:function(Y){Bj.superClass.onStyleChanged.apply(this,arguments),zi[Y]&&this.updateAttach()},updateAttach:function(D){var f=this;return $g?(f.updateLayoutParameters(),void 0):(f._51I||(f._51I=1,f._71O(D),delete f._51I),void 0)},_71O:function(I){var s,n,x,P,Z,A,Q=this,w=Q._host,i=I?I.property:N,h=I?I.oldValue:N,d=I?I.newValue:N;if(w instanceof z.Grid){if(i===Se)Q.setElevation(Q._54O+d-h);else if(!I||xi[i]){if(s=Q.s("attach.row.index"),n=Q.s("attach.column.index"),x=w.getCellRect(s,n),!x)return;P=Q.s("attach.row.span"),Z=Q.s("attach.column.span"),(1!==P||1!==Z)&&(x=Db(x,w.getCellRect(s+P-1,n+Z-1))),ns(x,Q,"attach.padding",1),Q.setRect(x)}}else if(w instanceof Kj&&(A=Q.s("attach.index"))>=0&&(!I||xb[i])){var g=Q.s("attach.thickness");g!=N&&Q.setHeight(w.getThickness()*g);var R=Q.s("attach.offset"),W=w.getPoints(),e=W.size();if(e>A){var t=W.get(A),k=e===A+1?W.get(0):W.get(A+1),p=[k.x-t.x,k.y-t.y],y=Df(p);if(y){Q.s("attach.offset.relative")&&(R*=y),Q.s("attach.offset.opposite")&&(R=y-R);var L={x:t.x+p[0]/y*R,y:t.y+p[1]/y*R},X=Q.s("attach.gap");X&&(Q.s("attach.gap.relative")&&(X*=w.getThickness()),L=Aj(N,L,k,X)),Q.p(L),Q.setRotation(_(p[1],p[0]))}}}else I&&(i===Jh?Q.translate(d.x-h.x,d.y-h.y):i===Se?Q.setElevation(Q._54O+d-h):rr[i]?Q._11Q(w,i,d-h):("anchor"===i||"width"===i||"height"===i||"scale"===i)&&Q.layout(w))},_11Q:function(){var C=new z.Math.Euler,T=z.Math.Euler.ReverseOrder,t=new z.Math.Vector2,N=new z.Math.Vector2;return function(E,d,g){var Y=this,p=E.p3(),c=E.r3(),A=Y.p3(),w=Y.r3();if(d===Om&&(d="rotationY",g=-g),(d===Om||"rotationY"===d)&&0===w[0]&&0===w[2]&&0===c[0]&&0===c[2]&&0===A[1]&&0===p[1])return Y.setRotation(-w[1]-g),t.set(A[0],A[2]).rotateAround(N.set(p[0],p[2]),-g),Y.p(t.x,t.y),void 0;var J=gi[E.getRotationMode()],s=J[0],I=J[1],D=J[2],$=rl[s],L=rl[I],x=rl[D],U=vq();d===Om+s?(x(U,c[xh[D]]),L(U,c[xh[I]]),$(U,g),L(U,-c[xh[I]]),x(U,-c[xh[D]])):d===Om+I?(x(U,c[xh[D]]),L(U,g),x(U,-c[xh[D]])):d===Om+D&&x(U,g);var m=xk(A,p);Ij(m,U),Y.p3(p[0]+m[0],p[1]+m[1],p[2]+m[2]);var H=Y.getRotationMode();fo(U,Y.r3(),H),C.setFromRotationMatrix(U,T(H)),Y.r3([C.x,C.y,C.z])}}(),isHostOn:function(A){var y=this;if(y._host&&A&&A._69O)for(var i={},t=y._host;t&&t!==y&&!i[t._id];){if(t===A)return!0;i[t._id]=t,t=t._host}return!1},isLoopedHostOn:function(U){return this.isHostOn(U)&&U.isHostOn(this)},getScaledSize:function(){var K=this.getSize(),U=this.getScale();return K.width*=Math.abs(U.x),K.height*=Math.abs(U.y),K},layout:function(I){if(I=I||this.getHost()){var L=this,q=L.s("layout.h")||"center",y=L.s("layout.v")||"center";if("center"!==q||"center"!==y){var r=new z.Math.Vector2,e=I.getPosition(),g=I.getAnchor(),Z=I.getScaledSize();L.getPosition();var H,n,i,h,Y,G=1,P=1;switch(L._layoutUpdating=!0,q){case"left":r.setX(L._layoutHValue-g.x*Z.width);break;case"right":r.setX((1-g.x)*Z.width-L._layoutHValue);break;case"leftright":H=Z.width-L._layoutHValue[2],i=L.getRotation()-I.getRotation(),h=Math.abs(Math.sin(i)),Y=Math.abs(Math.cos(i)),G+=Y*H/L._layoutHValue[3],P+=h*H/L._layoutHValue[4],r.setX(L._layoutHValue[1]+(L._layoutHValue[5]-g.x)*Z.width);break;case"center":r.setX((.5-g.x)*Z.width-L._layoutHValue);break;case"scale":i=L.getRotation()-I.getRotation(),h=Math.abs(Math.sin(i)),Y=Math.abs(Math.cos(i)),r.setX((.5-g.x)*Z.width-L._layoutHValue[1]*Z.width/L._layoutHValue[0]),n=Z.width/L._layoutHValue[2]-1,G+=Y*n,P+=h*n}switch(y){case"top":r.setY(L._layoutVValue-g.y*Z.height);break;case"bottom":r.setY((1-g.y)*Z.height-L._layoutVValue);break;case"topbottom":i||(i=L.getRotation()-I.getRotation(),h=Math.abs(Math.sin(i)),Y=Math.abs(Math.cos(i))),H=Z.height-L._layoutVValue[2],G+=h*H/L._layoutVValue[3],P+=Y*H/L._layoutVValue[4],r.setY(L._layoutVValue[1]+(L._layoutVValue[5]-g.y)*Z.height);break;case"center":r.setY((.5-g.y)*Z.height-L._layoutVValue);break;case"scale":i||(i=L.getRotation()-I.getRotation(),h=Math.abs(Math.sin(i)),Y=Math.abs(Math.cos(i))),r.setY((.5-g.y)*Z.height-L._layoutVValue[1]*Z.height/L._layoutVValue[0]),n=Z.height/L._layoutVValue[2]-1,G+=h*n,P+=Y*n}if("leftright"===q||"scale"===q||"topbottom"===y||"scale"===y){var M=this.getScale(),T=Math.abs(M.x),V=Math.abs(M.y);"leftright"===q||"scale"===q?L.setSize(L._layoutHValue[3]*G/T,L._layoutHValue[4]*P/V):L.setSize(L._layoutVValue[3]*G/T,L._layoutVValue[4]*P/V)}r.rotateAround(null,I.getRotation()),this.setPosition(r.x+e.x,r.y+e.y),L._layoutUpdating=s}}},updateLayoutParameters:function(g,h){if(g=g||this.getHost()){var i=this,C=i.s("layout.h"),U=i.s("layout.v");if(C||U){var N,J,S,G,R,q,V=new z.Math.Vector2,K=g.getPosition(),E=g.getAnchor(),e=g.getScaledSize(),D=i.getPosition(),I=i.getScaledSize();switch(V.set(D.x-K.x,D.y-K.y),V.rotateAround(null,-g.getRotation()),C){case"left":i._layoutHValue=V.x+E.x*e.width;break;case"right":i._layoutHValue=-V.x+(1-E.x)*e.width;break;case"center":i._layoutHValue=-V.x+(.5-E.x)*e.width;break;case"leftright":case"scale":"scale"===C?N=-V.x+(.5-E.x)*e.width:(J=i.getAnchor(),S=i.getRotation()-g.getRotation(),G=Math.cos(S),R=Math.sin(S),q=-Math.min(-J.x*G+J.y*R,-J.x*G-(1-J.y)*R,(1-J.x)*G+J.y*R,(1-J.x)*G-(1-J.y)*R),N=V.x-(q-E.x)*e.width),"position"===h&&"object"==typeof i._layoutHValue?(i._layoutHValue[0]=e.width,i._layoutHValue[1]=N):i._layoutHValue=[e.width,N,e.width,I.width,I.height,q]}switch(U){case"top":i._layoutVValue=V.y+E.y*e.height;break;case"bottom":i._layoutVValue=-V.y+(1-E.y)*e.height;break;case"center":i._layoutVValue=-V.y+(.5-E.y)*e.height;break;case"topbottom":case"scale":"scale"===U?N=-V.y+(.5-E.y)*e.height:(S||(J=i.getAnchor(),S=i.getRotation()-g.getRotation(),G=Math.cos(S),R=Math.sin(S)),q=-Math.min(-J.x*R-J.y*G,-J.x*R+(1-J.y)*G,(1-J.x)*R-J.y*G,(1-J.x)*R+(1-J.y)*G),N=V.y-(q-E.y)*e.height),"position"===h&&"object"==typeof i._layoutVValue?(i._layoutVValue[0]=e.height,i._layoutVValue[1]=N):i._layoutVValue=[e.height,N,e.height,I.width,I.height,q]}}}},getSerializableProperties:function(){var x=Bj.superClass.getSerializableProperties.call(this);return Vp(x,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),x}});var pg=z.Edge=function(B,W){var G=this;oj(pg,G),G.setSource(B),G.setTarget(W)};iq("Edge",Jn,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return nn},_22Q:function(){return Mb},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(E){if(E===this)return!1;if(wg(E))return!0;for(var u,g,T,B,d,L=[this],j=-1,f=0;f>j;)if(j++,u=L[j],g=u._44I)for(g=g.getArray(),B=0,d=g.length;d>B;B++)if(T=g[B],Wg(T)&&!(L.indexOf(T)>=0)){if(T===E)return!1;L.push(T),f++}return!0},setSource:function(B){var W=this;if(W._source!==B&&W.canSetSourceTarget(B)){var z=W._source;W._source=B,z&&z._16I(W),B&&B._2I(W),W._7I(),W.fp("source",z,B)}},setTarget:function(C){var q=this;if(q._target!==C&&q.canSetSourceTarget(C)){var N=q._target;q._target=C,N&&N._18I(q),C&&C._4I(q),q._7I(),q.fp("target",N,C)}},isLooped:function(){var j=this;return j._source===j._target&&wg(j._source)&&wg(j._target)},onPropertyChanged:function(){var g=this;g._49I&&g._49I.each(function(K){K.fp("agentChange",!0,!1)})},_7I:function(){var X,D=this,c=sq(D);D._40I!==c&&(X=this._40I,X&&X._15I(D),D._40I=c,c&&c._1I(D),D.fp("sourceAgent",X,c),$r(X,D._41I),$r(c,D._41I));var z=Zq(D);D._41I!==z&&(X=D._41I,X&&X._17I(D),D._41I=z,z&&z._3I(D),D.fp("targetAgent",X,z),$r(X,D._40I),$r(z,D._40I))},_22I:function(V){this._52I=V,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var s=this;return s._52I&&s._52I.get(0)!==s&&!s.getStyle(Bp)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var L=this,$=L._52I;return $&&!L.getStyle(Bp)&&$.size()>1&&L===$.get(0)},toggle:function(){var x=this._52I,g=!this.s(Bp);x&&x.size()>1&&(x.each(function(J){J.s(Bp,g)}),x.getSiblings().each(function(n){n!==x&&n.each(function(r){r.fp("edgeGroup",N,n)})}))},setStyle:function(Z,W){(Z===Tr||"edge.segments"===Z)&&(W=Dr(W)),pg.superClass.setStyle.call(this,Z,W)},onStyleChanged:function(G){pg.superClass.onStyleChanged.apply(this,arguments),kf[G]&&$r(this._41I,this._40I)},getSerializableProperties:function(){var O=pg.superClass.getSerializableProperties.call(this);return Vp(O,{source:1,target:1}),O}});var zk=z.Group=function(){oj(zk,this)};iq("Group",Bj,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return hk},onChildAdded:function(){zk.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){zk.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var y=this;if(!y._54I&&!$g){var q=y.getChildrenRect();q&&(y._53I=1,y.p(el(y.s("group.position"),q,y.getSize())),delete y._53I)}},getChildrenRect:function(){var W,R=this;return R.eachChild(function(a){wg(a)&&(W=Db(W,R.getChildRect(a)))}),W},getChildRect:function(F){var a;return wg(F)&&F.s(ip)&&(tm(F)&&F.isExpanded()&&F.eachChild(function(N){a=Db(a,F.getChildRect(N))}),!a&&F.getRect&&(a=F.getRect())),a},setPosition:function(D,P){var r=this;if(!r._54I){var N;N=2===arguments.length?{x:D,y:P}:D,$g||r._53I||(r._54I=1,Ld(r._children,N.x-r._position.x,N.y-r._position.y),delete r._54I),zk.superClass.setPosition.call(this,N)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(a){var U=this;if(U._57O!==a){var V=U._57O;U._57O=a,U.fp("expanded",V,U._57O),U._fireInvalidateDeep(),U._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(v){tm(v)?v._fireInvalidateDeep():v.iv()})},_8I:function(){zk.superClass._8I.call(this),this.eachChild(function(s){wg(s)&&s._8I()})},onStyleChanged:function(s){zk.superClass.onStyleChanged.apply(this,arguments),"group.position"===s&&this._81I()},getSerializableProperties:function(){var s=zk.superClass.getSerializableProperties.call(this);return s.expanded=1,s}});var Xh=z.Block=function(){oj(Xh,this)};iq("Block",Bj,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Td},onChildAdded:function(){Xh.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Xh.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var x=this;if(!$g&&!x._updatingToChildren&&x._syncSize&&!x._freezeSyncFromChildren){var k,G,U,V,X,W=[],$=x.getRotation();if(x.eachChild(function(s){wg(s)&&W.push.apply(W,s.getCorners())}),W.length){x._updatingFromChildren=1;var s=H(-$),T=R(-$),j=1/0,w=-1/0,I=1/0,n=-1/0;for(V=0,X=W.length;X>V;V++)U=W[V],k=U.x,G=U.y,U.x=s*k-T*G,U.y=T*k+s*G,j=h(j,U.x),w=E(w,U.x),I=h(I,U.y),n=E(n,U.y);var K=x.getScale();x.setSize(c((w-j)/K.x),c((n-I)/K.y));var t;K.x<0&&(t=j,j=w,w=t),K.y<0&&(t=I,I=n,n=t),s=H($),T=R($);var m=x.getAnchor();k=j+(w-j)*m.x,G=I+(n-I)*m.y,x.setPosition(s*k-T*G,T*k+s*G),delete x._updatingFromChildren}}},setPosition:function(L,U){var J=this;if(!J._updatingToChildren){var W;W=2===arguments.length?{x:L,y:U}:L,$g||J._updatingFromChildren||(J._updatingToChildren=1,Ld(J._children,W.x-J._position.x,W.y-J._position.y),delete J._updatingToChildren),Xh.superClass.setPosition.call(this,W)}},setWidth:function(B){return this.setSize(B,this.getHeight())},setHeight:function(_){return this.setSize(this.getWidth(),_)},setSize:function(s,o){1>s&&(s=1),1>o&&(o=1);var v=this;if(!v._updatingToChildren){2!==arguments.length&&(o=s.height,s=s.width);var w=v.getWidth(),j=v.getHeight();if(s!==w&&Xh.superClass.setWidth.call(v,s),o!==j&&Xh.superClass.setHeight.call(v,o),!$g&&!v._updatingFromChildren){v._updatingToChildren=1;var X=s/w,P=o/j;v._adjustChildScaleOrSize(X,P,"size"),delete v._updatingToChildren,v.updateFromChildren()}}},_adjustChildScaleOrSize:function(f,T,M){var e=this;if(e._syncSize){var y=e.getPosition(),i=e.getRotation();e.getScale(),e.eachChild(function(p){if(wg(p)){var w=p.getPosition(),u=p.getRotation(),J=p.getWidth(),x=p.getHeight(),G=p.getScale(),I=G.x*J,L=G.y*x,$=new Vd(u,w.x,w.y,I,L);$.translate(-y.x,-y.y),$.rotate(-i),u=_($.b*Math.sign(I),$.a*Math.sign(I)),$.scale(f,T);var E,l,h,g=H(u);if(Math.abs(g)<.001?(E=R(u),l=$.b/E,h=-$.c/E):(l=$.a/g,h=$.d/g),"scale"===M)p.setScale(l/J,h/x);else if("size"===M){var d=l/G.x,K=h/G.y;p.setScale(ps(l)*Math.abs(G.x),ps(h)*Math.abs(G.y)),p instanceof z.Shape?(p.setWidthForce(Math.max(Math.abs(d),1e-5)),p.setHeightForce(Math.max(Math.abs(K),1e-5))):p.setSize(Math.max(.01,Math.abs(d)),Math.max(.01,Math.abs(K)))}$.rotate(i),$.translate(y.x,y.y),p.setPosition($.tx,$.ty)}})}},_calcChangeFactor:function(z,k,D,h){var i,N,T,d;return i=c(z),N=c(D),T=i>N?i/N:N/i,i=c(k),N=c(h),d=i>N?i/N:N/i,E(T,d)},setAnchor:function(){var a=this;if(!a._updatingToChildren){var P=a.getAnchor();if(Xh.superClass.setAnchor.apply(a,arguments),!$g&&!a._updatingFromChildren&&a._syncSize){a._updatingToChildren=1;var L=a.getAnchor();a.getPosition();var q=a.getSize(),$=a.getScale(),o=a.getRotation(),p=-q.width*$.x*(P.x-L.x),O=-q.height*$.y*(P.y-L.y),g=R(o),Q=H(o),M=Q*p-g*O,B=g*p+Q*O;a.eachChild(function(k){if(wg(k)){var x=k.getPosition();k.setPosition(x.x-M,x.y-B)}}),delete a._updatingToChildren}}},setRotation:function(U){var H=this;if(!H._updatingToChildren){var T=H.getRotation();if(Xh.superClass.setRotation.apply(H,arguments),!$g&&!H._updatingFromChildren){H._updatingToChildren=1;var I=H.getPosition(),o=U-T;H.eachChild(function(M){if(wg(M)){var D=M.getMatrix();D.translate(-I.x,-I.y),D.rotate(o),D.translate(I.x,I.y);var n=Math.sign(M.getScale().x);M.setRotation(_(D.b*n,D.a*n)),M.setPosition(D.tx,D.ty)}}),delete H._updatingToChildren}}},setScale:function(H,C){var p=this;if(!p._updatingToChildren){null==C&&(C=H.y,H=H.x);var v=p.getScale();if(c(H)<.01&&(H=.01*(ps(H)||ps(v.x))),c(C)<.01&&(C=.01*(ps(C)||ps(v.y))),Xh.superClass.setScale.call(p,H,C),!$g&&!p._updatingFromChildren){p._updatingToChildren=1;var m=H/v.x,R=C/v.y;p._adjustChildScaleOrSize(m,R,"size"),delete p._updatingToChildren,p.updateFromChildren()}}},getSerializableProperties:function(){var t=Xh.superClass.getSerializableProperties.call(this);return t.clickThroughEnabled=1,t.syncSize=1,t}});var Xb=z.Grid=function(){oj(z.Grid,this)};iq("Grid",Bj,{IRotatable:!1,_icon:"grid_icon",_image:N,getUIClass:function(){return Tf},setRotation:function(){},getCellRect:function(W,s){var l=this,V=l.s("grid.row.count"),e=l.s("grid.column.count");if(0>=V||0>=e||0>W||W>=V||0>s||s>=e)return N;var B,X,U,F=l.getRect(),u=l.s("grid.row.percents"),K=l.s("grid.column.percents");if(ns(F,l,"grid.border",-1),u&&u._as&&(u=u._as),K&&K._as&&(K=K._as),u&&u.length===V){for(U=0,B=0;W>B;B++)U+=F.height*u[B];F.y+=U,F.height=F.height*u[W]}else F.height=F.height/V,F.y+=F.height*W;if(K&&K.length===e){for(X=0,B=0;s>B;B++)X+=F.width*K[B];F.x+=X,F.width=F.width*K[s]}else F.width=F.width/e,F.x+=F.width*s;return Jg(F,-l.s("grid.gap")),F}});var Jk=z.Text=function(){oj(Jk,this),this.setSize(100,50),this.s("text","TEXT")};iq("Text",Bj,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return zq},setWidth:function(E){E||(E=.001),Jk.superClass.setWidth.call(this,E)},setHeight:function(g){g||(g=.001),Jk.superClass.setHeight.call(this,g)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Gq("__text__",{width:{value:100,isSafeFunc:!0,func:function(u){return u._width}},height:{value:50,isSafeFunc:!0,func:function(k){return k._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Kj=z.Shape=function(){oj(Kj,this),this._59O=new cb};Kj.__de__=$b,iq("Shape",Bj,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return jc},_22Q:function(){return os},getLength:function(P){return Ag($l(this._59O,this._58O,P,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var b=this._58O;return b?new cb(b._as.slice(0)):b},setSegments:function(I){var S=this._58O;I=I?pi(I)?new cb(I.slice(0)):new cb(I._as.slice(0)):null,(S&&I&&S._as.join(",")!==I._as.join(",")||S!==I)&&(this._58O=I,this.fp("segments",S,I))},getPoints:function(){return this._59O},toPoints:function(){var $=this._59O;return new cb($._as.slice(0))},setPoints:function(M,Q){var V=this,E=V._59O;M=M?pi(M)?new cb(M.slice(0)):new cb(M._as.slice(0)):new cb;var G,s,Y,m,T,L;Q&&(G=V.getPosition(),L=new Vd(V.getRotation(),0,0,V.getScale().x,V.getScale().y)),(E&&M&&E._as.join(",")!==M._as.join(",")||E!==M)&&(V._59O=M,V.fs(),V.fp("points",E,M)),Q&&(s=V.getPosition(),Y=s.x-G.x,m=s.y-G.y,T=L.tf(Y,m),V.setPosition(s.x-Y+T.x,s.y-m+T.y))},addPoint:function(B,Q,v){var r=this.toPoints();r.add(B,Q),this.setPoints(r,v)},setPoint:function(U,v,q){var l=this.toPoints();l.set(U,v),this.setPoints(l,q)},removePointAt:function(N){var q=this.toPoints();q.removeAt(N),this.setPoints(q)},setWidthForce:function(m){var f=this;if(!f._55I&&!$g&&f.getWidth()){f._55I=1;var a=f._position.x,l=m/f.getWidth(),W=f.toPoints(),g=new cb;W.each(function(J){g.add({x:(J.x-a)*l+a,y:J.y,e:J.e})}),f.setPoints(g),Um(f,[l,0,0,1,a*(1-l),0]),f.fs(),delete f._55I}Kj.superClass.setWidth.call(f,m)},setWidth:function(G){return this.setWidthForce(1>G?1:G)},setHeightForce:function(y){var E=this;if(!E._55I&&!$g&&E.getHeight()){E._55I=1;var f=E._position.y,a=y/E.getHeight(),u=E.toPoints(),S=new cb;u.each(function(i){S.add({x:i.x,y:(i.y-f)*a+f,e:i.e})}),E.setPoints(S),Um(E,[1,0,0,a,0,f*(1-a)]),E.fs(),delete E._55I}Kj.superClass.setHeight.call(E,y)},setHeight:function(n){return this.setHeightForce(1>n?1:n)},setAnchorElevation:function(o){var V=this;V._55I=!0;var A=V._updatingAnchor3d,t=!$g&&!A;if(t){var j,J=o,E=V.getAnchorElevation(),N=V.getTall();j=N*(E-J),V.shiftPointsElevation(j)}var R=Kj.superClass.setAnchorElevation.apply(V,arguments);return A||delete V._55I,R},getShapeElevation:function(){var l=this,S=l._54O;return S-(l.getTall()||0)*(l._anchorElevation-.5)},setAnchor3d:function(K,I,U,l){var S,P=this;"number"==typeof K?S={x:K,y:I,z:U}:(S=K.length?{x:K[0],y:K[1],z:K[2]}:K,l=I),P._55I=!0,P._updatingAnchor3d=!0;var f=P.getDataModel();if(f&&f.beginTransaction(),!$g){var N=P.getAnchor3d(),u=P.getSize(),t=P.getTall(),z=u.width*(N.x-S.x),q=u.height*(N.z-S.z),i=t*(N.y-S.y);l||P.shiftPoints(z,q,i);var e=P.p3()}var C=Kj.superClass.setAnchor3d.apply(P,arguments);if(!$g&&l){var o=P.p3();P.shiftPoints(o[0]-e[0]+z,o[2]-e[2]+q,o[1]-e[1]+i)}return f&&f.endTransaction(),delete P._updatingAnchor3d,delete P._55I,C},setAnchor:function(A,H,h){var n=this;n._55I=!0;var s=n._updatingAnchor3d,Z=!$g&&!s;if(Z){var g,O,M;"number"==typeof A?M={x:A,y:H}:(M=A.length?{x:A[0],y:A[1]}:A,h=H);var S=n.getAnchor(),$=n.getSize();g=$.width*(S.x-M.x),O=$.height*(S.y-M.y),h||n.shiftPoints(g,O);var i=n.getPosition()}var G=Kj.superClass.setAnchor.apply(n,arguments);if(Z){var D=n.getPosition();h&&n.shiftPoints(D.x-i.x+g,D.y-i.y+O)}return s||delete n._55I,G},shiftPoints:function(d,m,g){var F=this,t=F.getElevation()||0,o=F.toPoints(),u=new cb;o.each(function(y){var b=y.e;g&&(b=(b==N?t:b)+g),u.add({x:y.x+d,y:y.y+m,e:b})}),F.setPoints(u),F.fs()},shiftPointsElevation:function(W){return this.shiftPoints(0,0,W)},setPosition:function(s,j){var S,i=this;if(!i._28Q){if(i._28Q=1,!i._55I&&!$g){S=2===arguments.length?{x:s,y:j}:s;var b=S.x-i._position.x,e=S.y-i._position.y;if(0===b&&0===e)return delete i._28Q,void 0;i._55I=1,i.shiftPoints(b,e),Um(i,[1,0,0,1,b,e]),delete i._55I}Kj.superClass.setPosition.apply(i,arguments),delete i._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var J=this;if(2!==J._59O.size())return!1;var C=J._58O;return C?2===C.size()&&1===C.get(0)&&2===C.get(1)?!0:!1:!0},fireShapeChange:function(){var m=this;if(!m._55I&&!$g){var E=Mp(m._59O);E&&(m._55I=1,m.setRect(E),delete m._55I)}m.fp(Ri,!1,!0)},getSerializableProperties:function(){var E=Kj.superClass.getSerializableProperties.call(this);return E.segments=1,E.points=1,E.thickness=1,E.closePath=1,E}});var Uk=z.Polyline=function(){oj(Uk,this),this.s({"shape.background":null,"shape.border.width":2})};iq("Polyline",Kj,{_icon:"polyline_icon",_22Q:function(){return On},getUIClass:function(){return uj},setClosePath:function(){},setTall:function(h){var A=this;if(!A._55I&&!A._24Q&&!$g&&A.getTall()){A._24Q=1;var X=A._54O,p=h/A.getTall();A._59O.each(function(v){v.e=v.e==N?X:(v.e-X)*p+X}),A.fs(),delete A._24Q}Uk.superClass.setTall.call(A,h)},setElevation:function(H){var Y=this;if(!Y._55I&&!Y._24Q&&!$g){Y._24Q=1;var $=H-Y._54O;Y._59O.each(function(V){V.e==N?V.e=H:V.e+=$}),Y.fs(),delete Y._24Q}Uk.superClass.setElevation.apply(Y,arguments)},fireShapeChange:function(){var i=this,u=i._59O;if(!i._55I&&!i._24Q&&!$g){var a=u.size();if(a){var _=1,r=u.get(0),I=i._54O;r.e==N&&(r.e=I);for(var o=r.e,T=0;a>_;_++){r=u.get(_),r.e==N&&(r.e=I);var e=h(o,r.e),J=E(o+T,r.e);o=e,T=J-e}i._24Q=1,i.setTall(T),i.setElevation(o+T*i._anchorElevation),delete i._24Q}}Uk.superClass.fireShapeChange.apply(i,arguments)}});var Jb=z.SubGraph=function(){oj(Jb,this)};iq("SubGraph",Bj,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Jb.superClass._8I.call(this),this.eachChild(function(f){wg(f)&&f._8I()})}}),Q.loadingRefGraph=0;var Vq=z.RefGraph=function(){oj(Vq,this)};iq("RefGraph",Xh,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(A){var d=this._ref;this._ref=A,this.fp("ref",d,A),this.updateRef()},_21I:function(){Vq.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var B=this;if(Q.loadingRefGraph++,B.clearChildrenFromDataModel(),Q.loadingRefGraph--,B._ref&&B._dataModel){B._xhrLoadHandler&&(B._xhrLoadHandler.cancel=!0);var i=$g,m=B._xhrLoadHandler=function(F){if(F&&B._dataModel){Q.loadingRefGraph++;var j=B._pendingUpdateInfo={needToRestore:i};i&&(j.position=B.p(),j.width=B.getWidth(),j.height=B.getHeight(),j.rotation=B.getRotation(),j.anchor=B.getAnchor(),j.scale=B.getScale()),B.p(0,0),B.setAnchor(.5,.5),B.setRotation(0),B.setScale(1,1);var A=Q.parse(F),h=B._dataModel.deserialize(A,B,{justDatas:!0});h.each(function(_){_._refGraph=B}),B.checkPendingUpdateInfo(),Q.loadingRefGraph--,Q.handleRefGraphLoaded(B,h,A)}};m.xhrLoadCalled=!1,Q.load(B._ref,function(n){m.cancel||(m.xhrLoadCalled?m(n):no(function(){m(n)}))}),m.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var k=this,D=k._pendingUpdateInfo;if(!D)return k.onPendingUpdated&&(Q.loadingRefGraph++,k.onPendingUpdated(),Q.loadingRefGraph--),void 0;var M=!0;this.eachChild(function(L){(L._pendingCheckImageJSON||L._pendingUpdateInfo)&&(M=!1)}),M&&(Q.loadingRefGraph++,k._pendingUpdateInfo=null,k.updateFromChildren(),D.needToRestore&&(k.setSize(D.width,D.height),k.setAnchor(D.anchor),k.setRotation(D.rotation),k.setScale(D.scale),k.p(D.position)),this.getParent()instanceof Vq&&this.getParent().checkPendingUpdateInfo(),k.onPendingUpdated&&k.onPendingUpdated(),Q.loadingRefGraph--)},getSerializableProperties:function(){var B=Vq.superClass.getSerializableProperties.call(this);return B.ref=1,B}}),z.EdgeGroup=function(Y,o){this._70O=Y,this._siblings=o;for(var P,A,y=0,q=Y.size(),F=e[Bp];q>y;y++)if(P=Y.get(y).getStyle(Bp,!1),P!=N){F=P;break}F==N&&(F=!0);var c=Q.edgeGroupAgentFunc;for(c&&(A=c(Y),A&&A!==Y.get(0)&&(Y.remove(A),Y.add(A,0))),y=0;q>y;y++)Y.get(y).s(Bp,F)},iq("EdgeGroup",W,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(p){return this._70O.get(p)},indexOf:function(p){return this._70O.indexOf(p)},each:function(p,G){this._70O.each(p,G)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(W,R){this._siblings.each(function(l){l._70O.each(W,R)})}});var Bl=function(q,h,_){var J=bh[q]={type:q,action:h};if(_)for(var z in _)J[z]=_[z]};Vp(Q,{setConnectAction:Bl,getConnectAction:function(d,I){if(!I){if(!d)return null;I=d.getCurrentConnectActionType()}return bh[I]},doConnectAction:function(j,d,r,L){L=L||j.getCurrentConnectActionType();var y=bh[L];if(!y)return!1;var D=y.action;return D?(d instanceof li.Group?j.sm().getSelection().each(function(q){D.call(null,j,q,r)}):D.call(null,j,d,r),!0):!1},doDeleteConnectionAction:function(T,G,Q){Q=Q||T.getCurrentConnectActionType();var x=bh[Q];if(!x||!x.delete)return!1;var A=x.delete.action;return A?(G instanceof li.Group?T.sm().getSelection().each(function(j){A.call(null,T,j)
}):A.call(null,T,G),!0):!1}});var Id=z.JSONSerializer=function(O,W){this.dm=this._dataModel=O,this._hierarchical=Q.forceHierarchicalSerialization?!0:W==N?O.isHierarchicalRendering():W};iq("JSONSerializer",W,{ms_ac:["hierarchical"],serialize:function(c){return Q.stringify(this.toJSON(),c)},toJSON:function(){var R=this,E=R.dm,L=E.getRoots(),X=R.json={v:Q.getVersion(),p:{},a:{},d:[]},Y=E.getSerializableAttrs();E.getInit()&&(X.init=E.getInit()),E.getName()&&(X.p.name=E.getName()),E.getBackground()&&(X.p.background=E.getBackground()),E.getLayers()&&(X.p.layers=E.getLayers()),E.getEnvmap()&&(X.p.envmap=E.getEnvmap()),X.p.autoAdjustIndex=E.isAutoAdjustIndex(),X.p.hierarchicalRendering=E.isHierarchicalRendering();for(var b in Y){var P=E.a(b);P!==s&&R[Mq](b,P,X.a)}return Uo(X.a)&&delete X.a,R._hierarchical?L.each(R.serializeData,this):E.each(function(S){R.serializeData(S)}),E.fireSerializeEvent({type:"serialize",json:X}),E.getPostProcessingData()&&(X.p.postProcessingData=E.getPostProcessingData()),X},isSerializable:function(){return!0},getProperties:function(d){return d.getSerializableProperties()},getStyles:function(z){return z.getSerializableStyles()},getAttrs:function(h){return h.getSerializableAttrs()},serializeData:function(Z){var J=this;if(J.isSerializable(Z)&&!Z._refGraph){var G,u,r,t,c=Co(Z.getClassName())||Z.getClass(),$=new c,d={c:Z.getClassName(),i:Z.getId(),p:{},s:{},a:{}};J.json.d.push(d),G=J.getProperties(Z);for(u in G)if(/^_/.test(u)){if(r=Z[u],("_width"===u||"_height"===u)&&r===s){var K;((Z.s("layout.h")||Z.s("layout.v"))&&Z.getHost()||Z instanceof z.Node&&(K=Z.getParent())&&K instanceof z.Block||Z.s("fullscreen"))&&(r=Z[u]="_width"===u?Z.getWidth():Z.getHeight())}r!==$[u]&&J[Mq](u.substr(1),r,d.p)}else t=bg(u),Z[t]&&(r=Z[t](),r!==$[t]()&&J[Mq](u,r,d.p));G=J.getStyles(Z);for(u in G)r=Z.s(u),r!==$.s(u)&&J[Mq](u,r,d.s);G=J.getAttrs(Z);for(u in G)r=Z.a(u),r!==$.a(u)&&J[Mq](u,r,d.a);Uo(d.p)&&delete d.p,Uo(d.s)&&delete d.s,Uo(d.a)&&delete d.a}J._hierarchical&&Z.getChildren().each(J.serializeData,J)},serializeValue:function(z,c,x){Cg(c)?c={__a:c._as}:c instanceof Jn&&(c={__i:c.getId()}),x[z]=c},deserialize:function(A,J,K){var b=this;return fh(A)&&/.json$/.test(A)?(Q.xhrLoad(A,function(w){b.deserializeImpl(w,J,K)}),void 0):b.deserializeImpl(A,J,K)},deserializeImpl:function(F,c,$){var D=this,W=D.dm;$=jm($)?{setId:$}:Wp($)?{finishFunc:$}:$||{},F=D.json=fh(F)?Q.parse(F):F,F.a&&F.a.onPreDeserialize&&!$.disableOnPreDeserialize&&F.a.onPreDeserialize(F,W,$.view),W.beginTransaction(),$g++,D._82I={};var o=new cb,y=new cb,A=0,e=F.d.length;if($.justDatas||(Wp(F.init)&&F.init(W),W.setInit(F.init)),!$.justDatas){for(var f in F.a)W.a(f,D[ln](F.a[f]));for(var j in F.p)W[ar(j)](F.p[j])}for(;e>A;A++){var R=F.d[A],X=Co(R.c),U=new X,G=R.i;$.setId&&G!=N&&(U._id=G),D._82I[G]=U,o.add(U),y.add(R)}for(A=0;e>A;A++)D.deserializeData(o.get(A),y.get(A));return o.each(function(d){c&&!d.getParent()&&d.setParent(c),W.add(d)}),W.fireSerializeEvent({type:"deserialize",json:F}),$g--,W.endTransaction(),F.a&&F.a.onPostDeserialize&&!$.disableOnPostDeserialize&&F.a.onPostDeserialize(F,W,$.view,o),$.finishFunc&&$.finishFunc(F,W,$.view,o),o},deserializeData:function(Z,i){for(var b in i.p)Z[ar(b)](this[ln](i.p[b]));for(b in i.s)Z.s(b,this[ln](i.s[b]));for(b in i.a)Z.a(b,this[ln](i.a[b]))},deserializeValue:function(y){if(yp(y)){var B=y.__i;if(B!=N)return this._82I[B];if(B=y.__a,pi(B))return new cb(B)}return y}}),Vp(aj,{serialize:function(e,x){return new Id(this,x).serialize(e)},toJSON:function(W){return new Id(this,W).toJSON()},deserialize:function(m,c,_){return new Id(this).deserialize(m,c,_)}});var xf=z.OverlappingBox=function(E){this.gv=E,this.boxes={}};iq("OverlappingBox",W,{clear:function(){var _,Q,U=this.boxes;for(_ in U)Q=U[_],Q.length=0},isOverlapping:function(N,I){var n,Q,h=this,V=h.boxes,D=V[N];D?(n=D.rects,Q=D.length):D=V[N]={rects:n=[],length:Q=0};var _,d,I;for(_=0;Q>_;_++)if(d=n[_],d.x<I.x+I.w&&d.x+d.w>I.x&&d.y<I.y+I.h&&d.h+d.y>I.y)return!0;return n.length<=Q?(n.push(I),D.length++):n[D.length++]=I,!1}}),Vp(Q,{fetch:function(O,V){var $="GET",l=!1,H=null,y="";V&&($=V.method||"GET",l=V.sync,y=V.url,H=V.data||null),O.open($,y,!l),V.responseType?O.responseType=V.responseType:V.overrideMimeType&&O.overrideMimeType&&O.overrideMimeType(V.overrideMimeType),O.send(H)},convertImageSrc:function(R,M){M&&"function"==typeof M||(M=function(){}),M(R)}});var lr=z.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};iq("Request",W,{_responseType:null,_overrideMimeType:"text/plain",send:function(M){var D=this._xhr,O=this.onload,o=this.onerror;this.getResponseType()?M.responseType=this.getResponseType():this.getOverrideMimeType()&&(M.overrideMimeType=this.getOverrideMimeType()),D.onload=O,D.onerror=o,Q.fetch(D,M)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(U){this._responseType=U},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(J){this._overrideMimeType=J},getResponseText:function(){var l=this._xhr;return l.response||l.responseText}}),ep.GraphView=function(z){var j=this;j._24I={},j._34I=new cb,j._25I={},j._56I={},j._view=ge(1,j),j._canvas=Wq(j._view),j.dm(z?z:new aj),this._coreInteractor=new us(this),j.setEditable(!1),j.setScrollBarVisible(Q.graphViewScrollBarVisible)},uf("GraphView",W,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[cl,nl,mc,gg,"resettable","editInteractor",ql,"zoomable","pannable","rectSelectable","autoScrollZone",Cq,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:Q.graphViewZoomable,_resettable:Q.graphViewResettable,_pannable:Q.graphViewPannable,_rectSelectable:Q.graphViewRectSelectable,_autoScrollZone:Q.graphViewAutoScrollZone,_rectSelectBackground:Q.graphViewRectSelectBackground,_rectSelectBorderColor:Q.graphViewRectSelectBorderColor,_editPointSize:Q.graphViewEditPointSize,_editPointBorderColor:Q.graphViewEditPointBorderColor,_editPointBackground:Q.graphViewEditPointBackground,_scrollBarColor:ap,_scrollBarSize:Xf,_autoHideScrollBar:Cr,_autoMakeVisible:Il,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(t){this._dataModel.setLayers(t)},setEditable:function(w){var N=this,k=N.__interactorMap__;if(!k){var j=ep.XEditInteractor;k=N.__interactorMap__={scrollBar:new di(N),select:new Pi(N),edit:j?new j(N):new kd(N),text:new wh(N),move:new Iq(N),"default":new cr(N),touch:new xd(N,{editable:!1})}}w?(N._uieditable=!0,N.setInteractors([k.scrollBar,k.select,k.edit,k.text,k.move,k.default,k.touch])):(N._uieditable=!1,N.setInteractors([k.scrollBar,k.select,k.move,k.default,k.touch]))},getCanvas:function(){return this._canvas},_33I:function(c){var _=c.getUIClass();return _?new _(this,c):N},getDataUI:function(D){var M=this,N=M._25I[D._id];return N===s&&(N=M._33I(D),M._25I[D._id]=N),N},getNodeRect:function(O){return Q.getNodeRect(this,O)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(F){var $=this.getDataUI(F);return $?($._79o(),$._78o):null},getEdgeSourcePosition:function(L){var C=this,w=C.getDataUI(L),I=w.s,g=w._data._40I;return yb(C,g,I("edge.source.position"),I("edge.source.offset.x"),I("edge.source.offset.y"),I("edge.source.anchor.x"),I("edge.source.anchor.y"))},getEdgeTargetPosition:function(w){var X=this,r=X.getDataUI(w),p=r.s,Y=r._data._41I;return yb(X,Y,p("edge.target.position"),p("edge.target.offset.x"),p("edge.target.offset.y"),p("edge.target.anchor.x"),p("edge.target.anchor.y"))},invalidateAll:function(Z){var H=this;if(Z){for(var Y in H._25I){var _=H._25I[Y];_&&_.dispose()}H._25I={},H._56I={},H._24I={},H._34I.clear(),H.redraw()}else H.dm().each(function(U){H.invalidateData(U)})},invalidateSelection:function(){var A=this;A.sm().each(function(J){A.invalidateData(J)})},invalidateData:function(d){var h=this;h._24I[d._id]=d,h._21Q(d),h.iv()},_21Q:function(R){var N=this,a=N._24I;if(Wg(R)&&ae[R.s(Yl)]){var p=R.getSourceAgent();p&&p.getAgentEdges().each(function(R){a[R._id]=R}),p=R.getTargetAgent(),p&&p.getAgentEdges().each(function(G){a[G._id]=G}),N.iv()}},redraw:function(B){var m=this;m._32I||(B?m._34I.add(B):(m._32I=1,m._34I.clear()),m.iv())},each:function(p,L){var w,x,W,R=0,H=this.getLayers(),P=this._dataModel,M=P._datas._as,t=M.length;if(H){for(var h=H.length;h>R;R++)if(W=H[R],yp(W)&&(W=W.name),P.isHierarchicalRendering()){var A=function(m){return m._layer===W?L?p.call(L,m):p(m):void 0};if(this._dataModel.eachByHierarchical(A)===!1)return}else for(var r=0;t>r;r++)if(w=M[r],w._layer===W&&(x=L?p.call(L,w):p(w),x===!1))return}else if(P.isHierarchicalRendering())this._dataModel.eachByHierarchical(p,null,L);else for(;t>R;R++)if(w=M[R],x=L?p.call(L,w):p(w),x===!1)return},reverseEach:function(V,Q){var u,c,l,A,J=this._dataModel,O=J._layers,L=J._datas._as,n=L.length;if(O){for(u=O.length-1;u>=0;u--)if(A=O[u],yp(A)&&(A=A.name),J.isHierarchicalRendering()){var I=function(f){return f._layer===A?Q?V.call(Q,f):V(f):void 0};if(J.reverseEachByHierarchical(I)===!1)return}else for(var M=n-1;M>=0;M--)if(c=L[M],c._layer===A&&(l=Q?V.call(Q,c):V(c),l===!1))return}else if(J.isHierarchicalRendering())J.reverseEachByHierarchical(V,null,Q);else for(u=n-1;u>=0;u--)if(c=L[u],l=Q?V.call(Q,c):V(c),l===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var q=this,e=q._84I;if(!e){var f=this.dm().a("width"),l=this.dm().a("height");f>0&&l>0?q._84I={x:0,y:0,width:f,height:l}:(q.each(function(B){q.isVisible(B)&&(e=Db(e,q.getDataUIBounds(B)))}),q._84I=e?e:nj)}return q._84I},getScrollRect:function(){return Db(this.getContentRect(),this._29I)},makeCenter:function(Y,A,W){var Z=this;if(!Z.getWidth()||!Z.getHeight())return W||no(Z.centerData,Z,[Y,A,!0],500),void 0;Z.makeVisible(Y),Z.validate();var M=Z.getDataUIBounds(Y);if(M){var E=Z.getWidth(),u=Z.getHeight(),$=M.x+M.width/2,S=M.y+M.height/2,G=-$*Z._zoom+E/2,s=-S*Z._zoom+u/2;Z.setTranslate(G,s,A)}},fitData:function(A,W,y,l,o){var r=this;if(!r.getWidth()||!r.getHeight())return o||no(r.fitData,r,[A,W,y,l,!0],500),void 0;var Z=function(){r.makeVisible(A),r.validate();var Z=r.getDataUIBounds(A);Z&&(Z=kg(Z),Jg(Z,y==N?20:y),r.fitRect(Z,W,l))};W?Q.callWhenLoaded(Z):Z()},fitContent:function(g,J,X,y){var z=this;if(!z.getWidth()||!z.getHeight())return y||no(z.fitContent,z,[g,J,X,!0],500),void 0;var j=function(){z.validate();var k=kg(z.getContentRect());Jg(k,J==N?20:J),z.fitRect(k,g,X)};g?Q.callWhenLoaded(j):j()},fitRect:function(j,R,G){var z=this,O=z.getWidth(),k=z.getHeight(),$=j.x+j.width/2,o=j.y+j.height/2,x=h(O/j.width,k/j.height),A=z._zoom,B=-$*A+O/2,U=-o*A+k/2;0===x||isNaN(x)||(G&&(x=h(1,x)),R?(z._65I&&(delete z._65I.finishFunc,z._65I.stop(!0)),z._14o&&z._14o.stop(!0),z.setTranslate(B,U,{finishFunc:function(){z.setZoom(x,R)}})):(z.setTranslate(B,U),z.setZoom(x)))},toCanvas:function(R,k){k=k||this._zoom,this.validateImpl();var U=this,L=U.getContentRect();L.width||(L.width=10),L.height||(L.height=10);var $=Wq(),q=L.x*k,C=L.y*k,p=L.width*k,O=L.height*k;Rj($,p,O,1);var x=Lq($);return R=R||this._dataModel.getBackground(),R&&Re(x,0,0,p,O,R),lj(x,-q,-C),x.scale(k,k),U._42(x),x.restore(),$},toDataURL:function(J,h,q){return this.toCanvas(J,q).toDataURL(h||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(j,o){var a=this,F=a.dm().getBackground();if(F){var y=a.dm().a("width"),v=a.dm().a("height");y>0&&v>0&&Re(j,0,0,y,v,F)}var K=a.__htmlOrderList,k=[];if(a._93db(j,o),a.each(function(l){var e=a.getDataUI(l);if(e){var M=a._56I[l._id],n=e._htmlView;if(M){var J=e._79o();if(n=e._htmlView,z.HtmlNode&&l instanceof z.HtmlNode)e._42(j);else{var m=a.getViewRect(),p=n&&n.layoutHTML;!o||Wr(o,J)?(p&&(n.layoutHTML(),e.__outerLayout&&delete e.__outerLayout),e._42(j)):Wr(m,J)||!p||e.__outerLayout||(n.layoutHTML(),e.__outerLayout=!0)}}n&&(k.push(n),n.getView&&(n=n.getView()),n.style.display=M?"block":vj)}}),K&&k.length>0){var C=!1;if(K.length!==k.length)C=!0;else for(var e=0;e<k.length;e++)if(k[e]!==K[e]){C=!0;break}C&&(k.forEach(function($){a.appendHTML($,!0)}),this.__htmlOrderList=k)}else this.__htmlOrderList=k;a._92db(j,o)},validateImpl:function(){this.tryUpdateRootData();var s,$,Z,x,Q,q=this,V=q.tx(),t=q.ty(),X=q._zoom,O=q._canvas,k=this.getWidth(),J=this.getHeight(),A=q._29I,R={x:-V/X,y:-t/X,width:k/X,height:J/X},j={},F=q._34I,P=q._24I,K=q._32I,T=q._23I;q._24I={},(k!==O.clientWidth||J!==O.clientHeight)&&(Rj(O,k,J),K=1),K||ve(R,A)||(K=1),q._29I=R,q.each(function(f){$=f._id;var y=j[$]=q.isVisible(f);y!==q._56I[$]&&(P[$]=f,Z=q.getDataUI(P[$]),Z&&Z._84o(y),q._84o(f,y))},q);for($ in P)Z=q.getDataUI(P[$]),Z&&(!K&&q._56I[$]&&(Q=Z._79o(),Q&&F.add(Q)),Z.invalidate()),q._83I=1;if(q._56I=j,!K)for($ in P)j[$]&&(Z=q.getDataUI(P[$]),Z&&(Q=Z._79o(),Q&&F.add(Q)));if(K?x=R:(F.each(function(E){Wr(R,E)&&(x=Db(x,E))}),x&&(Jg(x,E(1,1/X)),x.x=S(x.x*X)/X,x.y=S(x.y*X)/X,x.width=C(x.width*X)/X,x.height=C(x.height*X)/X,x=qd(R,x))),q._74O=x,x){s=Lq(O);var l=x.x,i=x.y,h=x.width,e=x.height;l=Math.floor((l*X+V)*sn),i=Math.floor((i*X+t)*sn),h=Math.ceil(h*X*sn)+1,e=Math.ceil(e*X*sn)+1,s.beginPath(),s.rect(l,i,h,e),s.clip(),s.clearRect(l,i,h,e),yq(s,V,t,X),q._42(s,x),s.restore(),delete q._74O}if(F.clear(),delete q._32I,T&&k>0&&J>0){var Z=q.getDataUI(T);if(Z){var Q=Z._79o(),f=q._29I,v=f.x,b=f.y,M=f.width,u=f.height,X=q._zoom;Q&&!Wr(Q,f)&&(Q.x+Q.width<v&&q.tx(-Q.x*X),Q.x>v+M&&q.tx(-(Q.x+Q.width-M)*X),Q.y+Q.height<b&&q.ty(-Q.y*X),Q.y>b+u&&q.ty(-(Q.y+Q.height-u)*X))}delete q._23I}q._83I&&(delete q._83I,delete q._84I),q._98O(),q.countFrame(),Uo(q._24I)||no(q.iv,q)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var t,o=this.getFullscreenDatas();for(var M in o)t=o[M],this.scaleRootData(t);this._rootDataUpdating=!1}},scaleRootData:function(S){var n=S.s("fullscreen");if("uniform"===n||"fill"===n){S.getRotation()&&S.setRotation(0);var Q,r,p,O=S.s("fullscreen.gap")||0,C=this.getWidth()-2*O,z=this.getHeight()-2*O,k=S.getAnchor(),c=S.getScaledSize(),I=c.width,b=c.height,j=S.s("fullscreen.lock");if(j)return"uniform"===n?C/z>I/b?(Q=z/b,I=b*C/z):(Q=C/I,b=I*z/C):"v"===j?(Q=z/b,I=C/Q,S.getWidth()!==I&&S.setWidth(I)):(Q=C/I,b=z/Q,S.getHeight()!==b&&S.setHeight(b)),this.setZoom(Q),r=O-(S.getX()-k.x*I)*Q,p=O-(S.getY()-k.y*b)*Q,r!==this.tx()&&this.tx(r),p!==this.ty()&&this.ty(p),void 0;r=this.tx(),p=this.ty(),Q=this._zoom;var e={x:(-r+O)/Q,y:(-p+O)/Q,width:C/Q,height:z/Q};if("uniform"===n){var V=I/b,x=Math.min(e.width,e.height*V),Z=x/V;e.x+=.5*(e.width-x),e.y+=.5*(e.height-Z),e.width=x,e.height=Z}C=e.width/S.getScaleX(),z=e.height/S.getScaleY(),(S.getWidth()!=C||S.getHeight()!==z)&&S.setSize(C,z);var T=e.x+k.x*e.width,w=e.y+k.y*e.height,q=S.getPosition();(T!==q.x||w!==q.y)&&S.setPosition(T,w)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(F){var M=this;F!==M.isScrollBarVisible()&&(F?(Mo(M._view,M._79O=ko()),Mo(M._79O,M._27I=ko()),Mo(M._79O,M._28I=ko())):(Xr(M._79O),delete M._79O,delete M._27I,delete M._28I),M.fp("scrollBarVisible",!F,F))},getDebugTip:function(){return""},showScrollBar:function(){var W=this;W._79O&&(W._85I||(p(function(){W._86I()},_i),W.iv()),W._85I=new Date)},_86I:function(){var N=this;if(N._85I){var q=new Date,R=q.getTime();R-N._85I.getTime()>=_i?(delete N._85I,N.iv()):p(function(){N._86I()},_i)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var v=this,l=this._27I,J=this._28I;if(v._79O){if(v._autoHideScrollBar&&!v._85I)return l.style.visibility=Qm,J.style.visibility=Qm,void 0;var Z=v.getScrollBarColor(),e=v._zoom,C=v.getScrollBarSize(),t=v.getViewRect(),g=v.getScrollRect(),z=t.height*e,E=g.height*e,j=t.width*e-C-2,W=z*((t.y-g.y)*e/E),m=z*(z/E),r=l.style;E-.5>z?(Ym>m&&(W=W+m/2-Ym/2,0>W&&(W=0),W+Ym>z&&(W=z-Ym),m=Ym),Zd(l,j,W,C,m),r.visibility=Ti,r.background=Z,r.borderRadius=C/2+Dm):r.visibility=Qm;var q=t.width*e,G=g.width*e,W=t.height*e-C-2,j=q*((t.x-g.x)*e/G),B=q*(q/G),r=J.style;G-.5>q?(Ym>B&&(j=j+B/2-Ym/2,0>j&&(j=0),j+Ym>q&&(j=q-Ym),B=Ym),Zd(J,j,W,B,C),r.visibility=Ti,r.background=Z,r.borderRadius=C/2+Dm):r.visibility=Qm}},setDataModel:function(E){var g=this,t=g._dataModel,F=g._selectionModel;t!==E&&(t&&(t.ump(g.handleDataModelPropertyChange,g),t.umm(g.handleDataModelChange,g),t.umd(g.handleDataPropertyChange,g),t.removeIndexChangeListener(g._75O,g),t.removeHierarchyChangeListener(g.handleHierarchyChange,g),F||t.sm().ums(g.handleSelectionChange,g)),g._dataModel=E,E.mp(g.handleDataModelPropertyChange,g),E.mm(g.handleDataModelChange,g),E.md(g.handleDataPropertyChange,g),E.addIndexChangeListener(g._75O,g),E.addHierarchyChangeListener(g.handleHierarchyChange,g),F?F._21I(E):E.sm().ms(g.handleSelectionChange,g),g.invalidateAll(!0),g.fp(eh,t,E),g.updateBackground())},getLayersInfo:function(){if(this._layersInfo===s){var e=this.getLayers();e?(this._layersInfo={},e.forEach(function(v){var t=yp(v)?v.name:v;this._layersInfo[t]=v},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(d,y,v){var X,e,i=this,S=i.getDataUI(d),V=Oo(S),D=Vf(y,function(X){return Gb(V,100*X)},100,.001),a=Gb(V,100*D);if(!v){var L=lc(S),k=new hh(a.x,a.y),W=49/(i._zoom*i._zoom);for(X=0,e=L.length;e>X;X++)if(k.distanceToSquared(L[X])<W)return{index:X,point:L[X],distance:Math.sqrt((L[X].x-y.x)*(L[X].x-y.x)+(L[X].y-y.y)*(L[X].y-y.y))}}return{percent:D,point:a,distance:Math.sqrt((a.x-y.x)*(a.x-y.x)+(a.y-y.y)*(a.y-y.y))}},calculateAttachPoint:function(){var Q=new hh,q=new hh,v=new hh;return function(R,u){var p=this.getAttachPoints(R);if(!p||!p.length)return null;v.set(u.x,u.y);for(var i,x,g,J,X=1/0,w=0,n=p.length;n>w;w++)g=p[w],q.x=g.x,q.y=g.y,Q.x=g.offsetX||0,Q.y=g.offsetY||0,J=yb(this,R,0,Q.x,Q.y,q.x,q.y),x=v.distanceToSquared(J),X>x&&(i=w,X=x);X=Math.sqrt(X);var t=this.getAttachStyle(R);if("close"===t){var Z=R.s("attach.close.threshold")/this._zoom;if(X>Z)return null}return{index:i,distance:X,info:p[i]}}}(),getAttachPoints:function(z){var e=z.s("attach.points");if(e)return e;var o=_c(z._image);return o?Cd(o.attachPoints,z,this)||null:void 0},getAttachStyle:function(X){var A=X.s("attach.style");if(A)return A;var B=_c(X._image);return B?Cd(B.attachStyle,X,this)||"close":void 0},updateLayers:function(){this._layersInfo=s,this.invalidateSelection(),this.redraw()},updateBackground:function(){var q=this.dm().a("width"),Y=this.dm().a("height");this._canvas.style.background=q>0&&Y>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(k){if("background"===k.property){var d=this._canvas.style.background,v=k.newValue||"";this.updateBackground(),this.fp("canvasBackground",d,v),this.redraw()}else"a:width"===k.property||"a:height"===k.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===k.property?this.updateLayers():"hierarchicalRendering"===k.property&&this.redraw()},handleDataPropertyChange:function(A){this.dm().isHierarchicalRendering()&&"parent"===A.property&&A.data.hasChildren()&&this.redraw(),this.invalidateData(A.data)},onPropertyChanged:function(S){var $=this,r=S.property;if($.redraw(),"zoom"===r){var c=$.sm().getSelection();c.size()&&c.each(function(i){i.invalidate()})}Ch[r]?$.showScrollBar():r===ql&&$.onCurrentSubGraphChanged(S)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(o){var i=this,v=o.kind,Y=o.data;if(i._83I=1,"add"===v)i.invalidateData(Y),Wg(Y)&&Y.getEdgeGroup()&&Y.getEdgeGroup().eachSiblingEdge(i.invalidateData,i);else if(v===Qp){i._21Q(Y);var t=Y._id,c=i._25I[t];if(c){if(i._56I[t]){var T=c._79o();T&&i.redraw(T)}c.dispose(),delete i._25I[t],delete i._24I[t],delete i._56I[t]}Y===i._currentSubGraph&&i.setCurrentSubGraph(N)}else v===Nq&&(i.invalidateAll(!0),i.setCurrentSubGraph(N))},_75O:function(h){this.invalidateData(h.data)},handleHierarchyChange:function(i){this.dm().isHierarchicalRendering()&&i.data.hasChildren()&&this.redraw(),this.invalidateData(i.data)},adjustIndex:function(M){var h=this;if(h.isVisible(M)){h.dm().beginTransaction();for(var H=M;H._parent&&h.isVisible(H._parent);)H=H._parent;H&&H!==M&&h._dataModel.adjustIndex(H),h._dataModel.adjustIndex(M),h.dm().endTransaction()}},getImage:function(p){return p.getImage?p.getImage():s},getSelectWidth:function(X){var $=_c(this.getImage(X));return $&&Cd($.disableSelectedBorder,X,this)?0:X.s("select.width")},getSelectColor:function(U){return U.s("select.color")},isSelectable:function(d,M){if(this.isSelected(d))return!0;if(!M&&d.getParent()instanceof Xh&&this.isSelectable(d.getParent(),!0)&&d.getParent().isSyncSize())return!1;var D=this.getLayersInfo();if(D){var X=D[d._layer];if(X&&X.selectable===!1)return!1}return d.s("2d.selectable")&&this.sm().isSelectable(d)},isMovable:function(N){var $=this;if(Wg(N)&&N.getStyle(Yl)!==zd)return!1;var r=this.getLayersInfo();if(r){var y=r[N._layer];if(y&&y.movable===!1)return!1}return N.s("2d.movable")?$._movableFunc?$._movableFunc(N):!0:!1},isEditable:function(m){var f=this;if(z._uiSerializing)return f._uieditable;if(!f._editInteractor||!f.isSelected(m))return!1;if(tm(m)){var l=f.getDataUI(m);if(!l||l._88I)return!1}if(Wg(m)&&m.getStyle(Yl)!==zd)return!1;var g=this.getLayersInfo();if(g){var e=g[m._layer];if(e&&e.editable===!1)return!1}return m.s("2d.editable")?f._editableFunc?f._editableFunc(m):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(u){return wg(u)&&0!==u.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(u):!0},isRectEditable:function(y){return this._rectEditableFunc?this._rectEditableFunc(y):!0},isAnchorEditable:function(M){return this._anchorEditableFunc?this._anchorEditableFunc(M):!0},isRotationEditable:function(i){return i.setRotation&&i.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(i):!0:!1},getRotationPoint:function(z){var i=z.getAnchor(),X=z.getScale(),U=this._zoom,Q=ig(z.getRotation(),0,-z.getHeight()*X.y*i.y-(X.y<0?-1:1)*(Ab?32:16)/U),W=z.p();return Q.x+=W.x,Q.y+=W.y,Q},getLogicalPoint:function(b){var a=this;return fq(b,a._canvas,a.tx(),a.ty(),a._zoom,a._zoom)},getScreenPoint:function(J,E){var v,e=this;return"object"==typeof J?J.x!==s?(v=J.x,E=J.y):(v=J[0],E=J[1]):v=J,tr(v,E,e._canvas,e.tx(),e.ty(),e._zoom,e._zoom)},getSelectedDataAt:function(e){var F=this;return this.getDataAt(e,function(V){return F.isSelected(V)})},getDataInfoAt:function(H,o,A){var q,x=this.lp(H),C=this.getDataAt(x,o,A);if(C){var v=this.getDataUI(C);q={data:C,ui:v,point:x};var l=v._38o;if(l){var V=l.icons;for(var G in V){var Y=V[G],L=l.rects[G];if(L)for(var Q=Cd(Y.names,C,this),g=Q?Q.length:0,P=L.rotation,z=g-1;z>=0;z--){var t=Q[z],c=L[z];if(Fr(c,x,P))return q.part="icons",q.name=G,q.icon=t,q.rect=c,q.index=z,q.rotation=P,q}}}if(this.isNoteVisible(C)){if(v.note2Info&&Fr(v.note2Info.clickRect,x,N,v.note2Info.scale))return q.part="note2",q;if(v.noteInfo&&Fr(v.noteInfo.clickRect,x,N,v.noteInfo.scale))return q.part="note",q}if(this.isLabelVisible(C)){if(v.label2Info&&Fr(v.label2Info.rect,x,v.label2Info.rotation,v.label2Info.scale))return q.part="label2",q;if(v.labelInfo&&Fr(v.labelInfo.rect,x,v.labelInfo.rotation,v.labelInfo.scale))return q.part="label",q}if(C.isInRect&&C.isInRect(x))return q.part="body",q}return q},getDataAt:function(M,Q,$){M.target&&(M=this.lp(M));var H,G=this._zoom;return this.reverseEach(function(y){return(Q?Q(y):this.isSelectable(y))&&this.rectIntersects(y,pl(M.x,M.y,$,G))?(H=y,!1):void 0},this),H},getIconInfoAt:function(H,g){var x=this;if(H.target&&(H=x.lp(H)),g||(g=x.getDataAt(H)),g){var D=x.getDataUI(g);if(D&&D._38o){var z,o=D._38o,G=new cb;for(z in o.icons)G.add(z);for(var l=G.size()-1;l>=0;l--){z=G.get(l);for(var Z=o.rects[z],t=Z.rotation,$=Z.length-1;$>=0;$--){var _=Z[$],w=_.width,W=_.height,e={x:H.x-_.x-w/2,y:H.y-_.y-W/2};t!=N&&(e=ig(-t,e.x,e.y));var _={x:-w/2,y:-W/2,width:w,height:W};if(Fr(_,e))return{key:z,index:$,name:o.icons[z].names[$],rect:Z[$],point:H,rotation:t,relativeRect:_,relativePoint:e,data:g}}}}}return N},getDatasInRect:function(u,v,i){i===s&&(i=1);var G=this,q=new cb;return G.reverseEach(function(l){i&&!G.isSelectable(l)||(v?G.rectIntersects(l,u):G.rectContains(l,u))&&q.add(l)}),q},moveSelection:function(Y,y){var g=this;g.dm().beginTransaction(),Ld(g.sm().toSelection(g.isMovable,g),Y,y),g.dm().endTransaction()},moveDatas:function(M,l,y){var Z=this;Z.dm().beginTransaction(),M instanceof cb||(M=new cb(M)),Ld(M,l,y),Z.dm().endTransaction()},getDataUIBounds:function(G){var n=this.getDataUI(G);return n?n._79o():N},drawData:function(K,R,l){var r=this.getDataUI(R);if(r){var T=r._79o();(!l||Wr(l,T))&&(r._42(K),R instanceof z.Block&&R.eachChild(function(I){this.drawData(K,I,l)},this))}},getBoundsForGroup:function(I){return I.s(ip)?this.getDataUIBounds(I):N},isPixelPerfect:function(N){return N.s("pixelPerfect")},rectIntersects:function(e,X){this.validate();var j=N;if(this._56I[e._id]){var p=this._25I[e._id];if(p){var a=p._79o();if(mk(X,a))j=!0;else if((X=qd(X,a))&&(p.rectIntersects&&(j=p.rectIntersects(X)),j==N)){if(!this.isPixelPerfect(e))return!0;var m=X.x,D=X.y,Z=X.width,I=X.height,t=this._zoom,q=Q.hitMaxArea,y=Z*I*t*t;if(y>q){var R=Math.sqrt(q/y);t*=R}Z*=t,I*=t,2>Z&&(Z=2),2>I&&(I=2),m*=t,D*=t;var n=Mn(Z,I);lj(n,-m,-D),n.scale(t,t),this._drawForChecking=!0,this.drawData(n,e,X),this._drawForChecking=!1;try{for(var l=0,T=n.getImageData(0,0,Z,I).data;l<T.length;l+=4)if(0!==T[l+3]){j=!0;break}n.restore()}catch(A){Vc=N,j=!1}}}}return j?!0:!1},rectContains:function(U,V){if(this._56I[U._id]){var T=this._25I[U._id];if(T)return mk(V,T._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(U){if(!Q.isInput(U.target)){var f=this,w=f._focusData,Z=w&&f._25I[w._id],R=0,n=f._dataModel._datas;if(!(w&&w._enabled&&w._editable&&Z&&Z.onKeyDown&&Z.onKeyDown(U)===!0))if(9===U.keyCode&&(w&&(R=n.indexOf(w),un(U)?-1===--R&&(R=0):++R===n.size()&&(R=0)),f._focusData=w=n.get(R),f.sm().setSelection(w)),In(U)?f.selectAll():$n(U)&&f.isResettable()&&f.reset(),f.sm().isEmpty()){if(f._editing)return;var $=f.tx(),X=f.ty(),Y=!1,d=un()?100:10;id(U)&&($-=d,Y=!0),Mg(U)&&(X-=d,Y=!0),$q(U)&&($+=d,Y=!0),Yk(U)&&(X+=d,Y=!0),Y&&f.setTranslate($,X)}else{te(U)&&f.handleDelete(U);var H=un()?10:1;id(U)&&(f.moveSelection(-H,0),f.fi({kind:"moveLeft"})),Mg(U)&&(f.moveSelection(0,-H),f.fi({kind:"moveUp"})),$q(U)&&(f.moveSelection(H,0),f.fi({kind:"moveRight"})),Yk(U)&&(f.moveSelection(0,H),f.fi({kind:"moveDown"}))}}},handleScroll:function(M,H){if(dc(M),this.isZoomable()){if(!this.getEditInteractor()){var U=this.getDataAt(M);if(U){var $=_c(this.getImage(U));if($&&Cd($.scrollable,U,this))return}}var p=this.lp(M);H>0?this.scrollZoomIn(p):0>H&&this.scrollZoomOut(p)}},handlePinch:function(H,T,z){this.isZoomable()&&(this._68I||(T>z?this.pinchZoomIn(H):this.pinchZoomOut(H)))},checkDoubleClickOnNote:function(p,$){var i=this,G=i.lp(p),T=i.getDataUI($),z=T.note2Info;return z&&$.s("note2.toggleable")&&Fr(z.clickRect,G)?($.s(zn,!$.s(zn)),i.fi({kind:"toggleNote2",event:p,data:$}),!0):(z=T.noteInfo,z&&$.s("note.toggleable")&&Fr(z.clickRect,G)?($.s(Ac,!$.s(Ac)),i.fi({kind:"toggleNote",event:p,data:$}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(t,P){var k=this,I=k.getAutoScrollZone(),v=I/k.getZoom(),q=I/4,n=k._29I,m=k.lp(t),V={x:k.tx(),y:k.ty()};return m&&I>0&&n&&(m.x-n.x<v?k.translate(q,0):n.x+n.width-m.x<v&&k.translate(-q,0),m.y-n.y<v?k.translate(0,q):n.y+n.height-m.y<v&&k.translate(0,-q)),V.x=k.tx()-V.x,V.y=k.ty()-V.y,P&&(P.x+=V.x,P.y+=V.y),V},getMoveMode:function(N,r){var u=r.s("2d.move.mode");return u?u:Sh["88"]?"x":Sh["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(U,s,A){var Q=this;return"currentSubGraph"===s?{__i:U.getId()}:A.serializeProperty(U,s,Q)},deserializeProperty:function(z,C,m){var e=this;if("currentSubGraph"===C){var R=e.dm(),H=R.__idMap;return H[z.__i]}return m.deserializeProperty(z,C,e)},setDefaultCursor:function(o,$){this._defaultCursor=o,$!==!1&&this.setCursor(o)},setCursor:function(j){"default"===j&&(j=this._defaultCursor||j);var C=this.getView().style;C.cursor=j,C.cursor="-webkit-"+j,C.cursor="-moz-"+j},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(r){return r===N||Q.getConnectAction(null,r)?(this._currentActionType=r,this.redraw(),!0):!1},getEditStyle:function(G){var j=this.getEditInteractor();return j?j.getStyle(G):s},setEditStyle:function(X,T,E){var L=this.getEditInteractor();return L?(L.setStyle(X,T,E),!0):!1},isConnectActionVisible:function(X){var x=Q.getConnectAction(this);if(!x)return!1;var j=x.visible;return Wp(j)&&(j=j(this,X)),j},isInteractive:function(I){var d=_c(this.getImage(I));return d&&Cd(d.interactive,I,this)?!0:I.s("interactive")},appendHTML:function(J,b){var G=this.getView();if(!(b||J&&J.parentNode!==G))return!1;var T=J.getView&&J.getView();if(!b&&T&&T.parentNode===G)return!1;(J.getView||J.isSelfViewEvent)&&(J=J.getView());var C=this.getEditInteractor();return C&&C._canvas?G.insertBefore(J,C._canvas):this.isScrollBarVisible()?G.insertBefore(J,this.getView().lastChild):Mo(G,J),!0},_layoutHTMLImpl:function(X,$,f){if(arguments.length>1){var Q,k=this,l=k._zoom;if($.getView&&(Q=$,$=$.getView()),$.style.position="absolute",f){var H=X.getRect();Zd(Q||$,k.tx()+H.x*l,k.ty()+H.y*l,H.width*l,H.height*l)}else{var i=new vh,H=X.getAnchorRect(),L=X.getPosition(),U=X.getScale(),P=$.style;Zd(Q||$,H),i.appendTranslate(k.tx(),k.ty()),i.appendScale(l,l),i.append(new vh(X.getRotation(),L.x,L.y,U.x,U.y)),fm(P,"transform","matrix("+i.a.toFixed(5)+", "+i.b.toFixed(5)+", "+i.c.toFixed(5)+",\n    "+i.d.toFixed(5)+", "+i.tx.toFixed(5)+", "+i.ty.toFixed(5)+")"),fm(P,"transformOrigin",(-H.x).toFixed(5)+"px "+(-H.y).toFixed(5)+"px"),$._matrixAppend=i.invert().translate(-H.x,-H.y)}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(U){return U instanceof Jk?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(A){var f="state",L=A.s(f);if(L)return L;var x=_c(A._image);return x?Cd(x[f],A,this)||null:void 0}}),W.defineProperties(ep.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(Y){this._layoutHTML=Y}}});var lb=function(m,t){var z=this;z.gv=m,z.s=function(y){return t.getStyle(y)},z._data=t,z._87I=new cb};Jl(lb,W,{_6I:N,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var V=this,C=V.gv.isSelected(V._data);return!C||V.isShadowed()?0:V.gv.getSelectWidth(V._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(O){var B=this._data,y=this.gv.getBodyColor(B);return y?y:O?B.getStyle(O):N},_2Q:function(I){return this.s(I)},_1Q:function(A,X,g,B){var G=this.s,V=G("2d.gray"),Z=G(X+".dash.color");if(V&&(Z=Q.toGrayColor(Z)),A.strokeStyle=Z,A.lineWidth=g,A.stroke(),G(X+".dash.3d")){var W=G(X+".dash.3d.color");Hj(A,Z,V?Q.toGrayColor(W):W,g,this.gv._zoom,G(X+".dash.3d.accuracy"))
}_e(A,B)},invalidate:function(){this._6I=N},_79o:function(){var $=this;if(!$._6I){var D=$._data,f=$.gv;$.labelInfo=$.label2Info=$.noteInfo=$.note2Info=$._38o=N,$._87I.clear(),$.interactiveInfo=f.isInteractive(D)?{}:N,$._3O(),$._55O=f.isEditable(D)?{_42O:f.isRectEditable(D),_43O:f.isPointEditable(D),_56O:f.isRotationEditable(D)}:N,$._6I=$._81o()}return $._6I},_3O:function(){},getPosition:function(){return nj},_68o:function(U,l){U&&this._87I.add(kh(U,l))},_81o:function(){var A=this,M=A.s;A._24O(mb,"getLabel"),A._24O(gm,"getLabel2"),A._26O(wb,"getNote"),A._26O(Fb,"getNote2"),A._15O(),A._55O&&A._48O();var Z;if(A._87I.each(function(F){Z=Db(Z,F)}),Z&&A.isShadowed()){var $=kg(Z);$.x+=M("shadow.offset.x"),$.y+=M("shadow.offset.y"),Jg($,M("shadow.blur")),Z=Db(Z,$)}return A._87I.clear(),Z},_42:function(Q){var D=this,H=D._data,I=D.gv,U=D.s,a=U("opacity"),w=this.isShadowed();if(w){var K=Q.shadowOffsetX,B=Q.shadowOffsetY,A=Q.shadowBlur,J=Q.shadowColor,t=I.getZoom();Q.shadowOffsetX=U("shadow.offset.x")*t,Q.shadowOffsetY=U("shadow.offset.y")*t,Q.shadowBlur=U("shadow.blur")*t,Q.shadowColor=D.getSelectColor()}if(a!=N){var m=Q.globalAlpha;Q.globalAlpha=a}D._80o(Q),I.isLabelVisible(H)&&((!I._drawForChecking||U("label.selectable"))&&Aq(Q,D.labelInfo),(!I._drawForChecking||U("label2.selectable"))&&Aq(Q,D.label2Info)),I.isNoteVisible(H)&&(ek(Q,D.noteInfo),ek(Q,D.note2Info)),D._99O(Q),a!=N&&(Q.globalAlpha=m),w&&(Q.shadowOffsetX=K,Q.shadowOffsetY=B,Q.shadowBlur=A,Q.shadowColor=J)},_80o:function(){},_47O:function(){},_24O:function(X,p){var K=this,U=K._data,u=K.gv,z=K.s,n=u[p](U);if(n!=N){var B=z(X+".scale"),C=z(X+".max"),$=z(X+".position"),O=K[X+"Info"]={label:n,scale:B,color:u[p+"Color"](U),font:z(X+".font"),opacity:z(X+".opacity"),align:z(X+".align"),rotation:K.getRotation(z(X+".rotation"),!1,$),background:u[p+"Background"](U)},P=gl(O,n);C>0&&C<P.width&&(O.labelWidth=P.width,P.width=C),1!==B&&(P.width*=B,P.height*=B);var r=K.getPosition($,z(X+".offset.x"),z(X+".offset.y"),P,z(X+".position.fixed"));if(P.x=r.x-P.width/2,P.y=r.y-P.height/2,K._68o(O.rect=P,O.rotation),1!==B){var Z=P.width/B,M=P.height/B;O.rect={x:r.x-Z/2,y:r.y-M/2,width:Z,height:M}}}},_26O:function(m,G){var W=this,S=W.gv,U=W._data,L=W.s,$=S[G](U);if($!=N){var A,t,u=L(m+".scale"),g=W[m+"Info"]={note:$,scale:u,data:U,view:S,expanded:L(m+".expanded"),font:L(m+".font"),color:L(m+".color"),opacity:L(m+".opacity"),align:L(m+".align"),icon:L(m+".icon"),backgroundImage:L(m+".backgroundImage"),borderWidth:L(m+".border.width"),borderColor:L(m+".border.color"),background:S[G+"Background"](U)},c=W.getPosition(L(m+".position"),L(m+".offset.x"),L(m+".offset.y")),F=c.x,Q=c.y;if(g.expanded){var l,H=L(m+".max"),J=L(m+".backgroundImage");J?(J=_c(J),l={width:Uj(J,U),height:dg(J,U)}):l=gl(g,$),l.width+=6,l.height+=2,H>0&&H<l.width&&(g.labelWidth=l.width,l.width=H),A=l.width,t=l.height+8,g.clickRect={x:F-A*u/2,y:Q-t*u,width:A*u,height:t*u*l.height/t}}else{var Z=L(m+".icon");Z?(Z=_c(Z),A=Uj(Z,U),t=dg(Z,U)):(A=12,t=18),g.clickRect={x:F-A*u/2,y:Q-t*u,width:A*u,height:t*u}}g.rect={x:F-A/2,y:Q-t*u/2-t/2,width:A,height:t};var i=C(g.borderWidth/2)*u;W._68o({x:F-A*u/2-i,y:Q-t*u-i,width:A*u+2*i,height:t*u+2*i})}},_48O:function(){},_99O:function(r){var L=this,E=L._38o;if(E){var n=L.gv,x=L._data,U=E.icons,p=L.interactiveInfo;p&&(p._38o={});for(var X in U){var F=U[X],B=E.rects[X];if(B){p&&(p._38o[X]=[]);var C=Cd(F.opacity,x,n),_=Cd(F.names,x,n),e=_?_.length:0,w=B.rotation;if(C!=N){var T=r.globalAlpha;r.globalAlpha*=C}for(var G=0;e>G;G++){var q=_[G],K=_c(q),M=B[G];if(w){var S=M.x+M.width/2,H=M.y+M.height/2;r.save(),lj(r,S,H),ne(r,w),lj(r,-S,-H)}p&&p._38o[X].push(r.interactiveInfo={compInfos:[],matrix:w?new vh(w,S,H).appendTranslate(-S,-H):new vh}),_n(r,K,Cd(F.stretch,x,n),M.x,M.y,M.width,M.height,L._data,L.gv),r.interactiveInfo=N,w&&r.restore()}C!=N&&(r.globalAlpha=T)}}}}});var Dj=function(c,g){oj(Dj,this,[c,g])};Jl(Dj,lb,{_checkEmptyRect:!0,_40O:function(q,P){var Z=this,s=Z.s,J=q.rect;(q.borderColor=Z.gv.getBorderColor(Z._data))&&(q.borderType=s("border.type"),q.borderWidth=s("border.width"),q.borderPadding=s("border.padding"),P=E(P,q.borderPadding+q.borderWidth/2));var R=Z._data.getScale(),C=E(1,E(c(R.x),c(R.y)));if(q.selectWidth=Z.getSelectWidth()){var h=Z.gv._zoom;q.selectType=s("select.type"),q._97o=Z.getSelectColor(),q.selectPadding=s("select.padding"),P=E(P,(q.selectPadding+q.selectWidth/2/h)/C)}P>0&&(P*=C,J=kg(J),Jg(J,P)),Z._68o(J)},_39O:function(V,r){var K,Z=this,Y=r.rect;if(r.borderWidth>0&&(K=r.borderPadding,V.strokeStyle=r.borderColor,V.lineWidth=r.borderWidth,Wn(V,r.borderType,{x:Y.x-K,y:Y.y-K,width:Y.width+2*K,height:Y.height+2*K}),V.stroke()),r.selectWidth>0){var D=Z.gv._zoom;if(K=r.selectPadding,V.strokeStyle=r._97o,V.lineWidth=r.selectWidth/D,r.rotation!=N){V.save(),V.translate(r.position.x,r.position.y),V.rotate(r.rotation);var F=Z._data,A=F.getWidth(),o=F.getHeight(),x=r.scale,a=r.anchor;Y={x:x.x*-A*a.x,y:x.y*-o*a.y,width:x.x*A,height:x.y*o}}Wn(V,r.selectType,{x:Y.x-K,y:Y.y-K,width:Y.width+2*K,height:Y.height+2*K}),r.rotation!=N&&V.restore(),V.stroke()}},dispose:function(){var n=this,b=n._htmlView;Dj.superClass._3O.call(n),b&&(b.onHTMLRemoved&&b.onHTMLRemoved(),Xr(b))},_3O:function(){var e=this,g=e.s,C=e._data,W=e.gv,B=C.getStyle(Ri),o=e.getBodyColor(),Z=e._83o=B?{shape:B,_53o:e.getBodyColor("shape.background"),_27Q:_c(g("shape.repeat.image"),o),shapeGradientPack:g("shape.gradient.pack"),_54o:g("shape.border.width"),_55o:g("shape.border.color"),_56o:g("shape.border.3d"),_57o:g("shape.border.3d.color"),_58o:g("shape.border.3d.accuracy"),shapeGradient:g("shape.gradient"),_59o:g("shape.gradient.color"),_60o:g("shape.border.pattern"),_61o:g("shape.border.cap"),_62o:g("shape.border.join"),shapeForeground:g("shape.foreground"),bodyColor:o,gray:g("2d.gray")}:{img:_c(W.getImage(C),o),bodyColor:o,gray:g("2d.gray"),stretch:g("image.stretch")};if(T&&!b);else{var D,H=Z.img;H&&H.renderHTML?(e._htmlInfo&&e._htmlInfo.img!==H&&(e._htmlInfo=N),e._htmlInfo||(e._htmlInfo={img:H,cache:{}}),D=H.renderHTML(C,W,e._htmlInfo.cache)):e._htmlInfo=N,e._htmlView&&e._htmlView!==D&&(e._htmlView.onHTMLRemoved&&e._htmlView.onHTMLRemoved(),Xr(e._htmlView.getView?e._htmlView.getView():e._htmlView)),(e._htmlView=D)&&W.appendHTML(D)&&(D.onHTMLAddedSync&&D.onHTMLAddedSync(),D.onHTMLAdded&&no(D.onHTMLAdded)),Z.rect=C.getRect(),Z.position=C.p(),Z.scale=C.getScale(),Z.anchor=C.getAnchor(),Z.rotation=C.getRotation(),B===ah&&(Z._63o=g("shape.depth"));var $=0;if(B)$=Sf(N,Z._54o/2,Z._62o),e.s("shape.dash")&&($=E($,(e.s("shape.dash.width")||Z._54o)/2));else if(H&&H.boundExtend)if($=Cd(H.boundExtend,C,W),H.boundExtendAbsolute){var U=C.getScale();$/=W._zoom*E(1,E(c(U.x),c(U.y)))}else if(!Cd(H.fitSize,C,W)){var p=Cd(H.width,C,W),s=Cd(H.height,C,W);$*=E(C.getWidth()/p,C.getHeight()/s)}e._40O(Z,$);var t=g("clip.percentage");if(1>t&&(0>t&&(t=0),Z.clipRect=Ml(C.getAnchorRect(),g("clip.direction"),t)),B){var O=g("shape.fill.clip.percentage");1>O&&(0>O&&(O=0),Z.shapeClipRect=Ml(C.getAnchorRect(),g("shape.fill.clip.direction"),O));var r=g("shape.foreground.clip.percentage");1>r&&(0>r&&(r=0),Z.shapeForegroundClipRect=Ml(C.getAnchorRect(),g("shape.foreground.clip.direction"),r))}}},getPosition:function(k,g,y,r){var _=el(k,this._83o.rect,r);return _.x+=g,_.y+=y,_},_80o:function(k){var C=this,d=C.s,g=C.gv,l=C._data,F=C._83o,o=F.rect,D=F.position,$=F.rotation,s=F.anchor,S=F.scale,p=F.shape,R=F.clipRect;if(!C._checkEmptyRect||o.width>0&&o.height>0){var P=l.getSize();if(P.x=-P.width*s.x,P.y=-P.height*s.y,k.save(),lj(k,D.x,D.y),ne(k,$),Xl(k,S.x,S.y),R&&(k.beginPath(),k.rect(R.x,R.y,R.width,R.height),k.clip()),g._drawForChecking&&F.img&&Cd(F.img.pixelPerfect,l,g)===!1)Re(k,P.x,P.y,P.width,P.height,"#888888");else if(C.freeDraw)C.freeDraw(k,P,F);else if(p){var t,Z,H,v,e=F._60o,E=cq(k,e),n=F._27Q,q=F._54o,y=F.shapeGradientPack,i=F.gray,U=k.lineJoin,Y=k.lineCap,K=function(I){return i?Q.toGrayColor(I):I};"roundRect"===p?t=d("shape.corner.radius"):"polygon"===p?t=d("shape.polygon.side"):"arc"===p&&(t=d("shape.arc.from"),Z=d("shape.arc.to"),H=d("shape.arc.close"),v=d("shape.arc.oval")),k.lineJoin=F._62o,k.lineCap=F._61o;var z=K(F._53o);if(z||n||y){var w=F.shapeClipRect;w&&(k.save(),k.beginPath(),k.rect(w.x,w.y,w.width,w.height),k.clip()),Wn(k,p,P,t,Z,H,v),y?ld(k,y):n?ed(k,n,K(F.bodyColor),null,l,g):Lp(k,z,F.shapeGradient,K(F._59o),P),k.fill(),w&&k.restore(),y&&k.restore(),k!==E&&Wn(E,p,P,t,Z,H,v)}else Wn(E,p,P,t,Z,H,v);var J=F.shapeForeground;if(J){k.save();var X=F.shapeForegroundClipRect;X&&(k.beginPath(),k.rect(X.x,X.y,X.width,X.height),k.clip()),Wn(k,p,P,t,Z,H,v),Lp(k,J,d("shape.foreground.gradient"),K(d("shape.foreground.gradient.color")),P),k.fill(),k.restore()}if(q>0){var x=d("shape.border.width.absolute");x&&(k.save(),k.setTransform(1,0,0,1,0,0)),k.lineWidth=q;var A=K(F._55o);k.strokeStyle=A,k.stroke(),x&&k.restore(),F._56o&&Hj(k,A,K(F._57o),q,g._zoom,F._58o)}if(_e(k,e),d("shape.dash")){var b=d("shape.dash.width")||q;if(b>0){e=d("shape.dash.pattern");var E=cq(k,e,C._2Q("shape.dash.offset"));E!==k&&Wn(E,p,P,t,Z,H,v),C._1Q(k,"shape",b,e)}}vm(k,z,F._63o,P),k.lineJoin=U,k.lineCap=Y}else{var c=C.interactiveInfo;c&&(k.interactiveInfo=c.bodyInfo={compInfos:[],matrix:new vh($,D.x,D.y,S.x,S.y)}),F.gray&&(k.compGray=!0);var V=F.img;V&&V.cacheRule!=N&&(V=to(k,V,F.stretch,P.width,P.height,l,g,F.bodyColor)),_n(k,V,F.stretch,P.x,P.y,P.width,P.height,l,g,F.bodyColor),k.compGray=!1,k.interactiveInfo=N}k.restore()}C._39O(k,F)},_48O:function(){},_47O:function(){}});var nn=function(J,N){oj(nn,this,[J,N])},fi=function(W,B,A,Q){var I=Df(W,B);return A=Q?h(A,I):Zm(A,I),I?A/=I:A=0,{x:W.x+(B.x-W.x)*A,y:W.y+(B.y-W.y)*A}};Jl(nn,lb,{_3O:function(){var K,o=this,T=o._data,l=o.gv,C=o.s,v=C(Yl),I=T.isLooped(),z=C("edge.width"),p=C("edge.center"),D=C("edge.offset"),Y=l.getBorderColor(T),i=Y?C("border.width"):0,d=o.getSelectWidth(),A=T._40I,F=T._41I,V=o._78o=A&&F?{looped:I,type:v,width:z,center:p,color:o.getBodyColor("edge.color"),borderColor:Y,borderWidth:i,_97o:d?o.getSelectColor():N,selectWidth:d,pattern:C("edge.pattern"),cap:C("edge.cap"),join:C("edge.join"),is3d:C("edge.3d"),_67o:C("edge.3d.color"),_66o:C("edge.3d.accuracy"),gray:C("2d.gray")}:N;if(V){var O=Q.getEdgeType(v);if(O){var G=O(T,Rf(o,l,T,I,v),l,o._19Q);G.points&&G.points.size()>1?(V.edgeTypeInfo=G,K=Mp(V.edgeTypeInfo.points)):G[Di]&&G.rect&&(V.edgeTypeInfo=G,K=G.rect)}else{var W=C("edge.source.anchor.x"),h=C("edge.source.anchor.y"),Z=C("edge.target.anchor.x"),H=C("edge.target.anchor.y"),c=Vh(l,T,"source"),t=Vh(l,T,"target");if(v===zd){var J=V.points=C(Tr)||gb,k=J.size();V.segments=C("edge.segments");var b=W!==s||h!==s||Wg(A),w=Z!==s||H!==s||Wg(F);if(!p)if(D)b||(c=fi(c,k?J.get(0):t,D,k)),w||(t=fi(t,k?J.get(k-1):c,D,k));else{var B;b||(B=Fe(c,k?J.get(0):t,Kn(l,A)),B&&(c={x:B[0],y:B[1]})),w||(B=Fe(k?J.get(k-1):c,t,Kn(l,F)),B&&(t={x:B[0],y:B[1]}))}K=Db(Mp(V.points),Mp(c,t))}else{var L=Rf(o,l,T,I,v);if(o._19Q||(L=-L),I)c=kg(c),c.x=l.getNodeRect(A).x,V.radius=L,K={x:c.x-L,y:c.y-L,width:2*L,height:2*L};else{var S=Df(c,t),n=Zm(D,S),R={x:n,y:L},u={x:S-n,y:L},e=_(t.y-c.y,t.x-c.x),j=V.mat=new Vd(e);if(V.orienAngle=e,V.angle=t.x<c.x?e+f:e,V.rect={x:R.x,y:R.y,width:u.x-R.x,height:0},V.origin=c,R=j.tf(R),R.x+=c.x,R.y+=c.y,u=j.tf(u),u.x+=c.x,u.y+=c.y,p){var P={x:S,y:0};P=j.tf(P),P.x+=c.x,P.y+=c.y,K=Mp([c,R,u,P]),V.c1=c,V.c2=P}else K=Mp(R,u);c=R,t=u}}V.sourcePoint=c,V.targetPoint=t,T._lastSourcePoint=c,T._lastTargetPoint=t}var g=0;C("edge.dash")&&(g=C("edge.dash.width")||z);var $="square"===V.cap?.71:.5;Sf(K,E(g*$,z*$+i+d),V.join),o._68o(K)}},getRotation:function(z,T,q){z=z||0;var U=this._78o;if(U){var G,K=U.angle,Y=U.points,J=U.edgeTypeInfo;if(K!=N)return T?U.orienAngle+z:K+z;if(J&&J[Di])return J.getRotation?J.getRotation(this,z,T,q):0;if(J&&J.points){var L=J.points;return G=L.size(),Ai[q]?G&&0===G%2?xo(L.get(G/2-1),L.get(G/2),T,z):z:Vr[q]?xo(L.get(0),L.get(1),T,z):xo(L.get(G-2),L.get(G-1),T,z)}if(Y)return G=Y.size(),Ai[q]?G&&0===G%2?xo(Y.get(G/2-1),Y.get(G/2),T,z):z:Vr[q]?xo(U.sourcePoint,G?Y.get(0):U.targetPoint,T,z):xo(G?Y.get(G-1):U.sourcePoint,U.targetPoint,T,z)}return z},getPosition:function(p,z,K,c,M){var e=this._78o;if(e){var X,i=e.type,b=e.points,A=e.edgeTypeInfo,s=e.sourcePoint,d=e.targetPoint;if(!i)return e.looped?{x:s.x-e.radius+z,y:s.y+K}:(M&&s&&d&&(s.x>d.x||s.x===d.x&&s.y>d.y)&&(p=Nm[p],K=-K),X=el(p,e.rect,c),X.x+=z,X.y+=K,X=e.mat.tf(X),X.x+=e.origin.x,X.y+=e.origin.y,X);if(A&&A[Di])return A.getPosition?A.getPosition(this,p,z,K,c,M):{x:(s.x+d.x)/2,y:(s.y+d.y)/2};if(b){var X,h=b.size();if(Ai[p]){if(h){var q=h%2;if(0===q)return Xo(b.get(h/2-1),b.get(h/2),p,z,K,c,M);X=b.get((h-q)/2)}else X={x:(s.x+d.x)/2,y:(s.y+d.y)/2};return X=el(p,{x:X.x,y:X.y,width:0,height:0},c),X.x+=z,X.y+=K,X}return Vr[p]?Xo(s,h?b.get(0):d,p,z,K,c,M):Xo(h?b.get(h-1):s,d,p,z,K,c,M)}if(A){var k=A.points,h=k.size();if(Ai[p]){var q=h%2;return 0===q?Xo(k.get(h/2-1),k.get(h/2),p,z,K,c,M):(X=k.get((h-q)/2),X=el(p,{x:X.x,y:X.y,width:0,height:0},c),X.x+=z,X.y+=K,X)}return Vr[p]?Xo(k.get(0),k.get(1),p,z,K,c,M):Xo(k.get(h-2),k.get(h-1),p,z,K,c,M)}}return nj},_42:function(l){this._78o&&nn.superClass._42.call(this,l)},drawPath:function(O,q){O.beginPath();var V=q.type,e=q.points,F=q.segments,n=q.edgeTypeInfo;if(!V||e){var p=q.sourcePoint,f=p.x,r=p.y,X=q.targetPoint,R=X.x,v=X.y;if(V)if(F){var k=new cb({x:f,y:r});k.addAll(e),k.add({x:R,y:v}),eo(O,k,F)}else O.moveTo(f,r),e.each(function(D){O.lineTo(D.x,D.y)}),O.lineTo(R,v);else q.looped?O.arc(f,r,q.radius,0,m,!0):q.center?(O.moveTo(q.c1.x,q.c1.y),O.lineTo(f,r),O.lineTo(R,v),O.lineTo(q.c2.x,q.c2.y)):(O.moveTo(f,r),O.lineTo(R,v))}else n&&(n.points?eo(O,n.points,n.segments):n[Di]&&n[Di](O,n))},_80o:function(W){var h=this,V=h.s,b=h._78o,j=b.width,x=b.selectWidth,M=b.borderWidth,$=W.lineJoin,k=W.lineCap,t=b.gray,S=b.pattern;W.lineJoin=b.join,W.lineCap=b.cap,h.drawPath(cq(W,S),b);var y=V("edge.width.absolute");y&&(W.save(),W.setTransform(1,0,0,1,0,0)),x&&(W.strokeStyle=b._97o,W.lineWidth=j+2*(M+x),W.stroke()),M&&(W.strokeStyle=t?Q.toGrayColor(b.borderColor):b.borderColor,W.lineWidth=j+2*M,W.stroke());var O=t?Q.toGrayColor(b.color):b.color,N=t?Q.toGrayColor(b._67o):b._67o;if(W.strokeStyle=O,W.lineWidth=j,W.stroke(),b.is3d&&Hj(W,O,N,j,h.gv._zoom,b._66o),y&&W.restore(),_e(W,S),V("edge.dash")){S=V("edge.dash.pattern");var q=cq(W,S,h._2Q("edge.dash.offset"));q!==W&&h.drawPath(q,b),h._1Q(W,"edge",V("edge.dash.width")||j,S)}W.lineJoin=$,W.lineCap=k},_48O:function(){},_47O:function(){}});var hk=function(q,u){oj(hk,this,[q,u])};Jl(hk,Dj,{_3O:function(){var E,G,y=this,C=y.s,h=y._data,u=y.gv;if(y._88I=N,h.isExpanded()&&h.eachChild(function(J){if(wg(J)){var m=u.getBoundsForGroup(J);m&&(G||(G=[]),G.push(m),E=Db(E,m))}}),E){var d=u.getLabel(h),n=C("group.type");E=Xj(n,G,E),ns(E,h,"group.padding",1);var j=y._88I={type:n,rect:E,_64o:E};if(!n&&d!=N){var i,T=y.labelInfo={label:d,color:C("group.title.color"),font:C("group.title.font"),align:C("group.title.align")},e=gl(T,d),M=e.width,O=e.height,J=C("group.title.align"),t=C("group.title.orientation");if((t===_m||t===Jr)&&M>E.width?E.width=M:(t===pc||t===hl)&&M>E.height&&(E.height=M),T.rect={y:E.y-O,width:e.width,height:O},i=J===pc?E.x:J===hl?E.x+E.width-M:E.x+E.width/2-M/2,T.rect.x=i,t===Jr)j.titleRect={x:E.x,y:E.y+E.height,width:E.width,height:O},j.rect={x:E.x,y:E.y,width:E.width,height:E.height+O},T.rect={x:i,y:E.y+E.height,width:M,height:O};else if(t===pc){var o=j.titleRect={x:E.x-O,y:E.y,width:O,height:E.height};j.rect={x:E.x-O,y:E.y,width:E.width+O,height:E.height},T.rect={x:o.x+O/2-E.height/2,y:o.y+E.height/2-O/2,width:E.height,height:O},T.rotation=-Math.PI/2}else if(t===hl){var o=j.titleRect={x:E.x+E.width,y:E.y,width:O,height:E.height};j.rect={x:E.x,y:E.y,width:E.width+O,height:E.height},T.rect={x:o.x+O/2-E.height/2,y:o.y+E.height/2-O/2,width:E.height,height:O},T.rotation=Math.PI/2}else j.titleRect={x:E.x,y:E.y-O,width:E.width,height:O+1},j.rect={x:E.x,y:E.y-O,width:E.width,height:E.height+O}}y._40O(j,C("group.border.width")/2)}else hk.superClass._3O.call(y)},getPosition:function(W,k,f,O){var Q=this._88I;if(Q){var T=el(W,Q.rect,O);return T.x+=k,T.y+=f,T}return hk.superClass.getPosition.apply(this,arguments)},_24O:function(m,Y){var K=this._88I;(!K||K.type||"label2"===m)&&hk.superClass._24O.call(this,m,Y)},_80o:function(B){var E=this,K=E._88I;if(K){var U=E._data,O=E.s,T=E.gv,$=K.type,P=K.rect,f=K._64o,x=K.titleRect,t=E.getBodyColor(),D=_c(O("group.image"),t),N=O("group.image.stretch"),S=E.getBodyColor("group.background"),w=_c(O("group.repeat.image"),t),M=O("group.gradient.pack"),A=O("group.gradient"),p=O("group.gradient.color"),o=O("group.border.width"),u=O("group.border.color"),d=O("group.border.pattern"),r=O("group.title.orientation"),Y=O("group.depth");if($){var G=B.lineJoin,m=B.lineCap;if(B.lineJoin=O("group.border.join"),B.lineCap=O("group.border.cap"),D){if(B.save(),Wn(B,$,P),B.clip(),_n(B,D,N,P.x,P.y,P.width,P.height,U,T,t),B.restore(),o>0){var l=cq(B,d);Wn(l,$,P),B.lineWidth=o,B.strokeStyle=u,B.stroke(),_e(B,d)}}else{var l=cq(B,d);S||w||M?(Wn(B,$,P),M?ld(B,M):w?ed(B,w,t,null,U,T):Lp(B,S,A,p,P),B.fill(),M&&B.restore(),B!==l&&Wn(l,$,P)):Wn(l,$,P),o>0&&(B.lineWidth=o,B.strokeStyle=O("group.border.color"),B.stroke()),_e(B,d),$===ah&&vm(B,S,Y,P)}B.lineJoin=G,B.lineCap=m}else{var h=O("group.title.background"),C=O("group.border.radius");if(D)_n(B,D,N,f.x,f.y,f.width,f.height,U,T,E.getBodyColor());else if(S||w)if(w?ed(B,w,t,null,U,T):Lp(B,S,A,p,f),0===o)Wn(B,ah,f),B.fill(),vm(B,S,Y,f);else{switch(B.beginPath(),r){case Jr:rb(B,f.x,f.y,f.width,f.height,C,C,0,0);break;case pc:rb(B,f.x,f.y,f.width,f.height,0,C,0,C);break;case hl:rb(B,f.x,f.y,f.width,f.height,C,0,C,0);break;case _m:rb(B,f.x,f.y,f.width,f.height,0,0,C,C)}B.fill()}if(x&&h)if(0===o)Re(B,x.x,x.y,x.width,x.height,h),vm(B,h,Y,x);else{switch(B.beginPath(),B.fillStyle=h,r){case Jr:rb(B,x.x,x.y,x.width,x.height,0,0,C,C);break;case pc:rb(B,x.x,x.y,x.width,x.height,C,0,C,0);break;case hl:rb(B,x.x,x.y,x.width,x.height,0,C,0,C);break;case _m:rb(B,x.x,x.y,x.width,x.height,C,C,0,0)}B.fill()}if(o>0){var l=cq(B,d);if(Wn(l,"roundRect",P,C),B.lineWidth=o,B.strokeStyle=u,x&&O("group.splitLine")){var W=x.x,Q=x.y,X=x.width,Z=x.height;r===Jr?(B.moveTo(W,Q),B.lineTo(W+X,Q)):r===pc?(B.moveTo(W+X,Q),B.lineTo(W+X,Q+Z)):r===hl?(B.moveTo(W,Q),B.lineTo(W,Q+Z)):(B.moveTo(W,Q+Z),B.lineTo(W+X,Q+Z))}B.stroke(),_e(B,d)}}E._39O(B,K)}else hk.superClass._80o.call(E,B)}});var Td=function(b,M){oj(Td,this,[b,M])};Jl(Td,Dj,{_80o:function(k){this._39O(k,this._83o)}});var jc=function(q,h){oj(jc,this,[q,h])};Jl(jc,Dj,{_3O:function(){var x=this,I=x._data,r=x.s,z=x.gv,P=I.getPoints(),F=z.getBorderColor(I),j=F?r("border.width"):0,L=x.getSelectWidth(),h=r("shape.border.width"),t=I.getRect(),H=I.getAnchorRect(),G=z.getBodyColor(I),m=x._99o=P.isEmpty()?N:{rect:t,rotation:I.getRotation(),fillRule:r("shape.fill.rule"),scale:I.getScale(),position:I.p(),points:P,segments:I.getSegments(),bodyColor:G,borderColor:F,borderWidth:j,_94o:r("shape.border.3d"),_95o:r("shape.border.3d.color"),_96o:r("shape.border.3d.accuracy"),_97o:L?x.getSelectColor():N,selectWidth:L,_53o:r("shape.background"),_27Q:_c(r("shape.repeat.image"),G),shapeGradientPack:r("shape.gradient.pack"),_54o:h,_55o:r("shape.border.color"),shapeGradient:r("shape.gradient"),_59o:r("shape.gradient.color"),_60o:r("shape.border.pattern"),_61o:r("shape.border.cap"),_62o:r("shape.border.join"),shapeForeground:r("shape.foreground"),gray:r("2d.gray")};if(m){H.x+=m.position.x,H.y+=m.position.y,m.gradientRect=H;var R=I.getScale(),C=E(1,E(c(R.x),c(R.y)));r("shape.dash")&&r("shape.dash.width")>h&&(h=r("shape.dash.width"));var b=h*("square"===m._61o?.71:.5)+j+L/x.gv._zoom/C;b&&(b*=C,t=kg(t),Sf(t,b,m._62o)),x._68o(t);var y=r("clip.percentage");1>y&&(0>y&&(y=0),m.clipRect=Ml(I.getAnchorRect(),r("clip.direction"),y));var u=r("shape.fill.clip.percentage");1>u&&(0>u&&(u=0),m.shapeClipRect=Ml(I.getAnchorRect(),r("shape.fill.clip.direction"),u));var o=r("shape.foreground.clip.percentage");1>o&&(0>o&&(o=0),m.shapeForegroundClipRect=Ml(I.getAnchorRect(),r("shape.foreground.clip.direction"),o))}},getPosition:function(z,n,H,G){var i=this._99o;if(i){var U=el(z,i.rect,G);return U.x+=n,U.y+=H,U}return nj},_42:function(e){this._99o&&jc.superClass._42.call(this,e)},_80o:function(R){var N,O=this,V=O.s,g=O._99o,s=g.position,j=g.scale,L=g.rotation,b=g.borderWidth,n=g.selectWidth/O.gv._zoom,o=g._27Q,u=g.shapeGradientPack,U=g._54o,W=g.clipRect,w=g.shapeClipRect,F=g.points,H=g.segments,D=O._data.isClosePath(),$=g.fillRule,q=g.gray,i=function(z){return q?Q.toGrayColor(z):z},G=i(g._53o),x=G||o||u;R.save(),lj(R,s.x,s.y),ne(R,L),Xl(R,j.x,j.y),W&&(R.beginPath(),R.rect(W.x,W.y,W.width,W.height),R.clip()),x&&w&&(R.save(),R.beginPath(),R.rect(w.x,w.y,w.width,w.height),R.clip()),lj(R,-s.x,-s.y);var A=g._60o,K=cq(R,A),c=R.lineJoin,J=R.lineCap;R.lineJoin=g._62o,R.lineCap=g._61o;var B=i(g.bodyColor);x?(eo(R,F,H,D),u?ld(R,u):o?ed(R,o,B,null,O._data,O.gv):(N=B?B:G,Lp(R,N,g.shapeGradient,i(g._59o),g.gradientRect)),R.fill($),w&&(R.restore(),lj(R,-s.x,-s.y)),u&&R.restore(),K!==R&&eo(K,F,H,D)):eo(K,F,H,D);var r=g.shapeForeground;if(r){R.save();var m=g.shapeForegroundClipRect;m&&(lj(R,s.x,s.y),R.beginPath(),R.rect(m.x,m.y,m.width,m.height),R.clip(),lj(R,-s.x,-s.y)),eo(R,F,H,D),Lp(R,r,V("shape.foreground.gradient"),i(V("shape.foreground.gradient.color")),g.gradientRect),R.fill($),R.restore()}var z=V("shape.border.width.absolute");if(z&&(R.save(),R.setTransform(1,0,0,1,0,0)),n&&(R.strokeStyle=g._97o,R.lineWidth=U+2*(b+n),R.stroke()),b&&(R.strokeStyle=i(g.borderColor),R.lineWidth=U+2*b,R.stroke()),U&&(N=i(g._55o),!G&&B&&(N=B),R.strokeStyle=N,R.lineWidth=U,R.stroke(),g._94o&&Hj(R,N,i(g._95o),U,O.gv._zoom,g._96o)),z&&R.restore(),_e(R,A),V("shape.dash")){var l=V("shape.dash.width")||U;if(l>0){A=V("shape.dash.pattern");var K=cq(R,A,O._2Q("shape.dash.offset"));K!==R&&eo(K,F,H,D),O._1Q(R,"shape",l,A)}}R.lineJoin=c,R.lineCap=J,R.restore()},_48O:function(){},_47O:function(){}});var uj=function(x,z){oj(uj,this,[x,z])};Jl(uj,jc,{getRotation:function($,v,I){$=$||0;var Z=this._data.getPoints(),D=Z.size();return D>1?Ai[I]?D&&0===D%2?xo(Z.get(D/2-1),Z.get(D/2),v,$):$:Vr[I]?xo(Z.get(0),Z.get(1),v,$):xo(Z.get(D-2),Z.get(D-1),v,$):$},getPosition:function(j,u,W,V,D){var g=this._data.getPoints(),S=g.size();if(S>1){if(Ai[j]){var n=S%2;if(0===n)return Xo(g.get(S/2-1),g.get(S/2),j,u,W,V,D);var U=g.get((S-n)/2),L={x:U.x,y:U.y,width:0,height:0};return U=el(j,L,V),U.x+=u,U.y+=W,U}return Vr[j]?Xo(g.get(0),g.get(1),j,u,W,V,D):Xo(g.get(S-2),g.get(S-1),j,u,W,V,D)}return nj}});var Tf=function(G,Z){oj(Tf,this,[G,Z])};Jl(Tf,Dj,{_3O:function(){var m=this;Tf.superClass._3O.call(m);var p=m.s,C=m._83o;m._82o=C.img||C.shape?N:{background:m.getBodyColor("grid.background"),depth:p("grid.depth"),rect:C.rect,_88o:p("grid.cell.depth"),cellBorderColor:p("grid.cell.border.color"),_89o:p("grid.row.count"),_90o:p("grid.column.count"),block:p("grid.block"),_91o:p("grid.block.color"),_92o:p("grid.block.padding"),_93o:p("grid.block.width")}},_80o:function(d){var o=this,x=o._82o;if(!x)return Tf.superClass._80o.call(o,d),void 0;var X,K,F=o._data,G=x.background,y=x.rect,S=x.block,T=x._91o,z=x._92o,L=x._93o,Y=x._88o,h=x.cellBorderColor,H=x._89o,i=x._90o;if(G)if(Re(d,y.x,y.y,y.width,y.height,G),vm(d,G,x.depth,y),Y)for(X=0;H>X;X++)for(K=0;i>K;K++)y=F.getCellRect(X,K),y&&vm(d,G,Y,y);else if(h){for(d.beginPath(),X=0;H>X;X++)for(K=0;i>K;K++)y=F.getCellRect(X,K),y&&d.rect(y.x,y.y,y.width,y.height);d.strokeStyle=h,d.lineWidth=1,d.stroke()}if("h"===S)for(X=0;H>X;X++)y=Db(F.getCellRect(X,0),F.getCellRect(X,i-1)),Jg(y,z),Tj(d,T,y.x,y.y,y.width,y.height,L);else if("v"===S)for(K=0;i>K;K++)y=Db(F.getCellRect(0,K),F.getCellRect(H-1,K)),Jg(y,z),Tj(d,T,y.x,y.y,y.width,y.height,L);o._39O(d,o._83o)}});var zq=function(Y,P){oj(zq,this,[Y,P])};Jl(zq,Dj,{_checkEmptyRect:!1,_81o:function(){var m=this._data,u=zq.superClass._81o.call(this),e=m.s("text");if(e!=N){var p,K,g=m.s("text.font"),y=m.s("text.align"),d=m.s("text.vAlign"),T=Tn(g,e),s=T.width,B=T.height,H=m.getAnchor(),I=m.getWidth(),t=m.getHeight();"left"===y?p=-I*H.x:"center"===y?p=-I*H.x+(I-s)/2:"right"===y&&(p=I*(1-H.x)-T.width),"top"===d?K=-t*H.y:"middle"===d?K=-t*H.y+(t-B)/2:"bottom"===d&&(K=t*(1-H.y)-T.height);var x,S=m.getMatrix();if(x=Mp([S.tf(p,K),S.tf(p+s,K),S.tf(p+s,K+B),S.tf(p,K+B)]),u=Db(u,x),u&&m.s("text.shadow")){var Q=kg(u);Q.x+=m.s("text.shadow.offset.x"),Q.y+=m.s("text.shadow.offset.y"),Jg(Q,m.s("text.shadow.blur")),u=Db(u,Q)}}return u}});var sm=ep.Interactor=function(M){this.gv=this._graphView=M};uf("Interactor",W,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(m){this.gv.fi(m)},setCursor:function(J){Ab||this.gv.setCursor(J)},startDragging:function(w){var N=this;N._lastClientPoint=Bb(w),N._lastLogicalPoint=N.gv.lp(w),pp(N,w)},clearDragging:function(){var n=this;n._lastClientPoint=n._lastLogicalPoint=n._logicalPoint=N},autoScroll:function(g){return this.gv.autoScroll(g,this._lastClientPoint)}});var Dh=N,Yg=function(F){Dh.handleWindowTouchMove(F)},oo=function(Y){Dh.handleWindowTouchEnd(Y),V.removeEventListener(hj,Yg,r),V.removeEventListener(Bn,oo,r),Dh=N},qk=function(v){Dh.handleWindowMouseMove(v)},Ei=function(y){Dh.handleWindowMouseUp(y),V.removeEventListener(rd,qk,r),V.removeEventListener(rn,Ei,r),Dh=N},Zg=function(L,m){L!==Dh&&(Dh?Ab?Dh.handleWindowTouchEnd(m):Dh.handleWindowMouseUp(m):Ab?(V.addEventListener(hj,Yg,r),V.addEventListener(Bn,oo,r)):(V.addEventListener(rd,qk,r),V.addEventListener(rn,Ei,r)),Dh=L)},us=function(R){var s=this;s.gv=R,s._is2d=R instanceof ep.GraphView,s._is2d&&(s.filter=function(G){return R.isSelectable(G)&&R.isInteractive(G)}),R.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",Qd].forEach(function(l){s.addListener(l)}),s.initImageResource()};Jl(us,sm,{enableVR:function(H){var R=this;if(!!R._vrEnable!==H)if(R._vrEnable=H,H)R.gv.vr.mp(R.onVRControllerChange,R);else if(R.gv.vr.ump(R.onVRControllerChange,R),R._vrRayPolyline){var E=R.gv.dm();E.remove(R._vrRayPolyline),E.remove(R._vrRayHitPoint),R._vrRayPolyline=s,R._vrRayHitPoint=s}},onVRControllerChange:function(x){var g=this,W=x.property,n=x.newValue,V=g.gv.vr.getController(n.id),o=V.getRay();o&&("gamepad.button.trigger"===W?"down"===n._62O?g.handle_mousedown(o):g.handleWindowMouseUp(o):"gamepad.pose"===W&&(g.handle_mousemove(o),g.handleWindowMouseMove(o)))},drawVRRay:function(X,s,B){var w,c=this,x=c.gv,f=c._vrRayPolyline,b=!1;if(f)w=c._vrRayHitPoint;else{var _=x.dm();c._vrRayPolyline=f=new z.Polyline,c._vrRayHitPoint=w=new z.Node,w.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),w.setAnchor3d(.5,.5,.499);var J=.2/x.vr.measureOflength;w.s3(J,J,J),f.s("intersect",!1),w.s("intersect",!1),_.add(f),_.add(w),b=!0}if(s){var Q=B.world,l=B.worldNormal,r=Q.x,d=Q.y,i=Q.z;f.s("shape.border.color","red"),f.setPoints([{x:X.origin.x,y:X.origin.z,e:X.origin.y},{x:r,y:i,e:d}]),w.s("3d.visible",!0),w.p3(r,d,i),w.lookAtDirection([l.x,l.y,l.z],"front")}else{f.s("shape.border.color","blue");var Y=new z.Math.Vector3;Y.copy(X.direction).setLength(1e3/c.gv.vr.measureOflength).add(X.origin),f.setPoints([{x:X.origin.x,y:X.origin.z,e:X.origin.y},{x:Y.x,y:Y.z,e:Y.y}]),w.s("3d.visible",!1)}x.fi({kind:"vrRayIntersect",ray:X,data:s,intersect:B,polyline:f,hitNode:w,begin:b})},addListener:function(l){var R=this;R.gv.getView().addEventListener(l,function(f){Q.preventDefault(f),R.disabled||R["handle_"+l](f)},r)},handleWindowTouchMove:function(N){this.handleWindowMouseMove(N)},handleWindowMouseMove:function(o){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",o):(this.handleDownInfo("onBeginDrag",o),this.isDragging=!0))},handleWindowTouchEnd:function(C){this.handleWindowMouseUp(C)},handleWindowMouseUp:function(d){if(this.isDragging&&(this.handleDownInfo("onEndDrag",d),this.isDragging=!1),this.downInfo){var $=this.handle("onUp",d);if($&&$.data===this.downInfo.data){this.handleMissingUp(d);var W=this,O=2===d.button?"onContextMenu":"onClick";if(!W._dbclickTimer)return W._dbclickTimer=p(function(){delete W._dbclickTimer,W.handleClick(d,O,$),this.downInfo=N},Q.clickDelay),void 0;I(W._dbclickTimer),delete W._dbclickTimer,O="onDoubleClick",W.handleClick(d,O,$)}else this.handleDownInfo("onUp",d);this.downInfo=N}},handle_mouseleave:function(z){var I=this,_=I.gv,C=I.currentInfo?I.currentInfo.data:N;if(C){C.s("onLeave")&&C.s("onLeave")(z,C,_),I.fire("data","onLeave",z,C);var b=I.currentInfo?I.currentInfo.hits:N;if(b)for(var x in b)I.handleLeave(z,x);I.currentInfo=N}},handle_mousewheel:function(z){z.scrollDelta=z.wheelDelta/40,this.handle("onScroll",z)},handle_DOMMouseScroll:function(t){t.scrollDelta=2===t.axis?-t.detail:0,this.handle("onScroll",t)},handle_touchstart:function(R){this.handle_mousedown(R)},handle_touchmove:function(D){this.handle("onMove",D)},handle_mousedown:function(p){this.isDragging&&(this.handleDownInfo("onEndDrag",p),this.isDragging=!1),this.downInfo=this.handle("onDown",p),this.downInfo&&Zg(this,p)},handle_mousemove:function(f){var g=this,K=g.gv;g._hoverTimer&&(I(g._hoverTimer),delete g._hoverTimer);var m,O,M,T=g.handle("onMove",f),a=this.currentInfo?this.currentInfo.data:N,X=this.currentInfo?this.currentInfo.hits:N;if(T&&(O=T.data,M=T.hits,g._hoverTimer=p(function(){I(g._hoverTimer),delete g._hoverTimer,g.handle("onHover",f,T)},K.getHoverDelay()||Q.hoverDelay)),O!==a){if(a&&(a.s("onLeave")&&a.s("onLeave")(f,a,K),this.fire("data","onLeave",f,a)),O&&(O.s("onEnter")&&O.s("onEnter")(f,O,K),this.fire("data","onEnter",f,O)),X)for(m in X)this.handleLeave(f,m);if(M)for(m in M){var A=M[m];A.target.onEnter&&A.target.onEnter(f,O,K,A.point,A.width,A.height),this.fire(A.type,"onEnter",A.event,A.data,A.image,A.comp,A.point,A)}}else{if(X)for(m in X)M&&M[m]||this.handleLeave(f,m);if(M)for(m in M)if(!X||!X[m]){var A=M[m];A.target.onEnter&&A.target.onEnter(f,O,K,A.point,A.width,A.height),this.fire(A.type,"onEnter",A.event,A.data,A.image,A.comp,A.point,A)}}this.currentInfo=T},handle:function(t,x,F){var $,A=this,d=A.gv;if(A._is2d){if(F=F||d.getDataInfoAt(x,this.filter),!F)return;if($=F.ui.interactiveInfo){var X,Z=F.data;if(Z.s(t)&&Z.s(t)(x,Z,d),this.fire("data",t,x,Z),"body"===F.part&&$.bodyInfo)X="body",F.hits=this.handleImage(X,d.getImage(Z),t,x,Z,F.point,$.bodyInfo);else if("icons"===F.part&&$._38o){var s=$._38o[F.name];s&&s[F.index]&&(X="icons|"+F.name+"|"+F.index,F.hits=this.handleImage(X,F.icon,t,x,Z,F.point,s[F.index]))}}return F}var Z,Y;if(!F)if(x&&x instanceof z.Math.Ray){var h=d.vr.intersectWorld(x);if(Z=h.data,Y=h.intersect,A.drawVRRay(x,Z,Y),!Z)return;var f=d.getData3dUI(Z);if($=f.interactiveInfo,!$)return;F={data:Z,part:Y.part,ui:f}}else{if(F=d.getDataInfoAt(x),!F)return;F&&(F={data:F.data,part:F.part})}if(!Y){Z=F.data;var f=d.getData3dUI(Z);if(F.ui=f,$=f.interactiveInfo,!$)return F;if(Y=d.intersectObject(x,Z),!Y)return}Z.s(t)&&Z.s(t)(x,Z,d),this.fire("data",t,x,Z);var S,N=Y.part;return"body"!==N&&(S=Z.s(N+".image")||Z.s("shape3d."+N+".image")),S||(S=Z.s("all.image")||Z.s("shape3d.image")),$="object"==typeof S?$[S.uuid]:$[S],$&&$.bodyInfo?(F.part="body",F.interactiveInfo=$,F.point=Y.uv.multiply({x:$.bodyInfo.rect.width,y:$.bodyInfo.rect.height}),F.image=S,F.hits=this.handleImage("body",S,t,x,Z,F.point,$.bodyInfo),F):F},_handleLeaveOrMissing:function($,u,G){var V="leave"===$?this.currentInfo:this.downInfo;if(V){var r=V.interactiveInfo||V.ui.interactiveInfo;if(r){var a,A,m=V.data;if(this._is2d){if(A=this.gv.lp(u),"body"===V.part&&r.bodyInfo)a="body","leave"===$?this.handleLeaveImage(G,a,this.gv.getImage(m),u,m,A,r.bodyInfo):this.handleMissingUpImage(a,this.gv.getImage(m),u,m,A,r.bodyInfo);else if("icons"===V.part&&r._38o){var s=r._38o[V.name];s&&s[V.index]&&(a="icons|"+V.name+"|"+V.index,"leave"===$?this.handleLeaveImage(G,a,V.icon,u,m,A,s[V.index]):this.handleMissingUpImage(a,V.icon,u,m,A,s[V.index]))}}else{if(!r.bodyInfo)return;var q=this.gv.intersectObject(u,m);
A=q?q.uv.multiply({x:r.bodyInfo.rect.width,y:r.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===$?this.handleLeaveImage(G,"body",V.image,u,m,A,r.bodyInfo):this.handleMissingUpImage("body",V.image,u,m,A,r.bodyInfo)}}}},handleClick:function(Z,C,s){var A=this,q=this.downInfo;if(q&&s){var i,f=s.interactiveInfo||s.ui.interactiveInfo,o=s.data,y=this.gv;if(o.s(C)&&o.s(C)(Z,o,y),A.fire("data",C,Z,o),f)if(this._is2d){if(q.part===s.part){var N=y.lp(Z);"body"===s.part&&f.bodyInfo&&(i="body",this.handleClickImage(i,y.getImage(o),C,Z,o,N,f.bodyInfo,s))}}else{if(!f.bodyInfo)return;var P=y.intersectObject(Z,o);if(!P)return;N=P.uv.multiply({x:f.bodyInfo.rect.width,y:f.bodyInfo.rect.height}),this.handleClickImage("body",q.image,C,Z,o,N,f.bodyInfo,s)}}},handleDownInfo:function(s,l){if(this.downInfo){var Q=this.downInfo,n=this.gv,y=Q.interactiveInfo||Q.ui.interactiveInfo;if(y){var c,Y=Q.data;if(Y.s(s)&&Y.s(s)(l,Y,n),this.fire("data",s,l,Y),this._is2d){var p=n.lp(l);if("body"===Q.part&&y.bodyInfo)c="body",this.handleDownInfoImage(c,n.getImage(Y),s,l,Y,p,y.bodyInfo);else if("icons"===Q.part&&y._38o){var Z=y._38o[Q.name];Z&&Z[Q.index]&&(c="icons|"+Q.name+"|"+Q.index,this.handleDownInfoImage(c,Q.icon,s,l,Y,p,Z[Q.index]))}}else{if(!y.bodyInfo)return;var x=n.intersectObject(l,Y);if(!x)return;p=x.uv.multiply({x:y.bodyInfo.rect.width,y:y.bodyInfo.rect.height}),this.handleDownInfoImage("body",Q.image,s,l,Y,p,y.bodyInfo)}}}},fire:function(N,A,c,v,X,b,W,T){this.gv.fi({kind:A,type:N,event:c,data:v,image:X,comp:b,view:this.gv,point:W,width:T?T.width:s,height:T?T.height:s})},handleImage:function(O,E,G,f,F,N,K){var e={};if(E&&(E=_c(E))){var R=this.gv,X=K.rect,U=this.convertPoint(N,K);U.inRect&&(E[G]&&E[G](f,F,R,U,X.width,X.height),this.fire("image",G,f,F,E,s,U,X),e[O+"|image"]={target:E,type:"image",image:E,data:F,event:f,point:U,width:X.width,height:X.height});for(var I=K.compInfos,q=E,o=I.length-1;o>=0;o--){var $=I[o],z=$.comp;U=this.convertPoint(N,$,q,z,R,F),U.inRect&&(X=$.rect,z[G]&&z[G](f,F,R,U,X.width,X.height),this.fire("comp",G,f,F,E,z,U,X),(E=X.image)&&(E[G]&&E[G](f,F,R,U,X.width,X.height),this.fire("image",G,f,F,E,s,U,X)),e[O+"|"+o]={target:z,type:"comp",comp:z,image:E,data:F,event:f,point:U,width:X.width,height:X.height},E&&(e[O+"|"+o+"|image"]={target:E,type:"image",image:E,data:F,event:f,point:U,width:X.width,height:X.height}))}}return e},handleLeave:function(r,c){return this._handleLeaveOrMissing("leave",r,c)},handleMissingUp:function(C){return this._handleLeaveOrMissing("missing",C)},handleLeaveImage:function(r,$,y,g,i,h,N){if(y&&(y=_c(y))){var v=this.gv,U=N.rect,x=this.convertPoint(h,N);r===$+"|image"&&(y.onLeave&&y.onLeave(g,i,v,x,U.width,U.height),this.fire("image","onLeave",g,i,y,s,x,U));for(var d=N.compInfos,J=y,X=d.length-1;X>=0;X--){var B=d[X],W=B.comp;x=this.convertPoint(h,B,J,W,v,i),U=B.rect,r===$+"|"+X&&(W.onLeave&&W.onLeave(g,i,v,x,U.width,U.height),this.fire("comp","onLeave",g,i,y,W,x,U)),(y=U.image)&&r===$+"|"+X+"|image"&&(y.onLeave&&y.onLeave(g,i,v,x,U.width,U.height),this.fire("image","onLeave",g,i,y,s,x,U))}}},handleMissingUpImage:function(q,Q,e,o,$,X){var V="onUp",z=this.downInfo.hits;if(z&&Q&&(Q=_c(Q))){var k=this.gv,O=X.rect,n=this.convertPoint($,X);!n.inRect&&z[q+"|image"]&&(Q[V]&&Q[V](e,o,k,n,O.width,O.height),this.fire("image",V,e,o,Q,s,n,O));for(var p=X.compInfos,Z=Q,P=p.length-1;P>=0;P--){var u=p[P],x=u.comp;n=this.convertPoint($,u,Z,x,k,o),n.inRect||(O=u.rect,z[q+"|"+P]&&(x[V]&&x[V](e,o,k,n,O.width,O.height),this.fire("comp",V,e,o,Q,x,n,O)),(Q=O.image)&&z[q+"|"+P+"|image"]&&(Q[V]&&Q[V](e,o,k,n,O.width,O.height),this.fire("image",V,e,o,Q,s,n,O)))}}},handleDownInfoImage:function(T,W,H,n,J,S,O){var q=this.downInfo.hits;if(q&&W&&(W=_c(W))){var t=this.gv,d=O.rect,I=this.convertPoint(S,O);q[T+"|image"]&&(W[H]&&W[H](n,J,t,I,d.width,d.height),this.fire("image",H,n,J,W,s,I,d));for(var $=O.compInfos,h=W,X=$.length-1;X>=0;X--){var k=$[X],F=k.comp;I=this.convertPoint(S,k,h,F,t,J),d=k.rect,q[T+"|"+X]&&(F[H]&&F[H](n,J,t,I,d.width,d.height),this.fire("comp",H,n,J,W,F,I,d)),(W=d.image)&&q[T+"|"+X+"|image"]&&(W[H]&&W[H](n,J,t,I,d.width,d.height),this.fire("image",H,n,J,W,s,I,d))}}},handleClickImage:function(r,Z,A,X,L,$,e,Q){var D=this.downInfo.hits,J=Q.hits;if(D&&Z&&(Z=_c(Z))){var f=this.gv,H=e.rect,M=this.convertPoint($,e);D[r+"|image"]&&(Z[A]&&Z[A](X,L,f,M,H.width,H.height),this.fire("image",A,X,L,Z,s,M,H));for(var R=e.compInfos,m=Z,T=R.length-1;T>=0;T--){var y=R[T],g=y.comp;M=this.convertPoint($,y,m,g,f,L),H=y.rect,D[r+"|"+T]&&J[r+"|"+T]&&(g[A]&&g[A](X,L,f,M,H.width,H.height),this.fire("comp",A,X,L,Z,g,M,H)),(Z=H.image)&&D[r+"|"+T+"|image"]&&(Z[A]&&Z[A](X,L,f,M,H.width,H.height),this.fire("image",A,X,L,Z,s,M,H))}}},initImageResource:function(){Q.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(H,D,C,p,O,W){var r=D.rect,S=D.matrix.applyInverse(H).sub(r),g=S.x>=0&&S.y>=0&&S.x<=r.width&&S.y<=r.height;if(!g)return S;if(p&&Cd(p.pixelPerfect,W,O)){var r,a=1;this._is2d?(a=O.getZoom(),r=pl(H.x,H.y,s,a)):r=pl(H.x,H.y);var i=!1,u=r.x,J=r.y,v=r.width,R=r.height,f=Q.hitMaxArea,B=v*R*a*a;if(B>f){var d=Math.sqrt(f/B);a*=d}v*=a,R*=a,2>v&&(v=2),2>R&&(R=2),u*=a,J*=a;var T=Mn(v,R),K=new vh(0,-u,-J,a,a);K.append(D.matrix),O._drawForChecking=!0,p.transform=K;var P=C.comps;C.comps=[p],Kp(T,C,0,0,v,R,W,self),C.comps=P,delete p.transform,O._drawForChecking=!1;try{for(var q=0,F=T.getImageData(0,0,v,R).data;q<F.length;q+=4)if(0!==F[q+3]){i=!0;break}T.restore()}catch(I){Vc=N,i=!1}S.inRect=i}else S.inRect=!0;return S}});var cr=ep.DefaultInteractor=function(z){oj(cr,this,[z])};uf("DefaultInteractor",sm,{handle_mousedown:function(f){dc(f);var n=this,F=n.gv,h=F.getDataAt(f);if(F.setFocus(f)&&!F._editing&&!F._scrolling){Zh(f)?F.handleDoubleClick(f,h):F.handleClick(f,h);var U=To(f);!$n()&&!U&&h&&(F.isMovable(h)||F.isInteractive(h))||!F.isPannable()||!Gf(f)&&!U||Vi(f)||(n._tx=F.tx(),n._ty=F.ty(),n.startDragging(f))}},handleWindowMouseUp:function(q){var y=this,H=y.gv;H._panning&&(delete H._panning,H.onPanEnded(),y.fi({kind:"endPan",event:q})),delete y._tx,delete y._ty,y.clearDragging()},handle_mousemove:function(h){var b=this,H=b.gv;b._hoverTimer&&(I(b._hoverTimer),delete b._hoverTimer),b._hoverTimer=p(function(){b.fi({kind:"hover",event:h}),I(b._hoverTimer),delete b._hoverTimer},H.getHoverDelay()||Q.hoverDelay)},handle_touchmove:function(x){this.handle_mousemove(x)},handleWindowMouseMove:function(J){var I=this,c=I.gv;I.fi({kind:c._panning?"betweenPan":"beginPan",event:J}),c._panning=1;var W=Wo(c,J,I._lastClientPoint);c.setTranslate(I._tx+W.x,I._ty+W.y)},handle_mousewheel:function(C){this.gv.handleScroll(C,C.wheelDelta)},handle_DOMMouseScroll:function(a){2===a.axis&&this.gv.handleScroll(a,-a.detail)},handle_keydown:function(J){this.gv.handleKeyDown(J)}});var Pi=ep.SelectInteractor=function(Q){oj(Pi,this,[Q])};uf("SelectInteractor",sm,{_42:function(){var D=this,n=D.gv,k=n.getZoom(),H=D.mark,v=D.div;v||(v=D.div=ko(),Mo(D.getView(),v));var x={};x.x=H.x*k+n.tx(),x.y=H.y*k+n.ty(),x.width=H.width*k,x.height=H.height*k,Zd(v,x),this.intersects()?(v.style.border="",v.style.background=n.getRectSelectBackground()):(v.style.background="",v.style.border="1px solid "+n.getRectSelectBorderColor())},handle_mousedown:function(F){var C=this,l=C.gv;if(C._57I=N,C.pendingClickThrough=N,!(l._editing||l._scrolling||$n()||To(F))){var x=l.getDataAt(F),j=l.sm();x?Vi(F)?j.co(x)?j.rs(x):j.as(x):j.co(x)?x instanceof Xh&&x.isClickThroughEnabled()&&Gf(F)&&(C.pendingClickThrough=Bb(F)):j.ss(x):Vi(F)||!l.isPannable()?Gf(F)&&(Vi(F)||j.cs(),l.isRectSelectable()&&(C.startDragging(F),l._77O=1)):Gf(F)&&(C._57I=Bb(F))}},handle_mouseup:function(C){var a=this,v=a.gv,I=a._57I;if(I&&(Df(I,Bb(C))<=1&&v.sm().cs(),a._57I=N),a.pendingClickThrough){if(Df(a.pendingClickThrough,Bb(C))<=1){var P=v.getDataAt(C);if(P instanceof Xh&&P.isClickThroughEnabled()){var n=v.getDataAt(C,function($){var i=$.getParent()===P&&v.isSelectable($,!0);return i});n&&(C.clickThrough=!0,v.sm().ss(n))}}a.pendingClickThrough=N}},handleWindowMouseUp:function(U){this.clear(U)},handleWindowMouseMove:function(r){var o=this,M=o.gv;o._logicalPoint=M.lp(r),o.mark?(o.fi({kind:"betweenRectSelect",event:r}),M.isPannable()&&o.autoScroll(r),o.redraw()):o.fi({kind:"beginRectSelect",event:r}),o.mark=Mp(o._lastLogicalPoint,o._logicalPoint),o.redraw()},intersects:function(){var Y=this,l=Y._lastLogicalPoint,i=Y._logicalPoint;return l.x>i.x||l.y>i.y},clear:function(i){var g=this,Q=g.gv,G=g.mark;if(g._57I=N,g.pendingClickThrough=N,g._lastLogicalPoint){if(G){if(0!==G.width&&0!==G.height){var w=Q.getDatasInRect(G,g.intersects());if(!w.isEmpty()){var c=Q.sm(),y=c.toSelection();w.each(function(U){c.co(U)?y.remove(U):y.add(U)}),c.ss(y)}}Xr(g.div),delete g.div,delete g.mark,g.redraw(),g.fi({kind:"endRectSelect",event:i}),Q.onRectSelectEnded()}g.clearDragging(),delete Q._77O}},redraw:function(){var E=this;E._draw||(E._draw=1,p(function(){E.mark&&E._42(),delete E._draw},16))}});var Iq=ep.MoveInteractor=function(c){oj(Iq,this,[c])};uf("MoveInteractor",sm,{handle_mousedown:function(J){var p=this,e=p.gv;if(Gf(J)&&!e._editing&&!e._scrolling&&!$n()){var G=e.getSelectedDataAt(J);!G||e.isInteractive(G)&&!e.isMovable(G)?e._focusData=N:(p._data=G,e.handleMouseDown&&e.handleMouseDown(J,G),p.startDragging(J),e.isMovable(G)&&(e._moving=1))}},handleWindowMouseUp:function(k){var o=this,I=o.gv;I.handleMouseUp&&I.handleMouseUp(k,o._data),o.clear(k)},handleWindowMouseMove:function(v){var s=this,w=s._data,O=s.gv;if((!O._93O||!O._93O(v,w))&&O._moving){s._logicalPoint||s.fi({kind:"prepareMove",event:v});var R=s._logicalPoint?"betweenMove":"beginMove",S={kind:R,event:v},H=s._logicalPoint=O.lp(v);"beginMove"!==R||s._alreadyBeginTransaction||(s._alreadyBeginTransaction=!0,O.getDataModel().beginTransaction());var b=s._calcShift(R,v),W=b.x,A=b.y,Z=s.gv.getMoveMode(v,w);Z&&("x"===Z?A=0:"y"===Z?W=0:"xy"!==Z&&(W=A=0)),O.moveSelection(W,A),s._lastLogicalPoint=H,s.autoScroll(v),s.fi(S)}},_calcShift:function(){var X=this,Z=X._logicalPoint,L=X._lastLogicalPoint,$=Z.x-L.x,N=Z.y-L.y;return{x:$,y:N}},clear:function(C){var h=this,i=h.gv;h._lastLogicalPoint&&(h._lastLogicalPoint=h._data=i._moving=N,h._logicalPoint&&(h.fi({kind:"endMove",event:C}),i.onMoveEnded()),h.clearDragging()),h._alreadyBeginTransaction&&(h._alreadyBeginTransaction=!1,i.getDataModel().endTransaction())}});var wh=ep.TextEditInteractor=function(f){oj(wh,this,[f]),this.init()};uf("TextEditInteractor",sm,{init:function(){var g=this,H=this.input=t.createElement("input"),V=H.style;H.text="text",V.border="1px solid #d8d8d8",V.position="absolute",V.padding="2px 3px",V.outline="none",V.marginLeft="-90px",V.marginTop="-16px",V.backgroundColor="rgba(255,255,255, 0.9)",V.fontSize="14px",V.width="180px",V.height="32px",V.boxShadow="0 0 13px rgba(16,142,233, 0.5)",V.textAlign="center",V.boxSizing="border-box",H.addEventListener("keyup",function(l){ab(l)&&g.endTextEdit()}),H.addEventListener("focus",function(){H.select()});var o=this.textarea=t.createElement("textarea"),s=this.wrap=t.createElement("div");s.appendChild(o),V=o.style,V.margin=0,V.padding="4px",V.overflow="hidden",V.boxSizing="border-box",V.position="absolute",V.outline="none",V.backgroundColor="transparent",V.resize="none",V.textAlign="center",V.fontSize="14px",V.border="none",V.borderWidth=0,V.width="100%",V.top="50%",V=s.style,V.boxSizing="border-box",V.margin=0,V.padding=0,V.position="absolute",V.boxShadow="0 0 13px rgba(16,142,233, 0.5)",V.border="1px solid #d8d8d8",V.backgroundColor="rgba(255,255,255, 0.9)",V.width="180px",V.marginLeft="-90px",o.addEventListener("keydown",function(U){return(un()||Vi())&&ab(U)?(g.endTextEdit(),void 0):(g.calculateTextareaHeight(String.fromCharCode(U.keyCode)),void 0)}),o.addEventListener("focus",function(){o.select()});var J=function(A){A.stopPropagation()};H.addEventListener("mousedown",J),H.addEventListener("touchstart",J),o.addEventListener("mousedown",J),o.addEventListener("touchstart",J),g.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],g.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",g.handleWindowClick=function(_){var d=g._editingDOM,D=d.getBoundingClientRect(),H=Bb(_);Fr(D,H)||g.endTextEdit()}},handle_mousedown:function(H){var p=this,l=p.gv;if(Zh(H)&&!l._editing){var z=l.getDataAt(H);if(z){var E=l.getTextEditInfo(z);E&&(this._editInfo=E,this._editTarget=z,l._editing=!0,E.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var R=this,o=R.gv,r=R._editTarget,X=R.getTargetValue(),O=R.textarea,z=R.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===X||X===s)&&(X=""),O.value=X,R._editingDOM=O,o.getView().appendChild(z),this.layoutHTML(z,r),this.calculateTextareaHeight(),p(function(){O.focus(),V.addEventListener("mousedown",R.handleWindowClick),V.addEventListener("touchstart",R.handleWindowClick)},10)},handleTextEdit:function(){var y=this,$=y.gv,x=y._editTarget,m=y.getTargetValue(),e=y.input;(null===m||m===s)&&(m=""),e.value=m,y._editingDOM=e,$.getView().appendChild(e),this.layoutHTML(e,x),p(function(){e.focus(),V.addEventListener("mousedown",y.handleWindowClick),V.addEventListener("touchstart",y.handleWindowClick)},10)},layoutHTML:function(w,x){var $=this.gv,F=$.getZoom();if(x instanceof z.Node){var S=x.getRect();w.style.left=(S.x+S.width/2)*F+$.tx()+"px",w.style.top=(S.y+S.height/2)*F+$.ty()+"px"}else if(x instanceof z.Edge){var I=$.getDataUI(x),S=I._6I;w.style.left=(S.x+S.width/2)*F+$.tx()+"px",w.style.top=(S.y+S.height/2)*F+$.ty()+"px"}},endTextEdit:function(){var O=this,P=O._editInfo.isMultiline?O.wrap:O.input,J=O._editInfo.isMultiline?O.textarea:O.input;O.setTargetValue(J.value),O.gv.getView().removeChild(P),O.gv._editing=!1,delete O._editingDOM,V.removeEventListener("mousedown",O.handleWindowClick),V.removeEventListener("touchstart",O.handleWindowClick)},setTargetValue:function(U){var O=this,r=O._editTarget,h=O._editInfo,q=h.accessType,N=h.name;if(N&&q||(q="p",N="name"),"p"===q){var J=z.Default.setter(N);r[J](U)}else"a"===q?r.a(N,U):r.s(N,U)},getTargetValue:function(){var K=this,U=K._editTarget,N=K._editInfo,i=N.accessType,j=N.name;if(j&&i||(i="p",j="name"),"p"===i){var v=z.Default.getter(j);return U[v]()}return"a"===i?U.a(j):U.s(j)},createHiddenTextarea:function(){this.hiddenTextarea=t.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(h,m){if(m&&this.computedStyleCache)return this.computedStyleCache;var B=this,$=V.getComputedStyle(h),M=$.getPropertyValue("box-sizing")||$.getPropertyValue("-moz-box-sizing")||$.getPropertyValue("-webkit-box-sizing"),s=parseFloat($.getPropertyValue("padding-bottom"))+parseFloat($.getPropertyValue("padding-top")),d=parseFloat($.getPropertyValue("border-bottom-width"))+parseFloat($.getPropertyValue("border-top-width")),T=B.SIZING_STYLE.map(function(O){return O+":"+$.getPropertyValue(O)}).join(";"),P={sizingStyle:T,paddingSize:s,borderSize:d,boxSizing:M};return m&&(this.computedStyleCache=P),P},calculateTextareaHeight:function(l){l=l||"";var h=this,n=h.textarea,F=h.hiddenTextarea,E=h.wrap,m=32,N=h.calculateHTMLStyle(n,!1),D=N.paddingSize,G=N.borderSize,b=N.boxSizing,R=N.sizingStyle;F.setAttribute("style",R+";"+h.HIDDEN_TEXTAREA_STYLE),F.value=n.value+l;var H=F.scrollHeight;"border-box"===b?H+=G:"content-box"===b&&(H-=D),n.style.height=H+"px",n.style.marginTop=0-.5*H+"px",E.style.height=Math.max(H,m)+"px",E.style.marginTop=H*-.5+"px"}});var di=ep.ScrollBarInteractor=function(h){oj(di,this,[h])};uf("ScrollBarInteractor",sm,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(p){var Z=this.gv.getViewRect();return this._41o()&&(Z.x+Z.width-this.gv.lp(p).x)*this.gv.getZoom()<ag},isH:function(w){var Y=this.gv.getViewRect();return this._40o()&&(Y.y+Y.height-this.gv.lp(w).y)*this.gv.getZoom()<ag},handle_mousemove:function(j){this.handle_touchmove(j)},handle_touchmove:function(i){if(!Xe&&Gf(i)&&this.gv.isScrollBarVisible()){var h=this,g=h.isV(i),k=h.isH(i);(g||k)&&h.gv.showScrollBar(),h.gv._scrolling=g||k}},handleWindowMouseUp:function(T){this.handleWindowTouchEnd(T)},handleWindowTouchEnd:function(q){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=N,this.fi({kind:"endScroll",event:q})},handle_mousedown:function(B){this.handle_touchstart(B)},handle_touchstart:function(C){var V=this;if(V.gv.setFocus(C),dc(C),V.handle_touchmove(C),!(qh(C)>1)&&V.gv._scrolling&&V.gv.isScrollBarVisible()){V._cp=Bb(C),V._tx=V.gv.tx(),V._ty=V.gv.ty();var p=V.isV(C);V._state=p?"vScroll":"hScroll",pp(V,C),V.fi({kind:"beginScroll",event:C})}},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(c){var J=Bb(c),Z=this.gv.getViewRect(),$=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-J.y)*$.height/Z.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-J.x)*$.width/Z.width),this.fi({kind:"betweenScroll",event:c})}});var xd=ep.TouchInteractor=function(j,r){r=r||{},r.selectable===s&&(r.selectable=!0),r.movable===s&&(r.movable=!0),r.pannable===s&&(r.pannable=!0),r.pinchable===s&&(r.pinchable=!0),r.editable===s&&(r.editable=!0),this.params=r,oj(xd,this,[j])};uf("TouchInteractor",sm,{ms_edit:1,setUp:function(){var m=this;xd.superClass.setUp.call(m),Ab&&m.params.editable&&m.gv.setEditInteractor(m)},tearDown:function(){var C=this;xd.superClass.tearDown.call(C),Ab&&C.params.editable&&C.gv.setEditInteractor(N)},clear:function(H){var R=this,u=R.gv;u._moving&&(R.fi({kind:"endMove",event:H}),delete u._moving,u.onMoveEnded(),u.dm().endTransaction()),u._panning&&(R.fi({kind:"endPan",event:H}),delete u._panning,u.onPanEnded()),u._pinching&&(R.fi({kind:"endPinch",event:H}),delete u._pinching,u.onPinchEnded()),u._editing&&(R._46O(H),R._77I=R._node=R._edge=R._shape=R._rect=R._89I=R._index=u._editing=N),R._moving=R._panning=R._pinching=R._editing=R._57I=R._data=R._beginHistory=N,R.clearDragging()},handle_touchstart:function(o){var H=this;if(!H.gv._editing){dc(o),H._57I=N;var B=H.params,w=H.gv,W=w.sm(),z=w.getDataAt(o),x=qh(o);if(1===x){if(Zh(o))return w.handleDoubleClick(o,z),void 0;w.handleClick(o,z),z&&(w.handleMouseDown&&w.handleMouseDown(o,z),H._data=z),B.selectable||(z=N),z?(W.co(z)||W.ss(z),B.editable&&w.isEditable(z)&&H._79I(o,z,!0)?(H._editing=1,H.startDragging(o)):B.movable&&w.isMovable(z)&&(H._moving=1,H.startDragging(o))):(H._57I=Bb(o),B.pannable&&w.isPannable()&&(H._panning=1,H.startDragging(o),H._translate={x:w.tx(),y:w.ty()}))}else if(B.pinchable&&2===x){H._pinching=1,H.startDragging(o);var a=w.getView(),g=w.getZoom(),R=a.getBoundingClientRect(),U=o.touches[0],V=o.touches[1],e={x:(U.clientX+V.clientX)/2-R.left,y:(U.clientY+V.clientY)/2-R.top};e.x-=w.tx(),e.y-=w.ty(),e.x/=g,e.y/=g,H._p=e,H._d=Pk(o)}}},handle_touchend:function(M){var D=this,X=D.gv,B=D._57I,_=D._data;B&&(Df(B,Bb(M))<=1&&X.sm().cs(),D._57I=N),_&&X.handleMouseUp&&X.handleMouseUp(M,_)},handleWindowTouchEnd:function(z){this.clear(z)},handleWindowTouchMove:function(g){var Z=this,U=Z.gv,A=qh(g);if(1===A){if(Z._editing&&(Z._beginHistory||(Z._beginHistory=1,U.dm().beginTransaction()),U._editing=1,Z._78I(g)),Z._moving)Z._beginHistory||(Z._beginHistory=1,U.dm().beginTransaction()),Z.handleMove(g);else if(Z._panning){var B=Bb(g),P=Wo(U,B,Z._lastClientPoint);U.setTranslate(Z._translate.x+P.x,Z._translate.y+P.y),Z.fi({kind:U._panning?"betweenPan":"beginPan",event:g}),U._panning=1}}else if(2===A&&Z._pinching){var n=Pk(g);U.handlePinch(Z._p,n,Z._d),Z._d=n,Z.fi({kind:U._pinching?"betweenPinch":"beginPinch",event:g}),U._pinching=1}},handleMove:function(j){var $=this,y=$.gv,M=y.lp(j);y._93O&&y._93O(j,$._data)||(y.moveSelection(M.x-$._lastLogicalPoint.x,M.y-$._lastLogicalPoint.y),$._lastLogicalPoint=M,$.autoScroll(j),$.fi({kind:y._moving?"betweenMove":"beginMove",event:j}),y._moving=1)}});var z=V.ht,li=z.graph._editor={Math:z.Math,Guide:{}};li.getStyle=function(C){var c,W=li.StyleMap;return W&&(c=W[C],c!==s)?c:li.DefaultStyleMap[C]},li.setStyle=function(_,i){var M=li.StyleMap;M||(M=li.StyleMap={}),M[_]=i},li.inEdit=function(i){return i._inXEdit===!0},li.startEdit=function(q){q._inXEdit=!0,li.Inject.doInject(q)},li._46O=function(U){U._inXEdit=!1,li.Inject.undoInject(U)},li.toScreenPosition=function(y,L){var F=y.tx(),e=y.ty(),Y=y._zoom;return new li.Math.Vector2(L.x*Y+F,L.y*Y+e)},li.checkHit=function(o,g,J){return o.distanceTo(g)<J?!0:!1},li.toWorldPosition=function(y,x){var d=y.tx(),R=y.ty(),r=y._zoom;return{x:(x.x-d)/r,y:(x.y-R)/r}},li.setAntialias=function(y,A){for(var G,x=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],L=0,M=x.length;M>L&&(G=x[L],!(G in y));L++);y[G],y[G]=A},li.getTargetCornersOnScreen=function(I,S){if(!S)return null;var y,N=[];if(Bg(S,I)){var C=Kn(I,S);y=[{x:C.x,y:C.y},{x:C.x+C.width,y:C.y},{x:C.x+C.width,y:C.y+C.height},{x:C.x,y:C.y+C.height}]}else{if(!S.getCorners)return null;y=S.getCorners()}return y.forEach(function(U){var Y=li.toScreenPosition(I,U);N.push(Y.x,Y.y)}),N},li.log=function(){};var Rq=li.Inject={_modules:[]};Rq.registAsModule=function(l,S){var U={},r={};for(var H in l){var q=S.prototype[H];U[H]=q}l.getBackup=function(P){return U[P]},l.getBackups=function(){return U},r.doInject=function(){for(var s in l)"getBackup"!==s&&(S.prototype[s]=l[s])},r.undoInject=function(){for(var w in l)"getBackup"!==w&&(S.prototype[w]=U[w])},Rq._modules.push(r)},Rq.doInject=function(Q){for(var k,S=Rq._modules,y=0,q=S.length;q>y;y++)k=S[y],k.doInject(Q)},Rq.undoInject=function(q){for(var f,v=Rq._modules,c=0,n=v.length;n>c;c++)f=v[c],f.undoInject(q)};var sm=z.graph.EditInteractor=function(Q){var H=this,s=t.createElement("canvas");s.className="editCanvas",s.style.position="absolute",H._styleMap={},H._canvas=s,H._context=s.getContext("2d"),sm.superClass.constructor.call(H,Q),li.setAntialias(H._context,!1),H._subModules=[new li.Anchor(H),new li.RotateX(H),new li.MoveDummy(H),new li.Rect(H),new li.Curve(H),new li.MoveHelper(H)],H._gridGuide=new li.Guide.Grid(H),H._rectGuide=new li.Guide.Rect(H),H._hoverGuide=new li.Guide.Hover(H)},kd=sm;z.Default.def(sm,z.graph.Interactor,{ms_edit:1,ms_fire:1}),W.defineProperties(sm.prototype,{editDetail:{get:function(){var T=!!this._editDetail;return T},set:function(I){var c=this,S=c._editDetail;S!==I&&(c._editDetail=I,c.gv._editing=I,c.fp("editDetail",S,I),c.fp("pointsEditingMode",S,I),c.fi({kind:I?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(r){(!this._editDetail||r)&&(this.gv._editing=r,r||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(I){this._editing=I,this.gvEditing=I}},pointsEditingMode:{get:function(){return this.editDetail},set:function(Y){var q=this;q.editDetail!==Y&&(Y?q._tryEnterEditDetailMode():q._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var O=this._gridEnabled;if(!O)return!1;var y=this.gv;return y?!0:!0},set:function(r){r!==this._gridEnabled&&(this._gridEnabled=r,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(D){D!==this._agEnabled&&(this._agEnabled=D,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),sm.prototype.getSubModule=function(e){var I,h,Z,M=this._subModules;for(h=0,Z=M.length;Z>h;h++)if(I=M[h],I.catalog===e)return I},sm.prototype.invokeSubModule=function(F,L){var a=this,H=a._subModules;if(H)for(var m,W,w,n=Array.prototype.slice.call(arguments,2),y=0,q=H.length;q>y;y++)if(m=H[y],W=m[F],W&&(w=W.apply(m,n),w!=s&&L))return m},sm.prototype.invokeSubModuleInverse=function(Y,k){var T=this,v=T._subModules;if(v)for(var Q,c,b,V=Array.prototype.slice.call(arguments,2),D=v.length-1;D>=0;D--)if(Q=v[D],c=Q[Y],c&&(b=c.apply(Q,V),b!=s&&k))return Q},sm.prototype.setUp=function(){li.log("setUp");var e=this,M=e.gv,P=M.getView(),L=e._canvas;sm.superClass.setUp.call(e),M.setEditInteractor(e),M._79O?P.insertBefore(L,M._79O):P.appendChild(L),li.startEdit(M),e.invokeSubModule("setUp"),M.dm().mm(e._onDataModelChanged,e),M.dm().md(e._onDataPropertyChanged,e)},sm.prototype.tearDown=function(){li.log("tearDown");var w=this,e=w.gv,T=e.getView();w._resetCustomCursorStyle(),sm.superClass.tearDown.call(w),e.dm().umm(w._onDataModelChanged,w),e.dm().umd(w._onDataPropertyChanged,w),e.setEditInteractor(null),T.removeChild(w._canvas),w._drawTimer&&(I(w._drawTimer),w._drawTimer=null),li._46O(e),w.invokeSubModule("tearDown")},sm.prototype._onDataModelChanged=function(M){var r=this;("clear"===M.kind||"remove"===M.kind&&r.editDetail&&M.data===r.getSubModule("Curve").target)&&(r.editDetail=!1,r._42())},sm.prototype._onDataPropertyChanged=function(p){var M=this;if(M.editDetail){var z=M.getSubModule("Curve"),W=p.data;W===z.target&&(W._writing||z._handleDataChanged(p))}},sm.prototype.clear=function(){li.log("clear")},sm.prototype.redraw=function(){this._42()},sm.prototype._42=function(){var V=this;V._drawTimer||(V._drawTimer=p(function(){V._drawTimer=null,V.drawImpl()},0))},sm.prototype.drawImpl=function(){var E;for(E in{_42:!0})break;return function(){var J=this,K=J._canvas,w=J.gv,v=w.getWidth(),$=w.getHeight(),S=J._context,e=z.Default.getInternal(),b=V.devicePixelRatio;(K.width!==v||K.height!==$)&&e.setCanvas(K,v,$,b),S.clearRect(0,0,K.width,K.height);var x=J._getValidSelection();S.save(),S.scale(b,b),J._gridGuide._42(),J.invokeSubModuleInverse(E,!1,S,w,x),J._rectGuide._42(),J._hoverGuide._42(),S.restore()}}(),sm.prototype._getValidSelection=function(){var x=this,S=x.gv,V=S.sm().getSelection(),j=[];return V.each(function(Z){S.isVisible(Z)&&S.isEditable(Z)&&j.push(Z)}),j},sm.prototype.handle_touchmove=function(r){return this.handle_mousemove(r)},sm.prototype.handle_mousemove=function(I){if(!z.Default.isDragging()){var R=this;if(R.editDetail||!$n()&&!To(I))if(R.gvEditing=!1,R._checkEdit(I))R.gvEditing=!0;else{if(!R.getStyle("hoverGuideEnabled"))return;R.hoverData=R.gv.getDataAt(I),R._42()}}},sm.prototype.handle_touchstart=function(x){return this.handle_mousedown(x)},sm.prototype.handle_mousedown=function(k){dc(k);var I=this;if(I.editDetail||!$n()&&!To(k)){if(Zh(k)&&!k.clickThrough){if(I.editDetail){if(I._tryQuitEditDetailMode(k))return}else if(I._tryEnterEditDetailMode())return;I.gv.dm().beginTransaction();var i=I.invokeSubModule("handleDoubleClick",!0,k);if(I.gv.dm().endTransaction(),i)return}var L=I._checkEdit(k);L&&(I._downPosition=I._getLogicalPoint(k),I.gv.dm().beginTransaction(),L.startEdit(I,k),I.editing=!0)}},sm.prototype._checkEdit=function(J){var r=this,V=r.gv,p=r._getLogicalPoint(J),E=r.invokeSubModule("check",!0,V,J,p)||null;return r._editMod=E,E},sm.prototype.handleWindowTouchMove=function(U){return this.handleWindowMouseMove(U)},sm.prototype.handleWindowMouseMove=function(K){var s=this,p=s._downPosition;if(p){var t=s._getLogicalPoint(K);if(t.distanceTo(p)<s.getStyle("moveSensitivity"))return;delete s._downPosition}var X=s._editMod;X&&X.handleEdit(s.gv,K)},sm.prototype._getLogicalPoint=function(M){var k=this,S=z.Default.getLogicalPoint(M,k._canvas);return new li.Math.Vector2(S)},sm.prototype.handleWindowTouchEnd=function(Z){return this.handleWindowMouseUp(Z)},sm.prototype.handleWindowMouseUp=function(){var m;for(m in{_46O:!0})break;return function(G){var B=this;B.editing=!1,B.setCursor("default"),B.invokeSubModule(m,!1,G),B._42(),B.gv.dm().endTransaction()}}(),sm.prototype.handle_mousewheel=function(o){var V=this;dc(o),V.invokeSubModule("preHandleScroll",!0)||V.gv.handleScroll(o,o.wheelDelta)},sm.prototype.handleDelete=function(){var B=this;if(!B.editDetail){B.gv.dm().beginTransaction();var t=B.invokeSubModule("handleNormalStateDelete",!0);return B.gv.dm().endTransaction(),t||B.gv.removeSelection(),void 0}B.gv.dm().beginTransaction(),B.invokeSubModule("handleDelete",!0),B.gv.dm().endTransaction(),B._42()},sm.prototype.handle_keydown=function(S){var A=this;if((S.metaKey||S.ctrlKey)&&A._42(),$n(S)&&!A.editing)return A.gvEditing=!1,A.setCursor("default"),A._42(),void 0;var o=ab(S);return A.editDetail?((o||$i(S))&&(A.editDetail=!1,A._42()),A.gv.dm().beginTransaction(),A.invokeSubModule("handle_keydown",!0,S),A.gv.dm().endTransaction(),void 0):(A.gv.dm().beginTransaction(),A.invokeSubModule("handleNormalStateKeyDown",!0,S),A.gv.dm().endTransaction(),o&&A._tryEnterEditDetailMode(),void 0)},sm.prototype.handle_keyup=function($){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,$),this.gv.dm().endTransaction()},sm.prototype._tryEnterEditDetailMode=function(){var _=this;return!_.editDetail&&_.invokeSubModule("canEnterEditDetailMode",!0)&&1===_._getValidSelection().length?(_.editDetail=!0,_._42(),!0):void 0},sm.prototype._tryQuitEditDetailMode=function(G){var n=this;return n.editDetail?!G||n.invokeSubModule("canQuitEditDetailMode",!0,G)?(n.editDetail=!1,n._42(),!0):!1:!1},sm.prototype.setStyle=function(X,r,I){var e=this;I?li.setStyle(X,r):e._styleMap[X]=r,"baseColor"===X&&(ze=r),e.fp("styleChanged",null,{key:X,value:r,base:I}),e._42()},sm.prototype.getStyle=function(D){var r=this,N=r._styleMap[D];return N!==s?N:li.getStyle(D)},sm.prototype.setCursor=function(W){this._resetCustomCursorStyle(),z.graph.EditInteractor.superClass.setCursor.call(this,W)},sm.prototype._resetCustomCursorStyle=function(){var t=this;if(t._customStyle){var B=this.gv.getView();B.classList&&B.classList.remove&&B.classList.remove(t._customStyle),t._customStyle=null}},sm.prototype._setRotateCursor=function(x){var V=this,o=V._cursorFactory;o||(o=V._cursorFactory=new li.CursorFactory(V));var n=o.getRotateCursor(x),c=V.gv.getView();V._resetCustomCursorStyle(),V._customStyle=n,c.classList&&c.classList.add&&c.classList.add(n)};var $o=li.Group=function(m){var T=this;T._entities=m,T._64O=0,T._position={x:0,y:0},T._scale={x:1,y:1},T._anchor={x:.5,y:.5},T._anchor2={x:.5,y:.5}};$o.prototype={},$o.prototype.constructor=$o;var Lf=null;$o.findOrCreateGroup=function(V){if(Lf&&Lf.checkIsMe(V))return Lf;var w=new li.Group(V);return w.getKeyOb()?(Lf=w,w):void 0},$o.prototype.checkIsMe=function(N){var y=this._entities;if(y.length!==N.length)return!1;var V,q={},S=N.length;for(V=0;S>V;V++)q[N[V]._id]=!0;for(V=0;S>V;V++)if(!q[y[V]._id])return!1;return!0},$o.prototype.getRotation=function(){return this._64O},$o.prototype.getPosition=function(){return this._position},$o.prototype.getAnchor=function(){return this._anchor},$o.prototype.getWidth=function(){return this._width},$o.prototype.getScale=function(){return this._scale},$o.prototype.getSize=function(){return{width:this._width,height:this._height}},$o.prototype.getHeight=function(){return this._height},$o.prototype.getKeyOb=function(){for(var u=this._entities,p=u.length-1;p>=0;p--){var G=u[p];if(this.isNode(G))return G}},$o.prototype.getAnchor2=function(){var t=this,W=t.rotateCenter;if(W)return W;var f=t.getKeyOb();if(!f)return t._anchor;var g=t._anchor2,N=f.getMatrix();return N.tf({x:f.getWidth()*(g.x-f.getAnchor().x),y:f.getHeight()*(g.y-f.getAnchor().y)})},$o.prototype.setAnchor2=function(w,R){var H=this,U=H.getKeyOb();if(U){var r,Q=U.getMatrix();r="number"==typeof w?{x:w,y:R}:w;
var A=Q.tfi(r);H._anchor2={x:U.getAnchor().x+A.x/U.getWidth(),y:U.getAnchor().y+A.y/U.getHeight()}}},$o.prototype.setRotation=function(){},$o.prototype.beginRotate=function(r){this.rotateCenter=r.pos,this.rotateMode=r.groupRotateMode},$o.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},$o.prototype.addRotation=function(T,X){return"batch"===X?this._addRotationInBatchMode(T):"block"===X?this._addRotationInBlockMode(T):void 0},$o.prototype._addRotationInBlockMode=function(H){var I=this,M=I.rotateCenter||I.getPosition();I._entities.forEach(function($){if(I.isNode($)){var O=$.getMatrix();O.translate(-M.x,-M.y),O.rotate(H),O.translate(M.x,M.y);var g=Math.sign($.getScale().x);$.setRotation(_(O.b*g,O.a*g)),$.setPosition(O.tx,O.ty)}})},$o.prototype._addRotationInBatchMode=function(O){var U=this,S=U._anchor2;U._entities.forEach(function(Q){if(U.isNode(Q)){var w=Q.getAnchor(),a=Q.getMatrix(),L=a.tf({x:Q.getWidth()*(S.x-w.x),y:Q.getHeight()*(S.y-w.y)}),H=new li.Math.Matrix2d;H.set(a.a,a.b,a.c,a.d,a.tx,a.ty),H.translate(-L.x,-L.y),H.rotate(O),H.translate(L.x,L.y);var F=Math.sign(Q.getScale().x);Q.setRotation(_(H.b*F,H.a*F)),Q.setPosition(H.tx,H.ty)}})},$o.prototype.setPosition=function(K){var C,r,G,Q,l=this,o=l._position,S=K.x-o.x,x=K.y-o.y,U=l._entities;for(r=0,G=U.length;G>r;r++)C=U[r],wg(C)&&(Q=C.getPosition(),C.setPosition(Q.x+S,Q.y+x));l._position=K},$o.prototype.setScale=function(a,K){var f=this,$=a/f._scale.x,Y=K/f._scale.y;f._adjustChildScaleOrSize($,Y,"size"),f._scale={x:a,y:K}},$o.prototype.getRect=function(){var q=this,r=q._position,M=q._width,C=q._height;return{x:r.x-M/2,y:r.y-C/2,width:M,height:C}},$o.prototype.setSize=function(W,E){var B=this,W=Math.max(1,W),E=Math.max(1,E),$=W/B._width,A=E/B._height;B._adjustChildScaleOrSize($,A,"size"),B._width=W,B._height=E},$o.prototype._adjustChildScaleOrSize=function(x,s,m){var h,t,Y,R,S,c,L,G,I,k,D,u,i,N,j=this,O=j._position,z=j._entities,p=new li.Math.Matrix2d;for(t=0,Y=z.length;Y>t;t++)if(h=z[t],j.isNode(h)){if(R=h.getPosition(),S=h.getRotation(),c=h.getWidth(),L=h.getHeight(),G=h.getScale(),D=G.x*c,u=G.y*L,p.identity().scale(D,u).rotate(S).translate(R.x,R.y).translate(-O.x,-O.y).rotate(-j._64O),S=_(p.b*Math.sign(D),p.a*Math.sign(D)),p.scale(x,s),I=Math.cos(S),k=Math.sin(S),Math.abs(I)<.001?(i=p.b/k,N=-p.c/k):(i=p.a/I,N=p.d/I),"scale"===m)h.setScale(i/c,N/L);else if("size"===m){var H=i/G.x,C=N/G.y;h.setScale(ps(i)*Math.abs(G.x),ps(N)*Math.abs(G.y)),h.setSize(Math.max(.1,Math.abs(H)),Math.max(.1,Math.abs(C)))}p.rotate(j._64O).translate(O.x,O.y),h.setPosition(p.tx,p.ty)}},$o.prototype.getMatrix=function(){var e=this,o=e._position,$=z.Default.getInternal(),Y=e._scale;return new $.Mat(e._64O,o.x,o.y,Y.x,Y.y)},$o.prototype.toGlobal=function(s){return this.getMatrix().tf(s)},$o.prototype.getCorners=function(){var j=this,r=j._width,O=j._height,V=j._anchor,l=-r*V.x,G=-O*V.y,s=j.getMatrix();return[s.tf(l,G),s.tf(l,G+O),s.tf(l+r,G+O),s.tf(l+r,G)]},$o.prototype.calcInfo=function(){var I,z,Y,W,M,x,X=this,f=[],c=X._entities,F=X._64O;for(W=0,M=c.length;M>W;W++)x=c[W],X.isNode(x)&&x.getCorners&&f.push.apply(f,x.getCorners());if(f.length){var U=Math.cos(-F),g=Math.sin(-F),K=1/0,V=-1/0,u=1/0,R=-1/0;for(W=0,M=f.length;M>W;W++)Y=f[W],I=Y.x,z=Y.y,Y.x=U*I-g*z,Y.y=g*I+U*z,K=Math.min(K,Y.x),V=Math.max(V,Y.x),u=Math.min(u,Y.y),R=Math.max(R,Y.y);X._width=(V-K)/X._scale.x,X._height=(R-u)/X._scale.y,U=Math.cos(F),g=Math.sin(F);var w=X._anchor;I=K+(V-K)*w.x,z=u+(R-u)*w.y,X._position={x:U*I-g*z,y:g*I+U*z}}},$o.prototype.isNode=function(K){return wg(K)?Bg(K)?!1:!0:!1},$o.prototype._42=function(E,Z,O){var m,p,v,i,V,r,j,h,l=this,A=l._entities,x=l.rotateMode;for("batch"===x&&(h=l.getKeyOb()),m=0,p=A.length;p>m;m++)v=A[m],l.isNode(v)&&(r=v.getRect(),i=li.toScreenPosition(O,{x:r.x,y:r.y}),V=li.toScreenPosition(O,{x:r.x+r.width,y:r.y+r.height}),j={min:i,max:V},v===h&&(j.isKeyOb=!0),li.Icons.DrawIcon(E,Z,li.Icons.GroupSubEntityRect,j))};var $k=li.CurveActiving=function(M,x){this._curve=M,this._interactor=M._interactor;for(var s in x)this[s]=x[s]};$k.prototype={},$k.prototype.constructor=$k,W.defineProperties($k.prototype,{point:{get:function(){return this._point},set:function(V){var C=this;C._point=V,C.editingCtrl||C._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(h){var a=this;a._pairs=h,a.editingCtrl&&a._firePointChange()}}}),$k.prototype._firePointChange=function(){var J=this,l=J.getCurrentEditingPoint(),D=J._interactor;if(!l)return D.fi({kind:"selectPoint"}),void 0;var $=this._curve.target;if($){var f=li.getDataMatrix($).invert(),G=l.e;l=f.apply(li.toWorldPosition(D.gv,l)),l.e=G;var W=J._lastFirePoint;W&&Math.abs(l.x-W.x)<1e-5&&Math.abs(l.y-W.y)<1e-5&&(l.e==s&&W.e==s||Math.abs(l.e-W.e)<1e-5)||(J._lastFirePoint=l,D.fi({kind:"selectPoint",x:l.x,y:l.y,e:l.e}))}},$k.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},$k.prototype.getCurrentEditingPoint=function(){var d=this,w=d.editingCtrl;if(w){var Q=d.pairs;if(Q){var F=Q[w.pairId],s=F[w.type];if(s)return s}}return d._point};var Mi=li.CursorFactory=function(M){var R=this;R._interactor=M,R._rotateCursorStyles={}};Mi.prototype={},Mi.prototype.constructor=Mi,Mi.prototype.getRotateCursor=function(O){var R=this;0>O&&(O+=2*Math.PI);var v=R._interactor,t=v.getStyle("rotateCursorSize"),c=v.getStyle("rotateCursorRound"),f=Math.round(180*(O/Math.PI)/c);f*c>=360&&(f=0);var Z=R._rotateCursorStyles,e="htCustomRotateStyle_"+t+"_"+c+"_"+f;return Z[e]||(R._produceRotateCursor(e,t,c,f),Z[e]=!0),e},Mi.prototype._produceRotateCursor=function(s,B,a,Z){var l=this;l._interactor;var j=l._canvas;j||(j=l._canvas=t.createElement("canvas")),j.width=j.height=B*devicePixelRatio,j.style.width=j.style.height=B+" px";var Y=j.getContext("2d");li.setAntialias(Y,!1),Y.scale(devicePixelRatio,devicePixelRatio);var n,U,E,w,p,g=Math.round(B/2),q=""+g+" "+g+",auto !important;";n=Math.PI/180*Z*a,Y.clearRect(0,0,B,B),Y.save(),Y.scale(B/32,B/32),Y.translate(16,16),Y.rotate(n+Math.PI/2),Y.beginPath(),Y.moveTo(-8,0),Y.lineTo(-8,3),Y.lineTo(-5,3),Y.moveTo(8,0),Y.lineTo(8,3),Y.lineTo(5,3),Y.moveTo(-8,3),Y.quadraticCurveTo(0,-6,8,3),Y.restore(),Y.strokeStyle="white",Y.lineWidth=4,Y.stroke(),Y.strokeStyle="black",Y.lineWidth=2,Y.stroke(),U=JSON.stringify(j.toDataURL()),w="cursor:url("+U+")"+q,1!==devicePixelRatio&&(E='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+B+'px" height="'+B+'px"><image xlink:href='+U+' width="'+B+'" height="'+B+'"/></svg>',w+="cursor:url(data:image/svg+xml;base64,"+btoa(E)+")"+q,w+="cursor:-webkit-image-set(url("+U+")"+devicePixelRatio+"x,url("+U+")1x)"+q),p=t.createElement("style"),p.textContent="body."+s+" *, ."+s+"{"+w+"}",t.head.appendChild(p)};var Xb=li.Guide.Grid=function(G){var v=this;v._interactor=G,v._alignmentGuideId=0,v._xAlignmentGuide=[],v._yAlignmentGuide=[]};Xb.prototype={},Xb.prototype.constructor=Xb,W.defineProperties(Xb.prototype,{gridBlockSize:{get:function(){var Y=this;return Y._gridBlockSize||Y._interactor.getStyle("gridBlockSize")},set:function(c){this._gridBlockSize=c,this._interactor._42()}},gridThickLinesEvery:{get:function(){var $=this;return $._gridThickLinesEvery||$._interactor.getStyle("gridThickLinesEvery")},set:function(k){this._gridThickLinesEvery=k,this._interactor._42()}},gridEnabled:{get:function(){var x=this,D=x._interactor;return D.gridEnabled&&x.isValidGrid()}}}),Xb.prototype._42=function(){var v=this,I=v._interactor;v.gridEnabled&&v.drawGrid(),I.alignmentGuideEnabled&&v.drawAlignmentGuide()},Xb.prototype.makeMatrix=function(){var I=this,M=I._interactor.getStyle("gridAngle"),p=I._interactor.getStyle("gridRotation"),u=new li.Math.Matrix2d,T=Math.sin(M),L=Math.cos(M);return u.set(1,0,L,T,0,0),u.rotate(p),u},Xb.prototype.isValidGrid=function(){var e=this,Z=Math.PI,v=e._interactor,E=v.gv;if(E._zoom<v.getStyle("gridZoomThreshold"))return!1;var J=v.getStyle("gridAngle"),x=Math.abs(180*(J%Z/Z)),k=1-1e-8;return k>x||x>180-k?!1:!0},Xb.prototype.drawAlignmentGuide=function(){var n=this,j=n._interactor,w=j.gv,O=j._canvas,o=j._context,u=O.width,t=O.height,T=w.tx(),Y=w.ty(),D=w._zoom;o.beginPath(),o.strokeStyle=j.getStyle("gridAlignmentGuideColor"),o.lineWidth=1,n._xAlignmentGuide.forEach(function(Q){var m=Q.p*D+T;o.moveTo(m,0),o.lineTo(m,t)}),n._yAlignmentGuide.forEach(function(w){var V=w.p*D+Y;o.moveTo(0,V),o.lineTo(u,V)}),o.stroke()},Xb.prototype.drawGrid=function(){function L(X,k,j,l){var A=li.toScreenPosition(r,t.apply({x:X,y:k})),w=li.toScreenPosition(r,t.apply({x:j,y:l}));N.moveTo(A.x,A.y),N.lineTo(w.x,w.y)}var y=this,Z=y._interactor,u=y.gridBlockSize,D=y.gridThickLinesEvery,i=Z.getStyle("gridThickColor"),z=Z.getStyle("gridLightColor"),r=Z.gv,p=Z._canvas,N=Z._context,V=p.width,x=p.height,t=y.makeMatrix(),g=t.applyInverse(li.toWorldPosition(r,{x:0,y:0})),F=t.applyInverse(li.toWorldPosition(r,{x:V,y:0})),K=t.applyInverse(li.toWorldPosition(r,{x:0,y:x})),o=t.applyInverse(li.toWorldPosition(r,{x:V,y:x})),q=Math.min(g.x,F.x,K.x,o.x),n=Math.max(g.x,F.x,K.x,o.x),B=Math.min(g.y,F.y,K.y,o.y),E=Math.max(g.y,F.y,K.y,o.y);V=n-q,x=E-B;var U=Math.ceil(q/u),f=Math.floor(n/u),v=Math.ceil(B/u),c=Math.floor(E/u);r.tx(),r.ty(),r._zoom;var G,e,s;for(N.save(),N.lineWidth=1,N.beginPath(),N.strokeStyle=i,s=Math.ceil(U/D)*D;f>=s;s+=D)G=s*u,L(G,B,G,E);for(s=Math.ceil(v/D)*D;c>=s;s+=D)e=s*u,L(q,e,n,e);for(N.stroke(),N.beginPath(),N.strokeStyle=z,s=U;f>=s;s++)0!==s%D&&(G=s*u,L(G,B,G,E));for(s=v;c>=s;s++)0!==s%D&&(e=s*u,L(q,e,n,e));N.stroke(),N.restore()},Xb.prototype.getAlignmentGuides=function(){var H=this;return{x:H._xAlignmentGuide,y:H._yAlignmentGuide}},Xb.prototype.addAlignmentGuide=function(q,F,U){var w=this,I="x"===q?w._xAlignmentGuide:w._yAlignmentGuide,U=U?U:++w._alignmentGuideId,t={p:F,id:U};if(I.length){var l=w._findClosestAlignmentGuide(t.p,I);l.dis<0?I.splice(l.index+1,0,t):I.splice(l.index,0,t)}else I.push(t);return w._interactor._42(),U},Xb.prototype.findClosest=function(y,L,p){var r=this,w=r._interactor,e=w.gv;p&&(y=li.toWorldPosition(e,y));var Y,T,s,c=1/0,X=1/0,G=y.x,U=y.y;if(r.gridEnabled){var A=r.gridBlockSize,J=r.makeMatrix(),H=J.applyInverse(y);H=J.apply({x:Math.round(H.x/A)*A,y:Math.round(H.y/A)*A}),c=H.x-G,X=H.y-U,s=!0}if(w.alignmentGuideEnabled&&(Y=r._findClosestAlignmentGuide(G,r._xAlignmentGuide).dis,T=r._findClosestAlignmentGuide(U,r._yAlignmentGuide).dis,Math.abs(Y)<Math.abs(c)&&(c=Y,s=!0),Math.abs(T)<Math.abs(X)&&(X=T,s=!0)),s){s=!1;var K=e._zoom,E=w.getStyle("smartGuideSensitivity")/K,C={};if(Math.abs(c)<E&&"y"!==L&&(C.x=p?c*K:c,s=!0),Math.abs(X)<E&&"x"!==L&&(C.y=p?X*K:X,s=!0),s)return C}},Xb.prototype._findClosestAlignmentGuide=function(q,_){if(!_.length)return{dis:1/0};for(var z,E=0,T=_.length-1;T-E>1;)z=Math.floor((E+T)/2),_[z].p<q?E=z:T=z;var y=_[E].p-q,X=_[T].p-q;return Math.abs(y)<=Math.abs(X)?{line:_[E],dis:y,index:E}:{line:_[T],dis:X,index:T}},Xb.prototype.removeAllAlignmentGuide=function(H){var n=this;"y"!==H&&(n._xAlignmentGuide=[]),"x"!==H&&(n._yAlignmentGuide=[]),n._interactor._42()},Xb.prototype.removeAlignmentGuide=function(Z){for(var I,s,K,f=this,G=f._xAlignmentGuide,e=0;2>e;e++)for(G=0===e?f._xAlignmentGuide:f._yAlignmentGuide,I=0,s=G.length;s>I;I++)if(K=G[I],K.id===Z)return G.splice(I,1),f._interactor._42(),{axis:0===e?"x":"y",position:K.p};return!1},Xb.prototype.adjustAlignmentGuide=function(i,v){var V=this,Z=V.removeAlignmentGuide(i);return Z?(V.addAlignmentGuide(Z.axis,v,i),!0):!1};var fl=li.Guide.Rect=function(Y){var P=this;P._interactor=Y};fl.prototype={},fl.prototype.constructor=fl,fl.prototype.gatherRects=function(){var H,O,q,A,P=this,i=P._interactor.gv,U=[],d=[],f={x:U,y:d},B={},t=i.getDataModel(),x=t.a("width"),N=t.a("height");x&&N&&(H=0,O=0,q=x,A=N,U.push({node:t,type:0,p:H},{node:t,type:1,p:H+q/2},{node:t,type:2,p:H+q}),d.push({node:t,type:0,p:O},{node:t,type:1,p:O+A/2},{node:t,type:2,p:O+A}),B[t._id||0]={x:H,y:O,width:q,height:A}),t.each(function(N){if(wg(N)&&!i.isSelected(N)&&i.isVisible(N)&&i.isValidGuideLineSource(N)){var K=!1;if(i.sm().getSelection().each(function(L){K||(N.isHostOn(L)?K=!0:N.isDescendantOf(L)&&(K=!0))}),!K){var Q=N.getRect();H=Q.x,O=Q.y,q=Q.width,A=Q.height,U.push({node:N,type:0,p:H},{node:N,type:1,p:H+q/2},{node:N,type:2,p:H+q}),d.push({node:N,type:0,p:O},{node:N,type:1,p:O+A/2},{node:N,type:2,p:O+A}),B[N._id]=Q}}}),U.sort(function(W,L){return W.p-L.p}),d.sort(function(I,z){return I.p-z.p}),P._grid=f,P._87I=B},fl.prototype.gatherLines=function(P,o,D){var F,h,w,X,Q,$,p,m,l,O,Y,T,A=this,s=[A.findClosest({x:P.x,y:P.y},o),A.findClosest({x:P.x+P.w/2,y:P.y+P.h/2},o),A.findClosest({x:P.x+P.w,y:P.y+P.h},o)],e={},z=A._87I;D=D||255;var V,k;for(A._guideLine=[],F=0;2>F;F++)for(e={},0===F?(X="y",m=P.x,l=m+P.w):(X="x",m=P.y,l=m+P.h),h=0;3>h;h++)Q=s[h],Q&&isFinite(Q[X])&&(V=1<<3*F+h,D&V&&($=Q[X+"Line"],p=$.node,k=p._id||0,e[k]||(e[k]=!0,T=z[k],"y"===X?(O=T.x,Y=T.x+T.width):(O=T.y,Y=T.y+T.height),w=$.p,A._guideLine.push({type:X,a:m,b:l,c:O,d:Y,p:w,center:1===$.type}))))},fl.prototype._binarySearchClosest=function(T,Y){if(!Y.length)return{dis:1/0};for(var m,V=0,H=Y.length-1;H-V>1;)m=Math.floor((V+H)/2),Y[m].p<T?V=m:H=m;var i=Y[V].p-T,s=Y[H].p-T;return Math.abs(i)<=Math.abs(s)?{line:Y[V],dis:i}:{line:Y[H],dis:s}},fl.prototype.findClosest=function(A,S,v){var F=this,B=F._interactor,s=B.gv,Y=F._grid;v&&(A=li.toWorldPosition(s,A));var x,L=F._binarySearchClosest(A.x,Y.x),m=F._binarySearchClosest(A.y,Y.y),G=L.dis,y=m.dis,K=s._zoom,o=B.getStyle("smartGuideSensitivity")/K,H={};return Math.abs(G)<o&&"y"!==S&&(H.x=v?G*K:G,H.xLine=L.line,x=!0),Math.abs(y)<o&&"x"!==S&&(H.y=v?y*K:y,H.yLine=m.line,x=!0),x?H:void 0},fl.prototype._42=function(){var h=this,t=h._guideLine;if(t&&!z.Default.isCtrlDown()){var F,f,E,N,g,T,s,I,b,O,c,j,X,x,i,P,a,B=h._interactor,G=B.gv,d=B._context,M=G.tx(),V=G.ty(),H=G._zoom,o=B.getStyle("guideLineTextSpacing");for(F=0,f=t.length;f>F;F++)E=t[F],I=E.type,b=E.p,O=E.a,c=E.b,j=E.c,X=E.d,x=Math.min(O,j),i=Math.max(c,X),"x"===I?(N=b*H+M,g=x*H+V,T=N,s=i*H+V):(N=x*H+M,g=b*H+V,T=i*H+M,s=g),li.Icons.DrawIcon(B,d,li.Icons.MoveLineGuide,{rect:[N,g,T,s],center:E.center}),X>=O&&c>=j||(x=O>X?X:c,i=O>X?O:j,a=i-x,"x"===I?(E.center2center||(N-=o,T=N),g=x*H+V,s=i*H+V,P=li.Icons.MoveLineGuideDistanceV):"y"===I&&(E.center2center||(g-=o,s=g),N=x*H+M,T=i*H+M,P=li.Icons.MoveLineGuideDistanceH),li.Icons.DrawIcon(B,d,P,{x0:N,y0:g,x1:T,y1:s,dis:a}))}},fl.prototype.clear=function(){this._guideLine=null};var Wk=li.Guide.Hover=function(w){var t=this;t._interactor=w};Wk.prototype={},Wk.prototype.constructor=Wk,W.defineProperties(Wk.prototype,{}),Wk.prototype._42=function(){var s=this._interactor;if(s.getStyle("hoverGuideEnabled")&&!s.gvEditing){var R=s.hoverData,j=s.gv;if(!wg(R)||j.isSelected(R))return s.hoverData=null,void 0;var J=Kn(j,R),c=li.toScreenPosition(j,{x:J.x,y:J.y}),I=li.toScreenPosition(j,{x:J.x+J.width,y:J.y+J.height});li.Icons.DrawIcon(s,s._context,li.Icons.HoverDataRect,{min:c,max:I,color:s.getStyle("hoverGuideColor")||s.getStyle("baseColor")})}},li.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyVisible:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,guideLineTextSpacing:0,hoverGuideEnabled:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var cs=li.Icons={},dr=1e4,Bs=null,ze=li.DefaultStyleMap.baseColor,im="rgb(183,232,135)",yc="rgb(255,204,153)",bj=6;z.Default.setImage("Icons.RectPoint",{width:bj,height:bj,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return ze}},rect:[0,0,bj,bj]}]}),cs.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var Q=cs.GroupSubEntityRect.data;if(!Q)return[];var P=Q.min,I=Q.max;return[P.x,P.y,P.x,I.y,I.x,I.y,I.x,P.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return cs.GroupSubEntityRect.data.isKeyOb?ze:ze}}}]};var Pn=4;cs.HoverDataRect={comps:[{type:"shape",points:{func:function(){var m=cs.HoverDataRect.data;if(!m)return[];var r=m.min,C=m.max,A=Pn;return r.x-=A,r.y-=A,C.x+=A,C.y+=A,[r.x,r.y,r.x,C.y,C.x,C.y,C.x,r.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return cs.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},cs.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[cs.Line.data.P1.x,cs.Line.data.P1.y],bj,bj]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[cs.Line.data.P2.x,cs.Line.data.P2.y],bj,bj]}}}]},cs.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return cs.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},cs.Rect={comps:[{type:"shape",points:{func:function(){var m=cs.Rect.data;if(!m)return[];var L=m.LT,s=m.LB,Q=m.RB,U=m.RT;return[L.x,L.y,s.x,s.y,Q.x,Q.y,U.x,U.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return ze}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cs.Rect.data.rotation}},rect:{func:function(){return[[cs.Rect.data.LT.x,cs.Rect.data.LT.y],bj,bj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cs.Rect.data.rotation}},rect:{func:function(){return[[cs.Rect.data.LB.x,cs.Rect.data.LB.y],bj,bj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cs.Rect.data.rotation}},rect:{func:function(){return[[cs.Rect.data.RB.x,cs.Rect.data.RB.y],bj,bj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cs.Rect.data.rotation}},rect:{func:function(){return[[cs.Rect.data.RT.x,cs.Rect.data.RT.y],bj,bj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cs.Rect.data.rotation}},visible:{func:function(){return cs.Rect.data.L?!0:!1}},rect:{func:function(){return[[cs.Rect.data.L.x,cs.Rect.data.L.y],bj,bj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cs.Rect.data.rotation}},visible:{func:function(){return cs.Rect.data.R?!0:!1}},rect:{func:function(){return[[cs.Rect.data.R.x,cs.Rect.data.R.y],bj,bj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cs.Rect.data.rotation}},visible:{func:function(){return cs.Rect.data.T?!0:!1}},rect:{func:function(){return[[cs.Rect.data.T.x,cs.Rect.data.T.y],bj,bj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cs.Rect.data.rotation}},visible:{func:function(){return cs.Rect.data.B?!0:!1}},rect:{func:function(){return[[cs.Rect.data.B.x,cs.Rect.data.B.y],bj,bj]}}}]};var xc=16;z.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return ze}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return ze}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),cs.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[cs.Anchor.data.POS.x,cs.Anchor.data.POS.y],xc,xc]}}}]},cs.TipShiftX=12,cs.TipShiftY=12;var fs=[8,28];cs.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[cs.TipHelper.data.helperPos.x,cs.TipHelper.data.helperPos.y,fs[0]*cs.TipHelper.data.size,fs[1]]}},background:{func:function(){return Bs.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return cs.TipHelper.data.text}},rect:{func:function(){return[cs.TipHelper.data.helperPos.x,cs.TipHelper.data.helperPos.y,fs[0]*cs.TipHelper.data.size,fs[1]]}},color:{func:function(){return Bs.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Cs=7;cs.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!cs.ShapePoint.data.dynamicVisible}},rect:{func:function(){var b=cs.ShapePoint.data.point,o=cs.ShapePoint.data.size||Cs;return[b,o+10,o+10]}},background:{func:function(){var X=Date.now(),v=cs.ShapePoint.data.dynamicPeriod||1500,y=Math.sin(X%v/v*Math.PI);return"rgba(27,124,22,"+.5*y+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var V=cs.ShapePoint.data.point,g=cs.ShapePoint.data.size||Cs;return[V,g,g]}},background:{func:function(){var k=cs.ShapePoint.data.isEnd;return k?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return cs.ShapePoint.data.color||ze}}},{type:"rect",visible:{func:function(){return!!cs.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return ze}},rect:{func:function(){var z=5;return[cs.ShapePoint.data.point,z,z]}}}]},cs.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!cs.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return cs.ShapeBgCurve.data.P}},segments:{func:function(){return cs.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var e=Date.now(),k=cs.ShapeBgCurve.data.dynamicPeriod||1500,t=Math.sin(e%k/k*Math.PI);return"rgba(27,124,22,"+.3*t+")"}}},{type:"shape",points:{func:function(){return cs.ShapeBgCurve.data.P}},segments:{func:function(){return cs.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return cs.ShapeBgCurve.data.color||ze}}}]};var He=8;cs.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var V=cs.ShapeHighlighPoint.data;return[[V.x,V.y],He,He]}},background:{func:function(){return Bs.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var tq=10;cs.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var m=cs.ShapeHighlighRealPoint.data;return[[m.x,m.y],tq,tq]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return ze}}}]};var mh=8;cs.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var N=cs.ShapeHighlighCtrlPoint.data,g=N.x,T=N.y,A=mh/2;return[g-A,T-A,g-A,T+A,g+A,T+A,g+A,T-A]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Bs.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Bs.getStyle("shapeCtrlPointBorderColor")||ze}}}]};var Rl=3;cs.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return cs.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Rl,borderColor:{func:function(){return Bs.getStyle("curveHighlightColor")}}}]},cs.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return cs.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},cs.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return cs.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return cs.MoveLineGuide.data.center?im:yc}}}]};var dh=5;cs.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var D=cs.MoveLineGuideDistanceH.data,m=D.x0,q=D.y0;return[m,q-dh,m,q+dh]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:yc},{type:"shape",points:{func:function(){var l=cs.MoveLineGuideDistanceH.data,U=l.x1,i=l.y1;return[U,i-dh,U,i+dh]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:yc},{type:"text",text:{func:function(){return Math.round(cs.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var f=cs.MoveLineGuideDistanceH.data;return[[(f.x0+f.x1)/2,f.y0-10],20,20]}},color:yc,font:"12px Arial",align:"center"}]},cs.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var Q=cs.MoveLineGuideDistanceV.data,Z=Q.x0,A=Q.y0;return[Z-dh,A,Z+dh,A]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:yc},{type:"shape",points:{func:function(){var d=cs.MoveLineGuideDistanceV.data,O=d.x1,j=d.y1;return[O-dh,j,O+dh,j]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:yc},{type:"text",text:{func:function(){return Math.round(cs.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var v=cs.MoveLineGuideDistanceV.data;return[[v.x0-10,(v.y0+v.y1)/2],20,20]}},color:yc,font:"12px Arial",align:"center"}]},z.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),cs.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var g=cs.EdgeElevationGuide.data,O=g.x,r=g.y,D=Bs.getStyle("curveElevationIntersectSize"),L=Bs.getStyle("curveElevationGuideShift");return O+=L[0],r+=L[1],[O-D,r-D,2*D,2*D]}}}]},z.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),z.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),cs.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return cs.ConnectGuide.data.rotation}},rect:{func:function(){var c=cs.ConnectGuide.data.connect;c.x,c.y;var w=Bs.getStyle("connectGuideIntersectSize");return[[c.x,c.y],2*w,2*w]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var D=cs.ConnectGuide.data.cursorPos||cs.ConnectGuide.data.connect,O=Bs.getStyle("connectGuideIntersectSize");return[[D.x,D.y],2*O-2,2*O-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var o=cs.ConnectGuide.data.connect,n=cs.ConnectGuide.data.cursorPos||o;return[o.x,o.y,o.x+.5*(n.x-o.x),o.y,n.x+.5*(o.x-n.x),n.y,n.x,n.y]}}}]},z.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),z.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),cs.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var U=cs.ConnectGuideGarbage.data.hover;return U?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var n=cs.ConnectGuideGarbage.data,g=Bs.getStyle("connectGuideGarbageIntersectsize");return n.hover&&(g+=5),[[n.x,n.y],2*g,2*g]}}}]};var Km=6;cs.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return cs.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var n=cs.ShapeActivingCtrl.data;return[n.point.x,n.point.y,n.c1.x,n.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return ze}}},{type:"shape",visible:{func:function(){return cs.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var J=cs.ShapeActivingCtrl.data;return[J.point.x,J.point.y,J.c2.x,J.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return ze}}},{type:"shape",visible:{func:function(){return cs.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var V=cs.ShapeActivingCtrl.data.c1,x=V.x,T=V.y,q=Km/2;return"c1"===cs.ShapeActivingCtrl.data.hl&&(q+=.5),[x-q,T-q,x-q,T+q,x+q,T+q,x+q,T-q]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Bs.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===cs.ShapeActivingCtrl.data.hl?Bs.getStyle("shapeCtrlPointHighlightBorder")||ze:Bs.getStyle("shapeCtrlPointBorderColor")||ze}}},{type:"shape",visible:{func:function(){return cs.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var r=cs.ShapeActivingCtrl.data.c2,X=r.x,w=r.y,d=Km/2;return"c2"===cs.ShapeActivingCtrl.data.hl&&(d+=.5),[X-d,w-d,X-d,w+d,X+d,w+d,X+d,w-d]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Bs.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===cs.ShapeActivingCtrl.data.hl?Bs.getStyle("shapeCtrlPointHighlightBorder")||ze:Bs.getStyle("shapeCtrlPointBorderColor")||ze}}}]},cs.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return ze}},rect:{func:function(){return[[cs.RoundPoint.data.x,cs.RoundPoint.data.y],bj,bj]}}}]},cs.AttachPoint={comps:[{type:"rect",background:{func:function(){return cs.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return ze}},rect:{func:function(){var q=cs.AttachPoint.data.isAttach?bj+4:bj;return[[cs.AttachPoint.data.x,cs.AttachPoint.data.y],q,q]}}}]},cs.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return cs.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return cs.SimpleRect.data.color||ze}},rect:{func:function(){var R=cs.SimpleRect.data;return[R.x,R.y,R.width,R.height]
}}}]},z.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),cs.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var c=cs.MoveDummy.data;return[[c.pos.x,c.pos.y],2*c.size,2*c.size]}}}]},li.Icons.DrawIcon=function(H,Y,s,M){s.width=s.height=dr,s.data=M,Bs=H,z.Default.drawImage(Y,s,0,0,dr,dr)},li.Icons.MapPoints=function(x,M){for(var z=0,C=x.length;C>z;z++)x[z]/=M},li.roundTo=function(M,q,A){var j=Math.abs(M%q);return A>j||A>q-j?q*Math.round(M/q):M},li.toFixed=function(u){return Math.round(100*u)/100},li.getDataMatrix=function(w){if(w instanceof z.Shape){var D=new z.Math.Matrix2d,F=w.getPosition();return D.translate(-F.x,-F.y).scale(w.getScale().x,w.getScale().y).rotate(w.getRotation()).translate(F.x,F.y),D}return w.getMatrix?w.getMatrix():new z.Math.Matrix2d};var cg=li.Math.Curve=function(){this._curves=[]};cg.prototype={},cg.prototype.constructor=cg,cg.prototype.createFromHtShape=function(c,r,X){r instanceof z.List&&(r=r.toArray());var b,O,M,F,p,B,P,W=this,v=null,I=null,Y=0,D=li.Math.Vector2,j=li.Math.CubicBezier,U=function(V){return new D(c[V],c[V+1],X?X[V/2]:s)};for(O=0,M=r.length;M>O;O++){switch(F=r[O],p=null,F){case 1:I=U(Y),v=I,Y+=2;break;case 2:b=U(Y),Y+=2,p=new j(I,I.clone(),b.clone(),b),I=b;break;case 3:B=U(Y),b=U(Y+2),Y+=4,p=new j(I,B.clone().sub(I).multiplyScalar(2/3).add(I),B.clone().sub(b).multiplyScalar(2/3).add(b),b),I=b;break;case 4:B=U(Y),P=U(Y+2),b=U(Y+4),Y+=6,p=new j(I,B,P,b),I=b;break;case 5:if(!v)break;p=new j(I,I.clone(),v.clone(),v),I=null,v=null}p&&(p._index=W._curves.length,W._curves.push(p))}},cg.prototype.checkPoint=function(m,f){var a,I,z,K,i,$=this,U=$._curves;for(a=0,I=U.length;I>a;a++)if(K=U[a],i=K.intersectRect(m,f,f),i.length)return z=0,i.forEach(function(D){z+=D.t}),z/=i.length,m=K.getPointAt(z),m.t=z,{bezier:K,intersection:m}},cg.prototype.insertKnot=function(t,e){var T=t.insertKnot(e),M=this,S=M._curves;S.splice(t._index,1,T[0],T[1])},cg.prototype._isCloseEnough=function(G,R){return Math.abs(G.x-R.x)<1e-6&&Math.abs(G.y-R.y)<1e-6},cg.prototype._isSamePoint=function(g,E){return g===E},cg.prototype.moveRealPoint=function(s,K){var S=this,T=S._curves,D=K.clone().sub(s);T.forEach(function(P){var L=P._p1;P._p2,P._p3;var m=P._p4;S._isSamePoint(L,s)&&(P._p2.add(D),P._p1=K),S._isSamePoint(m,s)&&(P._p3.add(D),P._p4=K)})},cg.prototype.moveCtrlDueToRealPointMovement=function(q,y){var L=this,m=L._curves,P=function(O){O.add(y),O.e&&y.e&&(O.e+=y.e)};m.forEach(function(Y){var f=Y._p1;Y._p2,Y._p3;var V=Y._p4;L._isSamePoint(f,q)&&P(Y._p2),L._isSamePoint(V,q)&&P(Y._p3)})},cg.prototype.moveCtrlPoint=function(R,l,Z){var J=R[Z];if(J){J.e!==s&&(l.e=J.e);var S=this,t=S._curves;l.clone().sub(J),t.forEach(function(z){var e;"c2"===Z?e="_p2":"c1"===Z&&(e="_p3"),S._isSamePoint(z[e],J)&&(z[e]=l)}),R[Z]=l}},cg.prototype.deleteRealPoint=function($,D){var a,l,t,L,Q,i,u,S=this,H=S._curves,j={},Z=[],Y=li.Math.CubicBezier;for(l=0,t=H.length;t>l;l++)a=H[l],L=a._p1,Q=a._p2,i=a._p3,u=a._p4,(j[l]||!S._isSamePoint(L,$))&&(S._isSamePoint(u,$)?t>l+1&&S._isSamePoint(H[l+1]._p1,$)&&(D||Z.push(new Y(L,Q,H[l+1]._p3,H[l+1]._p4))):Z.push(a));S._curves=Z},cg.prototype.findPairs=function(c,v){var f,C,r,H,a,J,h,S,B=this,o=B._curves,d={},s=[];for(C=0,r=o.length;r>C;C++)f=o[C],H=f._p1,a=f._p2,J=f._p3,h=f._p4,!d[C]&&B._isSamePoint(H,c)&&(v?s.push({point:H,r2:h}):s.push({point:H,c2:a})),B._isSamePoint(h,c)&&(S=v?{point:h,r1:H}:{point:h,c1:J},r>C+1&&B._isSamePoint(o[C+1]._p1,c)&&(v?S.r2=o[C+1]._p4:S.c2=o[C+1]._p2,d[C+1]=!0),s.push(S));return s},cg.prototype.toHtShape=function(){var q=this,Y=q._curves,W=[],b=[],w={x:1/0,y:1/0};return Y.forEach(function(A){var k=A._p1,N=A._p2,n=A._p3,I=A._p4;return q._isCloseEnough(k,w)||(W.push(1),b.push(k.clone())),w=I,q._isCloseEnough(k,N)&&q._isCloseEnough(n,I)?(W.push(2),b.push(I.clone()),void 0):(W.push(4),b.push(N.clone(),n.clone(),I.clone()),void 0)}),{segments:W,points:b}};var Wj=li.Math.CubicBezier=function(n,m,$,A){var v=this;v._id=li.Math.CubicBezier._globalId++,v._p1=n,v._p2=m,v._p3=$,v._p4=A};Wj._globalId=1,Wj.prototype={},Wj.prototype.constructor=Wj,Wj.prototype.toString=function(){return this._id},Wj.prototype.intersectRect=function(y,l,V){var j=l/2,N=V/2,S=y.x,t=y.y,D=li.Math.Vector2,x=new D(-j+S,-N+t),E=new D(j+S,N+t),I=new D(E.x,x.y),L=new D(x.x,E.y),q=this,O=q.intersectLine(x,I),M=q.intersectLine(I,E),Y=q.intersectLine(E,L),T=q.intersectLine(L,x),r=O.concat(M).concat(Y).concat(T);return r},Wj.prototype.intersectLine=function(P,k){var Q,b,q,u,j,s,J,n,N,R,w,L,o,E=this,Y=P.clone().min(k),z=P.clone().max(k);u=E._p1,j=E._p2,s=E._p3,J=E._p4,Q=u.clone().multiplyScalar(-1),b=j.clone().multiplyScalar(3),q=s.clone().multiplyScalar(-3),w=Q.add(b).add(q).add(J),Q=u.clone().multiplyScalar(3),b=j.clone().multiplyScalar(-6),q=s.clone().multiplyScalar(3),R=Q.add(b).add(q),Q=u.clone().multiplyScalar(-3),b=j.clone().multiplyScalar(3),N=Q.add(b),n=u.clone(),o=new li.Math.Vector2(P.y-k.y,k.x-P.x),L=P.x*k.y-k.x*P.y;for(var H=E.getRoots(o.dot(w),o.dot(R),o.dot(N),o.dot(n)+L),B=new Array,l=0,g=H.length;g>l;l++){var A=H[l];if(!(0>A||A>1)){var M=u.clone().lerp(j,A),Z=j.clone().lerp(s,A),e=s.clone().lerp(J,A),i=M.lerp(Z,A),F=Z.lerp(e,A),S=i.lerp(F,A);S.t=A,P.x==k.x?Y.y<=S.y&&S.y<=z.y&&B.push(S):P.y==k.y?Y.x<=S.x&&S.x<=z.x&&B.push(S):S.x>=Y.x&&S.y>=Y.y&&S.x<=z.x&&S.y<=z.y&&B.push(S)}}return B},Wj.prototype.solveTForPoint=function(d){var q,f,Y,g,w=this;q=w._p1.x-d.x,f=w._p2.x-d.x,Y=w._p3.x-d.x,g=w._p4.x-d.x;for(var h=w.getRoots(g-3*Y+3*f-q,3*Y-6*f+3*q,3*f-3*q,q),$=s,A=1/0,l=0,j=h.length;j>l;l++){var i=h[l];if(!(0>i||i>1)){var t=w._p1.clone().lerp(w._p2,i),N=w._p2.clone().lerp(w._p3,i),K=w._p3.clone().lerp(w._p4,i),E=t.lerp(N,i),I=N.lerp(K,i),W=E.lerp(I,i);W.t=i;var Z=Math.abs(W.y-d.y);A>Z&&(A=Z,$=W)}}return $},Wj.prototype.getPointAt=function(w){var c=this,g=c._p1,l=c._p2,y=c._p3,Z=c._p4,X=g.clone().lerp(l,w),J=l.clone().lerp(y,w),q=y.clone().lerp(Z,w),m=X.lerp(J,w),e=J.lerp(q,w);return m.lerp(e,w)},Wj.prototype.getRoots=function(z,$,s,i){var L,X,c,n,g,K=new Array;if(Math.abs(z)<1e-6){var L=$,X=s/L,c=i/L,n=X*X-4*c;if(n>0){var g=Math.sqrt(n);K.push(.5*(-X+g)),K.push(.5*(-X-g))}else 0==n&&K.push(.5*-X)}$/=z,s/=z,i/=z,L=(3*s-$*$)/3,X=(2*$*$*$-9*s*$+27*i)/27;var M=$/3,x=X*X/4+L*L*L/27,h=X/2;if(Math.abs(x)<=1e-6&&(x=0),x>0){var Z,J,g=Math.sqrt(x);Z=-h+g,J=Z>=0?Math.pow(Z,1/3):-Math.pow(-Z,1/3),Z=-h-g,Z>=0?J+=Math.pow(Z,1/3):J-=Math.pow(-Z,1/3),K.push(J-M)}else if(0>x){var a=Math.sqrt(-L/3),O=Math.atan2(Math.sqrt(-x),-h)/3,Q=Math.cos(O),q=Math.sin(O),A=Math.sqrt(3);K.push(2*a*Q-M),K.push(-a*(Q+A*q)-M),K.push(-a*(Q-A*q)-M)}else{var Z;Z=h>=0?-Math.pow(h,1/3):Math.pow(-h,1/3),K.push(2*Z-M),K.push(-Z-M)}return K},Wj.prototype._70I=function(){var J=this;return J._p1.distanceToSquared(J._p2)<1e-10&&J._p3.distanceToSquared(J._p4)<1e-10},Wj.prototype.insertKnot=function(Q){var L=this,M=L._p1,U=L._p2,_=L._p3,$=L._p4,q=M.clone().lerp(U,Q),J=U.clone().lerp(_,Q),T=_.clone().lerp($,Q),V=q.clone().lerp(J,Q),C=J.clone().lerp(T,Q),c=V.clone().lerp(C,Q);return L._70I()?(M.clone().lerp($,Q),[new li.Math.CubicBezier(M,M.clone(),c.clone(),c),new li.Math.CubicBezier(c,c.clone(),$.clone(),$)]):[new li.Math.CubicBezier(M,q,V,c),new li.Math.CubicBezier(c,C,T,$)]};var nn=z.Default.getInternal().ui().EdgeUI,Ni={_47O:function(U){var u=this,K=Ni.getBackups()._47O;li.inEdit(u.gv)||K.call(u,U)}};li.Inject.registAsModule(Ni,nn);var Dj=z.Default.getInternal().ui().NodeUI,qc={_47O:function(E){var O=this,A=qc.getBackups()._47O;li.inEdit(O.gv)||A.call(O,E)},getSelectWidth:function(){var D=this,h=D.gv,b=D._data;if(h.isEditable(b)&&li.inEdit(h))return 0;var n=qc.getBackup("getSelectWidth");return n.call(D)}};li.Inject.registAsModule(qc,Dj);var po=z.graph.GraphView,wl={_editPointSize:function(){var _=z.Default.isTouchable,Z=li.getStyle("pointSize");return Z[_?0:1]}(),isPointEditable:function(s){var G=this;if(li.inEdit(G))return G._pointEditableFunc?G._pointEditableFunc(s):!0;var f=wl.getBackup("isPointEditable");f.call(G,s)},isEditable:function(T){var y,B=this,I=wl.getBackup("isEditable");if(y=T instanceof li.Group?!0:I.call(B,T),!li.inEdit(B))return y;if(!(T instanceof z.Edge))return y;if(!T.s("2d.editable"))return!1;var i=B.getEditableFunc();return i?i(T):!0},_42:function(U,v){var X=this,u=wl.getBackups()._42;if(u.call(X,U,v),li.inEdit(X)){var f=X.getEditInteractor();f.drawImpl()}}};li.Inject.registAsModule(wl,po);var jc=z.Default.getInternal().ui().ShapeUI,Ef={_47O:function(i){var d=this,o=Ef.getBackups()._47O;li.inEdit(d.gv)||o.call(d,i)}};li.Inject.registAsModule(Ef,jc);var cr=z.graph.DefaultInteractor,jb={handle_mousewheel:function(Y){var e=this,Z=jb.getBackup("handle_mousewheel");li.inEdit(e.gv)||Z.call(e,Y)}};li.Inject.registAsModule(jb,cr);var Iq=z.graph.MoveInteractor,Ic={_calcShift:function(k,C){var w=this,O=Ic.getBackup("_calcShift"),d=w.gv;if(!li.inEdit(d))return O.call(w,k,C);var v=d.getEditInteractor(),p=v.getSubModule("Move").calcShift(k,C,w);return p||O.call(w,k,C)},clear:function(n){var L=this,G=Ic.getBackup("clear");G.call(L,n);var H=L.gv;if(li.inEdit(H)){var m=H.getEditInteractor();m.getSubModule("Move").clear(n)}}};li.Inject.registAsModule(Ic,Iq);var fl=li.Rect=function(H){this.catalog="Rect",this._interactor=H};fl.prototype={},fl.prototype.constructor=fl,fl.prototype.gatherInfo=function(B,Z){var i=this;if(1===Z.length){var y=Z[0];return y instanceof z.Shape&&y._70I()?i.gatherLine(B,y):Bg(y,B)?!1:i.gatherSingleTarget(B,y)}return Z.length>1?i.gatherMultiTargets(B,Z):!1},fl.prototype.gatherSingleTarget=function($,A){if(A.getCorners){var l,O=this,I=O.info;O.target=A,l=O.screenInfo={};var w=A.getCorners();I.LT=new li.Math.Vector2(w[0]),I.LB=new li.Math.Vector2(w[1]),I.RB=new li.Math.Vector2(w[2]),I.RT=new li.Math.Vector2(w[3]),I.T=I.LT.clone().add(I.RT).divideScalar(2),I.B=I.LB.clone().add(I.RB).divideScalar(2),I.L=I.LT.clone().add(I.LB).divideScalar(2),I.R=I.RT.clone().add(I.RB).divideScalar(2);for(var h in I)l[h]=li.toScreenPosition($,I[h]);var G=O._interactor,L=G.getStyle("checkSize"),g=function(A,u,o){var s=u.clone().sub(A).setLength(-L),S=o.clone().sub(A).setLength(-L),C=s.add(S).add(A);return C};return l.rotLT=g(l.LT,l.RT,l.LB),l.rotLB=g(l.LB,l.LT,l.RB),l.rotRB=g(l.RB,l.LB,l.RT),l.rotRT=g(l.RT,l.LT,l.RB),l.rotT=l.rotLT.clone().add(l.rotRT).divideScalar(2),l.rotB=l.rotLB.clone().add(l.rotRB).divideScalar(2),l.rotL=l.rotLT.clone().add(l.rotLB).divideScalar(2),l.rotR=l.rotRT.clone().add(l.rotRB).divideScalar(2),l.rotation=A.getRotation(),O.gatherConnectInfo(),!0}},fl.prototype.gatherConnectInfo=function(){var O=this,s=O.target,B=O._interactor,z=O.screenInfo,C=B.gv;if(C.isConnectActionVisible(s)&&B.getStyle("connectGuideVisible")){var W;s.s&&(W=s.s("connectGuideShift")),W||(W=B.getStyle("connectGuideShift"));var e=s.getAnchor(),D=s.getSize(),G=s.toGlobal({x:D.width*(W[0]-e.x),y:D.height*(W[1]-e.y)});G=li.toScreenPosition(C,G),z.P1?G.add(z.P2.clone().sub(z.P1).setLength(W[2])):(G.add(z.RT.clone().sub(z.LT).setLength(W[2])),G.add(z.LB.clone().sub(z.LT).setLength(W[3]))),z.connect=G}},fl.prototype.gatherMultiTargets=function(T,B){var U=li.Group.findOrCreateGroup(B);if(!U)return!1;var q=this;return q.editing&&"rotate"!==q.editing.mode||U.calcInfo(),q.gatherSingleTarget(T,U)},fl.prototype.gatherLine=function($,F){this.target=F;var H=this.screenInfo={},b=F.getPoints(),X=li.getDataMatrix(F);return H.P1=li.toScreenPosition($,X.apply(b.get(0))),H.P2=li.toScreenPosition($,X.apply(b.get(1))),this.gatherConnectInfo(),!0},fl.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],fl.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],fl.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],fl.prototype.check=function(V,q,D){if(z.Default.isLeftButton(q)){var s=this;if(s.editing=null,s.tipInfo=null,s.screenInfo){var d=s.target,e=V.isEditable(d),C=s.screenInfo;if(e&&C.connect){var J=s._checkConnect(D);if(J)return J}if(C.P1)return s._checkLine(D);var U,B,b,w=null,g=s._interactor,H=g.getStyle("checkSize");if(e&&V.isRectEditable(d))for(B=0;B<li.Rect.ResizeKeys.length;B++)if(b=li.Rect.ResizeKeys[B],li.checkHit(D,C[b],H)){w=b,U="resize";break}if(!w&&e&&V.isRotationEditable(d)&&!g.getStyle("rotateAsClock")){var n=g.getStyle("rotateCheckSize");for(B=0;B<li.Rect.RotateKeys.length;B++)if(b=li.Rect.RotateKeys[B],li.checkHit(D,C[b],n)){w=b,U="rotate";break}}if(!w)return g.setCursor("default"),void 0;if("rotate"===U){var $,o=V.lp(q);if(d instanceof li.Group){var X=g.getStyle("groupRotateModeKey");"string"==typeof X&&(X=[X]);for(var l=!1,R=0,O=X.length;O>R;R++)if(q[X[R]]){l=!0;break}var G=g.getStyle("groupRotateModeDefault");$=l?"batch"===G?"block":"batch":G}var i="batch"===$?d.getAnchor2():d.getPosition(),S=Math.atan2(o.y-i.y,o.x-i.x);g._setRotateCursor(S),s.editing={mode:U,key:w,pos:i,flipY:d.getScale().y<0,rotation:d.getRotation(),hitRot:S},$&&(s.editing.groupRotateMode=$)}else{var E=li.Rect.ResizeKeys.indexOf(w),x=li.Rect.ResizeDirection[E],L=Math.cos(d.getRotation()),M=Math.sin(d.getRotation()),y=x.x*Math.sign(d.getScale().x),p=x.y*Math.sign(d.getScale().y),T=Math.atan2(-M*y-L*p,L*y-M*p),I=(Math.round(T/(Math.PI/4))+8)%8,Z=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][I];this._interactor.setCursor(Z);var P=d.getWidth(),N=d.getHeight(),f=d.getAnchor();s.editing={mode:U,key:w,rect:{x:-P*f.x,y:-N*f.y,width:P,height:N},anchor:f,matrix:d.getMatrix()}}return w}}},fl.prototype._checkLine=function(M){var e=this;e.screenInfo;var X,Q=e._interactor.getStyle("checkSize");if(li.checkHit(M,e.screenInfo.P1,Q))X="P1";else{if(!li.checkHit(M,e.screenInfo.P2,Q))return this._interactor.setCursor("default"),void 0;X="P2"}return e.editing={mode:"line",key:X},X},fl.prototype._checkConnect=function(Z){var T=this,G=T.screenInfo,n=T._interactor,E=n.getStyle("connectGuideIntersectSize"),N=G.connect,u=Z.x,O=N.x;if(O>u&&E>O-u&&Math.abs(N.y-Z.y)<E||u>=O&&li.checkHit(Z,N,E)){var a="connect",B=Q.getConnectAction(n.gv);if(T.editing={mode:a},B&&B.delete)if(T.target instanceof li.Group){var r=!0;n.gv.sm().getSelection().each(function(q){B.delete.visible.call(null,n.gv,q)||(r=!1)}),T.editing.hasDeleteAction=r}else B.delete.visible.call(null,n.gv,T.target)&&(T.editing.hasDeleteAction=!0);return n.setCursor("default"),a}},fl.prototype._fireEditEvent=function(b,m){var C=this._interactor,w=this.editing;if(w){var L=w.mode;L="rotate"===L?"Rotation":"connect"===L?"Connection":L[0].toUpperCase()+L.slice(1),C.fi({kind:b+"Edit"+L,event:m})}},fl.prototype.startEdit=function(H,Q){H.startDragging(Q);var M=this;M._interactor.fi({kind:"prepareEdit",event:Q});var O=M.editing,t=M.target;if(O){if(M._fireEditEvent("begin",Q),"rotate"===O.mode)return O.groupRotateMode&&t.beginRotate(O),void 0;if("connect"!==O.mode)("line"===O.mode||t&&0===t.getRotation())&&(M._inSmartGuide=!0,M._interactor.rectGuide.gatherRects());else if(O.hasDeleteAction){var q=H.gv,S=M._interactor.getStyle("connectGuideGarbageShift");O.garbageInfo={x:q.getWidth()*S[0]+S[2],y:q.getHeight()*S[1]+S[3],size:M._interactor.getStyle("connectGuideGarbageIntersectsize")},H._42()}}},fl.prototype._46O=function(f){var N,G,U=this,M=U.editing,i=U.target;if(M){if("connect"===M.mode&&!M.canceled&&!M.deleted)try{M.garbageInfo&&M.garbageInfo.hover?Q.doDeleteConnectionAction(U._interactor.gv,i):Q.doConnectAction(U._interactor.gv,i,M.target)}catch(Z){console.error(Z)}G=M.freezeFlag,N=U.editing.groupRotateMode,U._fireEditEvent("end",f),U.editing=null}U.tipInfo=null,U._inSmartGuide&&(U._interactor.rectGuide.clear(),U._inSmartGuide=!1),N&&i&&i.endRotate(),i instanceof z.Block&&(G===s?delete i._freezeSyncFromChildren:i._freezeSyncFromChildren=G,i.updateFromChildren())},fl.prototype.handleNormalStateDelete=function(){var C=this,B=C.editing;if(B&&"connect"===B.mode&&!B.canceled&&!B.deleted){if(B.garbageInfo){try{Q.doDeleteConnectionAction(C._interactor.gv,C.target)}catch(W){console.error(W)}B.garbageInfo=null}return B.cursorPos=null,B.targetCorners=null,B.deleted=!0,C._interactor._42(),!0}},fl.prototype.handleNormalStateKeyDown=function(Z){var L=this,o=L.editing;return!o||"connect"!==o.mode||o.canceled||o.deleted?void 0:z.Default.isEsc(Z)?(o.cursorPos=null,o.targetCorners=null,o.canceled=!0,L._interactor._42(),!0):void 0},fl.prototype.handleEdit=function(Y,p){var h=this,w=h.editing;if(w){var i,q,v,o,D,T=h.target,G=w.key,Z=w.mode,n=Y.lp(p),l=h._interactor;if("connect"===Z){if(w.canceled)return;if(w.deleted)return;w.cursorPos=l._getLogicalPoint(p);var _=w.garbageInfo;return _&&li.checkHit(w.cursorPos,_,_.size)?(_.hover=!0,w.target=null,w.targetCorners=null):(_&&(_.hover=!1),w.target=Y.getDataAt(n,function(p){return Y.isSelectable(p)?wg(p)?!0:!1:!1})||null,w.targetCorners=li.getTargetCornersOnScreen(Y,w.target)),l._42(),void 0}if("rotate"===Z){var C,U,K=w.pos,W=Math.atan2(n.y-K.y,n.x-K.x);if(w.groupRotateMode?U=W-w.hitRot:(C=W-w.hitRot,U=w.rotation+C),U%=2*Math.PI,0>U&&(U+=2*Math.PI),!z.Default.isCtrlDown(p)){var c,V;un(p)?(c=l.getStyle("shiftRotateRound"),V=c/2):(c=l.getStyle("rotateRound"),V=l.getStyle("rotateSensitivity")),U=li.roundTo(U,c,V)}w.groupRotateMode?(C=U-(w.lastRotation||0),0!==C&&(T.addRotation(C,w.groupRotateMode),w.lastRotation=U)):T.setRotation(U),l._setRotateCursor(W),U>Math.PI&&(U-=2*Math.PI);var F=180*(U/Math.PI);F=F.toFixed(2),i=""+F+""}else if("resize"===Z){var e=w.rect;v=e.x,o=e.y;var x,t=e.width,J=e.height,s=w.anchor,r=w.matrix,j=T.s&&T.s("keepAspectRatio")||l.getStyle("keepAspectRatio");un(p)&&(j=!j);var k=h._unionPointMode1,E=h._unionPointMode2;if(h._inSmartGuide&&!z.Default.isCtrlDown(p)&&!j){var O;"L"===G||"R"===G?O="x":("T"===G||"B"===G)&&(O="y"),h._adsorbedToClosest(n,O),D=!0}x=r.tfi(n);var P;"LT"===G?(e=k(x,{x:v+t,y:o+J},t,J,j),P=9):"T"===G?(e=E({x:v,y:x.y},{x:v+t,y:o+J},t,J,j,"v"),P=1):"RT"===G?(e=k(x,{x:v,y:o+J},t,J,j),P=33):"L"===G?(e=E({x:x.x,y:o},{x:v+t,y:o+J},t,J,j,"h"),P=8):"R"===G?(e=E({x:v,y:o},{x:x.x,y:o+J},t,J,j,"h"),P=32):"LB"===G?(e=k(x,{x:v+t,y:o},t,J,j),P=12):"B"===G?(e=E({x:v,y:o},{x:v+t,y:x.y},t,J,j,"v"),P=4):"RB"===G&&(e=k(x,{x:v,y:o},t,J,j),P=36);var X=r.tf(e.x+e.width*s.x,e.y+e.height*s.y);T instanceof z.Block&&(w.hasOwnProperty("freezeFlag")||(w.freezeFlag=T._freezeSyncFromChildren,T._freezeSyncFromChildren=!0)),T.setPosition(X),T.setSize(e.width,e.height),D&&(q=T.getRect(),l.rectGuide.gatherLines({node:T,x:q.x,y:q.y,w:q.width,h:q.height},O,P)),i=""+Math.round(e.width)+" * "+Math.round(e.height)}else if("line"===Z){if(un(p)){var m=T.getPoints(),b="P1"===G?m.get(1):m.get(0),f={x:n.x-b.x,y:n.y-b.y},L=l.getStyle("shiftLineRotateRound"),d=h._shiftDirList;if(!d||h._shiftRotateRound!==L){h._shiftRotateRound=L,h._shiftDirList=d=[];for(var N=0;N<Math.PI;N+=L)d.push({x:R(N),y:H(N)})}for(var S,A=0,Q=0,$=d.length;$>Q;Q++){var I=d[Q],g=I.x*f.x+I.y*f.y;Math.abs(g)>Math.abs(A)&&(A=g,S=I)}n={x:b.x+S.x*A,y:b.y+S.y*A},l.rectGuide.clear()}else h._inSmartGuide&&!z.Default.isCtrlDown(p)&&(h._adsorbedToClosest(n),D=!0);var a=li.getDataMatrix(T).applyInverse(n);T.setPoint("P1"===G?0:1,a,!0);var B=T.getPoints(),y=B.get(0),u=B.get(1);v=y.x-u.x,o=y.y-u.y,i=" "+Math.round(Math.sqrt(v*v+o*o))+" ",D&&(q=T.getRect(),l.rectGuide.gatherLines({node:T,x:q.x,y:q.y,w:q.width,h:q.height}))}if(i){var M=z.Default.getLogicalPoint(p,l._canvas);M.x+=li.Icons.TipShiftX,M.y+=li.Icons.TipShiftY,h.tipInfo={helperPos:M,text:i,size:i.length}}h._fireEditEvent("between",p)}},fl.prototype._unionPointMode1=function(e,k,G,C,s){if(s&&G&&C){var J=e.x-k.x,h=e.y-k.y;Math.abs(J*C)<Math.abs(h*G)?(h=Math.sign(h)*Math.abs(J*C/G),e.y=k.y+h):(J=Math.sign(J)*Math.abs(h*G/C),e.x=k.x+J)}return z.Default.unionPoint(e,k)},fl.prototype._unionPointMode2=function(H,p,I,b,e,m){var W=z.Default.unionPoint(H,p);if(e&&I&&b){var S;"v"===m?(S=W.x+W.width/2,W.width=I*W.height/b,W.x=S-W.width/2):(S=W.y+W.height/2,W.height=b*W.width/I,W.y=S-W.height/2)}return W},fl.prototype._adsorbedToClosest=function(u,q){var g=this,$=g._interactor,h=$.rectGuide.findClosest(u,q),X=$.gridGuide.findClosest(u,q),B=1/0,P=1/0;h&&(isFinite(h.x)&&(B=h.x),isFinite(h.y)&&(P=h.y)),X&&(isFinite(X.x)&&Math.abs(X.x)<Math.abs(B)&&(B=X.x),isFinite(X.y)&&Math.abs(X.y)<Math.abs(P)&&(P=X.y)),isFinite(B)&&(u.x+=B),isFinite(P)&&(u.y+=P)},fl.prototype._42=function(t,k,w){var R=this;R.info={},R.screenInfo=null;var g=R._interactor;if(!g.editDetail&&R.gatherInfo(k,w)){var G=R.editing,Z=G?G.groupRotateMode:null,N=R.screenInfo;if("block"!==Z){if(N.P1?li.Icons.DrawIcon(g,t,li.Icons.Line,N):li.Icons.DrawIcon(g,t,li.Icons.Rect,N),N.connect&&(li.Icons.DrawIcon(g,t,li.Icons.ConnectGuide,{rotation:N.rotation,connect:N.connect,cursorPos:G?G.cursorPos:null}),G)){if(G.targetCorners){for(var Q={x:1/0,y:1/0},B={x:-1/0,y:-1/0},K=0,I=G.targetCorners.length;I>K;K+=2)Q.x=Math.min(Q.x,G.targetCorners[K]),B.x=Math.max(B.x,G.targetCorners[K]),Q.y=Math.min(Q.y,G.targetCorners[K+1]),B.y=Math.max(B.y,G.targetCorners[K+1]);li.Icons.DrawIcon(g,t,li.Icons.HoverDataRect,{min:Q,max:B,color:g.getStyle("hoverGuideColor")||g.getStyle("baseColor")})}G.garbageInfo&&li.Icons.DrawIcon(g,t,li.Icons.ConnectGuideGarbage,G.garbageInfo)}R.tipInfo&&li.Icons.DrawIcon(g,t,li.Icons.TipHelper,R.tipInfo)}R.target instanceof li.Group&&R.target._42(g,t,k)}};var $f=li.Anchor=function(z){this.catalog="Anchor",this._interactor=z};$f.prototype={},$f.prototype.constructor=$f,$f.prototype.gatherInfo=function(k,S){var $=this;if(1===S.length){var J=S[0];if(!J.getAnchor)return;if(J instanceof z.Shape&&J._70I())return;if(Bg(J,k))return;return $.gatherSingleTarget(k,S[0])}return S.length>1?$.gatherMultiTargets(k,S):!1},$f.prototype.gatherSingleTarget=function(G,w){var O=this;return O.info.POS=w.getPosition(),O.screenInfo.POS=li.toScreenPosition(G,O.info.POS),O.target=w,!0},$f.prototype.gatherMultiTargets=function(B,b){var r=this,n=li.Group.findOrCreateGroup(b);return n?(r.screenInfo.POS=li.toScreenPosition(B,n.getAnchor2()),r.target=n,!0):!1},$f.prototype.isVisible=function(){var m=this,Q=m._interactor;if(Q.getStyle("anchorVisible")===!1)return!1;var W=m.target;if(W){if(this.editing)return!0;var t=W.getAnchor(),p=Q.getStyle("anchorOutsideVisibleThreshold");if(t.x<-p||t.x>1+p||t.y<-p||t.y>1+p)return!0;var G=W.getSize(),x=W.getScale(),Z=Math.min(Math.abs(G.width*x.x),Math.abs(G.height*x.y));if(Z*Q.gv._zoom<Q.getStyle("anchorHideThreshold"))return!1}return!0},$f.prototype.check=function(K,d,m){if(z.Default.isLeftButton(d)){var v=this,l=v._interactor;if(v.isVisible()&&l.getStyle("anchorMovable")!==!1){v.editing=null,v.tipInfo=null;var W=v.target;if(W&&K.isAnchorEditable(W)&&K.isEditable(W)){var C;if(v.screenInfo&&(C=v.screenInfo.POS)&&li.checkHit(m,new li.Math.Vector2(C),l.getStyle("checkSize"))){if(W instanceof li.Group)return v.editing={},!0;var N=W.getWidth(),e=W.getHeight(),V=W.getAnchor();return v.editing={rect:{x:-N*V.x,y:-e*V.y,width:N,height:e},anchor:V,matrix:W.getMatrix()},!0}}}}},$f.prototype.startEdit=function(V,Z){V.startDragging(Z),V.fi({kind:"beginEditAnchor",event:Z})},$f.prototype._46O=function(g){var V=this;V.editing&&(V.editing=null,V._interactor.fi({kind:"endEditAnchor",event:g})),V.tipInfo=null},$f.prototype.handleEdit=function(E,Q){var b=this,Y=b.target;if(Y){var n=b.editing;if(n){var f=E.lp(Q),S=b._interactor;if(Y instanceof li.Group)return Y.setAnchor2(f),S._42(),void 0;var i=n.matrix,p=i.tfi(f),R=n.rect,W=(p.x-R.x)/R.width,j=(p.y-R.y)/R.height;if(!z.Default.isCtrlDown(Q)){var H=S.getStyle("anchorRound"),o=S.getStyle("anchorSensitivity");W=li.roundTo(W,H,o),j=li.roundTo(j,H,o)}Y.setAnchor(W,j,!0);var J=z.Default.getLogicalPoint(Q,S._canvas);J.x+=li.Icons.TipShiftX,J.y+=li.Icons.TipShiftY;var s=""+W.toFixed(2)+", "+j.toFixed(2);b.tipInfo={helperPos:J,text:s,size:s.length},S.fi({kind:"betweenEditAnchor",event:Q})}}},$f.prototype._42=function(J,k,Q){var W=this;W.info={},W.screenInfo={};var t=W._interactor;t.editDetail||W.gatherInfo(k,Q)&&W.isVisible()&&(li.Icons.DrawIcon(t,J,li.Icons.Anchor,W.screenInfo),W.tipInfo&&li.Icons.DrawIcon(t,J,li.Icons.TipHelper,W.tipInfo))};var Mr=li.MoveDummy=function(B){this.catalog="MoveDummy",this._interactor=B};Mr.prototype={},Mr.prototype.constructor=Mr,Mr.prototype.gatherInfo=function(){var A=this,L=this._interactor.getSubModule("Rect");if(L){var S=L.screenInfo;if(S){var E=A._interactor,m=A.getMovableTarget(L.target);if(m){var F=E.getStyle("moveDummyVisible"),O=S.LT||S.P1,B=S.RT||S.P2,v=S.LB||O;if(O){var x=S.P1,d=Math.min(O.distanceTo(v),O.distanceTo(B));if(!(d>F)){var l=E.getStyle("moveDummyPosition"),I=B.clone().sub(O),Y=v.clone().sub(O),j=l[2],o=l[3];if(x){var p=E.getStyle("moveDummyLineExtraShift");p&&(j+=p[0],o+=p[1])}var W=O.clone().add(I.clone().multiplyScalar(l[0])).add(I.setLength(j)).add(Y.clone().multiplyScalar(l[1])).add(Y.setLength(o));return A.screenInfo.pos=W,A.screenInfo.size=E.getStyle("moveDummySensitivity"),!0}}}}}},Mr.prototype.getMovableTarget=function(o){var v=this._interactor.gv;if(wg(o)){if(v.isMovable(o))return o}else if(o instanceof li.Group)for(var a=o._entities,c=a.length-1;c>=0;c--){var l=a[c];if(wg(l)&&v.isMovable(l))return l}return null},Mr.prototype.getMoveInteractor=function(){for(var j,m,Z,b=this._interactor.gv,F=b.getInteractors(),j=0,m=F.length;m>j;j++)if(Z=F.get(j),Z instanceof Iq)return Z},Mr.prototype.startEdit=function(x,o){x.startDragging(o);var g=this.getMoveInteractor();if(g){var n=this.selectedTarget,k=x.gv;k._moving=1,g._data=n,k.handleMouseDown&&k.handleMouseDown(o,n)}},Mr.prototype._46O=function(q){var i=this,I=i.getMoveInteractor();I&&(I.handleWindowMouseUp(q),i.selectedTarget=null)},Mr.prototype.handleEdit=function(M,J){var I=this.getMoveInteractor();I&&I.handleWindowMouseMove(J)},Mr.prototype.check=function(F,s,M){if(this.selectedTarget=null,z.Default.isLeftButton(s)&&!F._scrolling&&!$n()){var P=this;if(P.screenInfo){var G=P.screenInfo.pos;if(G&&!(M.distanceTo(G)>P.screenInfo.size)){var D=P._interactor;return P.selectedTarget=P.getMovableTarget(D.getSubModule("Rect").target),D.setCursor("default"),!0}}}},Mr.prototype._42=function(J,q,m){var D=this;D.screenInfo={};var x=D._interactor;x.editDetail||D.gatherInfo(q,m)&&(!x.editing||D.selectedTarget)&&li.Icons.DrawIcon(x,J,li.Icons.MoveDummy,D.screenInfo)};var ao=li.RotateX=function(L){this.catalog="RotateX",this._interactor=L};ao.prototype={},ao.prototype.constructor=ao,ao.prototype.gatherInfo=function(I,G){var Y=this;if(1===G.length){var Z=G[0];return Z instanceof z.Shape&&Z._70I()||Bg(Z,I)?!1:Y.gatherSingleTarget(I,Z)}return G.length>1?Y.gatherMultiTargets(I,G):!1},ao.prototype.gatherSingleTarget=function(){var l=new z.Math.Vector2,n=new z.Math.Vector2,c=new z.Math.Vector2,C=new z.Math.Vector2,W=function(G,c){var L=G.x-c.x,Z=G.y-c.y;return L*L+Z*Z};return function(F,z){if(z.getCorners){var k=this,J=z.getCorners(),I=15,B=z.getPosition();l.copy(J[0]),c.copy(J[1]),C.copy(J[3]),n.copy(l).add(C).divideScalar(2).add(l.sub(c).setLength(I/F.getZoom()));var f=Math.max(W(B,J[0]),W(B,J[1]),W(B,J[2]),W(B,J[3]));return k.info.POS=n.clone(),k.screenInfo.POS=li.toScreenPosition(F,k.info.POS),k.screenInfo.LEN=Math.sqrt(f)*F.getZoom()+I,k.screenInfo.CENTER=li.toScreenPosition(F,B),k.target=z,!0}}}(),ao.prototype.gatherMultiTargets=function(m,V){var L=this,g=li.Group.findOrCreateGroup(V);if(!g)return!1;var L=this;return L.gatherSingleTarget(m,g)},ao.prototype.isVisible=function(){var q=this._interactor;if(!q.getStyle("rotateAsClock"))return!1;var r=this.target;if(!r)return!0;var n=q.gv;return n.isEditable(r)&&n.isRotationEditable(r)?!0:!1},ao.prototype.check=function(q,Q,v){var V=this,l=V._checkImpl(q,Q,v);return(l||V._clockPainted)&&V._interactor._42(),l},ao.prototype._checkImpl=function(G,l,i){if(z.Default.isLeftButton(l)){var b=this;b.editing=null,b.tipInfo=null;var k;if(b.screenInfo&&(k=b.screenInfo.POS)&&b.isVisible()){var V=b._interactor;if(li.checkHit(i,k,V.getStyle("checkSize"))){var d=b.target,r=G.lp(l),X=d.getPosition(),M=Math.atan2(r.y-X.y,r.x-X.x);return V._setRotateCursor(M),b.editing={pos:X,rotation:d.getRotation(),hitRot:M,groupRotateMode:"block",screenInfo:{CENTER:b.screenInfo.CENTER,LEN:b.screenInfo.LEN}},!0}}}},ao.prototype.startEdit=function(D,E){D.startDragging(E),D.fi({kind:"beginEditRotation",event:E}),this.target instanceof li.Group&&this.target.beginRotate(this.editing)},ao.prototype._46O=function(r){var f=this;f.editing&&(f.editing=null,f._interactor.fi({kind:"endEditRotation",event:r})),f.target instanceof li.Group&&f.target.endRotate(),f.tipInfo=null},ao.prototype.handleEdit=function(B,d){var O=this,y=O.editing;if(y){var K,m,I=O.target,N=B.lp(d),H=O._interactor,J=y.pos,n=Math.atan2(N.y-J.y,N.x-J.x),C=I instanceof li.Group;if(C?m=n-y.hitRot:(K=n-y.hitRot,m=y.rotation+K),m%=2*Math.PI,0>m&&(m+=2*Math.PI),!z.Default.isCtrlDown(d)){var l,T;un(d)?(l=H.getStyle("shiftRotateRound"),T=l/2):(l=H.getStyle("rotateRound"),T=H.getStyle("rotateSensitivity")),m=li.roundTo(m,l,T)}C?(K=m-(y.lastRotation||0),0!==K&&(I.addRotation(K,y.groupRotateMode),y.lastRotation=m)):I.setRotation(m),H._setRotateCursor(n),m>Math.PI&&(m-=2*Math.PI);var b=180*(m/Math.PI),$=""+b.toFixed(2)+"",s=z.Default.getLogicalPoint(d,H._canvas);s.x+=li.Icons.TipShiftX,s.y+=li.Icons.TipShiftY,O.tipInfo={helperPos:s,text:$,size:$.length},H.fi({kind:"betweenEditRotation",event:d})}},ao.prototype._42=function(R,t,d){var H=this;H._clockPainted=!1,H.info={},H.screenInfo={};var W=H._interactor;W.editDetail||H.gatherInfo(t,d)&&H.isVisible()&&(li.Icons.DrawIcon(W,R,li.Icons.RoundPoint,H.screenInfo.POS),H.tipInfo&&li.Icons.DrawIcon(W,R,li.Icons.TipHelper,H.tipInfo),H.editing&&H.drawClock(R))
},ao.prototype.drawClock=function($){$.save();var o=this;o._clockPainted=!0;var D=o.editing||{},Z=D.screenInfo||o.screenInfo,Q=Z.LEN,u=Q+8,c=Q+18;$.save(),$.translate(Z.CENTER.x,Z.CENTER.y),$.beginPath(),$.strokeStyle="rgb(150, 150, 150)";for(var A,s,e,w,J,Y=0;360>Y;Y++)A=Y*Math.PI/180,0===Y%5&&(s=H(A)*Q,e=R(A)*Q,w=H(A)*u,J=R(A)*u,$.moveTo(s,e),$.lineTo(w,J)),0===Y%45&&(s=H(A)*Q,e=R(A)*Q,w=H(A)*c,J=R(A)*c,$.moveTo(s,e),$.lineTo(w,J));$.stroke(),$.rotate(-G);var C=D.lastRotation||o.target.getRotation();$.beginPath(),$.fillStyle="rgba(255, 0, 0, 0.1)",$.strokeStyle="rgb(157, 157, 157)",$.moveTo(0,0),$.arc(0,0,c,0,C,!1),$.fill(),$.beginPath(),$.moveTo(0+c,0),$.arc(0,0,c,0,C,!1),$.stroke(),$.restore()};var cg=li.Curve=function(s){this.catalog="Curve",this._interactor=s};cg.prototype={},cg.prototype.constructor=cg,W.defineProperties(cg.prototype,{activing:{get:function(){return this._activing},set:function(_){var v=this;if(_)v._activing=new li.CurveActiving(this,_);else{var P=v._activing;P&&P.dispose(),v._activing=null}}}}),cg.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},cg.prototype.setUp=function(){var N=this,i=N._interactor;i&&i.gv.mp(N._onGraphviewPropertyChanged,N)},cg.prototype._onGraphviewPropertyChanged=function(i){("zoom"===i.property||"translateX"===i.property||"translateY"===i.property)&&this._handleDataChanged()},cg.prototype.tearDown=function(){var z=this,e=z._interactor;e&&e.gv.ump(z._onGraphviewPropertyChanged,z)},cg.prototype.canEnterEditDetailMode=function(){var B=this,W=B._interactor,w=W._getValidSelection();if(1===w.length){var Q=w[0],o=Q instanceof z.Edge;if(Q instanceof z.Shape||o){if(o){var I=Q.s("edge.type");if(I&&"points"!==I)return}var i=W.gv;if(i.isPointEditable(Q)&&i.isEditable(Q))return B.target=Q,!0}}},cg.prototype.canQuitEditDetailMode=function(B){var o=this,D=o._interactor._getLogicalPoint(B);return o._checkEditRealPoint(D)?void 0:o._interactor.gv.getDataAt(B)!==o.target?!0:void 0},cg.prototype.preHandleScroll=function(){var s=this.editing;return s&&s.inEdit?!0:void 0},cg.prototype.getCurrentSelectintStatus=function(){var P=this;if(P.activing&&!P.activing.selections){if(P.activing.status!=s)return P.activing.status;var i=function(e){var h=P.activing.status;P.activing.status=e,P._interactor.fp("shapePointStatus",h,e)},T=li.Curve.PointType,W=P.activing.point,S=P.activing.pairs;if(!S||1!==S.length)return i(T.Mirrored);var v=S[0],L=v.c1&&v.c1.isNearEnough(W),b=v.c2&&v.c2.isNearEnough(W);if(!v.c1||!v.c2)return L||b?i(T.Straight):i(T.Disconnected);if(L&&b)return i(T.Straight);if(L||b)return i(T.Asymmetric);var J=v.c1.clone().sub(W),t=v.c2.clone().sub(W);return Math.abs(J.x*t.y-J.y*t.x)>1e-5||J.x*t.x>0?i(T.Disconnected):Math.abs(J.length()-t.length())>1e-5?i(T.Asymmetric):i(T.Mirrored)}},cg.prototype.handle_keydown=function(Q){var P=this;if(P._interactor.editDetail){var _=li.Curve.PointType;"1"===Q.key?P._setCurrentSelectionStatus(_.Straight):"2"===Q.key?P._setCurrentSelectionStatus(_.Mirrored):"3"===Q.key?P._setCurrentSelectionStatus(_.Disconnected):"4"===Q.key&&P._setCurrentSelectionStatus(_.Asymmetric)}},cg.prototype.setCurrentSelectionStatus=function(s){var W=this,w=W._interactor;if(w){var m=w.gv;m.dm().beginTransaction(),this._setCurrentSelectionStatus(s),m.dm().endTransaction()}},cg.prototype._setCurrentSelectionStatus=function(h){var A=this,u=A.activing;if(u){var Z=A.getCurrentSelectintStatus();if(null!==Z&&Z!==h){u.status=h;var p=A.activing.point,B=A.activing.pairs;if(B&&1===B.length){var l=B[0],e=A.screenInfo.curve,n=li.Curve.PointType,q=function(){A._writeToHt(),A._interactor.fp("shapePointStatus",Z,h)};if(h===n.Straight)return e.moveCtrlPoint(l,p,"c1"),e.moveCtrlPoint(l,p,"c2"),q(),void 0;if(Z===n.Straight){var v=e.findPairs(p,!0),Q=v[0],x=Q.r1||p,G=Q.r2||p,m=G.clone().sub(x).multiplyScalar(.25);return e.moveCtrlPoint(l,p.clone().sub(m),"c1"),e.moveCtrlPoint(l,p.clone().add(m),"c2"),q(),void 0}var U=l.c1,r=l.c2;if(U&&r){if(h===n.Mirrored)return e.moveCtrlPoint(l,p.clone().multiplyScalar(2).sub(r),"c1"),q(),void 0;if(h===n.Asymmetric&&Z===n.Disconnected){var W=U.clone().sub(p).length(),m=p.clone().sub(r).setLength(W).add(p);return e.moveCtrlPoint(l,m,"c1"),q(),void 0}}u._firePointChange(),A._interactor.fp("shapePointStatus",Z,h)}}}},cg.prototype._handleDataChanged=function(){var n="points,segments,shape,position,rotation,scale".split(",");return function(L){var R=this;if(R.screenInfo&&R.target){if(L&&n.indexOf(L.property)<0)return;var f=R._interactor;R.gatherSingleTarget(f.gv,R.target,!0),R.check(f.gv,null,new li.Math.Vector2(f._lastClientPoint)),f._42()}}}(),cg.prototype.gatherSingleTarget=function(q,H,J){var K,g,f=this;f.screenInfo&&f.screenInfo.curve&&(g=f.screenInfo.curve._curves);var M=f.editing;K=M?f.screenInfo:f.screenInfo={};var E,h,R=H instanceof z.Edge;R?(E=H.s("edge.segments"),h=H.s("edge.points")||new z.List):(E=H._58O,h=H._59O),K.S=E;var i,$=K.P=[],x=li.getDataMatrix(H);if(H instanceof z.Polyline&&(i=H.getElevation()||0,K.E=[]),h.each(function(R){K.E&&K.E.push(R.e||i),R=x.apply(R);var Z=li.toScreenPosition(q,R);$.push(Z.x,Z.y)}),R){var V=li.toScreenPosition(q,H._lastSourcePoint),p=li.toScreenPosition(q,H._lastTargetPoint);$.splice(0,0,V.x,V.y),$.push(p.x,p.y)}if(!K.S||!K.S.size()){K.S=new z.List,K.S.add(1);for(var G=0;G<$.length/2-1;G++)K.S.add(2)}if((!M||J)&&f.convertToCubicBezier(g),f.activing&&(J||!f.editing||"realPoint"===f.editing.type)){var Z=K.curve.findPairs(f.activing.point);f.activing.pairs=Z}R&&"points"!==H.s("edge.type")&&f._writeToHt()},cg.prototype._convertToNewPoint=function($,E,Z,y){var H,g,L;for(H=0,g=E.length;g>H;H++){if(L=E[H],L._p1.isNearEnough($)&&(!y||y.indexOf(L._p1)<0))return L._p1;if(L._p4.isNearEnough($)&&(!y||y.indexOf(L._p4)<0))return L._p4}if(Z)for(H=0,g=Math.min(Z.length,g);g>H;H++){if(L=Z[H],L._p1===$&&(!y||y.indexOf(E[H]._p1)<0))return E[H]._p1;if(L._p4===$&&(!y||y.indexOf(E[H]._p4)<0))return E[H]._p4}},cg.prototype.convertToCubicBezier=function(f){var r,A,H=this,R=new li.Math.Curve,x=H.screenInfo;if(R.createFromHtShape(x.P,x.S,x.E),x.curve=R,H.activing){var y=R._curves;r=H.activing.point,A=H._convertToNewPoint(r,y,f);var O=[];if(A&&(H.activing.point=A,O.push(A)),H.activing.selections){var u=-1,j=H.activing.selections;j.forEach(function(s){u++,A=H._convertToNewPoint(s,y,f,O),A&&(j[u]=A,O.push(A))})}}},cg.prototype.check=function(Z,y,m){if(!y||Gf(y)||To(y)){var E=this;if(E._interactor.setCursor("default"),E.editing=null,E.highlight=null,E.tipInfo=null,E.edgeEditResult=null,E.screenInfo){if($n()||To(y))return E._interactor._42(),!0;if(E._checkEditCtrlPoint(m))return E._interactor._42(),!0;if(E._checkEditRealPoint(m))return E._interactor._42(),!0;if(E._checkEditElevation(m))return E._interactor._42(),!0;var S=E.screenInfo.curve,q=S.checkPoint(m,E._interactor.getStyle("curveIntersectSize"));if(q){var t=E.highlight={};t.type="insertKnot",t.bezier=q.bezier,t.point=q.intersection}return E._interactor._42(),!0}}},cg.prototype._checkEditRealPoint=function(Q){var c,F,n,b,T,B,K=this,D=K.screenInfo.curve._curves,f=K._interactor.getStyle("curvePointIntersectSize"),V=1/0;for(f*=f,n=0,b=D.length;b>n;n++)c=D[n],T=c._p1,B=Q.distanceToSquared(T),V>B&&(V=B,F=T),T=c._p4,B=Q.distanceToSquared(T),V>B&&(V=B,F=T);if(V>f)return!1;var x=K.highlight={};return x.type="changeRealPoint",x.point=F,K.editing={type:"realPoint",point:F,shiftGuide:{point:F.clone(),dir:"x",limit:0}},K._interactor.setCursor("crosshair"),!0},cg.prototype._checkEditElevation=function(p){var Y=this;if(!Y._interactor.getStyle("curveElevationVisible"))return!1;var C=Y.activing;if(!C)return!1;var W=C.getCurrentEditingPoint();if(!W)return!1;var v=Y._interactor,o=v.getStyle("curveElevationGuideShift"),z=v.getStyle("curveElevationIntersectSize"),B=p.distanceToSquared({x:W.x+o[0],y:W.y+o[1]});if(!(B>z*z)){var _=Y.highlight={};_.type="elevation";var g=new li.Math.Vector2(p.x,p.y,W.e);return Y.editing={type:"elevation",startPoint:g},Y._interactor.setCursor("crosshair"),!0}},cg.prototype._checkEditCtrlPoint=function(O){var l=this;if(l.activing&&!l.activing.selections){var j=l.getCurrentSelectintStatus();if(j!==li.Curve.PointType.Straight){var Z=l.activing.pairs;if(Z){var u=l._interactor.getStyle("curvePointIntersectSize");u*=u;var F,v,J,W,B,I,c,M,_,N=1/0;for(c=0,_=Z.length;_>c;c++)for(W=Z[c],M=0;2>M;M++)B=0===M?"c1":"c2",W[B]&&(I=O.distanceToSquared(W[B]),N>I&&(N=I,F=W,v=c,J=B));if(N>u)return!1;l.activing.hlpair=F,l.activing.hltype=J;var m=l.highlight={};return m.type="changeCtrlPoint",m.point=F[J],l.editing={type:"ctrlPoint",pair:F,pairId:v,ctrlType:J,direction:F[J].clone().sub(l.activing.point).normalize()},l._interactor.setCursor("crosshair"),!0}}}},cg.prototype.startEdit=function(v,K){v.startDragging(K);var C=this;C.highlight&&"insertKnot"===C.highlight.type&&(C.insertKnot(),C.gatherSingleTarget(C._interactor.gv,C.target),C.activing=null,C._checkEditRealPoint(C._interactor._getLogicalPoint(K)));var M=C._activing;if(M){var c=C.editing?C.editing.type:null;"ctrlPoint"===c?M.editingCtrl={pairId:C.editing.pairId,type:M.hltype}:"realPoint"===c&&(M.editingCtrl=!1)}var H=C.highlight,_=z.Default.isCtrlDown(K);if(!H||$n()||To(K)){var k=C._interactor.gv;if(!k.setFocus(K)||k._scrolling)return;return _?C._multiSelect={startPoint:k.lp(K)}:k.isPannable()&&(Gf(K)||To(K))&&(C._pan={tx:k.tx(),ty:k.ty()},v.fi({kind:"beginPan",event:K})),void 0}if("changeRealPoint"===H.type){var B,b=C.activing?C.activing.point:null,p=C.activing?C.activing.selections:null;if(_&&C.activing)b===H.point?(p?(C.activing={point:p[0]},p.length>1&&(p.splice(0,1),C.activing.selections=p)):C.activing=null,C.editing=null):p&&(B=p.indexOf(H.point))>=0?(p.length>1?p.splice(B,1):delete C.activing.selections,C.editing=null):p?(p.push(b),C.activing={point:H.point,selections:p}):C.activing={point:H.point,selections:[b]};else if(p)b===H.point||((B=p.indexOf(H.point))>=0?(p.splice(B,1,b),C.activing={point:H.point,selections:p}):C.activing={point:H.point});else{var y;b===H.point&&(y=C.activing.status),C.activing={point:H.point},y&&(C.activing.status=y)}v.fi({kind:"beginEditPoint",event:K})}},cg.prototype.insertKnot=function(){var X=this,F=X.highlight,z=X.screenInfo.curve;z.insertKnot(F.bezier,F.point.t),X._writeToHt()},cg.prototype._writeToHt=function(){var W,r,H,d,g=this,y=g.screenInfo.curve,J=y.toHtShape(),l=J.points,O=[],B=J.segments,k=g._interactor.gv,F=g.target,q=F instanceof z.Edge,N=li.getDataMatrix(F).invert();d=F instanceof z.Polyline,d&&(H=F.getElevation());for(var e=0,Z=l.length;Z>e;e++)W=l[e],r=li.toWorldPosition(k,W),r=N.apply(r),W.e!=s&&W.e!==H&&(r.e=W.e),O.push(r);if(F._writing=!0,q){F.s("edge.type","points"),F.setStyle("edge.segments",B),F.setStyle("edge.points",O.slice(1,O.length-1)),F.setStyle("edge.source.offset.x",0),F.setStyle("edge.source.offset.y",0),F.setStyle("edge.target.offset.x",0),F.setStyle("edge.target.offset.y",0);var K=g._nextChangeEdgeHost;delete g._nextChangeEdgeHost,K&&("source"===K.type?F.setSource(K.host):F.setTarget(K.host)),g._writeEdgeHostAnchor("source",O[0]),g._writeEdgeHostAnchor("target",O[O.length-1])}else O.length?(F.setSegments(B),F.setPoints(O,!0)):F.removeFromDataModel();delete F._writing},cg.prototype._writeEdgeHostAnchor=function(i,n){var I=this,f=I.target,_=I._calcHostAnchor(f,i,n);_.index!==s?(f.setStyle("edge."+i+".index",_.index),f.setStyle("edge."+i+".percent",s),f.setStyle("edge."+i+".anchor.x",s),f.setStyle("edge."+i+".anchor.y",s)):_.percent!==s?(f.setStyle("edge."+i+".percent",_.percent),f.setStyle("edge."+i+".index",s),f.setStyle("edge."+i+".anchor.x",s),f.setStyle("edge."+i+".anchor.y",s)):(f.s("edge."+i+".anchor.x",_.x),f.s("edge."+i+".anchor.y",_.y),_.offsetX||_.offsetY?(f.s("edge."+i+".offset.x",_.offsetX),f.s("edge."+i+".offset.y",_.offsetY)):(f.s("edge."+i+".offset.x",0),f.s("edge."+i+".offset.y",0)))},cg.prototype._calcHostAnchor=function(T,W,f,$){$||($="source"===W?T.getSource():T.getTarget());var U=this._interactor.gv,S=U.calculateAttachPoint($,f);if(S)return S.info;if(Wg($)){var x=U.calculateEdgePosition($,f);return x}var l=$.getRotation(),Y=$.getAnchor();if(Bg($,U)&&(l=0),l){var D=$.getMatrix(),h=D.tfi(f),s=$.getSize();return{x:h.x/s.width+Y.x,y:h.y/s.height+Y.y}}var k=Kn(U,$),M={x:(f.x-k.x)/k.width,y:(f.y-k.y)/k.height};return M},cg.prototype._handlePanning=function(L){var S=this,Z=S._pan;if(Z){Z.started=!0;var z=S._interactor,R=z.gv,h=z._lastClientPoint,E=Bb(L),V=Wo(R,E,h);R.setTranslate(Z.tx+V.x,Z.ty+V.y),S.gatherSingleTarget(z.gv,S.target),z._42(),z.fi({kind:"betweenPan",event:L})}},cg.prototype.handleEdit=function(r,f){var w=this,c=w.editing;if(w._pan)return w._handlePanning(f),void 0;if(w._multiSelect)return w._multiSelect.endPoint=r.lp(f),w._interactor.redraw(),void 0;if(c){c.inEdit=!0;var B,Q,q,I=w._interactor._getLogicalPoint(f),$=z.Default.isCtrlDown(f),p=z.Default.isShiftDown(f),b=c.type,g=w.activing;if(w._guideInfo=null,"ctrlPoint"===b&&p){var y=w.editing.direction.clone();B=g.point;var P=y.dot(I.clone().sub(B));I=y.setLength(P).add(B)}else if("ctrlPoint"===b||"realPoint"===b){var y;if("realPoint"===b&&p){var t=w.editing.shiftGuide;Q=t.point;var S=Math.abs(I.x-Q.x),U=Math.abs(I.y-Q.y);S>U&&S>t.limit&&"y"===t.dir&&(t.dir="x"),U>S&&U>t.limit&&"x"===t.dir&&(t.dir="y"),y=t.dir,"x"===y?(I.y=Q.y,t.limit=Math.max(t.limit,S)):"y"===y&&(I.x=Q.x,t.limit=Math.max(t.limit,U))}var M=w._isEditEdgeSourceTarget();if(M){var N=w._editEdgeSourceTarget(M,I,$);N&&(w.edgeEditResult=N,q=N.tipText)}else if(!$){var K=w._guidingToEdit(I,y),G="realPoint"===b?w._interactor.gridGuide.findClosest(I,y,!0):null,i=1/0,u=1/0;G&&(G.x&&(i=G.x),G.y&&(u=G.y));var d=!1;K&&(K.xList&&(Math.abs(K.x)<=Math.abs(i)?(d=!0,i=K.x):delete K.xList),K.yList&&(Math.abs(K.y)<=Math.abs(u)?(d=!0,u=K.y):delete K.yList),d&&(w._guideInfo=K)),isFinite(i)&&(I.x+=i),isFinite(u)&&(I.y+=u),d&&(K.v=I)}}var R=w.screenInfo.curve;if("realPoint"===c.type){B=c.point,B.e!==s&&(I.e=B.e),R.moveRealPoint(B,I),c.point=I,w.highlight.point=I;var x=g.status,E=g.selections;if(w.activing={point:I,status:x},E){var V=I.clone().sub(B),A=0;E.forEach(function(X){var r=X.clone().add(V);R.moveRealPoint(X,r),E[A++]=r}),w.activing.selections=E}}else if("ctrlPoint"===c.type){var h=g.pairs,e=h[c.pairId];R.moveCtrlPoint(e,I,c.ctrlType);var C=g.status,W=li.Curve.PointType;if((C===W.Mirrored||C===W.Asymmetric)&&e.c1&&e.c2){var B=new li.Math.Vector2(g.point),j="c1"===c.ctrlType?"c2":"c1";if(C===li.Curve.PointType.Mirrored)R.moveCtrlPoint(e,B.clone().multiplyScalar(2).sub(I),j);else if(C===W.Asymmetric){var P=e[j].clone().sub(B).length(),Y=B.clone().sub(e[c.ctrlType]).setLength(P).add(B);isNaN(Y.x)||R.moveCtrlPoint(e,Y,j)}}g._firePointChange()}else if("elevation"===c.type){Q=c.startPoint;var n=Q.e+(Q.y-I.y)/r._zoom;w._setCurrentPointImpl("e",n),g._firePointChange(),q="E: "+li.toFixed(n)}var o=z.Default.getLogicalPoint(f,w._interactor._canvas);if(o.x+=li.Icons.TipShiftX,o.y+=li.Icons.TipShiftY,!q){var X=li.toWorldPosition(r,I);q=""+li.toFixed(X.x)+", "+li.toFixed(X.y)}w.tipInfo={helperPos:o,text:q,size:q.length},w._writeToHt(),w._interactor.fi({kind:"betweenEditPoint",event:f})}},cg.prototype._setCurrentPointImpl=function(S,z){var u=this,P=u._activing;if(!P)return!1;var a=u.target;if(!a)return!1;var Y=P.getCurrentEditingPoint();if(!Y)return!1;var J=P.editingCtrl;if(!J)var p=Y.clone();if("e"===S)Y.e=z;else{var g;if("x"===S||"y"===S){var T=P._lastFirePoint;g="x"===S?{x:z,y:T?T.y:0}:{x:T?T.x:0,y:z}}else"object"==typeof S?(g=S,S.e!==s&&(Y.e=S.e)):(g={x:arguments[0],y:arguments[1]},arguments[2]!==s&&(Y.e=arguments[2]));var M=li.getDataMatrix(a);g=li.toScreenPosition(u._interactor.gv,M.apply(g)),Y.x=g.x,Y.y=g.y}if(!J){var e=p.multiplyScalar(-1).add(Y);Y.e&&p.e&&(e.e=Y.e-p.e),u.screenInfo.curve.moveCtrlDueToRealPointMovement(Y,e)}return!0},cg.prototype.setCurrentPoint=function(i,J){return this._setCurrentPointImpl(i,J)?(this._writeToHt(),!0):!1},cg.prototype._isEditEdgeSourceTarget=function(){var m=this,N=m.target;if(!(N instanceof z.Edge))return!1;var y=m.editing.point,x=m.screenInfo.curve._curves;return y===x[0]._p1?"source":y===x[x.length-1]._p4?"target":!1},cg.prototype._editEdgeSourceTarget=function(g,U,k){var Z,Q=this,i=Q.target;if(Z="source"===g?i.getSource():i.getTarget()){var D,O=Q._interactor.gv,B=li.toWorldPosition(O,U),L=Q._calcHostAnchor(i,g,B,Z);if(D=L.index!==s||L.percent!==s?L.distance*O.getZoom()>Q._interactor.getStyle("edgeHostEdgeMaxDistance"):Q._interactor.getStyle("edgeHostDetectPerFrame")?!0:L.x<0||L.x>1||L.y<0||L.y>1?!0:!1){var C=O.getDataAt(B,function(C){return O.isSelectable(C)?C===Z?!1:i.canSetSourceTarget(C,g)?!0:!1:!1});if(C){var n=Q._calcHostAnchor(i,g,B,C);Z=C,Q._nextChangeEdgeHost={type:g,host:C},L=n}}var o,l,m;if(k||L.x===s)(L.percent!==s||L.index!==s)&&(l=L.point);else{var q=Q._interactor.getStyle("anchorRound"),I=Q._interactor.getStyle("anchorSensitivity");o=O.calculateAttachPoint(Z,B),o?L=o.info:(L.x=li.roundTo(L.x,q,I),L.y=li.roundTo(L.y,q,I)),l=Z.getAttachPosition(L.x,L.y,L.offsetX,L.offsetY)}l&&(m=li.toScreenPosition(O,l),U.x=m.x,U.y=m.y),Q._edgeHostGuideInfo={corners:li.getTargetCornersOnScreen(O,Z),attach:o?o.index:-1,host:Z};var K;return L.percent!==s?K="percent: "+L.percent.toFixed(2):L.index!==s?K="index: "+L.index:(K=""+L.x.toFixed(2)+", "+L.y.toFixed(2),(L.offsetX||L.offsetY)&&(K+=" offset: "+L.offsetX.toFixed(2)+", "+L.offsetY.toFixed(2))),{host:Z,anchor:L,tipText:K}}},cg.prototype._guidingToEdit=function(c,Z){var u,L,J=this;if(u=J.screenInfo.curve){L=u._curves;var z,Q,i,Y,G,y,h,s,p=1/0,F=1/0,e=[];for(J.editing&&"realPoint"===J.editing.type&&(s=J.editing.point),G=0,y=2*L.length;y>G;G++)h=L[Math.floor(G/2)][G%2?"_p4":"_p1"],e.indexOf(h)>=0||(e.push(h),s&&s===h||(i=h.x-c.x,Y=h.y-c.y,Math.abs(i)<Math.abs(p)?(p=i,z=[h]):i===p&&z.push(h),Math.abs(Y)<Math.abs(F)?(F=Y,Q=[h]):Y===F&&Q.push(h)));var q=J._interactor.getStyle("smartGuideSensitivity");if((Math.abs(p)>q||"y"===Z)&&(z=null),(Math.abs(F)>q||"x"===Z)&&(Q=null),z||Q){var g=!1,K={};if(z&&(g=!0,K.xList=z,K.x=p),Q&&(g=!0,K.yList=Q,K.y=F),g)return K}}},cg.prototype._46O=function(L){var V=this;V.editing&&(V.editing=null,V._interactor.fi({kind:"endEditPoint",event:L})),V._guideInfo=null,V._edgeHostGuideInfo=null,V._pan&&(V._pan=null,V._interactor.fi({kind:"endPan",event:L})),V._multiSelect&&(V._handleMultiSelect(V._multiSelect),V._multiSelect=null),V.tipInfo=null,V.edgeEditResult=null},cg.prototype._handleMultiSelect=function(L){if(L.startPoint&&L.endPoint){var w,b,J,I,R,d=this,v=d._interactor,E=v.gv,g=li.toScreenPosition(E,L.startPoint),j=li.toScreenPosition(E,L.endPoint),m=z.Default.unionPoint(g,j),r=d.screenInfo.curve._curves,O=[],S=function(X){X.x>=m.x&&X.y>=m.y&&X.x<=m.x+m.width&&X.y<=m.y+m.height&&O.indexOf(X)<0&&O.push(X)};for(w=0,b=r.length;b>w;w++)R=r[w],S(R._p1),S(R._p4);if(O.length){var F=d.activing||{},c=F.selections||[];for(F.point&&c.push(F.point),w=0,b=c.length;b>w;w++)J=c[w],I=O.indexOf(J),I>=0?O[I]=s:O.push(J);var o=O;for(O=[],w=0,b=o.length;b>w;w++)o[w]&&O.push(o[w]);b=O.length,0===b?d.activing=null:1===b?d.activing={point:O[0]}:(J=O[b-1],d.activing={point:J,selections:O.splice(0,b-1)}),v.redraw()}}},cg.prototype._canDeletePoint=function(E,R){var Q=this.target;if(!(Q instanceof z.Edge))return!0;var Y=E._curves[0],D=E._curves[E._curves.length-1];return Y._p1===R||D._p4===R?!1:!0},cg.prototype.handleDelete=function(){var M=this;if(M.activing&&M.screenInfo){var O=z.Default.isShiftDown(),v=M.screenInfo.curve;M._canDeletePoint(v,M.activing.point)&&v.deleteRealPoint(M.activing.point,O),M.activing.selections&&M.activing.selections.forEach(function(y){M._canDeletePoint(v,y)&&v.deleteRealPoint(y,O)}),M.activing=null,delete M.editing,delete M.tipInfo,delete M.edgeEditResult,delete M._pan,delete M._multiSelect,M._writeToHt(),M._interactor.fp("deleteShapePoint",!1,!0)}},cg.prototype.handleDoubleClick=function(d){var r=this,q=r._interactor._getLogicalPoint(d);if(r.screenInfo&&r._checkEditRealPoint(q)){var i=r.getCurrentSelectintStatus(),T=li.Curve.PointType;return i=i===T.Mirrored?T.Straight:T.Mirrored,r._setCurrentSelectionStatus(i),r._interactor._42(),!0}},cg.prototype._drawHighlight=function(q){var Y=this,J=Y.highlight;if(J){var a=J.bezier,V=Y._interactor;a&&li.Icons.DrawIcon(V,q,li.Icons.ShapeHighlightCurve,[a._p1.x,a._p1.y,a._p2.x,a._p2.y,a._p3.x,a._p3.y,a._p4.x,a._p4.y]);var c=J.point;c&&"insertKnot"===J.type&&li.Icons.DrawIcon(V,q,li.Icons.ShapeHighlighPoint,c)}},cg.prototype._drawGuide=function(c){var $=this,q=$._guideInfo;if(q){var L,B,A,O,i=q.v;for(L=0;2>L;L++)if(O=0===L?q.xList:q.yList)for(B=0,A=O.length;A>B;B++)li.Icons.DrawIcon($._interactor,c,li.Icons.ShapeGuideLine,[i.x,i.y,O[B].x,O[B].y])}},cg.prototype._drawCurrentPoint=function(_){var E=this;if(E.activing){var b=E.activing,V=E.getCurrentSelectintStatus(),S=E._interactor;if(V!==li.Curve.PointType.Straight){var v=b.pairs;b.hlpair,b.hltype;var P=b.selections,M=b.editingCtrl;if(v&&!P){var n,r,I;for(r=0,I=v.length;I>r;r++)n=v[r],M&&r===M.pairId&&n[M.type]?li.Icons.DrawIcon(S,_,li.Icons.ShapeActivingCtrl,{point:n.point,c1:n.c1,c2:n.c2,hl:M.type}):li.Icons.DrawIcon(S,_,li.Icons.ShapeActivingCtrl,n)}}li.Icons.DrawIcon(S,_,li.Icons.ShapeHighlighRealPoint,E.activing.point),P&&P.forEach(function(N){li.Icons.DrawIcon(S,_,li.Icons.ShapeHighlighRealPoint,N)})}},cg.prototype.clear=function(){var b=this;b.editing=null,b._guideInfo=null,b.activing=null,b.highlight=null},cg.prototype._42=function($){var m=this;m.info={},m.editing||(m.screenInfo=null);var S=m._interactor;if(!S.editDetail)return m.clear(),void 0;var Q=S.gv;if(!m.target||!Q.isSelected(m.target)||!Q.isVisible(m.target))return S.editDetail=!1,m.clear(),void 0;if(m.gatherSingleTarget(Q,m.target),li.Icons.DrawIcon(S,$,li.Icons.ShapeBgCurve,m.screenInfo),m._drawHighlight($),m._drawCurrentPoint($),m._getRealPoint().forEach(function(M){li.Icons.DrawIcon(S,$,li.Icons.ShapePoint,M)}),m._drawGuide($),m.tipInfo&&li.Icons.DrawIcon(S,$,li.Icons.TipHelper,m.tipInfo),m._edgeHostGuideInfo){li.Icons.DrawIcon(S,$,li.Icons.NodeHoverGuide,m._edgeHostGuideInfo.corners);var b=m._edgeHostGuideInfo.host;if(b){var I=Q.getAttachPoints(b);if(I&&I.length)for(var y=0,k=I.length;k>y;y++){var o=I[y],E=b.getAttachPosition(o.x,o.y,o.offsetX,o.offsetY);E=li.toScreenPosition(Q,E),E.isAttach=m._edgeHostGuideInfo.attach===y,li.Icons.DrawIcon(S,$,li.Icons.AttachPoint,E)}}}if(m._interactor.getStyle("curveElevationVisible")&&m.target instanceof z.Polyline&&m.activing){var g=m.activing.getCurrentEditingPoint();g&&li.Icons.DrawIcon(S,$,li.Icons.EdgeElevationGuide,g)}if(m.edgeEditResult&&m._drawEdgeHostHighlight($,m.edgeEditResult.host,m.edgeEditResult.anchor),m._multiSelect&&m._multiSelect.endPoint){var N=z.Default.unionPoint(li.toScreenPosition(Q,m._multiSelect.startPoint),li.toScreenPosition(Q,m._multiSelect.endPoint));N.color=Q.getRectSelectBorderColor(),$.save(),$.setTransform(1,0,0,1,0,0);var Z=V.devicePixelRatio,p=N.borderWidth=Math.round(Z);p/=2,N.x=Math.round(N.x*Z)+p,N.y=Math.round(N.y*Z)+p,N.width=Math.round(N.width*Z),N.height=Math.round(N.height*Z),li.Icons.DrawIcon(S,$,li.Icons.SimpleRect,N),$.restore()}},cg.prototype._drawEdgeHostHighlight=function(F,U,O){this.drawEdgeHostHighlight(F,U,O),this._interactor.redraw()},cg.prototype.drawEdgeHostHighlight=function(g,A,N){if(Wg(A)){var R,D,B,Y,H=this,I=H._interactor,t=I.gv,Q=t.getDataUI(A),x=kk(Q),v=[];for(B=0,Y=x.points.length;Y>B;B++)D=li.toScreenPosition(t,x.points.get(B)),v.push(D.x,D.y);x.segments&&(R=x.segments.toArray());var c=I.getStyle("edgeHostHighlighPeriod"),V=I.getStyle("edgeHostEdgeHighlighColor");li.Icons.DrawIcon(I,g,li.Icons.ShapeBgCurve,{P:v,S:R,color:V,dynamicVisible:N.index===s,dynamicPeriod:c}),V=I.getStyle("edgeHostPointHighlighColor");var e=lc(Q);for(B=0,Y=e.length;Y>B;B++){var p=e[B],F=li.toScreenPosition(t,p);li.Icons.DrawIcon(I,g,li.Icons.ShapePoint,{point:{x:F.x,y:F.y},color:V,size:12,dynamicVisible:B===N.index,dynamicPeriod:c})}}},cg.prototype._getRealPoint=function(){var P,X=this.screenInfo,u=X.P,l=X.S,W=-1,o=[],w=-1,c=l.length;return l.each(function(J){w++;var g=1;if(3===J)g=2;else if(4===J)g=3;else if(5===J)return;W+=g,P=w+1>=c?!0:1===l.get(w+1)?!0:!1,o.push({point:{x:u[2*W],y:u[2*W+1]},segmentIndex:w,pointIndex:W,isEnd:P})}),o},cg.prototype.getEditingPointsInfo=function(k){var c=this,H=c.activing;if(!H)return!1;var l=H.point;if(!l)return!1;var E=this._getRealPoint(),R=[{screen:l}];H.selections&&H.selections.forEach(function(D){R.push({screen:D})});var f,$,o=E.length;return R.forEach(function(q){for(f=0;o>f;f++)if($=E[f],q.screen.isNearEnough($.point)){q.segmentIndex=$.segmentIndex,q.pointIndex=$.pointIndex,q.point=c.target.getPoints().get($.pointIndex);break}}),k&&R.sort(function(N,h){return N.segmentIndex-h.segmentIndex}),R};var wr=li.MoveHelper=function(o){var I=this;I.catalog="Move",I._interactor=o};wr.prototype={},wr.prototype.constructor=wr,wr.prototype.calcShift=function(c,P,y){var _,j,X=this,i=X._interactor.gv,U=i.lp(P);if("beginMove"===c&&X._gatherGridInfo(y._lastLogicalPoint||U),_=X._target){var G=_.downPosition;if(G){var a=X._interactor.getStyle("moveSensitivity")/i._zoom;if(G.distanceTo(U)<a)return{x:0,y:0};delete _.downPosition}var n;j=z.Default.isShiftDown(P),j&&(U=X._dealShiftDown(U),n=_.shiftGuide.dir);var Z,E=_.rawPos={x:_.pos.x+U.x-_.lp.x,y:_.pos.y+U.y-_.lp.y};if(z.Default.isCtrlDown(P)){if(Z=X._calcShiftByAddon(),X._target.node instanceof li.Group){var O=X._target.node;O._position.x+=Z.x,O._position.y+=Z.y}return Z}for(var S,J=_.x+E.x,x=_.y+E.y,p={x:J,y:x},F={x:J+_.w/2,y:x+_.h/2},v={x:J+_.w,y:x+_.h},o=X._interactor.rectGuide,D=X._interactor.gridGuide,e=[o.findClosest(p,n),o.findClosest(F,n),o.findClosest(v,n),D.findClosest(p,n),D.findClosest(F,n),D.findClosest(v,n)],T=1/0,Q=1/0,h=0,L=e.length;L>h;h++)S=e[h],S&&(J=S.x,x=S.y,isFinite(J)&&Math.abs(J)<Math.abs(T)&&(T=J),isFinite(x)&&Math.abs(x)<Math.abs(Q)&&(Q=x));if(isFinite(T)||(T=0),isFinite(Q)||(Q=0),Z=X._calcShiftByAddon(T,Q),X._target.node instanceof li.Group){var O=X._target.node;O._position.x+=Z.x,O._position.y+=Z.y}var r=_.node;if(!Bg(r,i)){var u=E.x+T,l=E.y+Q;X._interactor.rectGuide.gatherLines({node:r,x:_.x+u,y:_.y+l,w:_.w,h:_.h},n)}return Z}},wr.prototype._calcShiftByAddon=function(h,u){var T=this._target,p=T.rawPos,X=T.node.getPosition();return h=h||0,u=u||0,{x:p.x-X.x+h,y:p.y-X.y+u}},wr.prototype._dealShiftDown=function(u){var v=this,J=v._target.shiftGuide,B=v._target.lp,E=Math.abs(u.x-B.x),i=Math.abs(u.y-B.y);E>i&&E>J.limit&&"y"===J.dir&&(J.dir="x"),i>E&&i>J.limit&&"x"===J.dir&&(J.dir="y");var A=J.dir;return"x"===A?(u.y=B.y,J.limit=Math.max(J.limit,E)):"y"===A&&(u.x=B.x,J.limit=Math.max(J.limit,i)),u},wr.prototype._gatherGridInfo=function(Z){var k,h=this,q=h._interactor,$=q._getValidSelection();if($.length){if(1===$.length){if(k=$[0],!k.getRect)return h._target=null,void 0}else if(k=li.Group.findOrCreateGroup($),!k)return h._target=null,void 0}else{var $=q.gv.sm().getSelection();if($.length&&(k=$.get(0),!k.getRect))return h._target=null,void 0}var n=k.getPosition(),o=k.getRect();h._target={node:k,x:o.x-n.x,y:o.y-n.y,w:o.width,h:o.height,lp:{x:Z.x,y:Z.y},pos:{x:n.x,y:n.y},shiftGuide:{dir:"x",limit:0},downPosition:new li.Math.Vector2(Z)},q.rectGuide.gatherRects()},wr.prototype.clear=function(){var Y=this;Y._interactor.rectGuide.clear(),Y._interactor._42()};var nc="directional",Mc="point",vf="spot",zf="light.color",Rm={},nr=function(K,N){fh(N)&&kj.test(N)?Sr(K,N):yp(N)&&N.modelType?Gm(K,N):Eg[K]=N},sl=function(Z){if(yp(Z))return Z.modelType?Z.uuid?Eg[Z.uuid]:(Z.uuid=z.Math.generateUUID(),Gm(Z.uuid,Z),s):Z;var u=Eg[Z];return Z&&u===s&&kj.test(Z)&&(Vg&&Vg[Z]||Sr(Z,Z)),u},Zf=function(W,X){W.frameStack?W.frameStack.push(X):W.frameStack=[X],W.bindFramebuffer(W.FRAMEBUFFER,X)},Zr=function(v){var m=v.frameStack;if(m){if(m.pop(),m.length)return v.bindFramebuffer(v.FRAMEBUFFER,m[m.length-1]),void 0;v.frameStack=null}v.bindFramebuffer(v.FRAMEBUFFER,null)};Vp(Q,{graph3dViewAttributes:N,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:f/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:ym,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:f/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:nr,getShape3dModel:sl,createMatrix:function(n,J){pi(n)||(n=[n]);for(var s=n.length-1;s>=0;s--){var E=n[s];J=mf(E.mat,E.s3,E.r3,E.rotationMode,E.t3,J)}return J},transformVec:function(u,w){return Ij(u,w)},glBindFrame:Zf,glUnbindFrame:Zr,createBoxModel:function(){return{vs:mn,ns:Gp,uv:Hl,is:Nc}},createRoundRectModel:function(A,H){return sr.roundRect(A,H)},createStarModel:function(w,O){return sr.star(w,O)},createRectModel:function(g,$){return sr.rect(g,$)},createTriangleModel:function(n,S){return sr.triangle(n,S)},createRightTriangleModel:function(T,L){return sr.rightTriangle(T,L)},createParallelogramModel:function(m,g){return sr.parallelogram(m,g)},createTrapezoidModel:function(D,v){return sr.trapezoid(D,v)},createSmoothSphereModel:function(S,m,v,W,K,F,t){return Yf(new zc(S,m,v,W,K,F,t))},createSphereModel:function(p,j,R,C,g,X){return p?Dk(p,j,R,C,g,X):Q.createSmoothSphereModel()},createSmoothConeModel:function(u,T,t,M,B){return Ro(u,T,t,M,B)},createConeModel:function(R,E,g,S,v,l){return R?eb(R,E,g,S,v,l):Ro(l)},createSmoothCylinderModel:function(b,P,$,Y,K,g,A,q){return Yf(new Pg(b,P,$,Y,K,g,A,q))},createCylinderModel:function(a,q,S,X,N,e,w){return a?le(a,q,S,X,N,e,w):qo(e,w)},createSmoothTorusModel:function($,O,Z,X,p,b){return Yf(new up($,O,Z,X,p,b))},createTorusModel:function(o,s,N,P,z,q,G){return o?Od(o,s,N,P,z,q,G):Zc(q,G)},createExtrusionModel:function(h,v,Q,l,A,L,i,q){return kl(h,v,Q,l,A,L,i,q)},createSmoothRingModel:function(C,p,m,w,n,i){for(var H=[],r=0;r<C.length-1;r+=2)H.push({x:C[r],y:C[r+1]});for(C=$l(H,p,m)[0],H=[],r=0;r<C.length;r++){var V=C[r];H.push(new hr(V.x,0,V.y))}return Yf(new _r(H,i,w,n))},createTextGeometry:function(c,u){return Yf(new Ok(c,u))},loadFontFace:function(p,$){Q.xhrLoad(p,function(V){if(!V)return $();var T;try{T=JSON.parse(V)}catch(s){T=JSON.parse(V.substring(65,V.length-2))}ud.loadFace(T),$&&$(T.familyName.toLowerCase())},$?null:{sync:!0})},createRingModel:function(V,F,r,T,f,b,v,g,m,S){for(var E=[],x=0;x<V.length-1;x+=2)E.push({x:V[x],y:V[x+1]});b=b||Q.shapeSide,v=v||0,g=g||b;var a,A,X,B,t,d,o,Z,e,W,x,P,D,i,M,k,G,J,h=[],n=[],I=m?[]:N,U=m?[]:N,$=S?[]:N,l=S?[]:N,s=T?[]:N,_=T?[]:N,w=f?[]:N,z=f?[]:N,V=$l(E,F,r),K=Ag(V),C=0,j=2*Math.PI/b;return V.forEach(function(c){if(X=c.length,X>1){if(B=c[0],T)for(d=B.x,Z=B.y,x=v;g>x;x++)P=x+1,D=x*j,i=P*j,M=H(D),k=R(D),G=H(i),J=R(i),s.push(M*d,Z,-k*d,G*d,Z,-J*d,0,Z,0),_.push(.5-.5*M,.5-.5*k,.5-.5*G,.5-.5*J,.5,.5);for(W=0;X>W;W++){for(t=c[W],d=B.x,o=t.x,Z=B.y,e=t.y,a=C/K,C+=Df(B,t),A=C/K,x=v;g>x;x++)P=x+1,D=x*j,i=P*j,M=H(D),k=R(D),G=H(i),J=R(i),h.push(M*o,e,-k*o,G*o,e,-J*o,M*d,Z,-k*d,G*o,e,-J*o,G*d,Z,-J*d,M*d,Z,-k*d),n.push(x/b,A,P/b,A,x/b,a,P/b,A,P/b,a,x/b,a),m&&x===v&&(I.push(0,Z,0,0,e,0,M*o,e,-k*o,M*o,e,-k*o,M*d,Z,-k*d,0,Z,0),U.push(0,.5-Z,0,.5-e,2*o,.5-e,2*o,.5-e,2*d,.5-Z,0,.5-Z)),S&&P===g&&($.push(0,Z,0,G*o,e,-J*o,0,e,0,G*o,e,-J*o,0,Z,0,G*d,Z,-J*d),l.push(1,.5-Z,1-2*o,.5-e,1,.5-e,1-2*o,.5-e,1,.5-Z,1-2*d,.5-Z));B=t}if(f)for(d=B.x,Z=B.y,x=v;g>x;x++)P=x+1,D=x*j,i=P*j,M=H(D),k=R(D),G=H(i),J=R(i),w.push(G*d,Z,-J*d,M*d,Z,-k*d,0,Z,0),z.push(.5-.5*G,.5+.5*J,.5-.5*M,.5+.5*k,.5,.5)
}}),{vs:h,uv:n,bottom_vs:w,bottom_uv:z,top_vs:s,top_uv:_,from_vs:I,from_uv:U,to_vs:$,to_uv:l}}},!0),Vp(e,{"3d.move.mode":s,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":s,"edge.gradient.color":s,"edge.source.t3":s,"edge.target.t3":s,"light.type":Mc,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":f/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Jo,"wf.short":!1,"wf.mat":s,"wf.geometry":!1,batch:s,"transparent.mask":!1,brightness:s,"select.brightness":.7,"repeat.uv.length":s,alphaTest:.4,renderTextureSamples:4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":fr,"label.t3":s,"label.r3":s,"label.texture.scale":2,"label.rotationMode":pm,"label.light":!1,"label.blend":s,"label.reverse.flip":!1,"label.reverse.color":Jj,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":fr,"label2.t3":s,"label2.r3":s,"label2.texture.scale":2,"label2.rotationMode":pm,"label2.light":!1,"label2.blend":s,"label2.reverse.flip":!1,"label2.reverse.color":Jj,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":fr,"note.t3":s,"note.r3":s,"note.texture.scale":2,"note.rotationMode":pm,"note.light":!1,"note.blend":s,"note.reverse.flip":!1,"note.reverse.color":Jj,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":fr,"note2.t3":s,"note2.r3":s,"note2.texture.scale":2,"note2.rotationMode":pm,"note2.light":!1,"note2.blend":s,"note2.reverse.flip":!1,"note2.reverse.color":Jj,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:s,"shape3d.color":tg,"shape3d.top.color":s,"shape3d.bottom.color":s,"shape3d.from.color":s,"shape3d.to.color":s,"shape3d.image":s,"shape3d.top.image":s,"shape3d.bottom.image":s,"shape3d.from.image":s,"shape3d.to.image":s,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":s,"shape3d.side.to":s,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":s,"shape3d.opacity":s,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Jj,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":s,"shape3d.uv.scale":s,"shape3d.top.uv.offset":s,"shape3d.top.uv.scale":s,"shape3d.bottom.uv.offset":s,"shape3d.bottom.uv.scale":s,"shape3d.from.uv.offset":s,"shape3d.from.uv.scale":s,"shape3d.to.uv.offset":s,"shape3d.to.uv.scale":s,"shape3d.top.cap":s,"shape3d.bottom.cap":s,"shape3d.start.angle":0,"shape3d.sweep.angle":m,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":s,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":tg,"all.image":s,"all.blend":s,"all.opacity":s,"all.reverse.flip":!1,"all.reverse.color":Jj,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":s,"all.uv.offset":s,"all.uv.scale":s,"all.discard.selectable":!0,mat:s,"left.mat":s,"right.mat":s,"top.mat":s,"bottom.mat":s,"front.mat":s,"back.mat":s},!0);var op,Dq=!1,fd=[0,0,0,0],Md={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:pc,2:hl,3:_m,4:Jr,5:fr,6:ms}},Eq=function(U,B,f,T){if(B.getFaceVisible(U,f)){Kd(B,ub(U,B.getFaceMat(U,f)||B.getMat(U)));var M=B._26I;B.getFaceReverseCull(U,f)?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE),Xd(M,B._prg.uFixPickReverseColor,Md[f]),Vb(M),ni(M,T,6),Xp(M),Ib(B)}},Ci=function(V){return V instanceof Bd},nm=function(E){return[E.x,E.e||0,E.y]},vd=function(M,r,o){for(var r=Sd(r),_=r[0],w=r[1],L=r[2];o--;)M.push(_,w,L)},gn=function(J,D,c){for(var D=Sd(D),$=D[0],X=D[1],C=D[2],n=D[3];c--;)J.push($,X,C,n)},cc=function(N,J,k){if(J)for(var F,G,z,u=J[0],h=J[1],$=J[2],b=J[4],e=J[5],P=J[6],m=J[8],R=J[9],X=J[10],D=J[12],w=J[13],y=J[14],x=k.length,f=0,f=0;x>f;f+=3)F=k[f],G=k[f+1],z=k[f+2],N.push(u*F+b*G+m*z+D,h*F+e*G+R*z+w,$*F+P*G+X*z+y);else Kb(N,k)},Cb=function(z,E){var v=E.s("light.intensity"),j=Sd(E.s(zf)),b=j[0],s=j[1],T=j[2];1!==v&&(b*=v,s*=v,T*=v),z.push(b,s,T,E.s("light.disabled")?1:0)},Un=function(t,w,g){Xd(w,g.uHeadlightRange,t._headlightRange);var p=t._headlightIntensity,y=Sd(t._headlightColor);1!==p&&(y=[y[0]*p,y[1]*p,y[2]*p]),Xd(w,g.uHeadlightColor,[y[0],y[1],y[2],t._headlightDisabled?1:0]);var I=t._59O,n=t._spots,d=t._dirs;if(I.length){var T=[],D=[],Y=[];I.forEach(function(k){Cb(T,k),Kb(D,t._transformPointToViewSpace(k.p3())),Y.push(k.s("light.range"))}),w.uniform4fv(g.uPointColor,T),w.uniform1fv(g.uPointRange,Y),w.uniform3fv(g.uPointPosition,D)}if(n.length){var l=[],x=[],f=[],Z=[],U=[],S=[];n.forEach(function(X){Cb(l,X),Kb(x,t._transformPointToViewSpace(X.p3())),Kb(U,t._transformDirectionToViewSpace(X.p3(),X.s("light.center"))),f.push(X.s("light.range")),Z.push(H(X.s("light.angle")/2)),S.push(X.s("light.exponent"))}),w.uniform4fv(g.uSpotColor,l),w.uniform1fv(g.uSpotRange,f),w.uniform1fv(g.uSpotAngle,Z),w.uniform1fv(g.uSpotExponent,S),w.uniform3fv(g.uSpotPosition,x),w.uniform3fv(g.uSpotDirection,U)}if(d.length){var L=[],c=[];d.forEach(function(z){Cb(L,z),Kb(c,t._transformDirectionToViewSpace(z.p3()))}),w.uniform4fv(g.uDirColor,L),w.uniform3fv(g.uDirDirection,c)}},jp=function(G){return G>0&&0===(G-1&G)},Nb=function(b){return b=E(0,h(f,b)),b=E(hi,h(f-hi,b))},ws=function(){return.05+Y()/2},fc=function(r,L,Q,H){var w,D=r.getEye();return r.isOrtho()?(w=xk(r.getCenter(),D),w[0]+=H[0],w[1]+=H[1],w[2]+=H[2]):w=D,Br(L,Q,H,w)},Br=function(l,s,G,p){var r=rq(l,s),w=xk(p,G,!0),I=rq(w,s);if(c(I)<hi)return N;var t=(r-rq(G,s))/I;return[G[0]+w[0]*t,G[1]+w[1]*t,G[2]+w[2]*t]},qb=function(q,i){return{x:2*q.x-i.x,y:2*q.y-i.y}},Aj=function(P,h,U,e){var f,m;if(!P)return f=_(h.y-U.y,U.x-h.x),{x:h.x+e*R(f),y:h.y+e*H(f)};if(!U)return f=_(P.y-h.y,h.x-P.x),{x:h.x+e*R(f),y:h.y+e*H(f)};var w=xk([P.x,P.y,0],[h.x,h.y,0],!0),c=xk([U.x,U.y,0],[h.x,h.y,0],!0),s=-(w[0]+c[0])/2,v=-(w[1]+c[1])/2,V=F(s*s+v*v);if(hi>V)return f=_(P.y-h.y,h.x-P.x),{x:h.x+e*R(f),y:h.y+e*H(f)};var i=P.x-h.x,T=P.y-h.y,G=U.x-h.x,N=U.y-h.y,A=F(i*i+T*T),k=F(G*G+N*N);f=j(rq(w,c))/2,m=w[1]*c[0]-w[0]*c[1]>0?-1:1,s/=V,v/=V;var L=e/R(f),z=E(A,k)/H(f);V=Math.min(L,z);var M={x:h.x+m*V*s,y:h.y+m*V*v};return U.b&&L>k/H(f)&&(M.adjust=!0),M},Me=function(e){var q=e[1],M=e[2],Z=e[3],C=e[6],K=e[7],v=e[11];e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=q,e[6]=e[9],e[7]=e[13],e[8]=M,e[9]=C,e[11]=e[14],e[12]=Z,e[13]=K,e[14]=v},Af=function(p){var c=p[0],F=p[1],t=p[2],A=p[3],o=p[4],V=p[5],H=p[6],I=p[7],P=p[8],Y=p[9],r=p[10],l=p[11],k=p[12],U=p[13],T=p[14],D=p[15],X=c*V-F*o,m=c*H-t*o,K=c*I-A*o,e=F*H-t*V,M=F*I-A*V,E=t*I-A*H,y=P*U-Y*k,s=P*T-r*k,G=P*D-l*k,v=Y*T-r*U,n=Y*D-l*U,O=r*D-l*T,L=X*O-m*n+K*v+e*G-M*s+E*y;return L?(L=1/L,p[0]=(V*O-H*n+I*v)*L,p[1]=(t*n-F*O-A*v)*L,p[2]=(U*E-T*M+D*e)*L,p[3]=(r*M-Y*E-l*e)*L,p[4]=(H*G-o*O-I*s)*L,p[5]=(c*O-t*G+A*s)*L,p[6]=(T*K-k*E-D*m)*L,p[7]=(P*E-r*K+l*m)*L,p[8]=(o*n-V*G+I*y)*L,p[9]=(F*G-c*n-A*y)*L,p[10]=(k*M-U*K+D*X)*L,p[11]=(Y*K-P*M-l*X)*L,p[12]=(V*s-o*v-H*y)*L,p[13]=(c*v-F*s+t*y)*L,p[14]=(U*m-k*e-T*X)*L,p[15]=(P*e-Y*m+r*X)*L,void 0):N},aq=function(C,f){if(f){var M=f[0],A=f[1],l=f[2];C[12]=C[0]*M+C[4]*A+C[8]*l+C[12],C[13]=C[1]*M+C[5]*A+C[9]*l+C[13],C[14]=C[2]*M+C[6]*A+C[10]*l+C[14],C[15]=C[3]*M+C[7]*A+C[11]*l+C[15]}},Rp=function(t,P){if(P){var V=P[0],C=P[1],d=P[2];t[0]=t[0]*V,t[1]=t[1]*V,t[2]=t[2]*V,t[3]=t[3]*V,t[4]=t[4]*C,t[5]=t[5]*C,t[6]=t[6]*C,t[7]=t[7]*C,t[8]=t[8]*d,t[9]=t[9]*d,t[10]=t[10]*d,t[11]=t[11]*d}},Vk=function(H,U,d){var g=U[0],j=U[1],f=U[2],w=U[3],t=U[4],r=U[5],i=U[6],h=U[7],Y=U[8],y=U[9],q=U[10],P=U[11],$=U[12],C=U[13],M=U[14],A=U[15],Q=d[0],W=d[1],V=d[2],G=d[3];return H[0]=Q*g+W*t+V*Y+G*$,H[1]=Q*j+W*r+V*y+G*C,H[2]=Q*f+W*i+V*q+G*M,H[3]=Q*w+W*h+V*P+G*A,Q=d[4],W=d[5],V=d[6],G=d[7],H[4]=Q*g+W*t+V*Y+G*$,H[5]=Q*j+W*r+V*y+G*C,H[6]=Q*f+W*i+V*q+G*M,H[7]=Q*w+W*h+V*P+G*A,Q=d[8],W=d[9],V=d[10],G=d[11],H[8]=Q*g+W*t+V*Y+G*$,H[9]=Q*j+W*r+V*y+G*C,H[10]=Q*f+W*i+V*q+G*M,H[11]=Q*w+W*h+V*P+G*A,Q=d[12],W=d[13],V=d[14],G=d[15],H[12]=Q*g+W*t+V*Y+G*$,H[13]=Q*j+W*r+V*y+G*C,H[14]=Q*f+W*i+V*q+G*M,H[15]=Q*w+W*h+V*P+G*A,H},Im=function(e,t,d,H){var W,R,O,N,m,r,B,P,Z,h,v=t[0],Y=t[1],C=t[2],Q=H[0],L=H[1],T=H[2],y=d[0],I=d[1],n=d[2];return c(v-y)<hi&&c(Y-I)<hi&&c(C-n)<hi?wo(e):(B=v-y,P=Y-I,Z=C-n,h=1/F(B*B+P*P+Z*Z),B*=h,P*=h,Z*=h,W=L*Z-T*P,R=T*B-Q*Z,O=Q*P-L*B,h=F(W*W+R*R+O*O),h?(h=1/h,W*=h,R*=h,O*=h):(W=0,R=0,O=0),N=P*O-Z*R,m=Z*W-B*O,r=B*R-P*W,h=F(N*N+m*m+r*r),h?(h=1/h,N*=h,m*=h,r*=h):(N=0,m=0,r=0),e[0]=W,e[1]=N,e[2]=B,e[3]=0,e[4]=R,e[5]=m,e[6]=P,e[7]=0,e[8]=O,e[9]=r,e[10]=Z,e[11]=0,e[12]=-(W*v+R*Y+O*C),e[13]=-(N*v+m*Y+r*C),e[14]=-(B*v+P*Y+Z*C),e[15]=1,e)},ji=function(R,F,b,z,v){var Q=1/o(F/2),e=1/(z-v);return R[0]=Q/b,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=Q,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=(v+z)*e,R[11]=-1,R[12]=0,R[13]=0,R[14]=2*v*z*e,R[15]=0,R},Xi=function(V,f,F,g,y,k,p){var u=1/(f-F),x=1/(g-y),t=1/(k-p);return V[0]=-2*u,V[1]=0,V[2]=0,V[3]=0,V[4]=0,V[5]=-2*x,V[6]=0,V[7]=0,V[8]=0,V[9]=0,V[10]=2*t,V[11]=0,V[12]=(f+F)*u,V[13]=(y+g)*x,V[14]=(p+k)*t,V[15]=1,V},Hf=function(u,T){var a=T[0],H=T[1],h=T[2],v=T[3],k=a*a+H*H+h*h+v*v,q=k?1/k:0;return u[0]=-a*q,u[1]=-H*q,u[2]=-h*q,u[3]=v*q,u},Sp=function(K,n){var h=n[0]+n[5]+n[10],B=0;return h>0?(B=2*Math.sqrt(h+1),K[3]=.25*B,K[0]=(n[6]-n[9])/B,K[1]=(n[8]-n[2])/B,K[2]=(n[1]-n[4])/B):n[0]>n[5]&n[0]>n[10]?(B=2*Math.sqrt(1+n[0]-n[5]-n[10]),K[3]=(n[6]-n[9])/B,K[0]=.25*B,K[1]=(n[1]+n[4])/B,K[2]=(n[8]+n[2])/B):n[5]>n[10]?(B=2*Math.sqrt(1+n[5]-n[0]-n[10]),K[3]=(n[8]-n[2])/B,K[0]=(n[1]+n[4])/B,K[1]=.25*B,K[2]=(n[6]+n[9])/B):(B=2*Math.sqrt(1+n[10]-n[0]-n[5]),K[3]=(n[1]-n[4])/B,K[0]=(n[8]+n[2])/B,K[1]=(n[6]+n[9])/B,K[2]=.25*B),K},pr=function(U,j,X){var C=j[0],b=j[1],a=j[2],H=j[3],o=C+C,f=b+b,m=a+a,g=C*o,r=C*f,N=C*m,T=b*f,M=b*m,E=a*m,v=H*o,S=H*f,Z=H*m;return U[0]=1-(T+E),U[1]=r+Z,U[2]=N-S,U[3]=0,U[4]=r-Z,U[5]=1-(g+E),U[6]=M+v,U[7]=0,U[8]=N+S,U[9]=M-v,U[10]=1-(g+T),U[11]=0,U[12]=X[0],U[13]=X[1],U[14]=X[2],U[15]=1,U},ks=function(){var Q=[0,0,0],X=[0,0,0],g=[0,0,0],M=function(F,O,Z){F[0]=O[1]*Z[2]-O[2]*Z[1],F[1]=O[2]*Z[0]-O[0]*Z[2],F[2]=O[0]*Z[1]-O[1]*Z[0]},A=function(R){return R[0]*R[0]+R[1]*R[1]+R[2]*R[2]},U=function(w){var W=Math.sqrt(A(w));w[0]/=W,w[1]/=W,w[2]/=W},d=function(C,F,G){C[0]=F[0]-G[0],C[1]=F[1]-G[1],C[2]=F[2]-G[2]};return function(Y,u,P){var n=vq();return d(g,Y,u),0===A(g)&&(g[2]=1),U(g),M(Q,P,g),0===A(Q)&&(1===Math.abs(P[2])?g[0]+=1e-4:g[2]+=1e-4,U(g),M(Q,P,g)),U(Q),M(X,g,Q),n[0]=Q[0],n[4]=X[0],n[8]=g[0],n[1]=Q[1],n[5]=X[1],n[9]=g[1],n[2]=Q[2],n[6]=X[2],n[10]=g[2],n}}(),_b=function(C,w){if(C.vr.enable){var O=C.vr.getViewMatrix(w);if(O)return O}return Im(w?w:vq(),C._eye,C._center,C._up)},fe=function(b,y){if(b.vr.enable){var x=b.vr.getProjectMatrix();if(x)return x}if(!y&&b._computedProjectMatrix)return so(b._computedProjectMatrix);var q=b.getAspect(),f=b._near,k=b._far,j=vq();if(b._ortho){var $=b._orthoWidth/2,C=$/q;Xi(j,-$,$,-C,C,f,k)}else ji(j,b._fovy,q,f,k);return j},_p=function(V,g){if(!V)return N;var l=0,o=1,R=2,k=[],$=0,n=V.length,w=n/3;if(g){for(;n>$;$++)k[$]=0;for($=0;$<g.length;$+=3){var s=[],u=[],U=[];s[l]=V[3*g[$+1]+l]-V[3*g[$]+l],s[o]=V[3*g[$+1]+o]-V[3*g[$]+o],s[R]=V[3*g[$+1]+R]-V[3*g[$]+R],u[l]=V[3*g[$+2]+l]-V[3*g[$+1]+l],u[o]=V[3*g[$+2]+o]-V[3*g[$+1]+o],u[R]=V[3*g[$+2]+R]-V[3*g[$+1]+R],U[l]=s[o]*u[R]-s[R]*u[o],U[o]=s[R]*u[l]-s[l]*u[R],U[R]=s[l]*u[o]-s[o]*u[l];for(var A=0;3>A;A++)k[3*g[$+A]+l]+=U[l],k[3*g[$+A]+o]+=U[o],k[3*g[$+A]+R]+=U[R]}}else for($=0;w>$;$+=3){var s=[],u=[],U=[];s[l]=V[3*($+1)+l]-V[3*$+l],s[o]=V[3*($+1)+o]-V[3*$+o],s[R]=V[3*($+1)+R]-V[3*$+R],u[l]=V[3*($+2)+l]-V[3*($+1)+l],u[o]=V[3*($+2)+o]-V[3*($+1)+o],u[R]=V[3*($+2)+R]-V[3*($+1)+R],U[l]=s[o]*u[R]-s[R]*u[o],U[o]=s[R]*u[l]-s[l]*u[R],U[R]=s[l]*u[o]-s[o]*u[l];for(var A=0;3>A;A++)k[3*($+A)+l]=U[l],k[3*($+A)+o]=U[o],k[3*($+A)+R]=U[R]}for($=0;n>$;$+=3){var S=[];S[l]=k[$+l],S[o]=k[$+o],S[R]=k[$+R];var v=F(S[l]*S[l]+S[o]*S[o]+S[R]*S[R]);0===v&&(v=hi),S[l]=S[l]/v,S[o]=S[o]/v,S[R]=S[R]/v,k[$+l]=S[l],k[$+o]=S[o],k[$+R]=S[R]}return new As(k)},he=function(y,q,T,J){if(T||(T=y.createTexture()),q){var z=y.TEXTURE_2D,t=y.REPEAT,D=y.CLAMP_TO_EDGE,p=y.TEXTURE_MIN_FILTER;J!==y.NEAREST&&(J=y.LINEAR),nq(y,T),y.texImage2D(z,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,q),Yi(y,y.TEXTURE_MAG_FILTER,J);var Q=q.naturalWidth||q.width,f=q.naturalHeight||q.height;jp(Q)&&jp(f)&&!q.clampToEdge?(Yi(y,y.TEXTURE_WRAP_S,t),Yi(y,y.TEXTURE_WRAP_T,t),Yi(y,p,y.LINEAR_MIPMAP_LINEAR),y.generateMipmap(z)):(Yi(y,y.TEXTURE_WRAP_S,D),Yi(y,y.TEXTURE_WRAP_T,D),Yi(y,p,J)),nq(y,N)}return T},Jp=function(R,Y){var r=new Uint8Array(4);return Y=Y||R.createTexture(),nq(R,Y),Yi(R,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,1,1,0,R.RGBA,R.UNSIGNED_BYTE,r),Y},Qj=function(Z){Z._26I&&Z._prg&&(Z._26I.deleteProgram(Z._prg),Z._prg=N)},Ak=function(r,x,f,G){var m=r.createShader(f);return r.shaderSource(m,G),r.compileShader(m),r.attachShader(x,m),m},Gl=function(P){return P.createBuffer()},nq=function(T,H){T.bindTexture(T.TEXTURE_2D,H)},Yi=function(o,X,v){o.texParameteri(o.TEXTURE_2D,X,v)},Kf=function(N,e){N.enable(N.POLYGON_OFFSET_FILL),N.polygonOffset(e[0],e[1])},Sb=function(W){W.disable(W.POLYGON_OFFSET_FILL)},vo=function(V,k){if(k){var k=Sd(k);V.clearColor(k[0],k[1],k[2],k[3])}},jg=function(U,u){Xd(U,u.uFix,!0),th(U,u.aNormal)},om=function(z,R){Xd(z,R.uFix,!1),Ip(z,R.aNormal)},pk=function(v,p,G,J,f,S,e,c){v._picking||(G?(Xd(v,p.uBlend,!0),Xd(v,p.uBlendColor,G)):Xd(v,p.uBlend,!1),Xd(v,p.uLight,J==N?!0:J),vg(f)&&1!==f&&Xd(v,p.uPartOpacity,f),Xd(v,p.uReverseFlip,S==N?!1:S),Xd(v,p.uFixPickReverseColor,e||Jj)),c?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE)},rm=function(l,x){l._picking||Xd(l,x.uPartOpacity,1)},Vb=function(){var Z=[0,0,1,1];return function(S,$,R,y,u,m,i,r,H){return R?(Xd(S,$.uTexture,!0),Xd(S,$.uDiscardSelectable,jm(y)?y:!0),Ip(S,$.aUv),fg(S,u,m,$.aUv,2),H?(Xd(S,$.uBlendTexture,!0),S.activeTexture(S.TEXTURE1),nq(S,H),S.uniform1i($.uBlendSampler,1)):(Xd(S,$.uBlendTexture,!1),S.activeTexture(S.TEXTURE1),nq(S,S._emptyBlendTexture)),S.activeTexture(S.TEXTURE0),nq(S,R),S.uniform1i($.uSampler,0),i?(Z[0]=i[0],Z[1]=i[1]):(Z[0]=0,Z[1]=0),r?(Z[2]=r[0],Z[3]=r[1]):(Z[2]=1,Z[3]=1),Xd(S,$.uOffsetScale,Z),void 0):(S.activeTexture(S.TEXTURE0),nq(S,S._emptyTexture),S.activeTexture(S.TEXTURE1),nq(S,S._emptyBlendTexture),void 0)}}(),Xp=function(B,j,E){B.activeTexture(B.TEXTURE0),nq(B,N),B.activeTexture(B.TEXTURE1),nq(B,N),E&&(th(B,j.aUv),Xd(B,j.uTexture,!1),Xd(B,j.uBlendTexture,!1))},Gd=function(p,L,e,o,Y,V){!e||pb||sj||p.lineWidth(e),o&&!p._picking&&Xd(p,L.uFixPickReverseColor,o),Y&&fg(p,Y,V,L.aPosition)},rk=function(c,B,b,v){op&&(v=c[op]),c.drawArrays(v==N?c.TRIANGLES:v,B,b);var Z=c._renderInfo;Z&&(Z.calls++,Z.vertices+=b,(v==N||v===c.TRIANGLES)&&(Z.faces+=b/3),v===c.LINES&&(Z.lines+=b/2))},ni=function(r,e,B,F){op&&(F=r[op]),r.drawElements(F==N?r.TRIANGLES:F,B,r.UNSIGNED_SHORT,e==N?0:2*e);var Q=r._renderInfo;Q&&(Q.calls++,Q.vertices+=B,(F==N||F===r.TRIANGLES)&&(Q.faces+=B/3),F===r.LINES&&(Q.lines+=B/2))},Qr=function(t,W,B,H,z){var d=t.ARRAY_BUFFER;t.bindBuffer(d,W),B&&t.bufferData(d,B,t.STATIC_DRAW),H!=N&&t.vertexAttribPointer(H,z?z:3,t.FLOAT,!1,0,0)},fg=function(e,B,f,u,d){return f?(fn(e,e.ARRAY_BUFFER,B,f),u!=N&&e.vertexAttribPointer(u,d?d:3,e.FLOAT,!1,0,0),void 0):Qr(e,B,f,u,d)},jl=function(E,i,P){var V=E.ELEMENT_ARRAY_BUFFER;E.bindBuffer(V,i),P&&E.bufferData(V,P,E.STATIC_DRAW)},Hc=function(q,j,J){fn(q,q.ELEMENT_ARRAY_BUFFER,j,J)},fn=function(R,P,N,Q){var k=Q._bufId;k||(k=Q._bufId=z.Math.generateIncreasingID());var N,s=R._bufPool;(N=s[k])&&N._buf?R.bindBuffer(P,N._buf):(N=s[k]={_buf:Gl(R)},R.bindBuffer(P,N._buf),R.bufferData(P,Q,R.STATIC_DRAW)),N._fid=R._renderInfo.frame},Xd=function(g,r,p){if(p!=N&&r!=N){p=Sd(p);var E=p.length;3===E?g.uniform3fv(r,p):4===E?g.uniform4fv(r,p):16===E?g.uniformMatrix4fv(r,!1,p):jm(p)?g.uniform1i(r,p?1:0):2===E?g.uniform2fv(r,p):g.uniform1f(r,p)}},Ip=function(P,v){v!=N&&v>=0&&P.enableVertexAttribArray(v)},th=function(s,q){q!=N&&q>=0&&s.disableVertexAttribArray(q)},Ib=function(I,N){var B=I.getGL(),E=I._prg;I._7O=I._8O.pop(),N&&(Xd(B,E.uMVMatrix,I._7O),I._6O=N,Xd(B,E.uNMatrix,N))},Gc=function(Q,f){return f||(f=vq()),cj(f,Q),Af(f),Me(f),f},Kd=function(A,K){var t=A.getGL(),d=A._prg,W=A._7O;K&&(A._8O.push(so(W)),Xd(t,d.uMMatrix,K),Vk(W,W,K),A._7O=W),Xd(t,d.uMVMatrix,W),Xd(t,d.uNMatrix,Gc(W,A._6O))},Cc=function(M,X,z,J,d,m){if(z){if(J){var V=z.value++,F=2147483648|V,w=[(255&F>>16)/255,(255&F>>8)/255,(255&F)/255,(255&F>>24)/255];z[V]={data:d,part:m}}else w=fd;return Xd(M,X.uFixPickReverseColor,w),w}},zp=function(){var S={center:function(P,_,e,I,H){var r=-_[1]/2,s={x:-_[0]/2,y:r,width:_[0],height:_[1]},d=el(P,s,e);return[d.x+I,-d.y-H,ws()]},front:function(X,u,z,j,v){var N=-u[1]/2,O={x:-u[0]/2,y:N,width:u[0],height:u[1]},w=el(X,O,z);return[w.x+j,-w.y-v,u[2]/2+ws()]},back:function(I,n,U,d,Q){var Z=-n[0]/2,R=-n[1]/2,B={x:Z,y:R,width:n[0],height:n[1]},X=el(I,B,U);return[-X.x-d,-X.y-Q,-n[2]/2-ws()]},left:function(o,R,Y,c,B){var E=-R[1]/2,z={x:-R[2]/2,y:E,width:R[2],height:R[1]},H=el(o,z,Y);return[-R[0]/2-ws(),-H.y-B,H.x+c]},right:function(x,n,w,P,K){var J=-n[2]/2,C=-n[1]/2,N={x:J,y:C,width:n[2],height:n[1]},U=el(x,N,w);return[n[0]/2+ws(),-U.y-K,-U.x-P]},top:function(S,j,O,F,l){var p={x:-j[0]/2,y:-j[2]/2,width:j[0],height:j[2]},u=el(S,p,O);return[u.x+F,j[1]/2+ws(),u.y+l]},bottom:function(A,u,P,b,t){var O=-u[2]/2,X={x:-u[0]/2,y:O,width:u[0],height:u[2]},C=el(A,X,P);return[C.x+b,-u[1]/2-ws(),-C.y-t]}};return function(n,B,t,G,d,h){return S[G](n,B,t,d||0,h||0)}}(),og=function(P,R,Z,j,O,y,t,m,q,r){if(O&&(R[0]+=O[0],R[1]+=O[1],R[2]+=O[2]),aq(P,Z),m){var i=vq();if(fo(i,q,r),Ij(R,i),aq(P,R),P.auto=m,P.pos=Ij([0,0,0],P),y){var Q=P.mat2=vq();fo(Q,y,t)}}else fo(P,q,r),aq(P,R),j===pc?ib(P,-G):j===hl?ib(P,G):j===_m?bp(P,-G):j===Jr?bp(P,G):j===ms&&ib(P,f),fo(P,y,t);return P},Tq=function(z,S){var j=S.auto,M=S.mat2,o=z.gv;if(j){var L,G=vq(),a=[0,0,0,0];L="string"==typeof j?[j.indexOf("x")<0?o._eye[0]:o._center[0],j.indexOf("y")<0?o._eye[1]:o._center[1],j.indexOf("z")<0?o._eye[2]:o._center[2]]:o._eye,Sp(a,Im(vq(),L,o._center,o._up)),pr(G,Hf(a,a),S.pos),M&&Vk(G,G,M),Kd(o,G)}else Kd(o,S)},Vj=function(h,x,J,w,T){var W=h.s,a=h.gv,I=a.getGL(),A=a._prg,X=a._buffer,e=a._1O;he(I,Vc,e),Tq(h,J),pk(I,A,W(x+".blend"),W(x+".light"),W(x+".opacity"),W(x+".reverse.flip"),W(x+".reverse.color"),W(x+".reverse.cull")),Vb(I,A,e,T,X.uv,Ng),fg(I,X.vs,w,A.aPosition),fg(I,X.ns,Rn,A.aNormal),Hc(I,X.is,sd),ni(I,0,sd.length),Xp(I,A,e),rm(I,A),Ib(a)},Kg=function(A,I,$){var u=A.gv,k=A.data,e=A[I]={blend:u.getBodyColor(k)||u.getFaceBlend(k,I),light:u.getFaceLight(k,I),color:u.getFaceColor(k,I),opacity:u.getFaceOpacity(k,I),transparent:u.getFaceTransparent(k,I),reverseFlip:u.getFaceReverseFlip(k,I),reverseColor:u.getFaceReverseColor(k,I),reverseCull:u.getFaceReverseCull(k,I),texture:u.getFaceImage(k,I),blendTexture:u.getFaceBlendImage(k,I),discardSelectable:u.getFaceDiscardSelectable(k,I)};if("csg"!==I){e.uv=u.getFaceUv(k,I)||$&&$[I+"Uv"],e.uvScale=u.getFaceUvScale(k,I)||$&&$[I+"UvScale"],e.uvOffset=u.getFaceUvOffset(k,I)||$&&$[I+"UvOffset"];var c=u.getFaceMat(k,I);c&&(e.mat=ub(k,c))}return e},Nf=function(B,M,z,Q,n){if(Q){if(!n(Q.transparent))return;var Z=B.data,K=B.gv,r=K._buffer,t=K.getTexture(Q.texture,Z),E=K.getTexture(Q.blendTexture,Z);Vb(M,z,t,Q.discardSelectable,r.uv,Q.tuv,Q.uvOffset,Q.uvScale,E),pk(M,z,Q.blend,Q.light,Q.opacity,Q.reverseFlip,Q.reverseColor,Q.reverseCull),Xd(M,z.uDiffuse,Q.color||e["color.empty"]),fg(M,r.vs,Q.vs,z.aPosition),fg(M,r.ns,Q.ns,z.aNormal),rk(M,0,Q.vs.length/3),rm(M,z),Xp(M,z,t)}},qn=function(U,M,N,X,v,K){var A,D,h,y,O,P,F,g,z,I,L,Q=[X-M,v-N],V=U?U.length:0;for(h=0;V>h;h++){for(y=2,A=U[h],O=A[0],P=A[1];y+1<A.length;){if(F=A[y],g=A[y+1],D=jo(M,N,X,v,O,P,F,g,!0)){z=[F-O,g-P],I=Df(z),z[0]/=I,z[1]/=I,I=rq(Q,z),I=I>0?K:-K,L=[z[0]*I,z[1]*I];break}O=F,P=g,y+=2}if(L)break}if(L)for(X=M+L[0],v=N+L[1],h=0;V>h;h++)for(y=2,A=U[h],O=A[0],P=A[1];y+1<A.length;){if(F=A[y],g=A[y+1],D=jo(M,N,X,v,O,P,F,g,!0))return[0,0];O=F,P=g,y+=2}return L?L:[X-M,v-N]},Vn=z.graph3d={},Mj=function(I,J,F){Jl(k+".graph3d."+I,J,F)},Fm="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Nj="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Vp(Q,{setBatchInfo:function(G,F){km[G]=F},getBatchInfo:function(l){return km[l]}},!0);var hp=[1,1,1],Fk=[1,0,0,0,0,1,0,1,1,1,1,0],bc=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],_d=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],xl=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Xm=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Qb=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],sb=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],xr=function(e,p){Yj(e,p,"_batchModelMap","_batchIndexMap"),dq(e,p,"_wireframeModelMap","_wireframeIndexMap"),dq(e,p,"_polylineModelMap","_polylineIndexMap"),dq(e,p,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),dq(e,p,"_polylineModelMapSwap","_polylineIndexMapSwap")},Yj=function(q,g,J,j){if(!g)return q[J]={},q[j]={},void 0;var z=g._id,x=q[j],u=x[z];if(u){var Q=q[J],R=u.batch,S=Q[R],k=S.ds,U=u.index;if(S.invalidate=!0,delete x[z],k.splice(U,1),Wl(k))return delete Q[R],void 0;for(var f=u.begin,Y=u.size,a=3*f,b=3*Y,p=4*f,M=4*Y,n=S.vs,H=S.ps,h=S.uv,D=S.cs,v=S.bs,w=S.rs,s=S.ns,e=S.ls;U<k.length;U++)u=x[k[U]._id],u.index--,u.begin-=Y;n.splice(a,b),H.splice(p,M),h&&h.splice(2*f,2*Y),D&&D.splice(p,M),v&&v.splice(a,b),w&&w.splice(f,Y),s&&s.splice(a,b),e&&e.splice(f,Y)}},dq=Yj,db=function(D,F,Y,E){if(!E)return N;var z=F[E];if(!z){var W=km[E]||Ee,B=W.image?[]:N;z=F[E]={vs:[],ns:[],uv:B,cs:B?N:W.color?N:[],bs:W.blend?[]:N,ps:[],rs:W.brightness?[]:N,ds:[]}}return z.invalidate=!0,D[Y._id]={index:z.ds.length,begin:z.vs.length/3,batch:E},z.ds.push(Y),z},pn=function(H,D){return D!=N&&1!==D?[H[0]*D,H[1]*D,H[2]*D,H[3]]:H},Nh=function(E,J,G){var i=E.getBrightness(J),v=Sd(G.color||"white"),W=v[3]<1,p=Math.ceil(G.width)||1,x=(W?"T":"O")+p,B=E._wireframeIndexMap,O=E._wireframeModelMap,f=O[x];f||(f=O[x]={vs:[],cs:[],ps:[],ds:[],T:W,W:p});var P,h=E.getData3dUI(J),A=jr(h);if(G.geometry){if(!A)return;if(P=Rb(A),!P)return}else P=G.short?ie:Ph;f.invalidate=!0;var Z=f.vs,q=f.cs,e=f.ds,I=B[J._id]={index:e.length,begin:Z.length/3,batch:x};e.push(J);var m=ub(J,G.mat),g=h._calcAnchorMat(J);g&&Vk(m,m,g),cc(Z,m,P);var Y=I.size=Z.length/3-I.begin;gn(q,pn(v,i),Y)},Mf=function(v,j,S,$,a,y,q,c,O){var e=v.getBrightness(j);e==N&&(e=1);var d=pn(Sd($),e),u=d[3]<1;y=Math.ceil(y)||1;var i=(u?"T":"O")+y;if(q){var C=q[0],r=(q[1]||C)+C;i+="-"+C+"-"+r,O&&(i+="-"+Yr(O)+"-"+e,O=pn(Sd(O),e))}var o=v._polylineIndexMap,b=v._polylineModelMap,m=b[i];m||(m=b[i]={vs:[],cs:[],ps:[],ds:[],ls:q?[]:N,T:u,W:y},q&&(m.D=C,m.G=r,m.A=O)),m.invalidate=!0;var l,Q=m.vs,F=m.cs,g=m.ds,A=m.ls,Y=o[j._id]={index:g.length,begin:Q.length/3,batch:i};g.push(j),Kb(Q,S);var p,I=Y.size=Q.length/3-Y.begin,V=S.length,M=0,n=[];if(q||a)for(l=0;V>l;l+=6)p=Df([S[l],S[l+1],S[l+2]],[S[l+3],S[l+4],S[l+5]]),n.push(p),M+=p;if(M&&a){var T,D=pn(Sd(a),e),K=[D[0]-d[0],D[1]-d[1],D[2]-d[2],D[3]-d[3]],P=0;for(l=0;V>l;l+=6)T=P/M,gn(F,[d[0]+K[0]*T,d[1]+K[1]*T,d[2]+K[2]*T,d[3]+K[3]*T],1),P+=n[l/6],T=P/M,gn(F,[d[0]+K[0]*T,d[1]+K[1]*T,d[2]+K[2]*T,d[3]+K[3]*T],1)}else gn(F,d,I);if(q)for(P=c||0,l=0;V>l;l+=6)A.push(P),P+=n[l/6],A.push(P)},Hg=function(d,C,f){if(C)for(var R=4*C.begin,Y=f[C.batch].ps,K=0;K<C.size;K++)Y[R++]=d[0],Y[R++]=d[1],Y[R++]=d[2],Y[R++]=d[3]},Bc=function(E,b){var I=b+["32"],O=E[b],s=E[I];O?s&&s.length===O.length?(s.set(O),s._bufId=null):E[I]=new As(O):delete E[I]},yg=function(F,k,R,S,Q,K,y,s,L){if(pi(R))R.forEach(function(W){yg(F,k,W,S,Q,K,y,s,L)});else if(fh(R))yg(F,k,jr(S,R),S,Q,K,y,s,L);else if(yp(R)){var J,X=Cd(R.mat,k,F),u=Cd(R.s3,k,F),D=Cd(R.t3,k,F),q=Cd(R.r3,k,F);if((u||q||D||X)&&(J=mf(X,u,q,Cd(R.rotationMode,k,F),D),K.push(J)),R.shape3d)yg(F,k,R.shape3d,S,Q,K,y,s,R);else{var c=S.s;L=L||Ee;var Y=K[0],N=K.length,$=c("shape3d.color",R.color,L.color);if(Q||(Q=c("shape3d.blend",R.blend,L.blend)),N>1){Y=so(Y);for(var I=1;N>I;I++)Vk(Y,Y,K[I])}R.vs&&c(_h,R.visible,L.visible)&&Rg(Y,y,s,R.vs,R.uv,R.is,Q,$),R.top_vs&&c(bl,R.topVisible,L.topVisible)&&Rg(Y,y,s,R.top_vs,R.top_uv,R.top_is,Q,c("shape3d.top.color",R.topColor,L.topColor)||$),R.bottom_vs&&c(Fd,R.bottomVisible,L.bottomVisible)&&Rg(Y,y,s,R.bottom_vs,R.bottom_uv,R.bottom_is,Q,c("shape3d.bottom.color",R.bottomColor,L.bottomColor)||$),R.from_vs&&c(ak,R.fromVisible,L.fromVisible)&&Rg(Y,y,s,R.from_vs,R.from_uv,R.from_is,Q,c("shape3d.from.color",R.fromColor,L.fromColor)||$),R.to_vs&&c(br,R.toVisible,L.toVisible)&&Rg(Y,y,s,R.to_vs,R.to_uv,R.to_is,Q,c("shape3d.to.color",R.toColor,L.toColor)||$)
}J&&K.pop()}},Rg=function(D,X,H,O,J,M,T,a){var V,q=X.cs,N=X.uv,R=X.bs;if(M){V=M.length;for(var l=0;V>l;l++){var G=M[l];cc(H,D,[O[3*G],O[3*G+1],O[3*G+2]]),N&&Kb(N,[J[2*G],J[2*G+1]])}}else V=O.length/3,cc(H,D,O),N&&Kb(N,J);q&&gn(q,a,V),R&&(T?vd(R,T,V):Kb(R,hp,V))},Bq=function(g,E,I,G){var j=[];G?yg(g.gv,g.data,G,g,g.getBodyColor(),[E],I,j):(gh(g,pc,E,I,j),gh(g,hl,E,I,j),gh(g,fr,E,I,j),gh(g,ms,E,I,j),gh(g,_m,E,I,j),gh(g,Jr,E,I,j),gh(g,"csg",E,I,j)),j.length&&(Kb(I.vs,j),Kb(I.ns,_p(j)))},gh=function(h,Y,C,f,I){var g=h[Y];if(g){var R=g.tuv;if(R){var X,S,T,q,B=g.uvScale,n=g.uvOffset;if(B)for(X=R.length,S=B[0],T=B[1],q=0;X>q;q+=2)R[q]*=S,R[q+1]*=T;if(n)for(X=R.length,S=n[0],T=n[1],q=0;X>q;q+=2)R[q]+=S,R[q+1]+=T}Rg(C,f,I,g.vs,R,N,g.blend,g.color)}},Ob=function(b,J,L,H,P,x,r,S){var p,z=L.cs,U=L.uv,w=L.bs;if(b.getFaceVisible(J,x)){var s=b.getFaceMat(J,x);if(s&&(P=ub(J,s)),cc(r,P,S),z&&gn(z,b.getFaceColor(J,x),6),U){var Q=b.getFaceUv(J,x)||H[x+"Uv"],c=b.getFaceUvScale(J,x)||H[x+"UvScale"],h=b.getFaceUvOffset(J,x)||H[x+"UvOffset"];Q=Q?[Q[6],Q[7],Q[0],Q[1],Q[2],Q[3],Q[2],Q[3],Q[4],Q[5],Q[6],Q[7]]:Fk;var O=Q[0],u=Q[1],n=Q[2],o=Q[3],v=Q[4],y=Q[5],I=Q[6],k=Q[7],M=Q[8],F=Q[9],d=Q[10],G=Q[11];if(c){var e=c[0],i=c[1];O*=e,u*=i,n*=e,o*=i,v*=e,y*=i,I*=e,k*=i,M*=e,F*=i,d*=e,G*=i}if(h){var B=h[0],m=h[1];O+=B,u+=m,n+=B,o+=m,v+=B,y+=m,I+=B,k+=m,M+=B,F+=m,d+=B,G+=m}U.push(O,u,n,o,v,y,I,k,M,F,d,G)}w&&(p=b.getBodyColor(J)||b.getFaceBlend(J,x),p?vd(w,p,6):Kb(w,hp,6))}},Ep=function(y,B,q,v){var K=y.getGL(),S=y._prg,j=y._buffer;if(!y.drawFilter&&!Uo(B)){Kd(y),jg(K,S);for(var Z in B){var A=B[Z];if(!(v&&!A.T||!v&&A.T)){A.invalidate?(A.invalidate=!1,Bc(A,"vs"),Bc(A,"cs"),Bc(A,"ls"),Bc(A,"ps")):q&&Bc(A,"ps");var X=A.vs32,I=q?A.ps32:A.cs32;Gd(K,S,A.W,N,j.vs,X);var Y=A.D,F=!y._dashDisabled&&Y;Xd(K,S.uAlphaTest,e.alphaTest),F&&(Xd(K,S.uDash,!0),Xd(K,S.uDashDistance,Y),Xd(K,S.uDashGapDistance,A.G),Ip(K,S.aLineDistance),fg(K,j.lineDistance,A.ls32,S.aLineDistance,1),Xd(K,S.uDiffuse,A.A||e["color.empty"]));var $=!y._batchColorDisabled;$&&(Xd(K,S.uBatchColor,!0),Ip(K,S.aBatchColor),fg(K,j.batchColor,I,S.aBatchColor,4)),Vb(K),rk(K,0,X.length/3,K.LINES),Xp(K),$&&(Xd(K,S.uBatchColor,!1),th(K,S.aBatchColor)),F&&(Xd(K,S.uDash,!1),th(K,S.aLineDistance))}}om(K,S)}},lk=function(F,x,c){var X,C,$,h,v,u,J,Z,r,H,U,P=F.getGL(),g=F._prg,t=F._buffer,T=F._batchModelMap;if(!Uo(T)){Kd(F);for(X in T)if(C=km[X]||Ee,!(c&&!C.transparent||!c&&C.transparent)&&($=T[X],x||!C.transparentMask)){var V=c&&C.autoSort!==!1&&(F._33Q||$.invalidate);if($.invalidate?($.invalidate=!1,Bc($,"vs"),Bc($,"ns"),Bc($,"cs"),Bc($,"rs"),Bc($,"ps"),Bc($,"bs"),Bc($,"uv")):x&&Bc($,"ps"),v=$.vs32,u=x?$.ps32:$.cs32,r=$.uv32,J=$.bs32,Z=$.rs32,U=v.length/3,V&&($.is=sf(v,F.getEye())),U){h=C.light,H=F.getTexture(C.image),pk(P,g,N,C.light,C.opacity,C.reverseFlip,C.reverseColor,C.reverseCull),u?F._batchColorDisabled||(Xd(P,g.uBatchColor,!0),Ip(P,g.aBatchColor),fg(P,t.batchColor,u,g.aBatchColor,4)):Xd(P,g.uDiffuse,C.color||e["color.empty"]);var z=C.alphaTest;Xd(P,g.uAlphaTest,z===s?e.alphaTest:z);var A=J&&!F._batchBlendDisabled;A&&(Xd(P,g.uBatchBlend,!0),Ip(P,g.aBatchBlend),fg(P,t.batchBlend,J,g.aBatchBlend));var K=Z&&!F._batchBrightnessDisabled;K&&(Xd(P,g.uBatchBrightness,!0),Ip(P,g.aBatchBrightness),fg(P,t.batchBrightness,Z,g.aBatchBrightness,1)),r?Vb(P,g,H,C.discardSelectable,t.uv,r,C.uvOffset,C.uvScale):Vb(P),fg(P,t.vs,v,g.aPosition),fg(P,t.ns,$.ns32,g.aNormal),$.is?(jl(P,t.is,$.is),ni(P,0,U)):rk(P,0,U),r?Xp(P,g,H):Xp(P),u&&!F._batchColorDisabled&&(Xd(P,g.uBatchColor,!1),th(P,g.aBatchColor)),A&&(Xd(P,g.uBatchBlend,!1),th(P,g.aBatchBlend)),K&&(Xd(P,g.uBatchBrightness,!1),th(P,g.aBatchBrightness)),rm(P,g)}}}},sf=function(o,C){for(var A=o.length/3,M=new Array(A),x=A/3,e=new Array(x),J=0;x>J;J++)e[J]=J;e.sort(function(i,S){var A=9*i,T=[(o[A]+o[A+3]+2*o[A+6])/4,(o[A+1]+o[A+4]+2*o[A+7])/4,(o[A+2]+o[A+5]+2*o[A+8])/4];A=9*S;var $=[(o[A]+o[A+3]+2*o[A+6])/4,(o[A+1]+o[A+4]+2*o[A+7])/4,(o[A+2]+o[A+5]+2*o[A+8])/4],P=Df(C,T)-Df(C,$);return P>0?-1:0>P?1:0});for(var J=0;x>J;J++){var V=3*J,$=3*e[J];M[V]=$,M[V+1]=$+1,M[V+2]=$+2}return new wq(M)},bf={obj:function(Y,U){var J={mat:Y.mat,s3:Y.s3,r3:Y.r3,rotationMode:Y.rotationMode,t3:Y.t3,cube:Y.cube==N?!0:Y.cube,center:Y.center==N?!0:Y.center,ignoreMtls:Y.ignoreMtls,ignoreTransparent:Y.ignoreTransparent,ignoreColor:Y.ignoreColor,ignoreImage:Y.ignoreImage,ignoreNormal:Y.ignoreNormal,prefix:Y.prefix,flipY:Y.flipY,flipFace:Y.flipFace,reverseFlipMtls:Y.reverseFlipMtls,finishFunc:function(g,i){if(g){var i=[];for(var $ in g){var t=g[$];i.rawS3=t.rawS3,i.push(t),Y.eachModel&&Y.eachModel($,t)}i.json=Y,U(i)}else U()}};Q.loadObj(Y.obj,Y.mtl,J)}};Q.getModelTypeHandlers=function(){return bf},Q.setModelTypeHandler=function(g,U){bf[g]=U},Q.getModelTypeHandler=function(b){return bf[b]},Q.handleModelLoaded=function(){},Q.handleUnfoundModel=function(){};var Vg=N,Fp=N,al=function(L){Vg&&!L._loadingModelView_&&(Fp||(Fp={}),Fp[L._loadingModelView_=Zb()]=L)},Sr=function(o,s){Vg||(Vg={});var k=Vg[o];if(k){if(k.url===s)return;k.request.onload=Yq,k.request.onerror=Yq}var _=new lr;if(Vg[o]={request:_,url:s},s=Q.beforeLoadURL(s),s.data){var Z=Q.parse(s.data);Gm(o,Z,s)}else{_.onload=function(){if(200===this.status||0===this.status){delete Vg[o];var f=Q.parse(_.getResponseText());Gm(o,f,s)}else ri(o,Q.handleUnfoundModel(o,s)||N)},_.onerror=function(){ri(o,Q.handleUnfoundModel(o,s)||N)};var d={};d.url=encodeURI(s),d.sync=!1,_.send(d)}},Gm=function(F,J,v){var r=J.modelType;if(!r)return ri(F,J),Q.handleModelLoaded(F,J),void 0;var u=Q.getModelTypeHandler(r);if(u){if(Vg||(Vg={}),Vg[F])return;Vg[F]=!0;var a=function(K){K?(ri(F,K),Q.handleModelLoaded(F,K)):ri(F,Q.handleUnfoundModel(F,v)||N)};u(J,a)}else ri(F,Q.handleUnfoundModel(F,v)||N)},ri=function(Y,j){if(Eg[Y]=j,delete Vg[Y],Uo(Vg)&&(Vg=N,Fp)){for(var l in Fp){var $=Fp[l];$.invalidateAll&&$.invalidateAll(s,"modelLoaded",Y),$.redraw&&$.redraw(),$.iv(),delete $._loadingModelView_}Fp=N}if(j&&Fp)for(var l in Fp){var $=Fp[l];$.invalidateAll&&$.invalidateAll(s,"modelLoading",Y),$.redraw&&$.redraw(),$.iv()}},Ng=new As([0,0,0,1,1,1,1,0]),Rn=new As([0,0,1,0,0,1,0,0,1,0,0,1]),sd=new wq([0,1,2,2,3,0]),mn=new As([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Nc=new wq([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Hl=new As([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Gp=_p(mn,Nc),zm=(new As([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new wq([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[pc,fr,hl,ms,_m,Jr]),Ph=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],ie=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Dk=function(z,l,W,r,E,V){V=V||16,z=z||16,l=l||0,W=W||z;var N,U,G,$,B,b,i,A,n=.5,F=[],g=[],q=m/z,Z=f/V;for(N=0;V>N;N++)for(B=N+1,$=N*Z,A=B*Z,U=l;W>U;U++)b=U+1,G=U*q,i=b*q,F.push(n*R($)*H(G),n*H($),-n*R($)*R(G),n*R(A)*H(i),n*H(A),-n*R(A)*R(i),n*R($)*H(i),n*H($),-n*R($)*R(i),n*R($)*H(G),n*H($),-n*R($)*R(G),n*R(A)*H(G),n*H(A),-n*R(A)*R(G),n*R(A)*H(i),n*H(A),-n*R(A)*R(i)),g.push(U/z,N/V,b/z,B/V,b/z,N/V,U/z,N/V,U/z,B/V,b/z,B/V);if(r){var o=[],s=[];for(G=l*q,N=0;V>N;N++)B=N+1,$=N*Z,A=B*Z,o.push(0,0,0,n*R(A)*H(G),n*H(A),-n*R(A)*R(G),n*R($)*H(G),n*H($),-n*R($)*R(G)),s.push(0,.5,l/z,B/V,l/z,N/V)}if(E){var p=[],O=[];for(G=W*q,N=0;V>N;N++)B=N+1,$=N*Z,A=B*Z,p.push(0,0,0,n*R($)*H(G),n*H($),-n*R($)*R(G),n*R(A)*H(G),n*H(A),-n*R(A)*R(G)),O.push(1,.5,W/z,N/V,W/z,B/V)}return{vs:F,uv:g,from_vs:o,from_uv:s,to_vs:p,to_uv:O}},Zc=function(V,g,E){V=V||.17,g=g||12,E=E||18,0>V?V=0:V>.25&&(V=.25);var t,M,Q,G,C,h,u,Z=.5,v=[],j=[],p=[],y=m/E,b=m/g,c=Z-V;for(M=0;g>=M;M++)for(G=-f+M*b,h=H(G),C=R(G),t=0;E>=t;t++)Q=t*y,u=c+V*h,v.push(H(Q)*u,C*V,-R(Q)*u),j.push(t/E,1-M/g);for(M=0;g>M;M++){var D=M*(E+1),K=(M+1)*(E+1);for(t=0;E>t;t++)p.push(D+t,K+t+1,K+t,D+t,D+t+1,K+t+1)}return{vs:v,uv:j,is:p}},Od=function(z,p,y,q,W,D,I){I=I||12,z=z||18,p=p||0,y=y||z,D=D||.17,0>D?D=0:D>.25&&(D=.25);var u,n,s,b,V,w,t,g,h,U,C=.5,v=[],d=[],O=m/z,N=m/I,k=C-D;for(s=0;I>s;s++)for(b=s+1,t=-f+s*N,g=-f+b*N,u=p;y>u;u++)n=u+1,V=u*O,w=n*O,h=k+D*H(t),U=k+D*H(g),v.push(H(V)*h,R(t)*D,-R(V)*h,H(w)*h,R(t)*D,-R(w)*h,H(w)*U,R(g)*D,-R(w)*U,H(V)*h,R(t)*D,-R(V)*h,H(w)*U,R(g)*D,-R(w)*U,H(V)*U,R(g)*D,-R(V)*U),d.push(u/z,1-s/I,n/z,1-s/I,n/z,1-b/I,u/z,1-s/I,n/z,1-b/I,u/z,1-b/I);if(q){var Z=[],K=[];for(s=0;I>s;s++)b=s+1,t=-f+s*N,g=-f+b*N,V=p*O,h=k+D*H(t),U=k+D*H(g),Z.push(H(V)*h,R(t)*D,-R(V)*h,H(V)*U,R(g)*D,-R(V)*U,H(V)*k,0,-R(V)*k),K.push(.5+.5*H(t),.5-.5*R(t),.5+.5*H(g),.5-.5*R(g),.5,.5)}if(W){var Y=[],S=[];for(s=0;I>s;s++)b=s+1,t=-f+s*N,g=-f+b*N,V=y*O,h=k+D*H(t),U=k+D*H(g),Y.push(H(V)*h,R(t)*D,-R(V)*h,H(V)*k,0,-R(V)*k,H(V)*U,R(g)*D,-R(V)*U),S.push(.5-.5*H(t),.5-.5*R(t),.5,.5,.5-.5*H(g),.5-.5*R(g))}return{vs:v,uv:d,from_vs:Z,from_uv:K,to_vs:Y,to_uv:S}},qo=function(P,X){for(var k,l,n,Q=.5,D=16,b=[],I=[],M=[],j=m/D,$=0;D>=$;$++)k=$*j,l=H(k)*Q,n=R(k)*Q,b.push(l,-Q,n,l,Q,n),I.push(1-$/D,1,1-$/D,0);for($=0;D>$;$++)M.push(2*$,2*$+1,2*$+3,2*$,2*$+3,2*$+2);if(X){var J=[],z=[],F=[];for(J.push(0,-Q,0),z.push(.5,.5),$=0;D>=$;$++)k=$*j,l=H(k),n=R(k),J.push(l*Q,-Q,-n*Q),z.push(.5+.5*l,.5+.5*n);for($=0;D>$;$++)F.push(0,$+2,$+1)}if(P){var N=[],d=[],f=[];for(N.push(0,Q,0),d.push(.5,.5),$=0;D>=$;$++)k=$*j,l=H(k),n=R(k),N.push(l*Q,Q,-n*Q),d.push(.5+.5*l,.5-.5*n);for($=0;D>$;$++)f.push(0,$+1,$+2)}return{vs:b,uv:I,is:M,bottom_vs:J,bottom_uv:z,bottom_is:F,top_vs:N,top_uv:d,top_is:f}},le=function(G,t,L,q,C,P,s){G=G||12,t=t||0,L=L||G;for(var k,O,S,_,J,i,h,u,M=.5,I=[],V=[],W=m/G,Q=t;L>Q;Q++)k=Q+1,O=Q*W,S=k*W,_=H(O)*M,J=R(O)*M,i=H(S)*M,h=R(S)*M,I.push(_,-M,-J,i,-M,-h,_,M,-J,i,-M,-h,i,M,-h,_,M,-J),V.push(Q/G,1,k/G,1,Q/G,0,k/G,1,k/G,0,Q/G,0);if(s){var z=[],N=[];for(Q=t;L>Q;Q++)O=W*Q,S=W*(Q+1),_=H(O),J=R(O),i=H(S),h=R(S),z.push(_*M,-M,-J*M,0,-M,0,i*M,-M,-h*M),N.push(.5+.5*_,.5+.5*J,.5,.5,.5+.5*i,.5+.5*h)}if(P){var Y=[],l=[];for(Q=t;L>Q;Q++)O=W*Q,S=W*(Q+1),_=H(O),J=R(O),i=H(S),h=R(S),Y.push(_*M,M,-J*M,i*M,M,-h*M,0,M,0),l.push(.5+.5*_,.5-.5*J,.5+.5*i,.5-.5*h,.5,.5)}if(q){var d=[],F=[];O=W*t,_=H(O)*M,J=R(O)*M,u=t/G,d.push(0,M,0,0,-M,0,_,-M,-J,_,-M,-J,_,M,-J,0,M,0),F.push(0,0,0,1,u,1,u,1,u,0,0,0)}if(C){var r=[],x=[];O=W*L,_=H(O)*M,J=R(O)*M,u=L/G,r.push(0,-M,0,0,M,0,_,M,-J,_,M,-J,_,-M,-J,0,-M,0),x.push(1,1,1,0,u,0,u,0,u,1,1,1)}return{vs:I,uv:V,bottom_vs:z,bottom_uv:N,top_vs:Y,top_uv:l,from_vs:d,from_uv:F,to_vs:r,to_uv:x}},Ro=function(G,Y,q,U,O){Y=Y||18,q=q||0,U=U==N?m:U,O=O==N?.5:O;for(var p,e,v,J,r,n,V=[0,.5,.75,.875,.9375],D=[],Q=[],x=[],E=U/Y,L=0;L<V.length;L++){var A=0===L%2?0:.5;for(p=0;Y>=p;p++)e=(p+A)*E+q,v=1-V[L],D.push(H(e)*O*v,-O+2*V[L]*O,-R(e)*O*v),Q.push((p+A)/Y,v)}for(L=0;L<V.length-1;L++){var h=L*(Y+1),W=(L+1)*(Y+1);for(p=0;Y>p;p++)x.push(h+p,W+p+1,W+p,h+p,h+p+1,W+p+1)}for(n=D.length/3-(Y+1),p=0;Y>p;p++)D.push(0,O,0),Q.push((p+.5)/Y,0);for(p=0;Y>p;p++)x.push(n+p,n+p+1,n+(Y+1)+p);if(G){var y=[],Z=[],c=[];for(y.push(0,-O,0),Z.push(.5,.5),p=0;Y>=p;p++)e=p*E+q,J=H(e),r=R(e),y.push(J*O,-O,-r*O),Z.push(.5+.5*J,.5+.5*r);for(p=0;Y>p;p++)c.push(0,p+2,p+1)}return{vs:D,uv:Q,is:x,bottom_vs:y,bottom_uv:Z,bottom_is:c}},eb=function(M,B,$,F,y,c){M=M||16,B=B||0,$=$||M;for(var C=.5,U=[],g=[],k=m/M,J=B;$>J;J++){var v=J+1,b=k*J,I=k*v;U.push(H(b)*C,-C,-R(b)*C,H(I)*C,-C,-R(I)*C,0,C,0),g.push(J/M,1,v/M,1,(J+v)/2/M,0)}if(c){var D=[],o=[];for(J=B;$>J;J++){b=k*J,I=k*(J+1);var G=H(b),O=R(b),h=H(I),T=R(I);D.push(G*C,-C,-O*C,0,-C,0,h*C,-C,-T*C),o.push(.5+.5*G,.5+.5*O,.5,.5,.5+.5*h,.5+.5*T)}}if(F){var L=[],u=[];b=k*B,L.push(0,C,0,0,-C,0,H(b)*C,-C,-R(b)*C),u.push(0,0,0,1,B/M,1)}if(y){var t=[],N=[];b=k*$,t.push(0,-C,0,0,C,0,H(b)*C,-C,-R(b)*C),N.push(1,1,1,0,$/M,1)}return{vs:U,uv:g,bottom_vs:D,bottom_uv:o,from_vs:L,from_uv:u,to_vs:t,to_uv:N}},kl=function(Q,e,A,z,C,T,Y,t){for(var S=[],G=0;G<Q.length-1;G+=2)S.push({x:Q[G],y:Q[G+1]});return Ff(S,e,A,z,C,T,Y,t,!1)},sr={roundRect:function(k,V){return kl([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],k,V,3)},star:function(R,r){return kl([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],R,r)},rect:function(h,q){return kl([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],h,q)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(g,u){return kl([0,-.5,.5,.5,-.5,.5],[1,2,2,5],g,u)},rightTriangle:function(L,g){return kl([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],L,g)},parallelogram:function(H,D){return kl([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],H,D)},trapezoid:function(R,u){return kl([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],R,u)}},tb={sphere:1,cylinder:1,cone:1,torus:1},ue={torus:1,sphere:1},gc=Vp(kg(sr),{cylinder:1}),Og=Vp(kg(sr),{cylinder:1,cone:1}),Hk=function(c,J,z){var C,H=Cd(c.anchor3d,z,J),R=Cd(c.mat,z,J),L=Cd(c.s3,z,J),w=Cd(c.t3,z,J),b=Cd(c.r3,z,J),V=L||b||w||R;if(H||V){C=so(J._6O);var X=V?mf(R,L,b,Cd(c.rotationMode,z,J),w):vq();H&&aq(X,[.5-H[0],.5-H[1],.5-H[2]]),Kd(J,X)}return C},Jq=function(B,I,k,E,s,Z,d){if(pi(k))k.forEach(function(V){Jq(B,I,V,E,s,Z,d)});else if(fh(k))Jq(B,I,jr(E,k),E,s,Z,d);else if(yp(k))if(k.shape3d){var V=Hk(k,B,I);Jq(B,I,k.shape3d,E,s,Z,k),V&&Ib(B,V)}else Wf(B,I,k,E.s,s,Z,d)},Wf=function(Z,h,V,o,J,B,n){if(n=n||Ee,!B||B(o("shape3d.transparent",V.transparent,n.transparent))){var i=Hk(V,Z,h);Sl(V);var c=Z._26I,t=Z._prg,m=Z._buffer,O=o("shape3d.color",V.color,n.color);J||(J=o("shape3d.blend",V.blend,n.blend));var w,a=V.opacity==N?n.opacity:V.opacity,I=o("shape3d.opacity");w=I!=N&&a!=N?a*I:a!=N?a:I,pk(c,t,J,o("shape3d.light",V.light,n.light),w,o("shape3d.reverse.flip",V.reverseFlip,n.reverseFlip),o("shape3d.reverse.color",V.reverseColor,n.reverseColor),o("shape3d.reverse.cull",V.reverseCull,n.reverseCull));var E=o("polygonOffset",V.polygonOffset,n.polygonOffset);V.vs&&o(_h,V.visible,n.visible)&&Pp(c,t,m,O,Z.getTexture(o("shape3d.image",V.image,n.image),h),o("shape3d.discard.selectable",V.discardSelectable,n.discardSelectable),V.vs,V.uv,V.ns,V.is,o("shape3d.uv.offset",V.uvOffset,n.uvOffset),o("shape3d.uv.scale",V.uvScale,n.uvScale),E),V.top_vs&&o(bl,V.topVisible,n.topVisible)&&Pp(c,t,m,o("shape3d.top.color",V.topColor,n.topColor)||O,Z.getTexture(o("shape3d.top.image",V.topImage,n.topImage),h),o("shape3d.top.discard.selectable",V.topDiscardSelectable,n.topDiscardSelectable),V.top_vs,V.top_uv,V.top_ns,V.top_is,o("shape3d.top.uv.offset",V.topUvOffset,n.topUvOffset),o("shape3d.top.uv.scale",V.topUvScale,n.topUvScale),E),V.bottom_vs&&o(Fd,V.bottomVisible,n.bottomVisible)&&Pp(c,t,m,o("shape3d.bottom.color",V.bottomColor,n.bottomColor)||O,Z.getTexture(o("shape3d.bottom.image",V.bottomImage,n.bottomImage),h),o("shape3d.bottom.discard.selectable",V.bottomDiscardSelectable,n.bottomDiscardSelectable),V.bottom_vs,V.bottom_uv,V.bottom_ns,V.bottom_is,o("shape3d.bottom.uv.offset",V.bottomUvOffset,n.bottomUvOffset),o("shape3d.bottom.uv.scale",V.bottomUvScale,n.bottomUvScale),E),V.from_vs&&o(ak,V.fromVisible,n.fromVisible)&&Pp(c,t,m,o("shape3d.from.color",V.fromColor,n.fromColor)||O,Z.getTexture(o("shape3d.from.image",V.fromImage,n.fromImage),h),o("shape3d.from.discard.selectable",V.fromDiscardSelectable,n.fromDiscardSelectable),V.from_vs,V.from_uv,V.from_ns,V.from_is,o("shape3d.from.uv.offset",V.fromUvOffset,n.fromUvOffset),o("shape3d.from.uv.scale",V.fromUvScale,n.fromUvScale),E),V.to_vs&&o(br,V.toVisible,n.toVisible)&&Pp(c,t,m,o("shape3d.to.color",V.toColor,n.toColor)||O,Z.getTexture(o("shape3d.to.image",V.toImage,n.toImage),h),o("shape3d.to.discard.selectable",V.toDiscardSelectable,n.toDiscardSelectable),V.to_vs,V.to_uv,V.to_ns,V.to_is,o("shape3d.to.uv.offset",V.toUvOffset,n.toUvOffset),o("shape3d.to.uv.scale",V.toUvScale,n.toUvScale),E),rm(c,t),i&&Ib(Z,i)}},Pp=function(C,r,R,n,L,x,h,z,$,H,f,E,b){h&&(b&&Kf(C,b),Xd(C,r.uDiffuse,n||e["color.empty"]),z?Vb(C,r,L,x,R.uv,z,f,E):Vb(C),fg(C,R.vs,h,r.aPosition),fg(C,R.ns,$,r.aNormal),H?(Hc(C,R.is,H),ni(C,0,H.length)):rk(C,0,h.length/3),z?Xp(C,r,L):Xp(C),b&&Sb(C))},jr=function(L,r){var z=L.s;if(r||(r=z(ul)),!r)return N;var y=sl(r);if(y)return y;if("text"===r){var m={amount:z("shape3d.text.amount"),size:z("shape3d.text.size"),font:z("shape3d.text.font"),style:z("shape3d.text.style"),weight:z("shape3d.text.weight"),fill:z("shape3d.text.fill"),curveSegments:z("shape3d.text.curveSegments"),spacing:z("shape3d.text.spacing")},U=L.gv.getShape3dText(L.data),Z=U;for(var e in m)Z+="_"+(m[e]===s?"U":m[e]);return L._cachedTextKey===Z?L._cachedTextGeometry:(L._cachedTextKey=Z,L._cachedTextGeometry=Q.createTextGeometry(U,m))}var e=r;if(tb[r]){var S=z("shape3d.side"),K=z("shape3d.side.from"),Y=z("shape3d.side.to"),E=z(ak),$=z(br);3>S?(S=0,K=0,Y=0,E=!1,$=!1):((K==N||0>K)&&(K=0),(Y==N||Y>S)&&(Y=S),0===K&&Y===S&&(E=!1,$=!1)),e+="-"+S+"-"+K+"-"+Y+"-"+E+"-"+$}if(gc[r]){var J=z(bl);e+="-"+J}if(Og[r]){var j=z(Fd);e+="-"+j}if("torus"===r){var v=z("shape3d.torus.radius");0>v?v=0:v>.25&&(v=.25),e+="-"+v}if(ue[r]){var D=z(er);e+="-"+D}return y=Oi[e],y||("box"===r?y=Q.createBoxModel():sr[r]?y=sr[r](J,j):"sphere"===r?y=Q.createSphereModel(S,K,Y,E,$,D):r===Sq?y=Q.createCylinderModel(S,K,Y,E,$,J,j):"cone"===r?y=Q.createConeModel(S,K,Y,E,$,j):"torus"===r&&(y=Q.createTorusModel(S,K,Y,E,$,v,D)),Oi[e]=y),y},Sl=function(){var E=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],W=["is","top_is","bottom_is","from_is","to_is"];return x=Bm(Fm.substr(Fm.indexOf("^#")+2)),wd(Q[bg(Of+E[15]+"n"+E[16])]())&&ye()?function($){$&&!$._complete_&&($._complete_=!0,$.vs&&Wl($.ns)&&($.ns=_p($.vs,$.is)),$.top_vs&&Wl($.top_ns)&&($.top_ns=_p($.top_vs,$.top_is)),$.bottom_vs&&Wl($.bottom_ns)&&($.bottom_ns=_p($.bottom_vs,$.bottom_is)),$.from_vs&&Wl($.from_ns)&&($.from_ns=_p($.from_vs,$.from_is)),$.to_vs&&Wl($.to_ns)&&($.to_ns=_p($.to_vs,$.to_is)),E.forEach(function(h){var B=$[h];pi(B)&&($[h]=new As(B))}),W.forEach(function(h){var D=$[h];pi(D)&&($[h]=new wq(D))}))}:void 0}(),Lj=function(n,$){var C=n[$];pi(C)&&(n[$]=new As(C))};Vp(ec,{_25Q:function(d){d._16O=function(x,R,p,k,z,Q,c,F,L){var N=this.info;if(N){var j,V,n,e,A,T,C=vq();if(Ai[R]?(j=N.p3,V=N.c1,n=N.c2):Vr[R]?(V=N.s1||N.c1,n=N.s2||N.c2):(V=N.t1||N.c1,n=N.t2||N.c2),j)T=zp(R,hb,p,k,F,L);else{var B=xk(n,V),i=Df(V,n);e=[0,-_(B[2],B[0]),M(B[1]/i)],A="zyx",j=[(V[0]+n[0])/2,(V[1]+n[1])/2,(V[2]+n[2])/2],T=zp(R,[i,0,0],p,k,F,L)}return og(C,T,j,k,z,Q,c,x,e,A)}return fb},d._80o=function(M,v,h){var E=this,y=E.shapeModel;if(y){var F=E.gv;Kd(F),Jq(F,E.data,y,E,E.getBodyColor(),h)}},d.createLineModel=function(m,j,$,O,_){for(var T=this,g=T.s,D=So(m,j,g(er)),h=[],k=0;k<D.length;k++){var V=D[k],n=V.length;if(n>1){var f=V[0];h.push(f.x,f.y,f.z);for(var s=1;n-1>s;s++)f=V[s],h.push(f.x,f.y,f.z),h.push(f.x,f.y,f.z);f=V[n-1],h.push(f.x,f.y,f.z)}}var P,F,E,K=g(O+".color"),d=g(_),o=0;return d&&(F=g(_+".color"),P=g(_+".pattern"),o=g(_+".offset"),E=K),Mf(T.gv,T.data,h,F||K,E?N:g(O+".gradient.color"),$,P||g(O+".pattern"),o,E),D},d.createTubeModel=function(B,h,O,y){for(var H=this,A=H.s,W=A("shape3d.side")||xp,x=A("shape3d.start.angle"),g=A("shape3d.sweep.angle"),n=A(bl)?A("shape3d.top.cap"):N,i=A(Fd)?A("shape3d.bottom.cap"):N,X="flat"===n,q="flat"===i,a=X&&(y?y.uv:A("shape3d.top.image")),m=q&&(y?y.uv:A("shape3d.bottom.image")),f=y?y.uv:A("shape3d.image"),c={vs:[],uv:f?[]:N,top_vs:X?[]:N,top_uv:a?[]:N,bottom_vs:q?[]:N,bottom_uv:m?[]:N},K=So(B,h,A(er),O),J=0,C=K.length;C>J;J++)Tc(c,K[J],A(Vl),O,W,x,g,n,i);if(y){var d=[];yg(H.gv,H.data,c,H,H.getBodyColor(),[],y,d),d.length&&(Kb(y.vs,d),Kb(y.ns,_p(d)))}else H.shapeModel=c;return K},d.getCache=function(){var E=this.info;if(E){var x=E.list;if(x){var Y=E.cache;return Y||(Y=E.cache=$c(x)),Y}}return N}}});var ac=function(w,L){for(var X,k=0,B=w.length,f=0,m=B-1;m>=f;)if(k=S(f+(m-f)/2),X=w[k].length-L,0>X)f=k+1;else{if(!(X>0)){m=k;break}m=k-1}k=m;var V=w[k],I=V.point;return k===B-1||V.length===L||(I=(new hr).subVectors(w[k+1].point,I).normalize().multiplyScalar(L-V.length).add(I)),{point:I,tangent:V.tangent}},$c=function($){for(var y,U,D=[],r=0,W=0;W<$.length;W++){for(var z=$[W],o=0;o<z.length;o++){y=z[o],U&&(r+=U.distanceTo(y));var V=new hr,A=z[o+1];A?V.subVectors(A,y):U?V.subVectors(y,U):V.x=1,V.normalize(),D.push({point:y,length:r,tangent:V}),U=y}U=null}return D},So=function(I,P,z,B){z=z||zj;for(var M=[],K=0,U=I.size();U>K;K++){var g=I.get(K);M.push(new hr(g.x,g.e||0,g.y))}P&&(Cg(P)&&(P=P._as),P.length||(P=null));for(var x,E,Q,k,w,F=[],n=0,L=0,C=P?P.length:U;C>L;L++)if(w=P?P[L]:0===L?1:2,1===w)F.push(Q=[]),Q.push(M[n++]);else if(2===w||5===w)if(k=2===w?M[n++]:Q[0],B){var $=P?P[L+1]:C>L+1?2:N;if(2===$||5===$){var u=Q[Q.length-1],s=2===$?M[n]:Q[0],v=(new hr).subVectors(u,k),J=(new hr).subVectors(s,k),j=v.length(),A=J.length();if(j&&A)if(B>j/2&&B>A/2)Q.push(k);else for(v.multiplyScalar(h(B,j/2)/j).add(k),J.multiplyScalar(h(B,A/2)/A).add(k),x=new fj(v,k,J).getPoints(z),E=0;z>=E;E++)Q.push(x[E])}else Q.push(k)}else Q.push(k);else if(3===w)for(x=new fj(Q[Q.length-1],M[n++],M[n++]).getPoints(z),E=1;z>=E;E++)Q.push(x[E]);else if(4===w)for(x=new ff(Q[Q.length-1],M[n++],M[n++],M[n++]).getPoints(z),E=1;z>=E;E++)Q.push(x[E]);return F},hc=function(u){for(var T,d,P=new hr,v=[],w=[],z=[],m=0,W=u.length;W>m;m++)T=u[m],d=u[m+1],d?P.subVectors(d,T):P.subVectors(T,u[m-1]),v.push(P.normalize().clone());var k,U,D,E,q=new hr,H=new hr,b=new Zl,t=1e-4,g=Number.MAX_VALUE,N=v[0],K=w[0]=new hr,M=z[0]=new hr;for(U=c(N.x),D=c(N.y),E=c(N.z),g>=U&&(g=U,q.set(1,0,0)),g>=D&&(g=D,q.set(0,1,0)),g>=E&&q.set(0,0,1),H.crossVectors(N,q).normalize(),K.crossVectors(N,H),M.crossVectors(N,K),m=1;W>m;m++)w[m]=w[m-1].clone(),z[m]=z[m-1].clone(),H.crossVectors(v[m-1],v[m]),H.length()>t&&(H.normalize(),k=j(rj(v[m-1].dot(v[m]),-1,1)),w[m].applyMatrix4(b.makeRotationAxis(H,k))),z[m].crossVectors(v[m],w[m]);return{B:z,T:v,N:w}},Tc=function(){var u=function(q){for(var X=1;X<arguments.length;X++){var a=arguments[X];q.push(a.x,a.y,a.z)}},o=function(G){for(var i=1;i<arguments.length;i++){var X=arguments[i].uv;G.push(X[0],X[1])}},n=function(S,U,D,W,A){var _=-W*H(A),K=W*R(A);return new hr(S.x+_*D.x+K*U.x,S.y+_*D.y+K*U.y,S.z+_*D.z+K*U.z)},$=function(Q,J,C,b,R,Z,o,t){o=o||m;for(var T=[],i=o/R,Y=0;R>=Y;Y++){var _=n(Q,J,C,b,Y*i+Z);T.push(_),t!=N&&(_.uv=[t,Y/R])}return T},Z=function(L,s,A,g,S,K,x,C,f){f=f||m;var J=s?L.top_vs:L.bottom_vs;if(J)for(var P=s?L.top_uv:L.bottom_uv,_=f/x,D=0;x>D;D++){var Q,N;s?(Q=D*_+C,N=(D+1)*_+C):(N=D*_+C,Q=(D+1)*_+C),u(J,n(A,g,S,K,Q),n(A,g,S,K,N),A),P&&P.push(.5-.5*H(Q),.5-.5*R(Q),.5-.5*H(N),.5-.5*R(N),.5,.5)}};return function(J,W,e,w,k,O,X,b,t){var p=W.length;if(p>1){var M,G,B,d,K,E,Q,l=hc(W),V=l.T,H=l.N,i=l.B;"flat"===b&&Z(J,!0,W[0],i[0],H[0],w,k,O,X),"flat"===t&&Z(J,!1,W[p-1],i[p-1],H[p-1],w,k,O,X);var q,T,P=[],h=C(k/2),v="round"===b,L="round"===t,m=W[0],Y=V[0],f=i[0],x=H[0],I=W[p-1],A=V[p-1],n=i[p-1],r=H[p-1];if(v){for(B=1;h>=B;B++)H.splice(0,0,x),i.splice(0,0,f),V.splice(0,0,Y),T=-B/h*w,W.splice(0,0,Y.clone().multiplyScalar(T).add(m)),P[h-B]=F(w*w-T*T);p+=h}if(L){for(B=1;h>=B;B++)H.push(r),i.push(n),V.push(A),T=B/h*w,W.push(A.clone().multiplyScalar(T).add(I)),P[W.length-1]=F(w*w-T*T);p+=h}if(J.uv){var S=0,z=0,g=[];for(e&&(S=e),K=W[0],g[0]=0,B=1;p>B;B++)d=W[B],g[B]=K.distanceTo(d),K=d,e||(S+=g[B]);for(q=[],B=0;p>B;B++)z+=g[B],q[B]=S?z/S:0}for(B=0;p>B;B++){if(d=W[B],E=i[B],Q=H[B],M=$(d,E,Q,P[B]===s?w:P[B],k,O,X,q?q[B]:N),G)for(var a=0;k>a;a++){var _=G[a],y=G[a+1]||G[0],D=M[a],j=M[a+1]||M[0];u(J.vs,y,_,D,D,j,y),J.uv&&o(J.uv,y,_,D,D,j,y)}G=M}}}}();Vp(Q,{getLineLength:function(u){return u[u.length-1].length},getLineOffset:function(I,R){return ac(I,R)},getLineCacheInfo:function(r,n,c,H){return $c(So(r,n,c,H))}});var as=z.graph3d.RenderLite={},cn=new Array(0),an=as.Buffer=function(R,Z,s,d){this.gl=R,this.buffer=R.createBuffer(),this.type=Z||R.ARRAY_BUFFER,this.drawType=d||R.STATIC_DRAW,this.data=cn,s&&this.upload(s)};an.prototype.upload=function(s,c,d){d||this.bind();var i=this.gl;s=s||this.data,c=c||0,this.data.byteLength>=s.byteLength?i.bufferSubData(this.type,c,s):i.bufferData(this.type,s,this.drawType),this.data=s},an.prototype.bind=function(){var H=this.gl;H.bindBuffer(this.type,this.buffer)},an.createVertexBuffer=function(E,s,Y){return new an(E,E.ARRAY_BUFFER,s,Y)},an.createIndexBuffer=function(O,$,N){return new an(O,O.ELEMENT_ARRAY_BUFFER,$,N)},an.create=function(E,e,x,K){return new an(E,e,K)},an.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var is=as.Shader=function(l,v,V){this.gl=l,this.program=kp(l,v,V),this.attributes=yl(l,this.program);var g=ic(l,this.program);this.uniforms=qm(l,g)};is.prototype.bind=function(){this.gl.useProgram(this.program)},is.prototype.destroy=function(){this.gl};var kp=function(b,g,d){var i=Fq(b,b.VERTEX_SHADER,g),w=Fq(b,b.FRAGMENT_SHADER,d);b.getShaderParameter(w,b.COMPILE_STATUS)||console.error(b.getError());var y=b.createProgram();return b.attachShader(y,i),b.attachShader(y,w),b.linkProgram(y),b.getProgramParameter(y,b.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",b.getProgramParameter(y,b.VALIDATE_STATUS)),console.error("gl.getError()",b.getError()),""!==b.getProgramInfoLog(y)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",b.getProgramInfoLog(y)),b.deleteProgram(y),y=null),b.deleteShader(i),b.deleteShader(w),y},Fq=function(j,Z,n){var A=j.createShader(Z);return j.shaderSource(A,n),j.compileShader(A),j.getShaderParameter(A,j.COMPILE_STATUS)?A:(console.log(j.getShaderInfoLog(A)),null)},ic=function(V,H){for(var M={},x=V.getProgramParameter(H,V.ACTIVE_UNIFORMS),B=0;x>B;B++){var P=V.getActiveUniform(H,B),I=P.name.replace(/\[.*?\]/,""),d=kn(V,P.type);M[I]={type:d,size:P.size,location:V.getUniformLocation(H,I),value:gk(d,P.size)}}return M},yl=function(y,E){for(var Y={},m=y.getProgramParameter(E,y.ACTIVE_ATTRIBUTES),w=0;m>w;w++){var c=y.getActiveAttrib(E,w),S=kn(y,c.type);Y[c.name]={type:S,size:Yh(S),gl:y,location:y.getAttribLocation(E,c.name),pointer:nb}}return Y},nb=function(k,F,D,X,l){var r=this.gl;r.enableVertexAttribArray(this.location),r.bindBuffer(k.type,k.buffer),r.vertexAttribPointer(this.location,this.size,F||r.FLOAT,D||!1,X||0,l||0)},Yh=function(b){return $m[b]},$m={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},kn=function(k,o){if(!Ve){var H=W.keys(af);Ve={};for(var R=0;R<H.length;++R){var $=H[R];Ve[k[$]]=af[$]}}return Ve[o]},Ve=null,af={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},gk=function(B,U){switch(B){case"float":return 0;case"vec2":return new Float32Array(2*U);case"vec3":return new Float32Array(3*U);case"vec4":return new Float32Array(4*U);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*U);case"ivec3":return new Int32Array(3*U);case"ivec4":return new Int32Array(4*U);case"bool":return!1;case"bvec2":return Ae(2*U);case"bvec3":return Ae(3*U);case"bvec4":return Ae(4*U);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Ae=function(a){for(var $=new Array(a),y=0;y<$.length;y++)$[y]=!1;return $},qm=function(K,I){var v={data:{}};v.gl=K;for(var j=W.keys(I),_=0;_<j.length;_++){var U=j[_],R=U.split("."),l=R[R.length-1],G=_g(R,v),A=I[U];G.data[l]=A,G.gl=K,W.defineProperty(G,l,{get:gj(l),set:Rd(l,A)})}return v},gj=function(k){var H=pe.replace("%%",k);return new Function(H)},Rd=function(I,J){var j,x=wj.replace(/%%/g,I);return j=1===J.size?zs[J.type]:Yd[J.type],j&&(x+="\nthis.gl."+j+";"),new Function("value",x)},_g=function($,Y){for(var I=Y,U=0;U<$.length-1;U++){var l=I[$[U]]||{data:{}};I[$[U]]=l,I=l}return I},pe=["return this.data.%%.value;"].join("\n"),wj=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),zs={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Yd={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Bd=z.Light=function(){oj(Bd,this),this.s(zf,e[zf]),this.s(ul,"sphere"),this.s3(20,20,20)};iq("Light",Bj,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(y,D,J){Bd.superClass.onStyleChanged.apply(this,arguments),y===zf&&this.s("shape3d.color",J)}});var df=Vn.Graph3dView=function(j,P){var B=this;B._webGLVersion=1,B._attributes=P||Q.graph3dViewAttributes,B._25I={},B._view=ge(1,B);var o=B._canvas=Wq(B._view);o.addEventListener("webglcontextlost",function(C){C.preventDefault(),Qj(B),B._26I&&B._doBufferGC(B._26I,!0),B._26I=N,B._1o.texture=N,B._35O=!0},r),o.addEventListener("webglcontextrestored",function(){B._35O=!1,B.iv()},r),B._batchIndexMap={},B._batchModelMap={},B._wireframeIndexMap={},B._wireframeModelMap={},B._wireframeIndexMapSwap={},B._wireframeModelMapSwap={},B._polylineIndexMap={},B._polylineIndexMap={},B._polylineIndexMapSwap={},B._polylineIndexMapSwap={},B._8O=[],B._7O=vq(),B._6O=vq(),B._1o=new Ko(B),B._30O=new Bf(B),B._31O=new je(B),B._32O=new Xk(B),B._raycaster=new eg(B),B._highlightHelper=new Hd(B),B._postProcessing=new Je(B),B._cameras=[],B._cameraId=0,B.vr=new qj(B),B._33Q=!0,B._eye=kg(Q.graph3dViewEye),B._center=kg(Q.graph3dViewCenter),B._up=kg(Q.graph3dViewUp),B._lightChanged=!1,B._59O=[],B._spots=[],B._dirs=[],B._frameId=0,B.overlappingBox=new xf(B),B.dm(j?j:new aj),B._coreInteractor=new us(this),B.setInteractors([new ug(B)])},Bh={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},De=function(Y,R,l,u){Y.clearColor(0,0,0,0),Y.clearDepth(1),Y.enable(Y.DEPTH_TEST),Y.depthFunc(Y.LEQUAL),Y.disable(Y.CULL_FACE),Y.enable(Y.BLEND),Y.blendFuncSeparate(Y.SRC_ALPHA,Y.ONE_MINUS_SRC_ALPHA,Y.ONE,Y.ONE_MINUS_SRC_ALPHA),Y.useProgram(l),Xd(Y,l.uBrightness,1),Xd(Y,l.uOpacity,1),Xd(Y,l.uPartOpacity,1),Xd(Y,l.uPick,u._picking),Xd(Y,l.uTexture,!1),Xd(Y,l.uBlendTexture,!1),Xd(Y,l.uAlphaTest,e.alphaTest),Xd(Y,l.uTransparent,!1),Xd(Y,l.uFix,!1),Xd(Y,l.uBatchColor,!1),Xd(Y,l.uBatchBlend,!1),Xd(Y,l.uBatchBrightness,!1),Xd(Y,l.uReflectivity,u._envmapReflectivity),Xd(Y,l.uCameraPosition,R.getEye()),Xd(Y,l.uPMatrix,u._projectMatrix),Xd(Y,l.uViewMatrix,u._viewMatrix),R.bindEnvMap(Y),u._picking||(Un(R,Y,l),R._fogDisabled||(Xd(Y,l.uFogColor,R._fogColor),Xd(Y,l.uFogNear,R._fogNear),Xd(Y,l.uFogFar,R._fogFar))),Ip(Y,l.aPosition),Ip(Y,l.aNormal),th(Y,l.aUv),th(Y,l.aBatchColor),th(Y,l.aBatchBlend),th(Y,l.aBatchBrightness),th(Y,l.aLineDistance),Y.depthMask(!0)
},xs=0;Mj("Graph3dView",W,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",ql,mc,"firstPersonMode",Cq,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",or,No,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:Q.graph3dViewEditHelperDisabled,_devicePixelRatio:s,_boundaries:s,_moveStep:Q.graph3dViewMoveStep,_rotateStep:Q.graph3dViewRotateStep,_pannable:Q.graph3dViewPannable,_rotatable:Q.graph3dViewRotatable,_walkable:Q.graph3dViewWalkable,_resettable:Q.graph3dViewResettable,_zoomable:Q.graph3dViewZoomable,_firstPersonMode:Q.graph3dViewFirstPersonMode,_mouseRoamable:Q.graph3dViewMouseRoamable,_gridVisible:Q.graph3dViewGridVisible,_gridSize:Q.graph3dViewGridSize,_gridGap:Q.graph3dViewGridGap,_gridColor:Q.graph3dViewGridColor,_originAxisVisible:Q.graph3dViewOriginAxisVisible,_centerAxisVisible:Q.graph3dViewCenterAxisVisible,_axisXColor:Q.graph3dViewAxisXColor,_axisYColor:Q.graph3dViewAxisYColor,_axisZColor:Q.graph3dViewAxisZColor,_ortho:Q.graph3dViewOrtho,_orthoWidth:Q.graph3dViewOrthoWidth,_fovy:Q.graph3dViewFovy,_near:Q.graph3dViewNear,_far:Q.graph3dViewFar,_headlightColor:Q.graph3dViewHeadlightColor,_headlightIntensity:Q.graph3dViewHeadlightIntensity,_headlightRange:Q.graph3dViewHeadlightRange,_headlightDisabled:Q.graph3dViewHeadlightDisabled,_rectSelectable:Q.graph3dViewRectSelectable,_rectSelectBackground:Q.graph3dViewRectSelectBackground,_editSizeColor:Q.graph3dViewEditSizeColor,_autoMakeVisible:Il,_fogDisabled:Q.graph3dViewFogDisabled,_fogColor:Q.graph3dViewFogColor,_fogNear:Q.graph3dViewFogNear,_fogFar:Q.graph3dViewFogFar,_dashDisabled:Q.graph3dViewDashDisabled,_batchColorDisabled:Q.graph3dViewBatchColorDisabled,_batchBlendDisabled:Q.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:Q.graph3dViewBatchBrightnessDisabled,addCamera:function(N){var z=W.freeze({id:this._cameraId++,priority:N.priority||0,ignoreInPick:!!N.ignoreInPick,useDefaultProgram:!!N.useDefaultProgram,render:N.render});this._cameras.push(z),this._cameras.sort(function(l,R){return l.priority!==R.priority?l.priority-R.priority:l.id-R.id})},setEye:function(z,V,j){1===arguments.length&&(V=z[1],j=z[2],z=z[0]);var A=this._eye;A[0]=z,A[1]=V,A[2]=j,this.fp(or,N,A)},setCenter:function(Y,h,e){1===arguments.length&&(h=Y[1],e=Y[2],Y=Y[0]);var T=this._center;T[0]=Y,T[1]=h,T[2]=e,this.fp(No,N,T)},setUp:function(w,G,n){1===arguments.length&&(G=w[1],n=w[2],w=w[0]);var L=this._up;L[0]=w,L[1]=G,L[2]=n,this.fp("up",N,L)},getDevicePixelRatio:function(){return this._devicePixelRatio||sn},isTransparentMask:function(j){return j.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var L=this,E=L._aspect;return E?E:(E=L.getWidth()/L.getHeight(),E||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(n){var E=this,J=E._dataModel,y=E._selectionModel;J!==n&&(J&&(J.ump(E.handleDataModelPropertyChange,E),J.umm(E.handleDataModelChange,E),J.umd(E.handleDataPropertyChange,E),y||J.sm().ums(E.handleSelectionChange,E)),E._dataModel=n,n.mp(E.handleDataModelPropertyChange,E),n.mm(E.handleDataModelChange,E),n.md(E.handleDataPropertyChange,E),y?y._21I(n):n.sm().ms(E.handleSelectionChange,E),E._postProcessing.handleDataModleChange(J,n),E.invalidateAll(!0),E.invalidateLight(),E.fp(eh,J,n),E._canvas.style.background=n.getBackground()||"")},handleDataModelPropertyChange:function(b){if("background"===b.property){var o=this._canvas.style.background,Q=b.newValue||"";this._canvas.style.background=Q,this.fp("canvasBackground",o,Q)}else"envmap"===b.property&&this.iv()},handleDataPropertyChange:function(O){var v=O.data;this.invalidateData(v),Ci(v)&&"s:light.type"===O.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(U){var O=this,J=U.property;O.iv(),O._18Q=N,"eye"===J?O._33Q=!0:"devicePixelRatio"===J?O._42(N,O.getDevicePixelRatio()):Bh[J]&&Qj(O)},_5O:function(e){var h=e._22Q();return h?new h(this,e):N},getData3dUI:function(k){var e=this._25I[k._id];return e===s&&(e=this._5O(k),this._25I[k._id]=e),e},invalidateAll:function(V){var W=this;if(V){for(var X in W._25I){var u=W._25I[X];u&&u.dispose()}W._25I={},W.iv(),xr(W)}else xr(W),W.dm().each(function(I){W.invalidateData(I)})},invalidateSelection:function(){var a=this;a.sm().each(function(S){a.invalidateData(S)})},invalidateData:function(o){var x=this,V=x.getData3dUI(o);V&&(V.iv(),x.iv()),xr(x,o)},getShape3dText:function(S){return S.getStyle("shape3d.text")||this.getLabel(S)},invalidateBatch:function(y){var N=this,V=N._batchModelMap,T=V[y],k=[],G={};if(T){T.ds.forEach(function(r){var g=N.getData3dUI(r);g&&g.iv(),delete N._batchIndexMap[r._id],k.push(r._id)}),delete V[y];for(var B,I,c,n,t,H,o,j,z,Q=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],v=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],e=0;e<Q.length;e++){var d=N[Q[e]],M=N[v[e]];for(G={},j=0;j<k.length;j++){var C=M[k[j]];if(C){delete M[k[j]],z=C.batch,B=d[z];var R=C.begin,Z=C.size,_=3*R,q=3*Z,S=4*R,w=4*Z;for(I=B.ds,c=B.vs,n=B.cs,t=B.ps,H=B.ls,o=C.index,B.invalidate=!0,I[o]=s,o=_;_+q>o;o++)c[o]=s;for(o=S;S+w>o;o++)n[o]=s;for(o=S;S+w>o;o++)t[o]=s;if(H)for(o=_;_+q>o;o++)H[o]=s;G[z]=!0}}for(z in G){B=d[z],I=B.ds,c=B.vs,n=B.cs,t=B.ps,H=B.ls;var Y=[];for(o=0;o<I.length;o++)I[o]!==s&&Y.push(I[o]);if(0===Y.length)delete d[z];else{for(B.ds=Y,Y=[],o=0;o<c.length;o++)c[o]!==s&&Y.push(c[o]);for(B.vs=Y,Y=[],o=0;o<n.length;o++)n[o]!==s&&Y.push(n[o]);for(B.cs=Y,Y=[],o=0;o<t.length;o++)t[o]!==s&&Y.push(t[o]);if(B.ps=Y,H){for(Y=[],o=0;o<H.length;o++)H[o]!==s&&Y.push(H[o]);B.ls=Y}}}}N.iv()}},handleDataModelChange:function(k){var L=this,q=k.kind,G=k.data;if("add"===q)L.invalidateData(G),Wg(G)&&G.getEdgeGroup()&&G.getEdgeGroup().eachSiblingEdge(L.invalidateData,L),Ci(G)&&L.invalidateLight();else if(q===Qp){var t=G._id,O=L._25I[t];O&&(O.dispose(),delete L._25I[t],L.iv()),G===L._currentSubGraph&&L.setCurrentSubGraph(N),xr(L,G),Ci(G)&&L.invalidateLight()}else q===Nq&&(L.invalidateAll(!0),L.setCurrentSubGraph(N),xr(L),L.invalidateLight())},toCanvas:function(t,o,C){var f=this,h=f.getGL();if(f.validate(),t){var j=h.getParameter(h.COLOR_CLEAR_VALUE);vo(h,t)}f._42(N,1);var b=f.getWidth(),z=f.getHeight(),p=new Uint8Array(4*b*z),s=Wq(),e=s.getContext("2d");h.readPixels(0,0,b,z,h.RGBA,h.UNSIGNED_BYTE,p),Rj(s,b,z,1);for(var P=e.getImageData(0,0,b,z),M=P.data,K=0;K<M.length;K+=4){var c=K/4,w=S(c/b),G=c-w*b;c=4*((z-1-w)*b+G),M[c]=p[K],M[c+1]=p[K+1],M[c+2]=p[K+2],M[c+3]=p[K+3]}if(e.putImageData(P,0,0),t&&vo(h,j),f._42(N,f.getDevicePixelRatio()),o&&C){var v=Wq(),d=v.getContext("2d");return o=o,C=C,Rj(v,o,C,1),Q.drawImage(d,s,0,0,o,C),v}return s},toDataURL:function(R,M){var d=this,J=d.getGL();if(d.validate(),R){var A=J.getParameter(J.COLOR_CLEAR_VALUE);vo(J,R)}d._42(N,1);var O=d._canvas.toDataURL(M||"image/png",1);return R&&vo(J,A),d._42(N,d.getDevicePixelRatio()),O},getGL:function(){var C=this._26I;if(C)return this.acquireProgram(),C;var V=this,B=V._canvas,c=V._attributes;try{C=B.getContext("webgl2",c)||B.getContext("experimental-webgl2",c),C&&(V._webGLVersion=2,V._26I=C)}catch(J){}if(!C)try{C=B.getContext("webgl",c)||B.getContext("experimental-webgl",c)}catch(J){throw new Error("WebGL not supported")}if(!C)throw new Error("WebGL not supported");V._26I=C,V._glExtensions=new q(C),V._glCapabilities=new w(C,V._glExtensions),V._2O={},C._emptyTexture=Jp(C),C._emptyBlendTexture=Jp(C),C._bufPool={},C._id=++xs,V._buffer={vs:Gl(C),ns:Gl(C),is:Gl(C),uv:Gl(C),batchColor:Gl(C),batchBlend:Gl(C),batchBrightness:Gl(C),lineDistance:Gl(C)},V._1O=he(C);var I=V._cube={vs:Gl(C),ns:Gl(C),is:Gl(C),uv:Gl(C)};return Qr(C,I.vs,mn),Qr(C,I.ns,Gp),Qr(C,I.uv,Hl),jl(C,I.is,Nc),V.acquireProgram(),C},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var l=this,b=l._26I;if(b){var H=z.Default.getImage(l.getEnvmap())?!0:!1,j=l._prg&&l._prg.envMapFlag?!0:!1;if(!l._prg||H!==j){var V=l._prg=b.createProgram();if(!V)return N;V.envMapFlag=H;var o=l._dirs.length,s=l._spots.length,M=l._59O.length,O=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];o&&O.push("uDirColor","uDirDirection"),s&&O.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),M&&O.push("uPointColor","uPointRange","uPointPosition"),vo(b,[0,0,0,0]),b.clearDepth(1),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL),b.enable(b.BLEND),b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA),Dq||(Fm=Bm(Fm.substring(0,Fm.indexOf("^#"))),Nj=Bm(Nj),Dq=!0);var B=["#define MAX_DIR "+o,"#define MAX_SPOT "+s,"#define MAX_POINT "+M,l._fogDisabled?"":"#define FOG",l._dashDisabled?"":"#define DASH",H?"#define USE_ENVMAP":"",l.isOrtho()?"#define ORTHOGRAPHIC":"",l._batchColorDisabled?"":"#define BATCHCOLOR",l._batchBlendDisabled?"":"#define BATCHBLEND",l._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),J=Ak(b,V,b.VERTEX_SHADER,Fm.replace("PREFIX",B));b.getShaderParameter(J,b.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",b.getShaderInfoLog(J));var R=Ak(b,V,b.FRAGMENT_SHADER,Nj.replace("PREFIX",B));b.getShaderParameter(R,b.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",b.getShaderInfoLog(R)),pb?O.push("aPosition"):(V.aPosition=0,b.bindAttribLocation(V,0,"aPosition")),b.linkProgram(V),O.forEach(function(j){V[j]=/^u/.test(j)?b.getUniformLocation(V,j):b.getAttribLocation(V,j)}),b.useProgram(V),b.deleteShader(J),b.deleteShader(R)}}},getBrightness:function(n){var J=n.s("brightness"),v=this.isSelected(n)?n.s("select.brightness"):N;return J==N?v:v==N?J:J*v},setHighlightMode:function(P){var Y;Y="selection"===P?Hd.Mode.Selection:"mouseover"===P?Hd.Mode.MouseOver:Hd.Mode.Disable,this._highlightHelper.mode=Y},getHighlightMode:function(){var B=this._highlightHelper.mode;return B===Hd.Mode.Selection?"selection":B===Hd.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(W){var I=this,M=I._prg,c=5,C=I.getEnvmap(),D=z.Default.getImage(C);if(D){if(C!==I._lastEnvMap){I._envMapTexture&&W.deleteTexture(I._envMapTexture);var r=I._envMapTexture=W.createTexture();W.activeTexture(W.TEXTURE0),W.bindTexture(W.TEXTURE_CUBE_MAP,r),W.texParameteri(W.TEXTURE_CUBE_MAP,W.TEXTURE_MAG_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_CUBE_MAP,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,D),W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,D),W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,D),W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,D),W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,D),W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,W.RGBA,W.RGBA,W.UNSIGNED_BYTE,D),W.bindTexture(W.TEXTURE_CUBE_MAP,null),I._lastEnvMap=C}W.activeTexture(W.TEXTURE0+c),W.bindTexture(W.TEXTURE_CUBE_MAP,I._envMapTexture),W.uniform1i(M.uEnvMap,c)}},getWireframe:function(T){var F=T.s("wf.visible"),J=T.s("wf.width");return F===!0||J>0&&"selected"===F&&this.isSelected(T)?{color:T.s("wf.color"),width:J,"short":T.s("wf.short"),mat:T.s("wf.mat")}:void 0},_transformPointToViewSpace:function(m){var h=[m[0],m[1],m[2]];return Ij(h,this._viewMatrix),h},_transformDirectionToViewSpace:function(t,K){var y=[t[0],t[1],t[2]];Ij(y,this._viewMatrix);var k=K?[K[0],K[1],K[2]]:[0,0,0];Ij(k,this._viewMatrix);var c=k[0]-y[0],P=k[1]-y[1],S=k[2]-y[2],m=Math.sqrt(c*c+P*P+S*S);return m?[c/m,P/m,S/m]:[c,P,S]},getWireframeGeometry:function(Q){return Q.s("wf.geometry")?{color:Q.s("wf.color"),width:Q.s("wf.width"),mat:Q.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(C){return C.s("body.color")},getMat:function(P){return P.getMat?P.getMat():P.s("mat")},getFaceMat:function(G,i){return G.getFaceMat?G.getFaceMat(i):G.s(i+".mat")},getFaceBlend:function(w,R){return w.s(R+".blend")||w.s("all.blend")},getFaceColor:function(l,L){return l.s(L+".color")||l.s("all.color")},getFaceImage:function(X,x){return X.s(x+".image")||X.s("all.image")},getFaceBlendImage:function(f,F){return f.s(F+".blend.image")||f.s("all.blend.image")},getFaceDiscardSelectable:function(F,v){var p=F.s(v+".discard.selectable");return p==N?F.s("all.discard.selectable"):p},getFaceUv:function(T,V){return T.s(V+".uv")||T.s("all.uv")},getFaceUvOffset:function(j,g){return j.s(g+".uv.offset")||j.s("all.uv.offset")},getFaceUvScale:function(q,I){return q.s(I+".uv.scale")||q.s("all.uv.scale")},getFaceLight:function(r,b){var $=r.s(b+".light");return $==N?r.s("all.light"):$},getFaceVisible:function(j,i){var t=j.s(i+".visible");return t==N?j.s("all.visible"):t},getFaceOpacity:function(v,e){var L=v.s(e+".opacity");return L==N?v.s("all.opacity"):L},getFaceTransparent:function(h,w){var A=h.s(w+".transparent");return A==N?h.s("all.transparent"):A},getFaceReverseColor:function(V,y){return V.s(y+".reverse.color")||V.s("all.reverse.color")},getFaceReverseFlip:function(Y,B){var Q=Y.s(B+".reverse.flip");return Q==N?Y.s("all.reverse.flip"):Q},getFaceReverseCull:function(t,n){var G=t.s(n+".reverse.cull");return G==N?t.s("all.reverse.cull"):G},getTextureMap:function(){return this._2O},deleteTexture:function(i){var j=this,F=j._2O[i];F&&(delete j._2O[i],j.getGL().deleteTexture(F))},invalidateShape3dCachedImage:function(u){var K=this.getData3dUI(u);K.invalidateCachedTexture(this.getGL())},isInteractive:function(X){return X.s("interactive")},getTexture:function(W,I){if(!W)return N;var p=this,B=p.getGL(),V=p._2O[W];if(!V){var g=_c(W);if(!g)return B._emptyTexture;if(g.uuid||(g.uuid=z.Math.generateUUID()),g.tagName){if(g.dynamic)return he(B,g,p._1O);V=p._2O[W]=he(B,g)}else{var r,o=I&&I.s("shape3d.image.cache")&&!p.isInteractive(I),y=p.vr.isPresenting();if(y&&(I._textureUpdateFrame===B._renderInfo.frame?o=!0:I._textureUpdateFrame=B._renderInfo.frame),o&&(r=p.getData3dUI(I),V=r.getCachedTexture()),!V){if(o){if(B._renderInfo.cacheTimeCost>Q.graph3dMaxVectorCacheTime)return p.redraw(),B._emptyTexture;if(!vs(g,I))return B._emptyTexture}var e,O=I&&I.s("shape3d.fixSizeOnScreen"),S=O?B.NEAREST:B.LINEAR;O||I&&I.s("shape3d.vector.dynamic")&&(r||(r=p.getData3dUI(I)),O=r.getVectorDynamicSize(),O&&(e=p.getDevicePixelRatio(),O[0]*=e,O[1]*=e));var U,Z,J=I&&I.s("shape3d.texture.scale")||1;if(O?(e||(e=p.getDevicePixelRatio()),U=O[0]>0?O[0]:J*Uj(g,I)*e,Z=O[1]>0?O[1]:J*dg(g,I)*e):(U=J*Uj(g,I),Z=J*dg(g,I)),U>=1&&Z>=1){var m=0;o&&(m=Date.now());var T=Mn(U,Z);if(!r&&I&&(r=p.getData3dUI(I)),r&&r.interactiveInfo){var w=W;"object"==typeof w&&(w=w.uuid||(w.uuid=z.Math.generateUUID()));var q=r.interactiveInfo[w]={};T.interactiveInfo=q.bodyInfo={compInfos:[],matrix:new vh,rect:{x:0,y:0,width:U,height:Z}}}Kp(T,g,0,0,U,Z,I,p),T.interactiveInfo&&(T.interactiveInfo=null),T.restore(),o||y?(V=he(B,Vc,null,S),r.setCachedTexture(V),B._renderInfo.cacheTimeCost+=Date.now()-m,Vc=null):V=he(B,Vc,p._1O,S)}}}}return V},redraw:function(){this.iv()},validateImpl:function(){var W=this;if(W._lightChanged){W._lightChanged=!1;var E=[],m=[],$=[];W.dm().each(function(b){if(Ci(b)){var A=b.s("light.type");A===Mc?E.push(b):A===vf?m.push(b):A===nc&&$.push(b)}}),(E.length!==W._59O.length||m.length!==W._spots.length||$.length!==W._dirs.length)&&Qj(W),W._59O=E,W._spots=m,W._dirs=$}W._42(),W._1o.iv()},getRenderInfo:function(){var t=this.getGL();return t?t._renderInfo:void 0},getDebugTip:function(){var V=this,y=V.getRenderInfo();if(y){var z=V.getGL()._validBufCount||0,Q="Draw Calls: "+y.calls+"<br/>"+"Vertices: "+y.vertices+"<br/>"+"Faces: "+y.faces+"<br/>"+"Lines: "+y.lines+"<br/>"+"Buffer Count: "+z;return V.vr.isPresenting()&&(Q+="<br/>VR fps: "+V.vr.getFps()),Q}},_42:function(m,b){var A=this;if(!A._35O&&(!Mk||Yo(Mk))){var e,V;m&&(m instanceof Bj?V=m:e=m);var j=A._canvas,R=A.getGL(),i=A._prg;if(R){var P=A.getWidth(),U=A.getHeight();b?m||Rj(j,P,U,b):(b=A.getDevicePixelRatio(),m||P===j.clientWidth&&U===j.clientHeight||Rj(j,P,U,b)),R.clear(R.COLOR_BUFFER_BIT),A.drawFilter||(R._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:m?A._frameId:++A._frameId,cacheTimeCost:0});var C,u=this._cameras,o=0,c=u.length,Y=!1,K=z.Default.cameraPriority.skybox,Q=z.Default.cameraPriority.main,p=z.Default.cameraPriority.top,f=P*b,F=U*b,X=function(){A.overlappingBox.clear(),A._81O=N,R.clear(R.DEPTH_BUFFER_BIT),R._picking=!!m;var H={_picking:!!m,_envmapReflectivity:A._envmapReflectivity||.5,_projectMatrix:A._projectMatrix=fe(A),_viewMatrix:_b(A,A._7O)};if(A._viewMatrix=so(A._7O),V){De(R,A,i,H);var h=R.getParameter(R.COLOR_CLEAR_VALUE);R.clearColor(0,0,0,0),R.disable(R.BLEND),th(R,i.aNormal),Qr(R,A._cube.vs,N,i.aPosition),jl(R,A._cube.is),Eq(V,A,pc,0),Eq(V,A,fr,6),Eq(V,A,hl,12),Eq(V,A,ms,18),Eq(V,A,_m,24),Eq(V,A,Jr,30),Ip(R,i.aNormal),vo(R,h)}else if(e){for(e.value=2;c>o;o++)if(C=u[o],!C.ignoreInPick){if(C.priority>=Q)break;C.useDefaultProgram&&De(R,A,i,H),C.render(R,A,e)}De(R,A,i,H);var h=R.getParameter(R.COLOR_CLEAR_VALUE);for(R.clearColor(0,0,0,0),R.disable(R.BLEND),A._95I(R,i,e),lk(A,e),Ep(A,A._polylineModelMap,e),Ep(A,A._wireframeModelMap,e),Xd(R,i.uTransparent,!0),A._95I(R,i,e,!0),lk(A,e,!0),Ep(A,A._polylineModelMap,e,!0),Ep(A,A._wireframeModelMap,e,!0),Xd(R,i.uTransparent,!1);c>o;o++)if(C=u[o],!C.ignoreInPick){if(C.priority>=p)break;C.useDefaultProgram&&De(R,A,i,H),C.render(R,A,e),Y=!0}for(Y&&(De(R,A,i,H),Y=!1),R.clear(R.DEPTH_BUFFER_BIT),A._swapLineMap(),A._95I(R,i,e,!1,!0),Ep(A,A._polylineModelMap,e),Ep(A,A._wireframeModelMap,e),A._swapLineMap(),A._swapLineMap(),A._95I(R,i,e,!1,!0),Ep(A,A._polylineModelMap,e),Ep(A,A._wireframeModelMap,e),Xd(R,i.uTransparent,!0),A._95I(R,i,e,!0,!0),Ep(A,A._polylineModelMap,e,!0),Ep(A,A._wireframeModelMap,e,!0),Xd(R,i.uTransparent,!1),A._swapLineMap(),R.disable(R.DEPTH_TEST),A.drawFilter||A._30O._42(R,i,e),R.enable(R.DEPTH_TEST);c>o;o++)C=u[o],C.ignoreInPick||(C.useDefaultProgram&&De(R,A,i,H),C.render(R,A,e));vo(R,h)}else{for(;c>o&&(C=u[o],!(C.priority>=K));o++)C.useDefaultProgram&&De(R,A,i,H),C.render(R,A);for(De(R,A,i,H),R.disable(R.BLEND),A.drawSky(R,i),A.drawReflectors(R,f,F,X,m)&&(H._projectMatrix=A._projectMatrix=fe(A),H._viewMatrix=_b(A,A._7O),A._viewMatrix=so(A._7O),De(R,A,i,H));c>o&&(C=u[o],!(C.priority>=Q));o++)C.useDefaultProgram&&De(R,A,i,H),C.render(R,A),Y=!0;for(Y&&(De(R,A,i,H),Y=!1),A._31O._42(R,i),A._95I(R,i),lk(A),Ep(A,A._polylineModelMap),Ep(A,A._wireframeModelMap),R.enable(R.BLEND),R.depthMask(!1),Xd(R,i.uTransparent,!0),A._95I(R,i,N,!0),lk(A,N,!0),Ep(A,A._polylineModelMap,N,!0),Ep(A,A._wireframeModelMap,N,!0),R.depthMask(!0),Xd(R,i.uTransparent,!1);c>o&&(C=u[o],!(C.priority>=p));o++)C.useDefaultProgram&&De(R,A,i,H),C.render(R,A),Y=!0;for(Y&&(De(R,A,i,H),Y=!1),R.clear(R.DEPTH_BUFFER_BIT),A._swapLineMap(),R.disable(R.BLEND),A._95I(R,i,N,!1,!0),Ep(A,A._polylineModelMap),Ep(A,A._wireframeModelMap),R.enable(R.BLEND),Xd(R,i.uTransparent,!0),R.depthMask(!1),A._95I(R,i,N,!0,!0),Ep(A,A._polylineModelMap,N,!0),Ep(A,A._wireframeModelMap,N,!0),R.depthMask(!0),Xd(R,i.uTransparent,!1),A._swapLineMap(),R.disable(R.DEPTH_TEST),R.disable(R.BLEND),A._32O._42(R,i),A._30O._42(R,i),A._highlightHelper._42(R,i),R.enable(R.DEPTH_TEST);c>o;o++)C=u[o],C.useDefaultProgram&&De(R,A,i,H),C.render(R,A)}Qr(R,N),jl(R,N)},r=!1,h=A.vr;h.enable&&h._42(R,f,F,X)&&(r=!0);var y=A.envRenderer;y&&y.enable&&y._42(R,f,F,X)&&(r=!0);var H=A._postProcessing;H._42(R,f,F,X,m)&&(r=!0),r||(A.setViewport(R,0,0,P*b,U*b),X()),A._33Q=!1,A.drawFilter||A.countFrame(),A._doBufferGC(R)}}},drawReflectors:function(C,n,u,S,R){var h,K,o,s=this,D=s._dataModel.getReflectors(),l=!1;for(h in D)K=D[h],s.isVisible(K)&&(o=s.getData3dUI(K),o&&o.drawReflector(C,n,u,S,R)&&(l=!0));return l},enablePostProcessing:function(C,V){return this._postProcessing.enableModule(C,V)},getPostProcessingModule:function(t){return this._postProcessing.getModule(t)},setViewport:function(S,W,R,_,$){this._viewport=[W,R,_,$],S.viewport(W,R,_,$)},getViewport:function(){return this._viewport},setBufferGCInterval:function(L){this._bufferGCInterval=L},_doBufferGC:function(v,A){var S,C,e=v._bufPool,d=0,N=0,l=v._renderInfo.frame,b=this._bufferGCInterval||10;for(S in e)d++,C=e[S],C&&(A||l-C._fid>b?(v.deleteBuffer(C._buf),C._buf=null,e[S]=null):N++);if(d/2>N&&d>128){var p={};for(S in e)e[S]&&(p[S]=e[S]);v._bufPool=p}v._validBufCount=N},_swapLineMap:function(){var S=this;d=S._polylineModelMap,S._polylineModelMap=S._polylineModelMapSwap,S._polylineModelMapSwap=d,d=S._wireframeModelMap,S._wireframeModelMap=S._wireframeModelMapSwap,S._wireframeModelMapSwap=d,d=S._polylineIndexMap,S._polylineIndexMap=S._polylineIndexMapSwap,S._polylineIndexMapSwap=d,d=S._wireframeIndexMap,S._wireframeIndexMap=S._wireframeIndexMapSwap,S._wireframeIndexMapSwap=d},_updateSkyBox:function(M){if(this._skyBox&&M){var n=M.property,W=!1,g=this._skyBox;if("eye"===n||"forceUpdate"===n){var Q=this._eye;g.p3(Q[0],Q[1],Q[2]),W=!0}if("near"===n||"far"===n||"forceUpdate"===n){var t=this._near,H=this._far,h=g.getFinalScale3d();if(h[0]/=2,h[1]/=2,h[2]/=2,h[0]<=t||h[0]>=H||h[1]<=t||h[1]>=H||h[2]<=t||h[2]>=H){var I=2*t*H/(t+H),o=Math.min(h[0],h[1],h[2]),d=I/o,X=g.getScale3d();g.setScale3d(X[0]*d,X[1]*d,X[2]*d),W=!0}}W&&this.invalidateData(g)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(E){var t=this._skyBox;t&&(this._skyBoxStyleMap&&t.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&t.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&t.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=E,this.ump(this._updateSkyBox,this),E&&(E.dm()&&E.dm().remove(E),this._skyBoxStyleMap=z.Default.clone(E.getStyleMap()),this._skyBoxAnchor3d=E.getAnchor3d(),E.setAnchor3d(.5,.5,.5),this._skyBoxP3=E.p3().slice(0),E.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",t,E)},drawSky:function(h,Z,n){var b=this,S=b._skyBox;if(S){var o=b._headlightIntensity,d=Sd(b._headlightColor),Z=b._prg;1!==o&&(d=[d[0]*o,d[1]*o,d[2]*o]),Xd(h,Z.uHeadlightColor,[d[0],d[1],d[2],1]);var G=b.getData3dUI(S);if(G){var Y,l=b.isOrtho(),$=l||this._computedProjectMatrix;$&&(Y=b._projectMatrix,l&&b.setOrtho(!1),Xd(h,Z.uPMatrix,b._projectMatrix=fe(b,!0))),G._42(h,Z,n,function(){return!0}),$&&(l&&b.setOrtho(!0),Xd(h,Z.uPMatrix,b._projectMatrix=Y))}h.clear(h.DEPTH_BUFFER_BIT),Xd(h,Z.uHeadlightColor,[d[0],d[1],d[2],b._headlightDisabled?1:0])}},_95I:function(A,_,s,N,W){function F(j){if(!!j.s("shape3d.alwaysOnTop")==!!W&&g.isVisible(j)&&(!T||b)){if(!s&&g.isTransparentMask(j))return;var Z=g.getData3dUI(j);Z&&Z._42(A,_,s,h)}}var g=this,h=function(C){return N?C:!C};g.sky&&A.clear(A.DEPTH_BUFFER_BIT);var n=g.drawFilter;n?g.dm().each(function(s){n(s)||F(s)}):g.dm().each(function(u){F(u)})},getLogicalPoint:function(a){return fq(a,this._canvas)},isRectOverlapping:function(G){var F=this.getData3dUI(G);return F._rectOverlapping},getHitFaceInfo:function(z){z.target&&(z=this.lp(z));var j=this.getDataInfoAt(z);if(j){var w=this._1o.face(j.data,pl(z.x,z.y));if(w)return{data:j.data,face:w}}return N},unproject:function(y,o){var O=this,r=O.getWidth(),G=O.getHeight(),b=y.target?O.lp(y):y,h=b.x-r/2,H=b.y-G/2,W=2*(h/r),R=2*(-1*H/G);o=o||0;var x=vq(),D=fe(O),B=_b(O);Vk(x,D,B),Af(x);var j=Uf([W,R,o,1],x);return[j[0]/j[3],j[1]/j[3],j[2]/j[3]]},getDataAt:function(t){var k=this.getDataInfoAt(t);return k?k.data:N},getDataInfoAt:function(R,G){return R.target&&(R=this.lp(R)),this._1o.get(pl(R.x,R.y,G),!0)},getDatasInRect:function(d){return this._1o.get(d)},setEditable:function(V){var h=this,d=h._editable;h._editable=V,this.fp(yh,d,V)},isEditable:function(p){var E=this;return E._editable?wg(p)?p.s("3d.editable")?E._editableFunc?E._editableFunc(p):!0:!1:!1:!1},isSelectable:function(n){return n.s("3d.selectable")&&this.sm().isSelectable(n)},isMovable:function(i){var Y=this;return Wg(i)&&i.getStyle(Yl)!==zd?!1:i.s("3d.movable")?Y._movableFunc?Y._movableFunc(i):!0:!1},isSizeEditable:function(b){return wg(b)?this._sizeEditableFunc?this._sizeEditableFunc(b):!0:!1},isRotationEditable:function(g){return wg(g)&&g.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(g):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(h){this.setZoom(Qq,h)},zoomOut:function(G){this.setZoom(1/Qq,G)},setZoom:function(F,I){if(1!==F){var J=this;if(J._ortho)return J.setOrthoZoom(F,I),void 0;J._14o&&J._14o.stop(!0);var j=1/F,A=J._eye,q=J._center,r=q[0]+(A[0]-q[0])*j-A[0],b=q[1]+(A[1]-q[1])*j-A[1],Q=q[2]+(A[2]-q[2])*j-A[2];if(!(Df(A,q)<J._moveStep&&1>j)){if(I=Xg(I)){var h=kg(A);return I.action=function(T){J.fi({kind:J._zooming?"betweenZoom":"beginZoom"}),J._zooming=1,A[0]=h[0]+r*T,A[1]=h[1]+b*T,A[2]=h[2]+Q*T,J.fp(or,N,A)},I._37o=function(){delete J._14o,delete J._zooming,J.fi({kind:"endZoom"}),J.onZoomEnded()},J._14o=Op(I)}A[0]+=r,A[1]+=b,A[2]+=Q,J.fp(or,N,A)}}},setOrthoZoom:function(i,c){if(1!==i){var k=this;k._14o&&k._14o.stop(!0);var e=k._orthoWidth,T=e/i-e;if(!(e<k._moveStep&&i>1))return(c=Xg(c))?(c.action=function(p){k.fi({kind:k._zooming?"betweenZoom":"beginZoom"}),k._zooming=1,k.setOrthoWidth(e+T*p)},c._37o=function(){delete k._14o,delete k._zooming,k.fi({kind:"endZoom"}),k.onZoomEnded()},k._14o=Op(c)):(k.setOrthoWidth(e/i),void 0)}},getPositionInfo:function(s){var J=this,N=J._eye,T=J._center,Z=J.getAspect(),O=s?rq(xk(T,N,!0),xk(s,N)):Df(N,T);if(J._ortho){var y=J._orthoWidth;return{length:O,height:y/Z,width:y}}var B=2*o(J._fovy/2)*O;return{length:O,height:B,width:B*Z}},getCenterInfo:function(){var L=this;return L._81O||(L._81O=L.getPositionInfo()),kg(L._81O)},rotate:function(z,b,U,I){var p=this;if(z||b){I==N&&(I=p._firstPersonMode),p._88O&&p._88O.stop(!0);var P=p._center,d=p._eye,Y=p.getCenterInfo().length,h=I?P:d,c=I?d:P,g=xk(h,c),Z=_(g[0],g[2]),A=_(F(g[0]*g[0]+g[2]*g[2]),g[1]),e=I?No:or;return I&&(b=-b),(U=Xg(U))?(U.action=function(Q){p.fi({kind:p._rotating?"betweenRotate":"beginRotate"}),p._rotating=1;var V=Z+z*Q,I=A+b*Q;I=Nb(I),g[0]=Y*R(I)*R(V),g[1]=Y*H(I),g[2]=Y*R(I)*H(V),h[0]=c[0]+g[0],h[1]=c[1]+g[1],h[2]=c[2]+g[2],p.fp(e,N,h)},U._37o=function(){delete p._88O,delete p._rotating,p.fi({kind:"endRotate"}),p.onRotateEnded()},p._88O=Op(U)):(Z+=z,A+=b,A=Nb(A),g[0]=Y*R(A)*R(Z),g[1]=Y*H(A),g[2]=Y*R(A)*H(Z),h[0]=c[0]+g[0],h[1]=c[1]+g[1],h[2]=c[2]+g[2],p.fp(e,N,h),void 0)}},pan:function(E,y,L,x){if(E||y){var Z=this;x==N&&(x=Z._firstPersonMode),Z._89O&&Z._89O.stop(!0);var K=_b(Z),h=[K[0]*E,K[4]*E,K[8]*E],n=[K[1]*y,K[5]*y,K[9]*y],u=h[0]+n[0],B=h[1]+n[1],R=h[2]+n[2],v=Z._center,j=Z._eye;if(x){var i=qn(Z.getBoundaries(),j[0],j[2],j[0]+u,j[2]+R,F(u*u+R*R));u=i[0],R=i[1]}if(L=Xg(L)){var r=kg(j),S=kg(v);return L.action=function(n){Z.fi({kind:Z._panning?"betweenPan":"beginPan"}),Z._panning=1,v[0]=S[0]+u*n,v[1]=S[1]+B*n,v[2]=S[2]+R*n,j[0]=r[0]+u*n,j[1]=r[1]+B*n,j[2]=r[2]+R*n,Z.fp(or,N,j),Z.fp(No,N,v)},L._37o=function(){delete Z._89O,delete Z._panning,Z.fi({kind:"endPan"}),Z.onPanEnded()},Z._89O=Op(L)}v[0]+=u,v[1]+=B,v[2]+=R,j[0]+=u,j[1]+=B,j[2]+=R,Z.fp(or,N,j),Z.fp(No,N,v)}},walk:function(x,g,M){if(x){var S=this;M==N&&(M=S._firstPersonMode),S._90O&&S._90O.stop(!0);var d=S._center,Q=S._eye,p=xk(d,Q,!0);if(M){var l=qn(S.getBoundaries(),Q[0],Q[2],Q[0]+p[0]*x,Q[2]+p[2]*x,c(x));if(x=Df(l),!x)return;p=[l[0]/x,0,l[1]/x]}if(g=Xg(g)){var h=kg(Q),B=kg(d);return g.action=function(v){S.fi({kind:S._walking?"betweenWalk":"beginWalk"}),S._walking=1;var O=x*v;Q[0]=h[0]+p[0]*O,Q[1]=h[1]+p[1]*O,Q[2]=h[2]+p[2]*O,d[0]=B[0]+p[0]*O,d[1]=B[1]+p[1]*O,d[2]=B[2]+p[2]*O,S.fp(or,N,Q),S.fp(No,N,d)},g._37o=function(){delete S._90O,delete S._walking,S.fi({kind:"endWalk"}),S.onWalkEnded()},S._90O=Op(g)}Q[0]+=p[0]*x,Q[1]+=p[1]*x,Q[2]+=p[2]*x,d[0]+=p[0]*x,d[1]+=p[1]*x,d[2]+=p[2]*x,S.fp(or,N,Q),S.fp(No,N,d)}},handleScroll:function(B,C){B.preventDefault();var Z=this,W=Z._moveStep,I=Z.getDataInfoAt(B);if(I){var J=I.data;if(J&&Z.isInteractive(J)){var c=Z.intersectObject(B,J);if(c){var P=c.part,O=_c(J.s(P+".image")||J.s("shape3d."+P+".image")||J.s("all.image")||J.s("shape3d.image"));if(O&&Cd(O.scrollable,J,Z))return}}}Z.isFirstPersonMode()?Z.isPannable()&&Z.pan(0,C>0?W:-W):Z.isZoomable()&&Z.setZoom(0>C?1/rf:rf)},handlePinch:function(u,z){this.isZoomable()&&this.setZoom(z>u?1/Pf:Pf)},reset:function(){this.setCenter(Q.graph3dViewCenter),this.setEye(Q.graph3dViewEye),this.setUp(Q.graph3dViewUp)},moveSelection:function(U,K,E){var m=this;m.dm().beginTransaction(),Ld(this.sm().toSelection(this.isMovable,this),U,K,E),m.dm().endTransaction()},getMoveMode:function(F,B){var H=B.s("3d.move.mode");if(H)return H;var O="88",l="89",U="90";return un(F)||Sh[O]&&Sh[l]&&Sh[U]?"xyz":Sh[O]&&Sh[l]?"xy":Sh[O]&&Sh[U]?"xz":Sh[l]&&Sh[U]?"yz":Sh[O]?"x":Sh[l]?"y":Sh[U]?"z":"xz"},handleTick:function(){var D=this,r=!1,K=D._moveStep,Z=K,j=!1,T=!0,G=D._rotateStep*(T?-1:1);if(D.isWalkable()||(Z=0),D.isPannable()||(K=0),D.isRotatable()||(G=0),D._32Q){var M=(gs()-D._32Q)/50;Z*=M,K*=M,G*=M}D._31Q&&(ss(D._31Q),delete D._31Q,delete D._32Q),Lk()&&(r=!0,D.pan(-K,0,j,T)),co()&&(r=!0,D.pan(K,0,j,T)),lm()&&(r=!0,un()?D.pan(0,K,j,T):D.walk(Z,j,T)),$p()&&(r=!0,un()?D.pan(0,-K,j,T):D.walk(-Z,j,T)),id()&&(r=!0,D.rotate(-G,0,j,T)),$q()&&(r=!0,D.rotate(G,0,j,T)),Mg()&&(r=!0,D.rotate(0,-G/2,j,T)),Yk()&&(r=!0,D.rotate(0,G/2,j,T)),r&&(D._32Q=gs(),D._31Q=no(D.handleTick,D))},handleKeyDown:function(h){var i=this;!Vi(h)&&sg[h.keyCode]?i.handleTick():In(h)?i.selectAll():te(h)?i.handleDelete(h):$n(h)&&this.isResettable()&&i.reset()},checkDoubleClickOnNote:function(V,M,b){var w=this;if(b===wb){if(M.s("note.toggleable"))return M.s(Ac,!M.s(Ac)),w.fi({kind:"toggleNote",event:V,data:M,part:b}),!0}else if(b===Fb&&M.s("note2.toggleable"))return M.s(zn,!M.s(zn)),w.fi({kind:"toggleNote2",event:V,data:M,part:b}),!0;return!1},checkDoubleClickOnRotation:function(G,I,l){return l===ml?(I.setRotationX(0),!0):l===hn?(I.setRotationY(0),!0):l===Rr?(I.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(c){var w=this;if(w.isOrtho())return w.getWidth()/w.getOrthoWidth();var p=w.getCenter(),K=w.getHeight(),g=w.getEye(),_=[p[0]-g[0],p[1]-g[1],p[2]-g[2]],$=[c[0]-g[0],c[1]-g[1],c[2]-g[2]],L=Math.sqrt(_[0]*_[0]+_[1]*_[1]+_[2]*_[2]),v=1/Math.tan(w.getFovy()/2);return K*L*v/($[0]*_[0]+$[1]*_[1]+$[2]*_[2])},inViewSpace:function(I){var A,B=this,x=B._transformPointToViewSpace(I),V=B.getAspect(),g=B.getNear(),Z=B.getFar();return-x[2]<g||-x[2]>Z?!1:B.isOrtho()?(A=B.getOrthoWidth()/2,Math.abs(x[0])<=A&&Math.abs(x[1]*V)<=A):(A=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2])*Math.tan(B.getFovy()/2),Math.abs(x[1]<=A)&&Math.abs(x[0])<=A*V)
},getPVMatrix:function(){var y=this,I=y.getWidth()/2,K=y.getHeight()/2,X=y._18Q;return X&&X._wh===I/K||(X=fe(y),y._18Q=Vk(X,X,_b(y)),y._18Q._wh=I/K),X},toViewPosition:function($){var p=this,s=p.getWidth()/2,H=p.getHeight()/2,r=p.getPVMatrix();return $=Uf([$[0],$[1],$[2],1],r),{x:s+s*$[0]/$[3],y:H-H*$[1]/$[3],z:$[2]/$[3]}},getHitPosition:function(x,e,U){var P=this,z=P.getWidth(),X=P.getHeight(),j=x.target?P.lp(x):x,m=j.x-z/2,L=j.y-X/2,b=P.getCenterInfo(),W=_b(P);e=e?e:[0,0,0],U=U?U:[0,1,0],m=m/z*b.width,L=-1*L/X*b.height;var d=[W[0]*m,W[4]*m,W[8]*m],i=[W[1]*L,W[5]*L,W[9]*L],B=[d[0]+i[0],d[1]+i[1],d[2]+i[2]],p=P.getCenter(),g=fc(P,e,U,[B[0]+p[0],B[1]+p[1],B[2]+p[2]]);return g?g:[0,0,0]},intersectObject:function(j,a){return this._raycaster.intersectObject(j,a)},intersectObjects:function(T,v,W){return this._raycaster.intersectObjects(T,v,W)},getLineLength:function(h){this.validate();var b=this.getData3dUI(h);if(b&&b.getCache){var d=b.getCache();if(d)return d[d.length-1].length}return 0},getLineOffset:function(f,Y){var q=this.getData3dUI(f);if(q&&q.getCache){var d=q.getCache();if(d){var C=ac(d,Y),G=f.r3();if(0===G[0]&&0===G[1]&&0===G[2])return C;var W=new yj(f.p3()),B=new yj(C.point).sub(W),e=new yj(C.tangent).add(B),l=(new Hb).setFromEuler(new ds(G,f.getRotationMode(),!0));return B.applyQuaternion(l),e.applyQuaternion(l),{point:B.add(W),tangent:e.sub(B).normalize()}}}return N},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(I,t,Q){var n=this,X=n.getEye();X=[X[0],X[1],X[2]];var M=n.getCenter();if(M=[M[0],M[1],M[2]],I||(I=X),t||(t=M),n._flyAnim&&n._flyAnim.stop(!0),Q=Xg(Q),!Q)return n.setEye(I[0],I[1],I[2]),n.setCenter(t[0],t[1],t[2]),delete n._flyAnim,!0;var b=[I[0]-X[0],I[1]-X[1],I[2]-X[2]],l=[t[0]-M[0],t[1]-M[1],t[2]-M[2]];return Q.action=function(z){n.setCenter(M[0]+l[0]*z,M[1]+l[1]*z,M[2]+l[2]*z),n.setEye(X[0]+b[0]*z,X[1]+b[1]*z,X[2]+b[2]*z)},Q._37o=function(){delete n._flyAnim},n._flyAnim=Op(Q)},flyTo:function(){function C(D,_,G){if(G instanceof z.Node){M.fromArray(ub(G,_.getMat(G)));var r=G.getAnchor3d();D.push((new yj).set(0-r.x,0-r.y,0-r.z).applyMatrix4(M)),D.push((new yj).set(0-r.x,0-r.y,1-r.z).applyMatrix4(M)),D.push((new yj).set(0-r.x,1-r.y,0-r.z).applyMatrix4(M)),D.push((new yj).set(0-r.x,1-r.y,1-r.z).applyMatrix4(M)),D.push((new yj).set(1-r.x,0-r.y,0-r.z).applyMatrix4(M)),D.push((new yj).set(1-r.x,0-r.y,1-r.z).applyMatrix4(M)),D.push((new yj).set(1-r.x,1-r.y,0-r.z).applyMatrix4(M)),D.push((new yj).set(1-r.x,1-r.y,1-r.z).applyMatrix4(M))}}var n=new yj,i=new yj,o=new yj,K=new yj,M=new re,J=new z.Math.Quaternion,g=new ds;return function(E,u,B){var F=this;if(B!==s)u={animation:u,ratio:B};else{var X=typeof u;("boolean"===X||"object"===X&&u.duration)&&(u={animation:u})}u=u||{},n.fromArray(F.getEye()),i.fromArray(F.getCenter());var Y,M,A=[],H=u.center,m=u.distance===s;if(H&&o.fromArray(H),E instanceof z.Node)H||o.fromArray(E.p3()),m&&(C(A,F,E),Y=A.length);else{if(E||(E=F.dm().getDatas()),!E.length)return;if((m||!H)&&(A=[],E.forEach(function(K){C(A,F,K)}),Y=A.length),!Y)return;if(!H){for(o.set(0,0,0),M=0;Y>M;M++)o.add(A[M]);o.multiplyScalar(1/Y)}}if(F.setCenter(o.x,o.y,o.z),K.subVectors(n,i),u.direction||u.worldDirection){!u.worldDirection&&E instanceof z.Node?J.setFromEuler(g.set(E.r3(),E.getRotationMode(),!0)):J.set(0,0,0,1);var w=K.length();K.fromArray(u.worldDirection||u.direction).applyQuaternion(J).setLength(w)}if(m){for(var r,W,Q,q,V,b=F.getNear(),p=10,B=u.ratio||.8;p--;){for(F._eye[0]=K.x+o.x,F._eye[1]=K.y+o.y,F._eye[2]=K.z+o.z,r=fe(F),Vk(r,r,_b(F)),q=!0,V=-1/0,M=0;Y>M;M++){if(Q=A[M],W=Uf([Q.x,Q.y,Q.z,1],r),W[3]<b&&p){K.multiplyScalar(2),q=!1;break}V=Math.max(V,Math.max(Math.abs(W[0]),Math.abs(W[1]))/B-W[3])}if(q)break}K.setLength(V+K.length()).add(o)}else K.setLength(u.distance).add(o);F._flyAnim&&F._flyAnim.stop(!0);var x=Xg(u.animation);if(x){F.setEye(n.x,n.y,n.z),F.setCenter(i.x,i.y,i.z);var S=(new yj).subVectors(K,n),t=(new yj).subVectors(o,i),N=new yj,k=new yj;return x.action=function(l){N.copy(n).addScaledVector(S,l),k.copy(i).addScaledVector(t,l),F.setCenter(k.x,k.y,k.z),F.setEye(N.x,N.y,N.z)},x._37o=function(){delete F._flyAnim},{lastEye:n,lastCenter:i,eye:K,center:o,animation:F._flyAnim=Op(x)}}return F.setEye(K.x,K.y,K.z),delete F._flyAnim,{lastEye:n,lastCenter:i,eye:K,center:o}}}(),getBoundingBox:function(){function u(j,P,n){J.fromArray(ub(n,P.getMat(n)));var V=n.getAnchor3d();j.push((new yj).set(0-V.x,0-V.y,0-V.z).applyMatrix4(J)),j.push((new yj).set(0-V.x,0-V.y,1-V.z).applyMatrix4(J)),j.push((new yj).set(0-V.x,1-V.y,0-V.z).applyMatrix4(J)),j.push((new yj).set(0-V.x,1-V.y,1-V.z).applyMatrix4(J)),j.push((new yj).set(1-V.x,0-V.y,0-V.z).applyMatrix4(J)),j.push((new yj).set(1-V.x,0-V.y,1-V.z).applyMatrix4(J)),j.push((new yj).set(1-V.x,1-V.y,0-V.z).applyMatrix4(J)),j.push((new yj).set(1-V.x,1-V.y,1-V.z).applyMatrix4(J))}var J=new re;return function($){if($=$||this.sm().getSelection(),$ instanceof z.Node&&($=[$]),0===$.length)return N;var p=[];$.forEach(function(w){u(p,this,w)},this);var S=[1/0,1/0,1/0],j=[-1/0,-1/0,-1/0];return p.forEach(function(P){S[0]=Math.min(P.x,S[0]),S[1]=Math.min(P.y,S[1]),S[2]=Math.min(P.z,S[2]),j[0]=Math.max(P.x,j[0]),j[1]=Math.max(P.y,j[1]),j[2]=Math.max(P.z,j[2])}),{min:S,max:j}}}()}),Vn.RenderEnv=function(B){this.gv=B,this.enable=!1},W.defineProperties(Vn.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(i){this._debugOn=i,this.capture&&this.capture()}}}),W.assign(Vn.RenderEnv.prototype,{renderEnvToCube:function(m,y,L,O){var B=this,c=B.gv;if(!m||!y||!L)return B.enable=!1,B._42=null,void 0;B.enable=!0;var f=Math.floor(O/m*y),C=c.getGL(),E=B._renderTargets;E?E.length<L&&(E=B._renderTargets=E.concat(new Array(L-E.length))):E=B._renderTargets=new Array(L);for(var P=0;L>P;P++)E[P]?E[P].setSize(C,O,f):E[P]=new Vn.RenderTarget(c,C,O,f);var T=!1;B.capture=function(){T=!0,c._42(),T=!1};var l=new yj,v=new yj,G=new yj,Q=new yj,Y=(new yj).setY(0),X=2*Math.PI/L,w=m/2/Math.tan(Math.PI/L),r=2*Math.atan2(y/2,w),D=m/y;B._42=function(p,f,x,u){var P=B._debugOn;if(!T&&!P)return!1;l.copy(c.getEye()),Q.copy(c.getCenter()).sub(l);var i=Math.atan2(Q.z,Q.x),h=c.getNear(),m=c.getFovy(),_=c.getAspect();v.copy(c.getCenter());for(var d,S=0;L>S;S++)if(d=E[S],Y.setZ(Math.cos(i)).setX(Math.sin(i)).multiplyScalar(w),i-=X,G.addVectors(l,Y),c.setNear(w),c.setCenter([G.x,G.y,G.z]),c.setFovy(r),c.setAspect(D),P){var O=Math.round(f/L);p.viewport(O*S,0,O,x),u()}else Zf(p,d.frame),p.viewport(0,0,d.width,d.height),p.clear(p.COLOR_BUFFER_BIT),u(),Zr(p),d.assureTexture();return c.setNear(h),c.setCenter([v.x,v.y,v.z]),c.setFovy(m),c.setAspect(_),!0},B.capture()},getTextureInfo:function(m){var A=this._renderTargets;if(!A)return null;var x=this._renderTargets[m];return x?{index:m,texture:x.texture,textureName:x.uuid}:null}}),W.assign(Vn.Graph3dView.prototype,{renderEnvToCube:function(F,x,k,g){var W=this;W.envRenderer||(W.envRenderer=new Vn.RenderEnv(W)),W.envRenderer.renderEnvToCube(F,x,k,g)}}),Vn.RenderTarget=function(D,T,G,l,w){var b=this;w=w||{},w.samples=w.samples&&w.samples>1&&2===D._webGLVersion?w.samples:s,b.options=w,b.uuid=z.Math.generateUUID(),b.gv=D,b.init(D,T,w),b.setSize(T,G,l)},W.assign(Vn.RenderTarget.prototype,{bind:function(P){Zf(P,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(B){Zr(B),this.options.samples&&(B.bindFramebuffer(B.READ_FRAMEBUFFER,this._MSAAFbo),B.bindFramebuffer(B.DRAW_FRAMEBUFFER,this.frame),B.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,B.COLOR_BUFFER_BIT,B.NEAREST))},init:function(W,r,Y){var x=this,j=x.texture=r.createTexture();r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,j),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);var V=Y.samples,q=V?r.NEAREST:r.LINEAR;r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,Y.minFilter||q),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,Y.magFilter||q),r.bindTexture(r.TEXTURE_2D,null),x.render=r.createRenderbuffer(),x.frame=r.createFramebuffer(),V&&(x._MSAAFbo=r.createFramebuffer(),x._MSAARbO=r.createRenderbuffer()),W._2O[x.uuid]=j},assureTexture:function(){var N=this,j=N.uuid,J=N.gv._2O;J[j]||(J[j]=N.texture)},setSize:function(P,u,Z){var t=this;if(u&&Z&&(t.width!==u||t.height!==Z)){var C=P.RGBA,q=P.TEXTURE_2D,F=P.RENDERBUFFER,I=P.FRAMEBUFFER,_=t.options.samples;nq(P,t.texture),P.texImage2D(q,0,C,u,Z,0,C,P.UNSIGNED_BYTE,N),P.bindRenderbuffer(F,t.render),_?P.renderbufferStorageMultisample(F,_,P.DEPTH_COMPONENT16,u,Z):P.renderbufferStorage(F,P.DEPTH_COMPONENT16,u,Z),Zf(P,t.frame),P.framebufferTexture2D(I,P.COLOR_ATTACHMENT0,q,t.texture,0),_||P.framebufferRenderbuffer(I,P.DEPTH_ATTACHMENT,F,t.render),Zr(P),_&&(P.bindRenderbuffer(P.RENDERBUFFER,t._MSAARbO),P.renderbufferStorageMultisample(P.RENDERBUFFER,_,P.RGBA8,u,Z),Zf(P,t._MSAAFbo),P.framebufferRenderbuffer(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.RENDERBUFFER,t._MSAARbO),P.framebufferRenderbuffer(I,P.DEPTH_ATTACHMENT,F,t.render),Zr(P)),nq(P,N),P.bindRenderbuffer(F,N),t.width=u,t.height=Z}},toCanvas:function(){var g=this,o=g.gv.getGL();Zf(o,g.frame);var x=g.width,h=g.height,Z=new Uint8Array(4*x*h);o.readPixels(0,0,x,h,o.RGBA,o.UNSIGNED_BYTE,Z),Zr(o);var w=t.createElement("canvas");w.width=x,w.height=h;var a=w.getContext("2d"),j=a.createImageData(x,h);return j.data.set(Z),a.putImageData(j,0,0),w}});var ph=Vn.Interactor=function(k){this.gv=k};Mj("Interactor",W,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var ug=Vn.DefaultInteractor=function(K){oj(ug,this,[K])};Mj("DefaultInteractor",ph,{handle_contextmenu:function(O){dc(O)},handle_mousewheel:function(F){this.gv.handleScroll(F,F.wheelDelta/40)},handle_DOMMouseScroll:function(h){2===h.axis&&this.gv.handleScroll(h,-h.detail)},handle_keydown:function(T){this.gv.handleKeyDown(T)},handle_mousedown:function(C){this.handle_touchstart(C)},handle_touchstart:function(x){dc(x);var T=this,w=T.gv,R=Gf(x),p=w.getDataInfoAt(x),D=p?p.data:N,t=p?p.part:N,f=w.sm(),I=dm(x),U=qh(x);w.setFocus(x)&&(T._62O=N,T._57I=N,D?Vi(x)?f.co(D)?f.rs(D):f.as(D):f.co(D)||f.ss(D):R&&(Vi(x)?w.isRectSelectable()&&(T._62O=go):T._57I=Bb(x)),T._31Q&&(ss(T._31Q),delete T._31Q,delete T._32Q),T._62O||(w.isFirstPersonMode()&&(un(x)||To(x)||U>2?T._62O="pan":w.isMouseRoamable()||Ab?(T._62O="roaming",T.foward=I&&Gf(x),T._32Q=gs(),T._31Q=no(T.tick,T)):R||(T._62O="roaming")),T._62O||(R&&I&&_j[t]?(T._62O=t,T.p3=D.p3()):R&&I&&wg(D)&&w.isSelected(D)?w.isMovable(D)?(T._62O="move",T.p3=D.p3(),T.movedata=D):w.isInteractive(D)&&(T._62O="none"):Ab&&(U>2?T._62O="pan":2===U&&(T.dist=Pk(x),T._62O="pinch")))),T.point=w.lp(x),pp(T,x),Zh(x)?w.handleDoubleClick(x,D,t):w.handleClick(x,D,t))},tick:function(){var M=this,x=M.gv,k=x._moveStep;M.point&&x.isWalkable()&&(M._32Q&&(k*=(gs()-M._32Q)/50),x.walk(M.foward?k:-k),M._32Q=gs(),M._31Q=no(M.tick,M))},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(V){var u=this._57I;u&&(Df(u,Bb(V))<=1&&this.gv.sm().cs(),this._57I=N)},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(t){var y,M,Z=this,E=Z.gv,O=Z._62O,e=Z.point,W=E.dm(),V=E.lp(t),T=V.x-e.x,n=V.y-e.y,N=E.getWidth(),R=E.getHeight();if(N&&R){var f=-m*T/N,b=-m*n/R;if("roaming"===O)Z.rotate(t,f/2,b/2);else if(O===ml||O===hn||O===Rr)E._86O||W.beginTransaction(),E.fi({kind:E._86O?"betweenEditRotation":"beginEditRotation",event:t}),E._86O=1,E.sm().each(function(V){if(wg(V)&&E.isRotationEditable(V)){var Z=c(f)>c(b)?f:b;O===ml?V.setRotationX(V.getRotationX()+Z):O===hn?V.setRotationY(V.getRotationY()+Z):O===Rr&&V.setRotationZ(V.getRotationZ()+Z)}});else if("move"===O||_j[O]){O===ls||O===si||O===Fh?(E._87O||W.beginTransaction(),E.fi({kind:E._87O?"betweenEditScale":"beginEditScale",event:t}),E._87O=1):(E._moving||W.beginTransaction(),E.fi({kind:E._moving?"betweenMove":"beginMove",event:t}),E._moving=1);var q,r=Z.p3,a=E.getPositionInfo(r),p=_b(E);q=O===$e?"x":O===jj?"y":O===lp?"z":O===ls?"sx":O===si?"sy":O===Fh?"sz":E.getMoveMode(t,Z.movedata),T=T/N*a.width,n=-1*n/R*a.height;var B,P,C=[p[0]*T,p[4]*T,p[8]*T],u=[p[1]*n,p[5]*n,p[9]*n],L=C[0]+u[0],v=C[1]+u[1],A=C[2]+u[2],g=[r[0]+L,r[1]+v,r[2]+A],Q=xk(E.getEye(),g,!0);if("xyz"===q?(B=g,E.moveSelection(L,v,A)):"xz"===q?(B=fc(E,r,[0,1,0],g),B&&E.moveSelection(B[0]-r[0],0,B[2]-r[2])):"xy"===q?(B=fc(E,r,[0,0,1],g),B&&E.moveSelection(B[0]-r[0],B[1]-r[1],0)):"yz"===q?(B=fc(E,r,[1,0,0],g),B&&E.moveSelection(0,B[1]-r[1],B[2]-r[2])):"x"===q||"sx"===q?(Q[0]=0,B=fc(E,r,Q,g),B&&(P=B[0]-r[0],"x"===q?E.moveSelection(P,0,0):E.sm().each(function(A){wg(A)&&E.isSizeEditable(A)&&(y=A.getScaleX()+P/100,M=y/A.getScaleX(),A.setScaleX(y),un(t)&&(A.setScaleY(A.getScaleY()*M),A.setScaleTall(A.getScaleTall()*M)))}))):"y"===q||"sy"===q?(Q[1]=0,B=fc(E,r,Q,g),B&&(P=B[1]-r[1],"y"===q?E.moveSelection(0,P,0):E.sm().each(function(f){wg(f)&&E.isSizeEditable(f)&&(y=f.getScaleTall()+P/100,M=y/f.getScaleTall(),f.setScaleTall(y),un(t)&&(f.setScaleY(f.getScaleY()*M),f.setScaleX(f.getScaleX()*M)))}))):("z"===q||"sz"===q)&&(Q[2]=0,B=fc(E,r,Q,g),B&&(P=B[2]-r[2],"z"===q?E.moveSelection(0,0,P):E.sm().each(function(q){wg(q)&&E.isSizeEditable(q)&&(y=q.getScaleY()+P/100,M=y/q.getScaleY(),q.setScaleY(y),un(t)&&(q.setScaleX(q.getScaleX()*M),q.setScaleTall(q.getScaleTall()*M)))}))),!B)return;Z.p3=B}else if(O===go){var o=Z.div;o||(o=Z.div=ko(),Mo(Z.getView(),o),o.op=e,o.style.background=E.getRectSelectBackground()),E.fi({kind:E._rectSelecting?"betweenRectSelect":"beginRectSelect",event:t}),E._rectSelecting=1,o.rect=Mp(o.op,V),Zd(o,o.rect)}else if("pinch"===O&&2===qh(t)){E.fi({kind:E._pinching?"betweenPinch":"beginPinch",event:t}),E._pinching=1;var P=Pk(t);E.handlePinch(P,Z.dist),Z.dist=P}else"pan"===O||un(t)||To(t)?Z.pan(t,T,n):"none"===O||E.isFirstPersonMode()||(Gf(t)?Z.rotate(t,f,b):(Z.pan(t,T,0),E.isWalkable()&&(E.fi({kind:E._walking?"betweenWalk":"beginWalk",event:t}),E._walking=1,E.walk(n/E.getHeight()*E.getCenterInfo().height))));Z.point=V}},pan:function(_,y,R){var x=this.gv;if(x.isPannable()){var l=x.getWidth(),n=x.getHeight();if(!l||!n)return;var C=x.getCenterInfo(),w=y/l*C.width,U=-1*R/n*C.height;x.fi({kind:x._panning?"betweenPan":"beginPan",event:_}),x._panning=1,x.pan(-w,-U)}},rotate:function(s,y,i){var C=this.gv;C.isRotatable()&&(C.fi({kind:C._rotating?"betweenRotate":"beginRotate",event:s}),C._rotating=1,C.rotate(y,i))},handleWindowMouseUp:function(n){this.handleWindowTouchEnd(n)},handleWindowTouchEnd:function(u){var p=this,T=p.gv,P=T.dm(),L=p.div;if(L){var C=T.getDatasInRect(L.rect);if(!C.isEmpty()){var e=T.sm(),Z=e.toSelection();C.each(function(C){e.co(C)?Z.remove(C):Z.add(C)}),e.ss(Z)}Xr(L)}T._moving&&(delete T._moving,T.fi({kind:"endMove",event:u}),T.onMoveEnded(),P.endTransaction()),T._panning&&(delete T._panning,T.fi({kind:"endPan",event:u}),T.onPanEnded()),T._rotating&&(delete T._rotating,T.fi({kind:"endRotate",event:u}),T.onRotateEnded()),T._86O&&(delete T._86O,T.fi({kind:"endEditRotation",event:u}),P.endTransaction()),T._87O&&(delete T._87O,T.fi({kind:"endEditScale",event:u}),P.endTransaction()),T._pinching&&(delete T._pinching,T.fi({kind:"endPinch",event:u}),T.onPinchEnded()),T._rectSelecting&&(delete T._rectSelecting,T.fi({kind:"endRectSelect",event:u}),T.onRectSelectEnded()),T._walking&&(delete T._walking,T.fi({kind:"endWalk",event:u}),T.onWalkEnded()),p.dist=p.point=p._62O=p.p3=p.movedata=p.div=p._57I=p._32Q=p._31Q=p.foward=N}});var Ge=Vn.MapInteractor=function(v){oj(Ge,this,[v]),this._minPhi=0,this._maxPhi=5*f/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};Mj("MapInteractor",ph,{handle_contextmenu:function(Z){dc(Z)},handle_mousewheel:function(v){this.gv.handleScroll(v,v.wheelDelta/40)},handle_DOMMouseScroll:function(V){2===V.axis&&this.gv.handleScroll(V,-V.detail)},handle_keydown:function(m){this.gv.handleKeyDown(m)},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(S){dc(S);var C=this,q=C.gv;if(q.setFocus(S)){q.lp(S);var p=q.getDataInfoAt(S),Y=p?p.data:N,o=p?p.part:N;if(!Y||!q.isInteractive(Y)){var w=C.editing={point:q.lp(S)};Ab?w.touch=!0:(w.touch=!1,w.clickLeft=Gf(S),w.pan=To(S)?!0:"left"===this.panButton===w.clickLeft),pp(C,S)}Zh(S)?q.handleDoubleClick(S,Y,o):q.handleClick(S,Y,o)}},handle_mouseup:function(R){this.handle_touchend(R)},handle_touchend:function(){},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(j){var t=this,q=t.gv,l=t.editing;if(l){var s=q.lp(j),y=l.point,K=s.x-y.x,$=s.y-y.y;if(!l.moved){if(Math.abs(K)<t.threshold&&Math.abs($)<t.threshold&&!(j.touches&&j.touches.length>1))return;l.moved=!0}if(l.point=s,l.touch){var P=j.touches.length;if(2!==P)t.pan(j,K,$);else{if(1>=P)return;var i=j.touches,L={x:i[0].clientX,y:i[0].clientY},W={x:i[1].clientX,y:i[1].clientY},z={x:W.x-L.x,y:W.y-L.y},T=l.lastCenter,o=Math.atan2(z.y,z.x),c=l.theta,k=0;c==N?c=l.theta=o:(k=o-c,l.thetaStarted||Math.abs(k)>t.touchRotateThreshold?(l.thetaStarted=!0,l.theta=o):k=0);var V=f*(L.y+W.y)/2/q.getHeight(),Z=l.phi,u=0;Z==N?Z=l.phi=V:(u=V-Z,l.phiStarted||Math.abs(u)>t.touchRotateThreshold?(l.phiStarted=!0,l.phi=V):u=0);var E,w=Math.sqrt(z.x*z.x+z.y*z.y),n=l.vlen;if(n){var D=L.x-T.x,g=L.y-T.y,G=W.x-T.x,x=W.y-T.y,p=Math.sqrt(D*D+g*g),h=Math.sqrt(G*G+x*x),R=n/2,v=t._sign2(p-R),d=t._sign2(h-R);0>v*d||0===v&&0===d?(E=1,l.vlen=w):(E||(E=w/n),l.scaleStarted||Math.abs(E-1)>t.touchScaleThreshold?(l.vlen=w,l.scaleStarted=!0):E=1)}else n=l.vlen=w,E=1;1!==E&&q.setZoom(E),(u||k)&&t.rotate(j,k,-u),l.lastCenter={x:(W.x+L.x)/2,y:(W.y+L.y)/2}}}else if(l.pan)t.pan(j,K,$);else{var e=q.getWidth(),B=q.getHeight();if(!e||!B)return;var M=-m*K/e,r=-m*$/B;t.rotate(j,M,r)}}},_sign2:function(Z){return Math.abs(Z)<this._touchScaleCheckAccuracy?0:Z>0?1:-1},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(L){var H=this,x=H.editing;if(H.editing=null,x){var u=H.gv;if(!x.moved&&x.clickLeft){var P=u.getDataAt(L);P?u.sm().setSelection([P]):u.sm().clearSelection()}else u._panning=null,u._rotating=null,u.fi({kind:x.pan?"endPan":"endRotate",event:L})}},pan:function(h,P,t){var f=this,T=f.gv;if(T.isPannable()){var m=T.getWidth(),_=T.getHeight();if(m&&_){var p=T.getCenterInfo(),i=-P/m*p.width,x=1*t/_*p.height;T.fi({kind:T._panning?"betweenPan":"beginPan",event:h}),T._panning=1;var j=f.keepHorizon,v=f.editing.touch;if((v&&h.touches&&h.touches.length>1||!v&&un(h))&&(j=!j),!j)return T.pan(i,x);if(i||x){var V=_b(T),C=[V[0]*i,V[4]*i,V[8]*i],z=[V[1],0,V[9]],$=Math.sqrt(z[0]*z[0]+z[2]*z[2]);$&&(z=[z[0]/$*x,0,z[2]/$*x]);var g=C[0]+z[0],F=C[1]+z[1],d=C[2]+z[2],X=T._center,E=T._eye;X[0]+=g,X[1]+=F,X[2]+=d,E[0]+=g,E[1]+=F,E[2]+=d,T.fp(or,N,E),T.fp(No,N,X)}}}},rotate:function(S,I,c){var g=this,T=g.gv;if(T.isRotatable()){var u=T._center,K=T._eye,V=xk(K,u),k=_(F(V[0]*V[0]+V[2]*V[2]),V[1]),o=k+c;o=Math.max(g.minPhi,Math.min(g.maxPhi,o)),c=o-k,T.fi({kind:T._rotating?"betweenRotate":"beginRotate",event:S}),T._rotating=1,T.rotate(I,c)}}}),W.defineProperties(Ge.prototype,{panButton:{get:function(){return this._panButton},set:function(E){this._panButton=E}},minPhi:{get:function(){return this._minPhi},set:function(M){this._minPhi=M}},maxPhi:{get:function(){return this._maxPhi},set:function(I){this._maxPhi=I}},keepHorizon:{get:function(){return this._keepHorizon},set:function(C){this._keepHorizon=C}},threshold:{get:function(){return this._threshold},set:function(o){this._threshold=o}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(r){this._touchScaleThreshold=r}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(i){this._touchRotateThreshold=i}}});var Ko=function(t){this.gv=t};Jl(Ko,W,{_iv:!0,iv:function(){this._iv=!0},face:function(j,g){var U=this,J=U.gv.getGL();if(!J||!wg(j))return N;var T=g.x,K=g.width,i=g.height,y=U.height-g.y-i,z=S(K/2),M=new Uint8Array(4*K*i),L=0;for(U.iv(),U.validate(j),Zf(J,U.frame),J.readPixels(T,y,K,i,J.RGBA,J.UNSIGNED_BYTE,M),Zr(J),U.iv();z>=L;L++)for(var E=z-L,d=z+L,s=E;d>=s;s++)for(var l=E;d>=l;l++)if(s===E||s===d||l===E||l===d){var f=Md.m[M[4*(s*K+l)]];if(f)return f}},get:function(e,m){this.validate();var p=this,b=p.gv.getGL();if(!b)return N;var G,R,l=e.x,A=e.width,n=e.height,K=p.height-e.y-n,w=S(A/2),t=new Uint8Array(4*A*n),h=0,U=t.length,F=m?N:new cb,k=m?N:{};if(Zf(b,p.frame),b.readPixels(l,K,A,n,b.RGBA,b.UNSIGNED_BYTE,t),Zr(b),m){for(;w>=h;h++)for(var E=w-h,C=w+h,T=E;C>=T;T++)for(var H=E;C>=H;H++)if((T===E||T===C||H===E||H===C)&&(G=p.info(t,4*(T*A+H))))return G}else for(;U>h;h+=4)G=p.info(t,h),G&&(R=G.data,k[R._id]||(F.add(R),k[R._id]=R));return F},info:function(K,a){return this.colorMap[(K[a]<<16)+(K[a+1]<<8)+K[a+2]+((127&K[a+3])<<24)]},validate:function(A){var M=this,Z=M.gv,r=Z.getGL();if(r){var s=Z.getWidth(),J=Z.getHeight(),H=r.RGBA,_=r.TEXTURE_2D,T=r.RENDERBUFFER,B=r.FRAMEBUFFER;M.texture||(M.texture=he(r),M.render=r.createRenderbuffer(),M.frame=r.createFramebuffer()),(M.width!==s||M.height!==J)&&(nq(r,M.texture),r.texImage2D(_,0,H,s,J,0,H,r.UNSIGNED_BYTE,N),Yi(r,r.TEXTURE_MIN_FILTER,r.LINEAR),r.bindRenderbuffer(T,M.render),r.renderbufferStorage(T,r.DEPTH_COMPONENT16,s,J),Zf(r,M.frame),r.framebufferTexture2D(B,r.COLOR_ATTACHMENT0,_,M.texture,0),r.framebufferRenderbuffer(B,r.DEPTH_ATTACHMENT,T,M.render),nq(r,N),r.bindRenderbuffer(T,N),Zr(r),M.width=s,M.height=J),M._iv&&(M._iv=!1,Zf(r,M.frame),Z._42(A||(M.colorMap={}),1),Zr(r))}}});var je=function(A){this.gv=A};Jl(je,W,{gap:0,size:0,_42:function(x,T){var J=this,e=J.gv,C=e._gridGap,Q=e._gridSize;if(e._gridVisible){if(J.gap!==C||J.size!==Q){for(var o=[],H=e._gridSize/2,L=C*H,t=0;2*H+1>t;t++){var r=6*t,z=6*(2*H+1)+r;o[r]=-L,o[r+1]=0,o[r+2]=-L+t*C,o[r+3]=L,o[r+4]=0,o[r+5]=-L+t*C,o[z]=-L+t*C,o[z+1]=0,o[z+2]=-L,o[z+3]=-L+t*C,o[z+4]=0,o[z+5]=L}J.vs=new As(o),J.gap=C,J.size=Q}Kd(e),jg(x,T),Vb(x),Gd(x,T,1,e._gridColor,e._buffer.vs,J.vs),rk(x,0,J.vs.length/3,x.LINES),Xp(x),om(x,T)}else J.vs=J.gap=J.size=N}});var Xk=function(Z){this.gv=Z};Jl(Xk,W,{_42:function(T,D){var u=this.gv,z=u._buffer.vs,i=u._axisXColor,v=u._axisYColor,b=u._axisZColor,X=u._originAxisVisible,o=u._centerAxisVisible;if(X||o){var W=pb?T.TRIANGLES:T.TRIANGLE_FAN,e=T.LINES;if(Kd(u),jg(T,D),Vb(T),X){var n=u.getCenterInfo(),x=h(n.width,n.height)/5,U=.8*x,G=.05*x;Gd(T,D,1.5,i,z,new As([0,0,0,x,0,0,U,G,0,U,0,G,U,-G,0,U,0,-G,U,G,0,0,0,0,0,x,0,G,U,0,0,U,G,-G,U,0,0,U,-G,G,U,0,0,0,0,0,0,x,G,0,U,0,G,U,-G,0,U,0,-G,U,G,0,U])),rk(T,0,2,e),rk(T,1,6,W),Gd(T,D,N,v),rk(T,7,2,e),rk(T,8,6,W),Gd(T,D,N,b),rk(T,14,2,e),rk(T,15,6,W)}if(o){var E=u._center,I=E[0],_=E[1],t=E[2],n=u.getPositionInfo(E);x=h(n.width,n.height)/20,Gd(T,D,1.5,i,z,new As([I,_,t,I+x,_,t,I,_,t,I,_+x,t,I,_,t,I,_,t+x])),rk(T,0,2,e),Gd(T,D,N,v),rk(T,2,2,e),Gd(T,D,N,b),rk(T,4,2,e)}Xp(T),om(T,D)}}});var Hd=function(G){this.gv=G,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Hd.Mode.Disable};Hd.Mode={Disable:0,Selection:1,MouseOver:2},Jl(Hd,W,{onMouseOver:function(t){Q.preventDefault(t);var w=this.gv.getDataAt(t);w!==this.mouseOverData&&(this.mouseOverData=w,this.gv.iv())},setFetchTargetFunc:function(l){this.fetchTargetFunc=l},_42:function(U,C){var n,O=this,H=O._mode;if(H!==Hd.Mode.Disable&&(H===Hd.Mode.Selection?n=O.gv.sm().getSelection().toArray(function(w){return w.s("highlight.visible")}):H===Hd.Mode.MouseOver&&O.mouseOverData&&O.mouseOverData.s("highlight.visible")&&(n=[O.mouseOverData]),O.fetchTargetFunc&&(n=O.fetchTargetFunc(n)),n&&n.length)){var I=O.gv,z=I.vr.isPresenting(),L=I.getWidth();if(z){var S=I.getWidth;L/=2,I.getWidth=function(){return L};var j=I.getViewport()}var q,M=I.getDevicePixelRatio(),r=L*M,k=I.getHeight()*M;(q=O._renderTarget)?q.setSize(U,r,k):O._renderTarget=q=new Vn.RenderTarget(I,U,r,k),Zf(U,q.frame),I.drawFilter=function(W){return n.indexOf(W)<0?!0:void 0},I._42({}),I.drawFilter=null,Zr(U),z&&(I.getWidth=S,I.setViewport(U,j[0],j[1],j[2],j[3])),O.shader||(O.shader=new as.Shader(U,vk.vs,vk.fs));var l=O.shader;if(O.shader.bind(),U.enable(U.BLEND),U.activeTexture(U.TEXTURE0+0),U.bindTexture(U.TEXTURE_2D,q.texture),l.uniforms.image=0,l.uniforms.textureSize=[r,k],l.uniforms.edgeWidth=e["highlight.width"],O.highlightColor!==e["highlight.color"]){var Y=Yr(O.highlightColor=e["highlight.color"]);O.highlightColorData=[Y[0]/255,Y[1]/255,Y[2]/255,Y[3]/255]}l.uniforms.edgeColor=O.highlightColorData,O.ibuffer?(O.ibuffer.upload(),O.vbuffer.upload()):(O.ibuffer=as.Buffer.createIndexBuffer(U,new Uint16Array([0,2,1,1,2,3])),O.vbuffer=as.Buffer.createVertexBuffer(U,new Float32Array([0,0,1,0,0,1,1,1]))),l.attributes.pos.pointer(O.vbuffer),U.drawElements(U.TRIANGLES,6,U.UNSIGNED_SHORT,0),U.disable(U.BLEND),U.bindTexture(U.TEXTURE_2D,null),U.useProgram(C)}}}),W.defineProperties(Hd.prototype,{mode:{get:function(){return this._mode},set:function(o){var S=this._mode;o!==S&&(this._mode=o,o===Hd.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):S===Hd.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var vk={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Bf=function(S){this.gv=S},$e="edit_tx",jj="edit_ty",lp="edit_tz",ml="edit_rx",hn="edit_ry",Rr="edit_rz",ls="edit_sx",si="edit_sy",Fh="edit_sz",_j={};_j[$e]=1,_j[jj]=1,_j[lp]=1,_j[ml]=1,_j[hn]=1,_j[Rr]=1,_j[ls]=1,_j[si]=1,_j[Fh]=1,Jl(Bf,W,{_42:function(o,N,O){var r=this,V=r.gv,z=V.sm().ld();if(z&&V.isEditable(z)&&!V.isEditHelperDisabled()&&wg(z)&&(!V.isFirstPersonMode()||!V.isMouseRoamable()&&!Ab)){Kd(V);var M,Q,L=V.isMovable(z),Z=V.isRotationEditable(z),i=V.isSizeEditable(z),s=V._axisXColor,A=V._axisYColor,S=V._axisZColor,g=V._editSizeColor,J=z.p3(),K=Df(V.getEye(),J)/10,e=K/(O?5:10),E=.7*K,u=.4*E,a=J[0],q=J[1],X=J[2];M=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],L&&r._17O(o,N,z,O,$e,s,M,[a,q-e,X,a+E,q-e,X,a+E,q,X,a+E,q,X,a,q,X,a,q-e,X,a,q-e,X+e,a+E,q-e,X+e,a+E,q-e,X,a+E,q-e,X,a,q-e,X,a,q-e,X+e]),Q=a+E,i&&r._17O(o,N,z,O,ls,g,M,[Q,q-e,X,Q+u,q-e,X,Q+u,q,X,Q+u,q,X,Q,q,X,Q,q-e,X,Q,q-e,X+e,Q+u,q-e,X+e,Q+u,q-e,X,Q+u,q-e,X,Q,q-e,X,Q,q-e,X+e]),Q+=u,Z&&r._17O(o,N,z,O,ml,s,M,[Q,q-e,X,Q+u,q-e,X,Q+u,q,X,Q+u,q,X,Q,q,X,Q,q-e,X,Q,q-e,X+e,Q+u,q-e,X+e,Q+u,q-e,X,Q+u,q-e,X,Q,q-e,X,Q,q-e,X+e]),M=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],L&&r._17O(o,N,z,O,jj,A,M,[a,q,X,a,q+E,X,a-e,q+E,X,a-e,q+E,X,a-e,q,X,a,q,X,a,q,X,a,q,X-e,a,q+E,X-e,a,q+E,X-e,a,q+E,X,a,q,X]),Q=q+E,i&&r._17O(o,N,z,O,si,g,M,[a,Q,X,a,Q+u,X,a-e,Q+u,X,a-e,Q+u,X,a-e,Q,X,a,Q,X,a,Q,X,a,Q,X-e,a,Q+u,X-e,a,Q+u,X-e,a,Q+u,X,a,Q,X]),Q+=u,Z&&r._17O(o,N,z,O,hn,A,M,[a,Q,X,a,Q+u,X,a-e,Q+u,X,a-e,Q+u,X,a-e,Q,X,a,Q,X,a,Q,X,a,Q,X-e,a,Q+u,X-e,a,Q+u,X-e,a,Q+u,X,a,Q,X]),M=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],L&&r._17O(o,N,z,O,lp,S,M,[a,q,X,a,q,X+E,a,q-e,X+E,a,q-e,X+E,a,q-e,X,a,q,X,a,q-e,X,a-e,q-e,X,a-e,q-e,X+E,a-e,q-e,X+E,a,q-e,X+E,a,q-e,X]),Q=X+E,i&&r._17O(o,N,z,O,Fh,g,M,[a,q,Q,a,q,Q+u,a,q-e,Q+u,a,q-e,Q+u,a,q-e,Q,a,q,Q,a,q-e,Q,a-e,q-e,Q,a-e,q-e,Q+u,a-e,q-e,Q+u,a,q-e,Q+u,a,q-e,Q]),Q+=u,Z&&r._17O(o,N,z,O,Rr,S,M,[a,q,Q,a,q,Q+u,a,q-e,Q+u,a,q-e,Q+u,a,q-e,Q,a,q,Q,a,q-e,Q,a-e,q-e,Q,a-e,q-e,Q+u,a-e,q-e,Q+u,a,q-e,Q+u,a,q-e,Q])}},_17O:function(v,X,Q,d,h,z,g,I){var t=this.gv._buffer;Cc(v,X,d,!0,Q,h),pk(v,X,N,!0,N,!0,N,!1),Xd(v,X.uDiffuse,z),Qr(v,t.vs,new As(I),X.aPosition),Qr(v,t.ns,new As(g),X.aNormal),Vb(v),rk(v,0,12),Xp(v),rm(v,X)}});var eg=z.Raycaster=function(V){this.gv=V,this.maxTriangleTest=1/0};iq("Raycaster",W,{intersect:function(V){var D=this,J=D.gv,o=J.getDataAt(V);return o?D.intersectObject(V,o):null},intersectObjects:function(t,M,d){var s,J,Q,U,O=this,r=1/0,T=t.origin||(new yj).fromArray(O.gv.getEye()),N=O.maxTriangleTest,h=[];return M.forEach(function(w){d&&d(w)===!1||w.s("intersect")!==!1&&h.push(w)}),h.sort(function(e,h){return T.distanceToSquared2(e.p3())-T.distanceToSquared2(h.p3())}),O.countTriangles=0,h.forEach(function(v){O.countTriangles>N||(s=O.intersectObject(t,v),s&&(J=T.distanceToSquared(s.world),r>J&&(Q=v,U=s,r=J)))}),O.countTriangles=0,{data:Q,intersect:U}},intersectObject:function(Z,o){if(Z instanceof Cn)return this._intersectObjectImpl(Z,o);var Y=this,g=Y.gv,f=g.unproject(Z),A=new yj,T=g.getEye(),H=new yj;if(g.isOrtho()){var C=new yj(T);H.copy(g.getCenter()).sub(C).normalize();var I=A.copy(f).sub(C).dot(H);A.copy(H).setLength(-I).add(C.copy(f))}else A.copy(T),H.copy(f).sub(A).normalize();var r=new z.Math.Ray(A,H);return Y._intersectObjectImpl(r,o)},_intersectObjectImpl:function(){function u(){var Y=new yj;return Y.subVectors(S,H),J.subVectors(p,H),Y.cross(J).normalize(),Y}function s(I,E,T,X,k,D,N){return ir.barycoordFromPoint(I,E,T,X,l),k.multiplyScalar(l.x),D.multiplyScalar(l.y),N.multiplyScalar(l.z),k.add(D).add(N),k.clone()}var P=new re,A=new re,j=new Cn,W=new yj,x=new yj,q=new yj,i=new yj,R=new yj,p=new yj,H=new yj,S=new yj,G=new hh,L=new hh,D=new hh,J=new yj,g={vs:mn,is:Nc,uv:Hl},l=new yj;return function(a,Y){var E=this.gv.getData3dUI(Y),F=Y.mat||E.mat;if(F){P.fromArray(F),A.getInverse(P),j.copy(a).applyMatrix4(A);var w,t,X="body",$=E.shapeModel;if($||($=jr(E)),$||(Y instanceof z.Node&&!(Y instanceof z.Shape)?(w=!0,$=g):(t=!0,$=[E.left,E.front,E.right,E.back,E.top,E.bottom])),!$)return console.log("Can not find shape model."),null;pi($)||($=[$]);var m,N,M,e,C,d,U,l,c,Z,Q,k,J,n,b,B,K=1/0,h=["","top_","bottom_"],v=!1;for(m=0,N=$.length;N>m;m++)if(J=$[m])for(M=0,e=h.length;e>M;M++)if(n=h[M],U=J[n+"vs"],l=J[n+"is"],c=J[n+"uv"]||J[n+"tuv"],U){if(b=J[n+"boundingBox"]){var Q=j.intersectBox(b);if(!Q)continue;if(j.origin.distanceTo(Q)>K)continue;B=!1}else J[n+"boundingBox"]=b=new z.Math.Box3,B=!0;for(C=0,d=l?l.length:U.length/3;d>C;C+=3)this.countTriangles++,l?(x.fromArray(U,3*l[C]),q.fromArray(U,3*l[C+1]),i.fromArray(U,3*l[C+2])):(x.fromArray(U,3*C),q.fromArray(U,3*(C+1)),i.fromArray(U,3*(C+2))),B&&(b.expandByPoint(x),b.expandByPoint(q),b.expandByPoint(i)),Z=j.intersectTriangle(x,q,i,!0,W),Z&&(k=j.origin.distanceTo(Z),K>k&&(K=k,R.copy(Z),p.copy(x),H.copy(q),S.copy(i),""!==n?X=n.slice(0,-1):w?X=zm[Math.floor(C/6)]:t&&(X=zm[m]),c&&(v=!0,l?(G.fromArray(c,2*l[C]),L.fromArray(c,2*l[C+1]),D.fromArray(c,2*l[C+2])):(G.fromArray(c,2*C),L.fromArray(c,2*(C+1)),D.fromArray(c,2*(C+2))))))}if(!isFinite(K))return null;var O,y=R.clone().applyMatrix4(P);v&&(O=s(R,p,H,S,G,L,D));var V=u(p,H,S),r=u(p.applyMatrix4(P),H.applyMatrix4(P),S.applyMatrix4(P)),o=j.direction.dot(V);return o>0&&(V.multiplyScalar(-1),r.multiplyScalar(-1)),{world:y,local:R.clone(),worldNormal:r,normal:V,uv:O,part:X}}}}()});var zr=function(D,G){this.gv=D,this.s=function($,S,l){return S==N&&(S=l),S==N?G.getStyle($):Cd(S,G,D)},this.data=G};Jl(zr,W,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(T,f,$,p){var r=this,w=r.data;
if(!(w instanceof Xh)){var R,O,h,J,X,A,B,Z=r.gv,U=w._id,V=r.s("shape3d.alwaysOnTop")?null:r.s("batch"),I=Z._batchIndexMap,D=Z._batchModelMap,s=Z.isSelectable(w),t=Z.getBrightness(w),e=t!=N&&1!==t;if(r.needValidate(T)){if(h=db(I,D,w,V),r.validate(h,V?km[V]||Ee:N),h&&(J=I[U],X=J.size=h.vs.length/3-J.begin,B=h.rs))for(t=e?t:1,A=0;X>A;A++)B.push(t);if(wg(w)){var n=Z.getWireframeGeometry(w);if(n)Nh(Z,w,n);else{var d=Z.getWireframe(w);d&&Nh(Z,w,d)}}r.labelInfo=r.label2Info=r.noteInfo=r.note2Info=r._38o=N,r._24O(mb,"getLabel"),r._24O(gm,"getLabel2"),r._26O(wb,"getNote"),r._26O(Fb,"getNote2"),r._15O(),r.interactiveInfo=Z.isInteractive(w)?{}:N,r._iv=!1}e&&Xd(T,f.uBrightness,t),Xd(T,f.uAlphaTest,r.s("alphaTest")),Xd(T,f.uUseEnvMap,w.s("envmap")?!0:!1),Xd(T,f.uReflectivity,w.s("envmap")||.01),O=Cc(T,f,$,s,w,Pr),O&&(Hg(O,I[U],D),Hg(O,Z._polylineIndexMap[U],Z._polylineModelMap),Hg(O,Z._wireframeIndexMap[U],Z._wireframeModelMap)),I[U]||r._80o(T,f,p),Z.isLabelVisible(w)&&((R=r.labelInfo)&&(Cc(T,f,$,s,w,mb),r._28O(R,mb,p)),(R=r.label2Info)&&(Cc(T,f,$,s,w,gm),r._28O(R,gm,p))),Z.isNoteVisible(w)&&((R=r.noteInfo)&&(Cc(T,f,$,s,w,wb),r._29O(R,wb,p)),(R=r.note2Info)&&(Cc(T,f,$,s,w,Fb),r._29O(R,Fb,p))),(R=r._38o)&&r._99O(T,f,R,$,s,p),e&&Xd(T,f.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return fb},_80o:function(){},dispose:function(){},_calcAnchorMat:function(O){if(O.hasOwnProperty("_anchor")||O.hasOwnProperty("_anchorElevation")){var t=O.getAnchor3d(),C={x:t.x-.5,y:t.y-.5,z:t.z-.5},y=vq();return aq(y,[-C.x,-C.y,-C.z]),y}},getBodyColor:function(G){var n=this.data,u=this.gv.getBodyColor(n);return u?u:G?n.getStyle(G):N},_24O:function(R,m){var T=this,G=T.data,$=T.gv,e=T.s,i=$[m](G);if(i!=N){var O=e(R+".scale"),g=e(R+".max"),t=T[R+"Info"]={label:i,textureScale:e(R+".texture.scale"),color:$[m+"Color"](G),font:e(R+".font"),align:e(R+".align"),background:$[m+"Background"](G)},D=t.rect=gl(t,i);g>0&&g<D.width&&(t.labelWidth=D.width,D.width=g),D.x=D.y=0,D.width*=O,D.height*=O,t.mat=T._16O(e(R+".autorotate"),e(R+".position"),D,e(R+".face"),e(R+".t3"),e(R+".r3"),e(R+".rotationMode"));var h=D.width/2,F=D.height/2;t.vs=new As([-h,F,0,-h,-F,0,h,-F,0,h,F,0]),D.width/=O,D.height/=O}},_26O:function(e,A){var Z=this,z=Z.data,F=Z.gv,x=Z.s,f=F[A](z);if(f!=N){var Y=x(e+".scale"),L=this[e+"Info"]={note:f,textureScale:x(e+".texture.scale"),expanded:x(e+".expanded"),font:x(e+".font"),color:x(e+".color"),align:x(e+".align"),borderWidth:x(e+".border.width"),borderColor:x(e+".border.color"),background:F[A+"Background"](z)};if(L.expanded){var H=x(e+".max"),C=gl(L,f);C.width+=6,C.height+=2,H>0&&H<C.width&&(L.labelWidth=C.width,C.width=H);var r={x:-C.width/2,y:-8-C.height,width:C.width,height:C.height+8}}else r={x:-6,y:-18,width:12,height:18};L.mat=Z._16O(x(e+".autorotate"),x(e+".position"),N,x(e+".face"),x(e+".t3"),x(e+".r3"),x(e+".rotationMode")),L.rect=r,1!==Y&&(r=kg(r),r.x*=Y,r.height*=Y,r.y=-r.height,r.width*=Y);var T=r.x,j=r.y,t=r.width,b=r.height;L.vs=new As([T,-j,0,T,-j-b,0,T+t,-j-b,0,T+t,-j,0])}},_28O:function(L,E,K){if(K(this.s(E+".transparent"))){var j=L.rect,U=L.textureScale,G=j.width*U,N=j.height*U;if(G>=1&&N>=1){var r=Mn(G,N);1!==U&&(r.translate(r,j.x,j.y),r.scale(U,U),r.translate(r,-j.x,-j.y)),Aq(r,L),r.restore(),Vj(this,E,L.mat,L.vs,!0)}}},_29O:function(X,E,_){if(_(this.s(E+".transparent"))){var J=X.rect,P=X.textureScale,v=J.x,w=J.y,U=J.width*P,V=J.height*P;if(U>=1&&V>=1){J.x=J.y=0;var R=Mn(U,V);1!==P&&R.scale(P,P),ek(R,X),R.restore(),J.x=v,J.y=w,Vj(this,E,X.mat,X.vs,!1)}}},_99O:function(X,S,Q,d,u,T){if(Q){var Y=this,P=Y.gv,O=Y.data,g=P._buffer,i=P._1O,A=Q.icons;for(var j in A){var J=A[j],D=Q.rects[j];if(D&&T(Cd(J.transparent,O,P))){Cc(X,S,d,u,O,j);var L=Cd(J.shape3d,O,P),C=L?[L]:Cd(J.names,O,P),f=C?C.length:0,k=Cd(J.textureScale,O,P)||1,$=Cd(J.light,O,P);$==N&&($=L?!0:!1),pk(X,S,Cd(J.blend,O,P),$,Cd(J.opacity,O,P),Cd(J.reverseFlip,O,P),Cd(J.reverseColor,O,P),Cd(J.reverseCull,O,P));for(var K=0;f>K;K++){var c=C[K],o=D[K];if(Tq(Y,o.mat),L)Jq(P,O,jr(Y,L),Y);else{var a=_c(c);if(a){var y=o.width*k,q=o.height*k;if(y>=1&&q>=1){var p=Mn(y,q);_n(p,a,Cd(J.stretch,O,P),0,0,y,q,O,P),p.restore(),he(X,Vc,i),Vb(X,S,i,Cd(J.discardSelectable,O,P),g.uv,Ng),Qr(X,g.vs,o.vs,S.aPosition),fg(X,g.ns,Rn,S.aNormal),Hc(X,g.is,sd),ni(X,0,sd.length),Xp(X,S,i)}}}Ib(P)}rm(X,S)}}}}});var Gi=function(z,o){oj(Gi,this,[z,o])};Jl(Gi,zr,{_16O:function(r,h,w,S,B,p,V,L,t){var b=this.data,D=b.getFinalScale3d(),K=zp(h,D,w,S,L,t);if(b.hasOwnProperty("_anchor")||b.hasOwnProperty("_anchorElevation")){var C=b.getAnchor3d();K[0]-=(C.x-.5)*D[0],K[1]-=(C.y-.5)*D[1],K[2]-=(C.z-.5)*D[2]}return og(vq(),K,b.p3(),S,B,p,V,r,b.getFinalRotation3d(),b.getRotationMode())},clear:function(){var K=this;K.faceMat=K.mat=K.shapeModel=K.left=K.right=K.front=K.back=K.top=K.bottom=K.csg=N},needValidate:function(c){if(this._iv)return this._validateFrameId=c._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var Z=c._renderInfo.frame;if(this._validateFrameId!==Z)return this._validateFrameId=Z,!0}return!1},validate:function(h,l){var G=this,M=G.gv,L=G.data,P=G.shapeName=G.s(ul),q=jr(G,P);G._updateAutoRotation(),G._updateFixSize2d(),G._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(dq(M,L,"_wireframeModelMap","_wireframeIndexMap"),dq(M,L,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var A=ub(L,M.getMat(L),q?G.s("shape3d.scaleable"):!0),r=G._calcAnchorMat(L);if(r&&Vk(A,A,r),L.mat=A,G.clear(),q||!P)if(h){var Y=[];q?yg(M,L,q,G,G.getBodyColor(),[A],h,Y):(Ob(M,L,h,l,A,pc,Y,bc),Ob(M,L,h,l,A,hl,Y,_d),Ob(M,L,h,l,A,_m,Y,xl),Ob(M,L,h,l,A,Jr,Y,Xm),Ob(M,L,h,l,A,fr,Y,Qb),Ob(M,L,h,l,A,ms,Y,sb)),Y.length&&(Kb(h.vs,Y),Kb(h.ns,_p(Y)))}else G.mat=A,(G.shapeModel=q)||(G._cubeUvs=null,G.vf(pc,0),G.vf(hl,16),G.vf(fr,8),G.vf(ms,24),G.vf(_m,32),G.vf(Jr,40))},_updateAutoRotation:function(){var i=new ds;return function(){var l=this,X=l.data,Z=l.s("shape3d.autorotate");if(!Z)return X._dynamicRotation&&delete X._dynamicRotation,void 0;var c,A=l.gv;c="string"==typeof Z?[Z.indexOf("x")<0?A._eye[0]:A._center[0],Z.indexOf("y")<0?A._eye[1]:A._center[1],Z.indexOf("z")<0?A._eye[2]:A._center[2]]:A._eye;var w=A._center,t=X.p3(),L=ks([t[0]+c[0]-w[0],t[1]+c[1]-w[1],t[2]+c[2]-w[2]],t,A._up);i.set(0,0,0,X.getRotationMode(),!0).setFromRotationMatrix(L);var a=X._dynamicRotation;a&&Math.abs(a[0]-i.x)<1e-5&&Math.abs(a[1]-i.y)<1e-5&&Math.abs(a[2]-i.z)<1e-5||(X._dynamicRotation=[i.x,i.y,i.z])}}(),_updateFixSize2d:function(){var p=this,l=p.data,n=p.s("shape3d.fixSizeOnScreen");if(!n)return l._dynamicScale3d&&delete l._dynamicScale3d,void 0;var j=p.gv;l.getFinalScale3d();var g=ub(l,j.getMat(l)),w=Ij([0,0,0],g),M=j.toViewPosition(w);if(!isNaN(M.x)&&!isNaN(M.y)){var a=Ij([1,0,0],g),F=j.toViewPosition(a),V=Ij([0,1,0],g),K=j.toViewPosition(V),x=F.x-M.x,o=K.y-M.y;if(x&&o){var v=l._dynamicScale3d||[1,1,1],s=_c(l.s("shape3d.image")),U=n[0]>0?n[0]:s?Uj(s,l):20,k=n[1]>0?n[1]:s?dg(s,l):20,c=Math.abs(x/U),R=Math.abs(o/k);Math.abs(c-1)<.001&&Math.abs(R-1)<.001||(l._dynamicScale3d=[v[0]/c,v[1]/R,v[2]])}}},_updateOverlapping:function(){var d=this,o=d.s("hide.overlapping.group");if(!o)return d._rectOverlapping&&(d._rectOverlapping=s),void 0;var H,t,v,G=d.gv,j=d.data,S=ub(j,G.getMat(j)),L=1/0,i=1/0,c=-1/0,F=-1/0,Y=j.getAnchor3d(),M=Y.x,N=Y.y,U=Y.z;for(H=0;8>H;H++){if(t=Ij([(H>>2)-M,(1&H>>1)-N,(1&H)-U],S),v=G.toViewPosition(t),isNaN(v.x)||isNaN(v.y))return;L=Math.min(L,v.x),c=Math.max(c,v.x),i=Math.min(i,v.y),F=Math.max(F,v.y)}var W={x:L,y:i,w:c-L,h:F-i};d._rectOverlapping=G.overlappingBox.isOverlapping(o,W)},getVectorDynamicSize:function(){var A,Q=this,H=Q.s("shape3d"),T=Q.data;if("billboard"===H||"plane"===H||(A=T._currentCubeElementId)!=N){var n,E,V=Q.gv,e=ub(T,V.getMat(T)),I=T.getAnchor3d(),u=.5-I.x,p=.5-I.y,U=.5-I.z,w=Q.s("shape3d.vector.dynamic.maxsize"),O=function(l,R){l[0]+=u,l[1]+=p,l[2]+=U,R[0]+=u,R[1]+=p,R[2]+=U;var f=V.toViewPosition(Ij(l,e)),P=V.toViewPosition(Ij(R,e)),o=f.x-P.x,J=f.y-P.y;return Math.min(w,Math.sqrt(o*o+J*J))};if("billboard"===H)n=O([-.5,0,0],[.5,0,0]),E=O([0,-.5,0],[0,.5,0]);else if("plane"===H)n=O([-.5,0,0],[.5,0,0]),E=O([0,0,-.5],[0,0,.5]);else if(T._currentCubeElementId!=N){var b=3*Nc[A+1],M=3*Nc[A],z=3*Nc[A+2];n=O([mn[b],mn[b+1],mn[b+2]],[mn[z],mn[z+1],mn[z+2]]),E=O([mn[b],mn[b+1],mn[b+2]],[mn[M],mn[M+1],mn[M+2]])}return[n,E]}},getCachedTexture:function(){var l=this,w=l.data,x=w._currentCubeElementId;return x!=N?l._cubeCachedImage?l._cubeCachedImage[x]:null:l._shape3dCachedImage},setCachedTexture:function(F){var H=this,c=H.data,y=c._currentCubeElementId;y!=N?(H._cubeCachedImage||(H._cubeCachedImage={}),H._cubeCachedImage[y]=F):H._shape3dCachedImage=F},invalidateCachedTexture:function(K){var W,J,x,t=this;if((x=t._shape3dCachedImage)&&(K.deleteTexture(x),t._shape3dCachedImage=null),J=t._cubeCachedImage){for(W in J)K.deleteTexture(J[W]);t._cubeCachedImage=null}},vf:function(Z,s){var k=this;if(k.gv.getFaceVisible(k.data,Z)){var A=Kg(k,Z);A.mat&&(k.faceMat=!0);var P=A.uv;if(P){var d=k._cubeUvs;d||(d=k._cubeUvs=new As([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var y=0;8>y;y++)d[s+y]=P[y]}return A}},_billboardInView:function(){var X=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],S=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],M=new Qg,C=new yj,T=new re,b=new Zk,O=new Array(16);return function(A){var u=this;if(!u.mat)return!0;for(var g=u.gv.getPVMatrix(),$=!1,j=0;16>j;j++)g[j]!==O[j]&&($=!0,O[j]=g[j]);$&&b.setFromMatrix(T.fromArray(g));var N="billboard"===A?X:S;M.makeEmpty(),T.fromArray(u.mat);for(var j=0,V=N.length;V>j;j+=3)M.expandByPoint(C.fromArray(N,j).applyMatrix4(T));return b.intersectsBox(M)}}(),_80o:function(j,_,e){var c=this;if(c._rectOverlapping)return!0;var X=c.shapeModel;if(X||!c.shapeName){var a=c.s("shape3d");if(("billboard"===a||"plane"===a)&&!c._billboardInView(a))return!0;var s=c.gv,k=c.data,B=s._cube;Kd(s,c.mat),c.s("shape3d.reflector")&&!j._picking||(X?Jq(s,k,X,c,c.getBodyColor(),e):(Qr(j,B.vs,N,_.aPosition),Qr(j,B.ns,N,_.aNormal),jl(j,B.is),c._18O(j,_,c.left,0,e),c._18O(j,_,c.front,6,e),c._18O(j,_,c.right,12,e),c._18O(j,_,c.back,18,e),c._18O(j,_,c.top,24,e),c._18O(j,_,c.bottom,30,e))),Ib(s),c.faceMat&&(c._18O(j,_,c.left,0,e,!0),c._18O(j,_,c.front,6,e,!0),c._18O(j,_,c.right,12,e,!0),c._18O(j,_,c.back,18,e,!0),c._18O(j,_,c.top,24,e,!0),c._18O(j,_,c.bottom,30,e,!0))}},_18O:function(A,w,c,T,S,n){if(c){if(!S(c.transparent))return;if(n&&!c.mat||!n&&c.mat)return;var d=this.data.s("polygonOffset");d&&Kf(A,d),n&&Kd(this.gv,c.mat);var h=this,o=h.data;o._currentCubeElementId=T;var U=h.gv,r=U.getTexture(c.texture,o),D=c.uv,x=c.uvScale,L=c.uvOffset,X=c.discardSelectable;r?D?Vb(A,w,r,X,U._buffer.uv,h._cubeUvs,L,x):Vb(A,w,r,X,U._cube.uv,N,L,x):Vb(A),pk(A,w,c.blend,c.light,c.opacity,c.reverseFlip,c.reverseColor,c.reverseCull),Xd(A,w.uDiffuse,c.color||e["color.empty"]),ni(A,T,6),rm(A,w),Xp(A,w,r),n&&Ib(U),d&&Sb(A),o._currentCubeElementId=null}},drawReflector:function(){var k=new yj,Q=new yj,U=new ds,v=new re,m=new yj,i=new yj,R=new yj,_=new yj,F=new re,Y=new re,Z=new Tk,P=new pj,a=new pj,t=function(E,j,x){E[x]=j[0],E[x+1]=j[1],E[x+2]=j[2]},p=function(U,q){t(U,q.getEye(),0),t(U,q.getCenter(),3),t(U,q.getUp(),6)},S=function(q,e){e._eye=[q[0],q[1],q[2]],e._center=[q[3],q[4],q[5]],e._up=[q[6],q[7],q[8]],e._18Q=N;var O=e._skyBox;O&&(O.p3([q[0],q[1],q[2]]),e.getData3dUI(O).iv())};return function(h,K,g,w,T){var X=this;X._reflectorInfo=null;var $=X.data;if($._reflecting)return!1;var M=X.gv;if(T)return!1;var I=X._reflectorRenderTarget;I?I.setSize(h,K,g):I=X._reflectorRenderTarget=new Vn.RenderTarget(M,h,K,g),k.copy($.p3()),Q.copy(M.getEye()),v.makeRotationFromEuler(U.set($.r3(),$.getRotationMode(),!0));var u;if(!X._reflectNormal){var u=jr(X,X.s("shape3d"));if(!u)return!1;if(!u.ns&&u.length&&(u=u[0]),!u.ns||!u.vs)return!1;X._reflectNormal=[u.ns[0],u.ns[1],u.ns[2]],X._reflectorVbuffer=as.Buffer.createVertexBuffer(h,new Float32Array(u.vs))}if(m.copy(X._reflectNormal),m.applyMatrix4(v),i.subVectors(k,Q),i.dot(m)>0)return!1;i.reflect(m).negate(),i.add(k),R.copy(M.getCenter()).negate().add(k),R.reflect(m).negate(),R.add(k),_.copy(M.getUp()),_.reflect(m);var y=[0,0,0,0,0,0,0,0,0];p(y,M),M._eye=i.toArray(),M._center=R.toArray(),M._up=_.toArray(),M._18Q=N;var l=M._skyBox;l&&(l.p3(M._eye),M.getData3dUI(l).iv()),Zf(h,I.frame),h.viewport(0,0,I.width,I.height),h.clearColor(0,0,0,1),h.clear(h.COLOR_BUFFER_BIT);var e=fe(M),G=_b(M);Z.setFromNormalAndCoplanarPoint(m,k),Z.applyMatrix4(Y.fromArray(G)),P.set(Z.normal.x,Z.normal.y,Z.normal.z,Z.constant),a.x=(Math.sign(P.x)+e[8])/e[0],a.y=(Math.sign(P.y)+e[9])/e[5],a.z=-1,a.w=(1+e[10])/e[14],P.multiplyScalar(2/P.dot(a));var O=$.s("shape3d.reflector.clip"),A=O===s?.003:O;e[2]=P.x,e[6]=P.y,e[10]=P.z+1-A,e[14]=P.w;var o=M._computedProjectMatrix;M._computedProjectMatrix=e,$._reflecting=!0,w(),M._computedProjectMatrix=o,F.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),F.multiply(Y.fromArray(M._projectMatrix)),F.multiply(Y.fromArray(M._viewMatrix)),Zr(h),S(y,M);var q=Rm.Reflector.shader;return q||(q=Rm.Reflector.shader=new as.Shader(h,Rm.Reflector.vs,Rm.Reflector.fs)),q.bind(),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,I.texture),q.uniforms.tDiffuse=0,q.uniforms.color=Sd($.s("shape3d.reflector.color")||"rgb(128,128,128)"),q.uniforms.textureMatrix=F.toArray(),q.uniforms.modelMatrix=ub($),q.uniforms.viewMatrix=_b(M),q.uniforms.projectionMatrix=fe(M),X._reflectorVbuffer.upload(),q.attributes.pos.pointer(X._reflectorVbuffer),h.drawArrays(h.TRIANGLES,0,6),$._reflecting=!1,h.useProgram(M._prg),!0}}()}),Rm.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var Mb=function(B,f){oj(Mb,this,[B,f])};Jl(Mb,zr,{_25Q:1,validate:function(O){var e=this,m=e.gv,W=e.data,z=e.s,a=z("edge.width"),M=W._40I,t=W._41I;if(e.shapeModel=e.info=N,M&&t){var u,w,o,P,E,f,c,Z,G,I,L=W.isLooped(),K=z(Yl),H=Q.getEdgeType(K);if(H){var S=H(W,Rf(e,m,W,L,K),m,e._19Q);if(!S.points||S.points.isEmpty())return;f=e.info={},c=S.segments,E=S.points,Z=E.size();for(var r=M.getElevation(),U=t.getElevation(),y=0;Z>y;y++){var v=E.get(y);v.e==N&&(v.e=r+(U-r)*y/(Z-1))}G=nm(E.get(0)),I=nm(E.get(Z-1));var V=Z%2;0===V?(f.c1=nm(E.get(Z/2-1)),f.c2=nm(E.get(Z/2))):f.p3=nm(E.get((Z-V)/2)),f.s1=G,f.s2=nm(E.get(1)),f.t1=nm(E.get(Z-2)),f.t2=I}else{E=new cb,f=e.info={};var Y=z("edge.offset"),l=z("edge.center"),k=z("edge.source.t3"),J=z("edge.target.t3"),s=M.p3(),p=t.p3();if(k&&(s[0]+=k[0],s[1]+=k[1],s[2]+=k[2]),J&&(p[0]+=J[0],p[1]+=J[1],p[2]+=J[2]),K===zd){c=z("edge.segments");var d=f.points=z(Tr)||gb;if(Z=d.size()){G=nm(d.get(0)),I=nm(d.get(Z-1)),!l&&Y&&(o=xk(G,s,!0),Y=h(Y,Df(s,G)),s=[s[0]+o[0]*Y,s[1]+o[1]*Y,s[2]+o[2]*Y],o=xk(p,I,!0),Y=h(Y,Df(I,p)),p=[p[0]-o[0]*Y,p[1]-o[1]*Y,p[2]-o[2]*Y]);var V=Z%2;0===V?(u=nm(d.get(Z/2-1)),w=nm(d.get(Z/2))):f.p3=nm(d.get((Z-V)/2)),f.s1=s,f.s2=G,f.t1=I,f.t2=p}else!l&&Y&&(o=xk(p,s,!0),P=Df(s,p),Y=Zm(Y,P),s=[s[0]+o[0]*Y,s[1]+o[1]*Y,s[2]+o[2]*Y],p=[p[0]-o[0]*Y,p[1]-o[1]*Y,p[2]-o[2]*Y]),u=s,w=p;E.add({x:s[0],y:s[2],e:s[1]}),E.addAll(d),E.add({x:p[0],y:p[2],e:p[1]})}else{var B=Rf(e,m,W,L,K);if(e._19Q||(B=-B),L){var x=s[0],g=s[1],T=s[2],F=M.getTall()/2+B;u=[x-B,g+F,T],w=[x+B,g+F,T],E.add({x:x-B,y:T,e:g}),E.add({x:x-B,y:T,e:g+F}),E.add({x:x+B,y:T,e:g+F}),E.add({x:x+B,y:T,e:g})}else{o=xk(p,s,!0),P=Df(s,p);var R={x:s[0],y:s[2]},D={x:p[0],y:p[2]},X=Aj(N,R,D,B),A=X.x-R.x,q=X.y-R.y;Y=Zm(Y,P),o[0]*=Y,o[1]*=Y,o[2]*=Y,u=[s[0]+o[0]+A,s[1]+o[1],s[2]+o[2]+q],w=[p[0]-o[0]+A,p[1]-o[1],p[2]-o[2]+q],l?(E.add({x:s[0],y:s[2],e:s[1]}),E.add({x:u[0],y:u[2],e:u[1]}),E.add({x:w[0],y:w[2],e:w[1]}),E.add({x:p[0],y:p[2],e:p[1]})):(E.add({x:u[0],y:u[2],e:u[1]}),E.add({x:w[0],y:w[2],e:w[1]}))}}f.c1=u,f.c2=w}f.list=z(ul)===Sq?e.createTubeModel(E,c,a/2,O):e.createLineModel(E,c,a,"edge","edge.dash")}}});var os=function(g,W){oj(os,this,[g,W])};Jl(os,Gi,{_80o:function(h,g,N){var M=this,d=M.gv,t=M.shapeModel;Kd(d,M.mat),t?Jq(d,M.data,t,M,M.getBodyColor(),N):(Nf(M,h,g,M.left,N),Nf(M,h,g,M.front,N),Nf(M,h,g,M.right,N),Nf(M,h,g,M.back,N),Nf(M,h,g,M.top,N),Nf(M,h,g,M.bottom,N)),Ib(d)},validate:function(A,d){var o,E,c=this,u=c.s,L=c.data,b=L.p3(),S=L._thickness/2,K=L.isClosePath(),W=L.getPoints(),w=L.getSegments(),G=u(er),$=A&&A.uv;if(c.clear(),0>S)E=c.shapeModel=Ff(W,w,u(bl),u(Fd),G,u(Vl),L.getTall(),L.getShapeElevation(),K),u(_h)?u("shape3d.image")||delete E.uv:(delete E.vs,delete E.ns,delete E.uv),u("shape3d.top.image")||delete E.top_uv,u("shape3d.bottom.image")||delete E.bottom_uv;else if(u(ul)===Sq)o=$l(W,w,G,K),E=c.shapeModel={vs:[]},u("shape3d.image")&&(E.uv=[],E.sum=u(Vl)||Ag(o)||1,E.len=0),u(bl)&&!K&&(E.top_vs=[],u("shape3d.top.image")&&(E.top_uv=[])),u(Fd)&&!K&&(E.bottom_vs=[],u("shape3d.bottom.image")&&(E.bottom_uv=[])),c._12O(o,S);else{var j,e,s,t,m,f,M,B,J,R;if(o=$l(W,w,G,K),m=c.vf(fr,$,!1,d),S&&(f=c.vf(ms,$,!1,d),M=K?N:c.vf(pc,$,!1,d),B=K?N:c.vf(hl,$,!1,d),J=c.vf(_m,$,!1,d),R=c.vf(Jr,$,!1,d)),S){for(var y=0,C=o.length;C>y;y++)o[y]=c._tryRemoveBezierPoints(o[y],S);c._12O(o,S)}else m&&o.forEach(function(T){if(t=T.length,t>0)for(j=T[0],s=1;t>s;s++)e=T[s],c.addV(m.vs,j,e),j=e});c._20Q(o),A||(m&&(m.ns=_p(m.vs),Lj(m,"vs"),Lj(m,hd)),S&&(f&&(f.ns=_p(f.vs),Lj(f,"vs"),Lj(f,hd)),M&&(M.ns=_p(M.vs),Lj(M,"vs"),Lj(M,hd)),B&&(B.ns=_p(B.vs),Lj(B,"vs"),Lj(B,hd)),J&&(J.ns=_p(J.vs),Lj(J,"vs"),Lj(J,hd)),R&&(R.ns=_p(R.vs),Lj(R,"vs"),Lj(R,hd))))}var h=c.mat=vq();aq(h,b),fo(h,L.getFinalRotation3d(),L.getRotationMode());var n=L.getScale3d(),F=L._dynamicScale3d;F&&(n[0]*=F[0],n[1]*=F[1],n[2]*=F[2]),Rp(h,n),aq(h,wm(b)),A&&(Bq(c,h,A,E),c.clear())},_20Q:function(y){var i,C,w,g,D,u,W,B=this,f=B.front,A=B.back,G=B.top,Q=B.bottom,T=f?f.tuv:N,Y=A?A.tuv:N,J=G?G.tuv:N,p=Q?Q.tuv:N,c=0;(T||Y||J||p)&&(i=B.s(Vl)||Ag(y)||1,y.forEach(function(I){if(C=I.length,C>0)for(u=I[0],w=1;C>w;w++)W=I[w],g=c/i,c+=Df(u,W),D=c/i,B._14O(f,g,D),B._14O(A,1-D,1-g),B._14O(G,g,D),B._14O(Q,g,D),u=W}))},_14O:function(P,d,n){if(P){var t=P.uv,H=P.tuv;if(H){if(t)var g=t[0]+(t[6]-t[0])*d,x=t[1]+(t[7]-t[1])*d,E=t[2]+(t[4]-t[2])*d,L=t[3]+(t[5]-t[3])*d,l=t[2]+(t[4]-t[2])*n,j=t[3]+(t[5]-t[3])*n,M=t[0]+(t[6]-t[0])*n,$=t[1]+(t[7]-t[1])*n;else g=d,x=0,E=d,L=1,l=n,j=1,M=n,$=0;H.push(E,L,l,j,M,$,M,$,g,x,E,L)}}},_13O:function(n){var Y=n.uv,w=n.tuv;w&&(Y?w.push(Y[2],Y[3],Y[4],Y[5],Y[6],Y[7],Y[6],Y[7],Y[0],Y[1],Y[2],Y[3]):w.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(U,p){var h=U.length;if(4>h)return U;var y,P,i,n,r,A,N=!1,C=function(O){return U[O]},l=function(K){return U[h-1-K]};for(r=0;1>=r;r++)for(A=r?l:C,P=A(0),i=A(1),y=2;h-1>y;y++)if(n=A(y),!n.remove)if(n.b){var L=Aj(P,i,n,p);L.adjust?(n.remove=!0,N=!0):(P=i,i=n)}else P=i,i=n;if(!N)return U;var b=[];for(y=0;h>y;y++)U[y].remove||b.push(U[y]);return b},_12O:function(o,B){var v,A,H,f,D,c=this;o.forEach(function(b){if(D=b.length,D>0)for(v={p:b[0],n:!0},f=1;D>f;f++)A=b[f],H=D-1>f?b[f+1]:N,c.addPoint(v,A,H,B,b)})},addPoint:function(s,G,n,d,x){var W,i,o,h,R,X,V,k,y,L=this,Y=s.p,e=s.f,Z=s.b,E=L.s("shape3d.side")||xp,z=L.s("shape3d.start.angle"),u=L.s("shape3d.sweep.angle"),H=L.shapeModel,p=L.data.isClosePath();if(s.n&&(s.n=!1,e=p&&x.length>2?Aj(x[x.length-2],Y,G,d):Aj(N,Y,G,d),Z=qb(Y,e),H?H.top_vs&&L._10O(Z,e,E,z,u,H.top_vs,H.top_uv):(W=L.left)&&(L.addV(W.vs,Z,e),L._13O(W))),i=n?Aj(Y,G,n,d):p&&x.length>2?Aj(Y,G,x[1],d):Aj(Y,G,N,d),o=qb(G,i),H){var t,M,B=H.vs,r=H.uv,_=H.sum;for(r&&(t=H.len/_,H.len+=Df(Y,G),M=H.len/_),X=L._9O(Z,e,E,z,u),V=L._9O(o,i,E,z,u),k=0;E>k;k++)y=k+1,Kb(B,X[y]),Kb(B,V[k]),Kb(B,X[k]),Kb(B,V[k]),Kb(B,X[y]),Kb(B,V[y]),r&&(h=k/E,R=y/E,r.push(t,R,M,h,t,h,M,h,t,R,M,R));!n&&H.bottom_vs&&L._10O(o,i,E,z,u,H.bottom_vs,H.bottom_uv,!0)}else!n&&(W=L.right)&&(L.addV(W.vs,i,o),L._13O(W)),(W=L.front)&&L.addV(W.vs,e,i),(W=L.back)&&L.addV(W.vs,o,Z),(W=L.top)&&L.addH(W.vs,e,i,o,Z,!0),(W=L.bottom)&&L.addH(W.vs,Z,o,i,e);s.p=G,s.f=i,s.b=o},_10O:function(p,c,C,N,K,t,o,e){var x,G,d=this,F=d.data,I=d._9O(p,c,C,N,K),i=(p.x+c.x)/2,$=(p.y+c.y)/2,y=F.getShapeElevation(),E=0;for(E=0;C>E;E++)e?(Kb(t,I[E]),Kb(t,I[E+1])):(Kb(t,I[E+1]),Kb(t,I[E])),Kb(t,[i,y,$]),o&&(e?(x=m*(E+1)/C+N,G=m*E/C+N):(x=m*E/C+N,G=m*(E+1)/C+N),o.push(.5-.5*H(G),.5-.5*R(G),.5-.5*H(x),.5-.5*R(x),.5,.5))},_9O:function(r,k,M,e,D){var G,X,A=this,V=A.data,C=[],t=(r.x+k.x)/2,y=(r.y+k.y)/2,j=V.getTall()/2,E=V.getShapeElevation(),K=0;for(D=D||m;M>=K;K++)G=D*K/M+e,X=H(G),C.push([t+(r.x-t)*X,E+j*R(G),y+(r.y-y)*X]);return C},addV:function(r,t,O){var x=t.x,l=t.y,P=O.x,e=O.y,w=this.data,V=w.getShapeElevation(),U=w.getTall()/2;r.push(x,V-U,l,P,V-U,e,P,V+U,e,P,V+U,e,x,V+U,l,x,V-U,l)},addH:function(x,J,q,T,Q,z){var l=this.data,p=l.getTall()/2,P=l.getShapeElevation()+(z?p:-p);x.push(J.x,P,J.y,q.x,P,q.y,T.x,P,T.y,T.x,P,T.y,Q.x,P,Q.y,J.x,P,J.y)},vf:function(u,q,G,$){var L,Z=this,s=Z.gv.getFaceVisible(Z.data,u);return(G||s)&&(L=Kg(Z,u,$),L.vs=[],L.tuv=s&&(L.texture||q)?[]:N,L.visible=s),L}});var On=function(Y,m){oj(On,this,[Y,m])};Jl(On,zr,{_25Q:1,validate:function(O){var W=this,w=W.data,U=W.s,h=w.getPoints(),Z=h.size();if(W.shapeModel=W.info=N,Z>1){var H=W.info={},C=w.getSegments(),c=w.getThickness(),g=nm(h.get(0)),V=nm(h.get(Z-1)),o=Z%2;0===o?(H.c1=nm(h.get(Z/2-1)),H.c2=nm(h.get(Z/2))):H.p3=nm(h.get((Z-o)/2)),H.s1=g,H.s2=nm(h.get(1)),H.t1=nm(h.get(Z-2)),H.t2=V,H.list=U(ul)===Sq?W.createTubeModel(h,C,c/2,O):W.createLineModel(h,C,c,"shape.border","shape.dash")}var S=w.p3(),q=W.mat=vq();aq(q,S),fo(q,w.getFinalRotation3d(),w.getRotationMode());var r=w.getScale3d(),J=w._dynamicScale3d;J&&(r[0]*=J[0],r[1]*=J[1],r[2]*=J[2]),Rp(q,r),aq(q,wm(S))},_80o:function(q,m,f){var t=this,U=t.shapeModel;if(U){var V=t.gv;Kd(V,t.mat),Jq(V,t.data,U,t,t.getBodyColor(),f),Ib(V)}}});var qj=z.graph3d.VR=function(b){var m=this;m.gv=b,m._controllers=[],m.switch=new qr(m),m._enable=!1,m._defaultCallLater=z.Default.callLater,m._defaultCancelLater=ss,"undefined"!=typeof V&&"VRFrameData"in V&&(m._frameData=new V.VRFrameData),m.measureOflength=1,m.eyesOffset=[0,0,0],m._orientation=new z.Math.Quaternion,m._lastHeadPose=[0,0,0],m._offsetToBeAdd=[0,0,0],m._fpsInfo={time:0,fps:0,frames:0}};Jl(qj,W,{ms_fire:!0,_42:function(Z,c,e,g){var K=this,H=K.gv;if(!H.drawFilter&&K._deviceInAction){var J=K._device;if(J){var C=K._measureOflength;J.depthNear=H.getNear()*C,J.depthFar=H.getFar()*C;var o=K._offsetToBeAdd;if(K.eyesOffset[0]+=o[0],K.eyesOffset[1]+=o[1],K.eyesOffset[2]+=o[2],o[0]=0,o[1]=0,o[2]=0,J.isPresenting===!1)return K._controllers.forEach(function(Z){Z&&Z.update()}),H.iv(),!1;var h=K._frameData;J.getFrameData(h);var T=h.pose.position;if(T){var r=K.toViewPosition(T);H.setEye(r),K._orientation.fromArray(h.pose.orientation);var W=new z.Math.Vector3(0,0,-10*K._scaleFactor);W.applyQuaternion(K._orientation),H.setCenter([r[0]+W.x,r[1]+W.y,r[2]+W.z])}K._controllers.forEach(function(m){m&&m.update()}),H.setViewport(Z,0,0,c/2,e),K._viewMatrix=K._copyViewMatrix(h.leftViewMatrix),K._projectMatrix=K._copyProjectMatrix(h.leftProjectionMatrix),g(),H.setViewport(Z,c/2,0,c/2,e),K._viewMatrix=K._copyViewMatrix(h.rightViewMatrix),K._projectMatrix=K._copyProjectMatrix(h.rightProjectionMatrix),g(),K._lastViewMatrix=K._viewMatrix,K._lastProjectMatrix=K._projectMatrix,K._viewMatrix=null,K._projectMatrix=null,K.submitFrame();var n=Date.now(),f=K._fpsInfo;return n-f.time>1e3?(f.fps=Math.round(1e3*(f.frames+1)/(n-f.time)),f.time=n,f.frames=0):f.frames++,!0}}},onVRDisplayPresentChange:function(){var Z=this.isPresenting();this._injectGraphView(Z),this.fp("present",!Z,Z)},getOrientation:function(){return this._orientation},addController:function(k){k=k||0;var S=this,I=S.getController(k);return I?I:(I=new ce(S,k),S._controllers.push(I),I)},getController:function(J){J=J||0;for(var L=this._controllers,M=0,v=L.length;v>M;M++)if(L[M]&&L[M].id===J)return L[M];return null},removeController:function(u){u=u||0;for(var R=this._controllers,c=0,q=R.length;q>c;c++)if(R[c]&&R[c].id===u)return R.splice(c,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(P,k){var u=this,N=u._scaleFactor,q=u._eyesOffset,y=u._lastHeadPose;return y[0]=P[0]*N,y[1]=P[1]*N,y[2]=P[2]*N,k?(k[0]=y[0]+q[0],k[1]=y[1]+q[1],k[2]=y[2]+q[2],k):[y[0]+q[0],y[1]+q[1],y[2]+q[2]]},addEyesOffset:function(c,N,T){var V=this._offsetToBeAdd;V[0]+=c,V[1]+=N,V[2]+=T},_copyViewMatrix:function(N){var L=this.dup(N),B=this._scaleFactor;L[12]*=B,L[13]*=B,L[14]*=B;var Z=this._eyesOffset;if(Z&&(Z[0]||Z[1]||Z[2])){var g=Z[0],T=Z[1],Q=Z[2];L[12]-=L[0]*g+L[4]*T+L[8]*Q,L[13]-=L[1]*g+L[5]*T+L[9]*Q,L[14]-=L[2]*g+L[6]*T+L[10]*Q}return L},shutdown:function(){var F=this._device;F&&F.isPresenting&&F.exitPresent()},isPresenting:function(){var C=this._device;return C&&C.isPresenting},_copyProjectMatrix:function(A){var k=this.dup(A),n=this._scaleFactor;return k[14]*=n,k},dup:function(g,P){for(var h=g.length,F=P||new Array(h);h--;)F[h]=g[h];return F},getViewMatrix:function(O){var Z=this._viewMatrix;return Z?this.dup(Z,O):void 0},getProjectMatrix:function(){var r=this._projectMatrix;return r?this.dup(r):void 0},submitFrame:function(){var E=this;if(E._enable&&E._deviceInAction){var c=E._device;c&&c.isPresenting&&(c.submitFrame(),E.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(T){var A=this.gv;return A.intersectObjects(T,A.dm().getDatas())},setDevice:function(S){var Y=this;Y._device=S},_injectGraphView:function(){var i,P,V;return function(F){var W=this.gv;if(!F)return i&&(W.getWidth=i,W.getHeight=P,W.getDevicePixelRatio=V),void 0;var T=this._device,n=T.getEyeParameters("left"),S=n.renderWidth,g=n.renderHeight;i=W.getWidth,P=W.getHeight,V=W.getDevicePixelRatio,W.getWidth=function(){return 2*S},W.getHeight=function(){return g},W.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(U){var g=this;if(!U)return no=z.Default.callLater=g._defaultCallLater,ss=z.Default.cancelLater=g._defaultCancelLater,void 0;var g=this;no=z.Default.callLater=function(O,F,J,j){var v=g._device;return v&&v.isPresenting?j?p(function(){no(O,F,J)},j):v.requestAnimationFrame(function(){g._deviceInAction=!0,O.apply(F,J),g._deviceInAction=!1}):g._defaultCallLater(O,F,J,j)},ss=z.Default.cancelLater=function(n,e){var k=g._device;return k&&k.isPresenting?e?I(n):k.cancelAnimationFrame(n):g._defaultCancelLater(n,e)}}}),W.defineProperties(qj.prototype,{enable:{get:function(){return this._enable},set:function(J){var H=this;H._enable!==J&&(H._enable=J,J?(H.switch.showButton(),H._injectCallLaterFunc(!0)):(H.shutdown(),H.switch.hideButton(),H._injectCallLaterFunc(!1)),H.fp("enable",!J,J))}},measureOflength:{get:function(){return this._measureOflength},set:function(R){this._measureOflength=R;var Q=this._scaleFactor=1/R;this._controllers.forEach(function(f){f&&f._setScaleFactor(Q)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(k){this._eyesOffset=k}},controllerModel:{get:function(){return this._controllerModel},set:function(s){var p;"object"==typeof s?(p=s.mtl,s=s.obj):(p=s+".mtl",s+=".obj");var v=this,D=v._controllerModel;D&&D.obj===s&&D.mtl===p||(D=v._controllerModel={obj:s,mtl:p},Q.loadObj(s,p,{finishFunc:function(b,w){v._controllerModel===D&&Q.setShape3dModel("vrControllerModel",w)}}))}},interactive:{get:function(){return!!this._interactive},set:function(y){!!y!=!!this._interactive&&(this._interactive=y,y&&this.addController(0),this.gv.getCoreInteractor().enableVR(y))}}});var ce=function(o,q){function R(L){var R=navigator.getGamepads&&navigator.getGamepads();if(R)for(var e=0,m=0,V=R.length;V>e;e++){var i=R[e];if(i){var A=i.id;if("OpenVR Gamepad"===A||"OpenVR Controller"===A||0===A.indexOf("Oculus Touch")||0===A.indexOf("Spatial Controller")){if(m===L)return i;m++}}}}function D(H,b,E){return Math.abs(H[0]-b[0])<E&&Math.abs(H[1]-b[1])<E&&Math.abs(H[2]-b[2])<E?!0:!1}var a=this;a.vr=o,a.id=q;var F,I,X=[0,0],B=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],c=new Bj;c.s("shape3d","vrControllerModel"),c.isController=!0,c.s("intersect",!1),a.getGamepad=function(){return I},a.isButtonPressed=function(W){for(var I,H=0,h=B.length;h>H;H++)if(I=B[H],I.id===W)return I.pressed;return!1},a.getNode=function(){return c};var r=.003;a.setRotationEpsilon=function(M){r=M};var b=5e-4,L=b;a.setPositionEpsilon=function(n){b=n,L=n*a.vr._scaleFactor},a._setScaleFactor=function(n){c.s3(n,n,n),L=b*n},a._setScaleFactor(a.vr._scaleFactor);var T,K=new Hb,O=new re,x=[0,0,0],v=[0,0,0],V=new ds,g=new yj,j=new Cn;a.getRay=function(){return T?(j.origin.fromArray(x),j.direction.copy(g),T=!1,j):j},a.update=function(){if(F=I,I=R(q),F!=I&&console.log("gamepad changed",I),!I||I.pose===s)return I=null,c.s("3d.visible",!1),void 0;if(Q.getShape3dModel("vrControllerModel")){c.dm()||o.gv.dm().add(c),c.s("3d.visible",!0);var l=I.pose;if(null!==l){l.position&&(a.vr.toViewPosition(l.position,x),D(c.p3(),x,L)||(T=!0,c.p3(x))),l.orientation&&(K.fromArray(l.orientation),g.set(0,0,-1).applyQuaternion(K).normalize(),O.makeRotationFromQuaternion(K),V.set(0,0,0,c.getRotationMode(),!0).setFromRotationMatrix(O),v[0]=V.x,v[1]=V.y,v[2]=V.z,D(c.r3(),v,r)||(T=!0,c.r3(v))),T&&o.fp("gamepad.pose",null,{position:x,rotation:v,id:q});var E=I.axes;(X[0]!==E[0]||X[1]!==E[1])&&(X=[E[0],E[1]],o.fp("gamepad.axes",null,{id:q,axes:X}));var Y,M,e,j,G=I.buttons;for(Y=0,M=G.length;M>Y;Y++)if(e=G[Y],j=e.pressed,j!==B[Y].pressed){B[Y].pressed=j;var t={id:q},b="state";t[b]=t._62O=j?"down":"up",o.fp("gamepad.button."+B[Y].id,null,t)}}}}},qr=function(k){this.vr=k,this._button=null};Jl(qr,W,{showButton:function(){var V=this.assureButton();if(!V.parentNode){var l=this.vr.gv,e=l.getView();l._79O?e.insertBefore(V,l._79O):e.appendChild(V)}},hideButton:function(){var G=this._button;G&&G.parentNode&&G.parentNode.removeChild(G)},assureButton:function(){var i=this._button;return i?i:this._button=this.createButton(this.vr.gv)},createButton:function(d){function W(P,k){P.textContent=k&&k.isPresenting?" VR ":" VR "}function j(h){z.style.display="",z.style.cursor="pointer",z.style.left="calc(50% - 50px)",z.style.width="100px",W(z,h),z.onmouseenter=function(){z.style.opacity="1.0"},z.onmouseleave=function(){z.style.opacity="0.5"},z.onclick=function(){h.isPresenting?h.exitPresent():h.requestPresent([{source:d.getCanvas()}])},d.vr.setDevice(h)}function p(){z.style.display="",z.style.cursor="auto",z.style.left="calc(50% - 75px)",z.style.width="150px",W(z,null),z.onmouseenter=null,z.onmouseleave=null,z.onclick=null,d.vr.setDevice(null)}function w(T){T.style.position="absolute",T.style.bottom="20px",T.style.padding="12px 6px",T.style.border="1px solid #fff",T.style.borderRadius="4px",T.style.color="#000",T.style.font="normal 13px sans-serif",T.style.textAlign="center",T.style.opacity="0.5",T.style.outline="none",T.style.zIndex="999"}if("getVRDisplays"in navigator){var z=this._button=t.createElement("button");return z.style.display="none",w(z),V.addEventListener("vrdisplayconnect",function(r){j(r.display)},r),V.addEventListener("vrdisplaydisconnect",function(){p()},r),V.addEventListener("vrdisplaypresentchange",function(P){W(z,P.display),d.vr.onVRDisplayPresentChange()},r),navigator.getVRDisplays().then(function(Q){Q.length>0?j(Q[0]):p()
}),z}var A=t.createElement("a");return A.href="https://webvr.info",A.innerHTML=" webvr",A.style.left="calc(50% - 90px)",A.style.width="180px",A.style.textDecoration="none",w(A),A}}),W.defineProperties(qr.prototype,{});var Je=z.graph3d.PostProcessing=function(y){function v(){if(!f){var b=y.getGL();f=new Vn.RenderTarget(y,b,null,null,{samples:e.renderTextureSamples||1}),Z=new as.Shader(b,m.vs,m.fs),T=as.Buffer.createIndexBuffer(b,new Uint16Array([0,2,1,1,2,3])),k=as.Buffer.createVertexBuffer(b,new Float32Array([0,0,1,0,0,1,1,1]))}}var f,Z,T,k,r=this,s={},R=!1;!function(){W.keys(Je).forEach(function(u){s[u]=new Je[u](y)})}(),r.getModule=function(E){return E?s[E]:r},r.getModuleList=function(){return W.keys(s)},r.handleDataModleChange=function(B,u){B&&(B.setPostProcessingData(r.serialize()),B.removeSerializeListener(r.onDataModelSerialize,r)),u&&(u.addSerializeListener(r.onDataModelSerialize,r),r.deserialize(u.getPostProcessingData()))},r.onDataModelSerialize=function(t){"serialize"===t.type?y.dm()._postProcessingData=r.serialize():"deserialize"===t.type&&r.deserialize(y.dm().getPostProcessingData())},r.serialize=function(){var B,h,T,x={};for(B in s)h=s[B],x[B]={enable:h.enable},T=h.serializeProperties,T&&T.forEach(function(P){x[B][P]=h[P]});return x},r.deserialize=function(i){if(i){var P,D,H,n;for(P in i)if(D=s[P]){H=i[P],r.enableModule(P,H.enable);for(n in H)"enable"!==n&&(D[n]=H[n])}}else{var P,D;for(P in s)D=s[P],D.enable=!1,D.resetProperties&&D.resetProperties()}},r.decodeShader=function(c){var u,z,r,Q="",e="";for(r=0;r<c.length;r++)u=c[r],"%"===u?u="'":"a"===u?u='"':"]"===u&&(u="\\"),z=String.fromCharCode(u.charCodeAt(0)-1),r%2?e+=z:Q=z+Q;return e+Q},r.createShader=function(X,Y,A){var F=Y.indexOf("^#"),$=r.decodeShader(Y.substr(0,F)),i=r.decodeShader(Y.substr(F+2));if(A){var u=A($,i);u&&u.vs&&($=u.vs),u&&u.fs&&(i=u.fs)}return new as.Shader(X,$,i)},r.enableModule=function(J,S){var d,Z,E,z=J.split(",");for(d=0,Z=z.length;Z>d;d++)E=z[d].trim(),s[E]&&(s[E].enable=S);R=!1;for(E in s)if(s[E].enable){R=!0;break}R&&v()};var m={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};r._42=function(x,g,$,e,i){if(R&&!i){f.setSize(x,g,$),f.bind(x),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),y.setViewport(x,0,0,g,$),e(),f.unbind(x);var o,_=f;for(o in s)_=s[o]._42(x,_)||_;return y.setViewport(x,0,0,g,$),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),Z.bind(),x.activeTexture(x.TEXTURE0+0),x.bindTexture(x.TEXTURE_2D,_.texture),Z.uniforms.image=0,T.upload(),k.upload(),Z.attributes.pos.pointer(k),x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0),x.bindTexture(x.TEXTURE_2D,null),x.useProgram(y._prg),!0}}},qq=z.graph3d.PostProcessing.Bloom=function(q){function w(){var e=q.getWidth(),_=q.getHeight();if(e&&_){p=[e,_],N=!0;var G,R=q.getGL(),W=Math.round(p[0]/2),U=Math.round(p[1]/2);for(t=new Vn.RenderTarget(q,R,W,U),G=0;A>G;G++)Q.push(new Vn.RenderTarget(q,R,W,U)),g.push(new Vn.RenderTarget(q,R,W,U)),W=Math.round(W/2),U=Math.round(U/2);var T=q._postProcessing;l=T.createShader(R,qq._34Q);for(var G=0;A>G;G++)E[G]=T.createShader(R,qq._35Q,function(p,c){return{fs:c.replace(/DEFINE_VALUE/g,Z[G])}});O=T.createShader(R,qq._36Q,function(F,u){return{fs:u.replace(/NUM_MIPS/g,A)}}),d=T.createShader(R,qq.finalShader),c=as.Buffer.createIndexBuffer(R,new Uint16Array([0,2,1,1,2,3])),s=as.Buffer.createVertexBuffer(R,new Float32Array([0,0,1,0,0,1,1,1]))}}var m,J,K,c,s,T=this,M=!1,N=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){m=1.5,J=.55,K=.4},W.defineProperties(T,{enable:{get:function(){return M},set:function(F){!!M!=!!F&&(M=F,F&&!N&&w())}},strength:{get:function(){return m},set:function(e){m=e}},threshold:{get:function(){return J},set:function(n){J=n}},radius:{get:function(){return K},set:function(U){K=U}}}),this.resetProperties();var t,l,O,d,p=[256,256],Q=[],g=[],A=5,Z=[3,5,7,9,11],E=[];T._42=function(j,C){function v(G,i,B,d){Zf(j,i.frame),q.setViewport(j,0,0,i.width,i.height),d?d(j):j.clear(j.COLOR_BUFFER_BIT|j.DEPTH_BUFFER_BIT),_!==G&&G.bind();var E=0;for(var e in B){var p=B[e];p instanceof WebGLTexture&&(j.activeTexture(j.TEXTURE0+E),j.bindTexture(j.TEXTURE_2D,p),p=E,E++),G.uniforms[e]=p}for(_!==G&&(c.upload(),s.upload(),G.attributes.pos.pointer(s),_=G),j.drawElements(j.TRIANGLES,6,j.UNSIGNED_SHORT,0);E--;)j.activeTexture(j.TEXTURE0+E),j.bindTexture(j.TEXTURE_2D,null);Zr(j)}if(M){N||w();var _;v(l,t,{smoothWidth:.01,luminosityThreshold:J,tDiffuse:C.texture});var y,u=t,T=Math.round(p[0]/2),S=Math.round(p[1]/2);for(y=0;A>y;y++)v(E[y],Q[y],{colorTexture:u.texture,direction:[1,0],texSize:[T,S]}),v(E[y],g[y],{colorTexture:Q[y].texture,direction:[0,1],texSize:[T,S]}),T=Math.round(T/2),S=Math.round(S/2),u=g[y];return v(O,Q[0],{blurTexture1:g[0].texture,blurTexture2:g[1].texture,blurTexture3:g[2].texture,blurTexture4:g[3].texture,blurTexture5:g[4].texture,bloomStrength:m,bloomRadius:K,bloomTintColor:[1,1,1]}),v(d,C,{image:Q[0].texture},function(h){h.enable(h.BLEND),h.blendEquation(h.FUNC_ADD),h.blendFunc(h.SRC_ALPHA,h.ONE)}),j.blendEquationSeparate(j.FUNC_ADD,j.FUNC_ADD),j.blendFuncSeparate(j.SRC_ALPHA,j.ONE_MINUS_SRC_ALPHA,j.ONE,j.ONE_MINUS_SRC_ALPHA),C}}};qq._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",qq._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d1j/t2j!p-on!viTjuhiihqj!fgxm0pnbvuT<ftwvbgsgzjjeo)h5!dwffwd!3>!!wsVpwm<pDvhobjsgGp`smnh!t~bn<qxm!f+s!31E/!3d!p>m,p!snUvfTyuuivhsjff<xv<oxj!g+p!s*n3!fwmfqdn3b!tu!f,y!T2jf{mfq<nbvto)j!g>p,s!nn!vwTffdt3v!gegjjsefd<ucjhpso/<*u$fetfgggjPowfv!!L.F!SwOVFwM!`-SfBsEvJuVyTf!UEsFpGmJpOdF!`)WEB3MfVsFvu$yeffug!j>o!f3!fTmJqHnNbBt!!E4FdGfJwOF<`cWhBsM/V*FufgtmgpgbPuw!vh!b,v!twtVjwb!o-Qfesgv)ujyof!Ugsmppmbpud!!y)-E!3jfos!vgumypfbuu!!>t!j2hfnmbq*n!b|t!s4fdufvwso<!y1!/+4!:f9{:j5T!w+o!jf!y+q!)o!p.j1u/d6f!s+j!ey!!>+!!uyf0t)g!gtPjwhvn!b3!d+f!wtj<h*nbbn*h*j0Ttgj!h-nyb)<ge~Qowbpjjtet!vnbbhj!o>)!*x!!|ubwpfmdg3!<j*ojw)Tujb{pfm!g>!!>2!/y1!!u0b!pumfgyT|j!{*f!<,,g!mjp!b<uT!VgJTEjBhSn`bM!F>O!SgFmLp!b=u!)jT!J<H2N!B>*!<j!gumopjb!u)!sxpfgjh<inuvTTvuni!h>j!fhxb!v+t!tcjhbso/Q*ewgV)w1!/-1f-s!vguTyjfhUnsbp*m<pdw!f)dE43!fesjvgugyvftuf!T>v!n",qq._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",qq.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Ck=z.graph3d.PostProcessing.Dof=function(m){function q(){v=!0;var J=m.getGL();z=new Vn.RenderTarget(m,J),o=m._postProcessing.createShader(J,Ck._38Q),k=as.Buffer.createIndexBuffer(J,new Uint16Array([0,2,1,1,2,3])),E=as.Buffer.createVertexBuffer(J,new Float32Array([0,0,1,0,0,1,1,1]))}var z,o,k,E,j,R,d,H,u=this,O=!1,v=!1;this.serializeProperties="aperture,maxblur,image".split(","),this.resetProperties=function(){this.aperture=.025,this.maxblur=1,this.image=null},W.defineProperties(u,{enable:{get:function(){return O},set:function(i){!!O!=!!i&&(O=i,i&&!v&&q())}},image:{get:function(){return R},set:function(O){R!==O&&(R=O,j&&(m.getGL().deleteTexture(j),j=null),m.iv())}},maxblur:{get:function(){return d},set:function(s){d!==s&&(d=s,m.iv())}},aperture:{get:function(){return H},set:function(h){H!==h&&(H=h,m.iv())}}}),this.resetProperties(),u._42=function(h,s){function _(w,B,K,z){Zf(h,B.frame),m.setViewport(h,0,0,B.width,B.height),z?z(h):h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),n!==w&&w.bind();var f=0;for(var s in K){var C=K[s];C instanceof WebGLTexture&&(h.activeTexture(h.TEXTURE0+f),h.bindTexture(h.TEXTURE_2D,C),C=f,f++),w.uniforms[s]=C}for(n!==w&&(k.upload(),E.upload(),w.attributes.pos.pointer(E),n=w),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0);f--;)h.activeTexture(h.TEXTURE0+f),h.bindTexture(h.TEXTURE_2D,null);Zr(h)}if(O){v||q();var n;if(!j){var r=_c(this.image);if(!r||!r.tagName)return s;j=he(h,r)}var H=s.width,g=s.height;return z.setSize(h,H,g),_(o,z,{tColor:s.texture,tDepth:j,aspect:H/g,aperture:this.aperture,maxblur:this.maxblur}),z}}};Ck._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",Vp(Q,{accordionViewExpandIcon:ti(Zo),accordionViewCollapseIcon:ti(Zo,!0),accordionViewLabelColor:Pm,accordionViewLabelFont:wi,accordionViewTitleBackground:zb,accordionViewSelectBackground:Jo,accordionViewSelectWidth:3,accordionViewSeparatorColor:s,splitViewDividerSize:1,splitViewDividerBackground:zb,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Jd,rect:[2,2,12,12],background:Zo}]},propertyViewLabelColor:tl,propertyViewLabelSelectColor:Pm,propertyViewLabelFont:wi,propertyViewExpandIcon:ti(gp),propertyViewCollapseIcon:ti(gp,!0),propertyViewBackground:sh,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Dl,propertyViewColumnLineColor:Dl,propertyViewSelectBackground:Jo,listViewLabelColor:tl,listViewLabelSelectColor:Pm,listViewLabelFont:wi,listViewRowLineVisible:!1,listViewRowLineColor:Dl,listViewSelectBackground:Jo,treeViewLabelColor:tl,treeViewLabelSelectColor:Pm,treeViewLabelFont:wi,treeViewExpandIcon:ti(ki),treeViewCollapseIcon:ti(ki,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Dl,treeViewSelectBackground:Jo,treeViewDoubleClickToToggle:!0,tableViewLabelColor:tl,tableViewLabelSelectColor:Pm,tableViewLabelFont:wi,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Dl,tableViewColumnLineColor:Dl,tableViewSelectBackground:Jo,treeTableViewLabelColor:tl,treeTableViewLabelSelectColor:Pm,treeTableViewLabelFont:wi,treeTableViewExpandIcon:ti(ki),treeTableViewCollapseIcon:ti(ki,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Dl,treeTableViewColumnLineColor:Dl,treeTableViewSelectBackground:Jo,tableHeaderLabelColor:tl,tableHeaderLabelFont:wi,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Do,tableHeaderBackground:sh,tableHeaderMoveBackground:Oe,tableHeaderInsertColor:Jo,tableHeaderSortDescIcon:me(gp,!0),tableHeaderSortAscIcon:me(gp),tabViewTabGap:1,tabViewLabelColor:Pm,tabViewLabelFont:wi,tabViewTabBackground:zb,tabViewSelectWidth:3,tabViewSelectBackground:Jo,tabViewMoveBackground:Oe,tabViewInsertColor:Jo,toolbarLabelColor:tl,toolbarLabelSelectColor:Pm,toolbarLabelFont:wi,toolbarBackground:sh,toolbarSelectBackground:Jo,toolbarItemGap:8,toolbarSeparatorColor:zo},!0);var _f={translateX:1,sortColumn:1},eq={sortable:1,sortOrder:1,sortFunc:1},Qe={focusData:1},ad={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},bb={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Ah=function(s,k){k.add(s),s.hasChildren()&&s.eachChild(function(H){Ah(H,k)})},xq=function(L,J,G,s,n,A,U,E,W,q,P){var w,k=G.getValueType(q),x=G.getAlign(q);if(G.getEnumValues(q)){var F=G.toEnumLabel(J,q),t=qg||0,e=0,g=A,R=Q.getTextSize(s,F).width;return w=_c(G.toEnumIcon(J,q)),w&&(e=A+qg/2,"center"===x?e+=(E-(t+R))/2:"right"===x&&(e=e+E-(t+R)),Tp(L,w,e,U+W/2,q,P),g=e+qg/2),F!=N&&(w?Xn(L,F,s,n,g,U,E-(g-A),W):Xn(L,F,s,n,A,U,E,W,x)),void 0}return J=G.formatValue(J),J!=N?k===Sm?(Re(L,A,U,E,W,J),void 0):k===bk||!k&&jm(J)?(w=_c(J?Rh:Ar),Tp(L,w,A+E/2,U+W/2,q,P),void 0):(Xn(L,J,s,n,A,U,E,W,x),void 0):void 0},jk=function(f,$){var D=$.view,E=oh(f),p=$.column||$.property;D.getDataModel().beginTransaction(),$.editor=f,f.info=$,D.setCurrentEditor(f),D.getView().insertBefore(E,D._79O),Zd(f,$.editorRect),f.setFocus?f.setFocus():xg(f),f.commitValue=function(u,o){f._17Q&&(f=f._17Q),o||D.setValue($.data,p,f.getValue?f.getValue():f.value),f.close&&f.close(),Xr(E)},p.onEditorCreated&&p.onEditorCreated($)},Ql=function(R,C,I,V,u){var q=ik(R,I),m=C.value,c=C.view,E=u.getValueType(C.data);return q.onblur=q.onchange=function(){c.endEditing()},"input"===R?(m=u.formatValue(m),m!=N&&(q.value=m),q.onkeydown=function(s){ab(s)?c.endEditing():$i(s)&&c.endEditing(!0)},(E===Of||E===xe)&&q.addEventListener(Hh,Q.numberListener,r)):R===go&&V.forEach(function(W){var r=t.createElement("option");r.innerHTML=u.toEnumLabel(W),r.value=W,u.isEnumEqual(m,W)&&(r.selected=!0),Mo(q,r)}),jk(q,C),q},Ie=z.widget={},Ke=function(j,r,Q){Jl(k+".widget."+j,r,Q)};Vp(ec,{ms_value:function(I){I.getValue=function(o){var Y=this.getItemById(o),L=Y.element;return fh(L)?L:L?L.getValue?L.getValue():L.value:Y.selected},I.setValue=function(e,A){var u=this.getItemById(e);if(u){var o=u.element;o&&!fh(o)?o.setValue?o.setValue(A):o.value=A:jm(A)?(u.selected=A,this.iv()):(u.element=A,this.iv())}},I.v=function(w,j){var P=this;if(2===arguments.length)P.setValue(w,j);else{if(!yp(w))return P.getValue(w);for(var I in w)P.setValue(I,w[I])}return P}},_46o:function(k){k._icon=N,k._accessType=N,k._valueType=N,k._editable=!1,k._batchEditable=!0,k._align=pc,k._nullable=!0,k._emptiable=!1,k.setParent=jh,k.formatValue=function($){var F=this,e=F._valueType;return F.getEnumValues()?F.toEnumLabel($):e===bk?!!$:$!=N&&e===Of?O($):$},k.setEnum=function(L,D,y,i,u,o,$){var Y=this;L&&!pi(L)&&L.values&&(i=L.editable,y=L.icons,D=L.labels,u=L.strict,o=L.maxHeight,$=L.dropDownWidth,L=L.values),Cg(L)&&(L=L._as),Cg(D)&&(D=D._as),Cg(y)&&(y=y._as),Y._enumValues=L,Y._enumLabels=D,Y._enumIcons=y,Y._enumEditable=i,Y._enumStrict=u==N?!0:u,Y._enumMaxHeight=o,Y._enumDropDownWidth=$,L&&L.length&&vg(L[0])&&(Y._valueType=xe),Y.fp("enum",!1,!0)},k.getEnumDropDownWidth=function(){return this._enumDropDownWidth},k.getEnumMaxHeight=function(){return this._enumMaxHeight},k.isEnumEditable=function(){return this._enumEditable},k.getEnumValues=function(){return this._enumValues},k.getEnumLabels=function(){return this._enumLabels},k.getEnumIcons=function(){return this._enumIcons},k.isEnumStrict=function(){return this._enumStrict},k.isEnumEqual=function(b,d){return this._enumStrict?b===d:b==d},k.toEnumLabel=function(M,J){var U=this,S=U.getEnumValues(J),u=U.getEnumLabels(J);if(S&&u)for(var x=0;x<S.length;x++)if(U.isEnumEqual(M,S[x]))return u[x];return M},k.toEnumIcon=function(p,$){var l=this,m=l.getEnumValues($),u=l.getEnumIcons($);if(m&&u)for(var I=0;I<m.length;I++)if(l.isEnumEqual(p,m[I]))return u[I];return s}},_45o:function(Y){Y._87o=function(b,e,P,C,I,z){if(b){var Q=this,n=Q._90I,i=ko(1);Q._columnLineVisible&&(I-=1),Q._rowLineVisible&&(z-=1),0>=I||0>=z||(Q._90I||(n=Q._90I={}),n[e]||(n[e]=new cb),Zd(i,Q.tx()+P,Q.ty()+C,I,z),Mo(i,b),Q._view.insertBefore(i,Q._79O),b.onParentAdded&&b.onParentAdded(i),n[e].add(i))}},Y._76o=function(){var f=this,M=f._90I;if(M){for(var G in M)M[G].each(function(X){Xr(X)});delete f._90I}},Y._77o=function(E){var V=this;if(V._90I){var Y=V._90I[E];Y&&(Y.each(function(M){Xr(M)}),delete V._90I[E])}}},_47o:function(o){o.getValue=function(m,K){return K.getValue?K.getValue(m,K,this):od(m,K.getAccessType(),K.getName())},o.setValue=function(j,v,h){if(v.isEmptiable(j)||""!==h||(h=s),v.isNullable(j)||h!=N){var X=this,D=v.getName(j),B=v.getAccessType(j),G=v.getValueType(j);G===Of&&fh(h)?h=i(h):G===xe&&fh(h)?h=parseFloat(h):G===bk&&fh(h)&&(h="true"===h),X._batchEditable&&v._batchEditable&&X.isSelected(j)?X.sm().each(function(G){v.setValue?v.setValue(G,v,h,X):Pc(G,B,D,h)}):v.setValue?v.setValue(j,v,h,X):Pc(j,B,D,h)}},o.setCurrentEditor=function(D){this.endEditing(),this._currentEditor=D,this.redraw()},o.isEditing=function(a,l){var P=this,W=P._currentEditor;if(!W)return!1;if(l){var q=W.info;return q?(q.column||q.property)===l&&q.data===a:!1}return!0},o.endEditing=function(n){var w=this,s=w._currentEditor;s&&(delete w._currentEditor,s.commitValue&&s.commitValue(s.info,n),w.redraw(),w.getDataModel().endTransaction())},o.beginEditing=function(b){this.endEditing();var l=this,T=b.column||b.property;if(T.beginEditing)T.beginEditing(b);else{var x=b.data,t=b.value,O=l.getSelectBackground(x),H=T.getEnumValues(x),u=T.getSlider(x),c=T.getColorPicker(x);if(u){var _=Ii(Ie.Slider,u);return _.setValue(t),_.getView().onblur=function(){l.endEditing()},_.isInstant()&&(_.onValueChanged=function(){l.setValue(x,T,_.getValue())}),jk(_,b),void 0}if(c||T.getValueType(x)===Sm){var Z=Ii(Ie.ColorPicker,c);return Z.setValue(t),Z.onClosed=function(){l.endEditing()},Z.isInstant()&&(Z.onValueChanged=function(A,o){l.setValue(x,T,o)}),jk(Z,b),Z.open(),void 0}if(H){if(Ie.ComboBox){var s=new Ie.ComboBox;s.setValue(t),s.setValues(H),s.setLabels(T.getEnumLabels(x)),s.setIcons(T.getEnumIcons(x)),s.setEditable(T.isEnumEditable(x)),s.setStrict(T.isEnumStrict(x)),s.setMaxHeight(T.getEnumMaxHeight(x)),s.setDropDownWidth(T.getEnumDropDownWidth(x)),s.onClosed=function(){l.endEditing()},jk(s,b),s.open()}else Ql(go,b,O,H,T);return}var v=T.getValueType(x);if(v===bk||jm(t))return l.setValue(x,T,!t),void 0;if(T.getItemEditor(x)){var r=Co(T.getItemEditor(x)),i=new r(x,T,l,b),F=i.getView();return F._17Q=i,i.setValue(t),Kh(F),jk(F,b),i.editBeginning&&i.editBeginning(),void 0}Ql("input",b,O,N,T)}}},_44o:function(Z){Z.init=function(y){var R=this,l=R.th=new Kl(y),i=R._view=ge(1,R);R.tv=R._tableView=y,Mo(i,l.getView()),Mo(i,y.getView()),l.mp(function(E){E.property===Gr&&R.iv()}),R.iv()},Z.getTableView=function(){return this.tv},Z.getTableHeader=function(){return this.th},Z.getDataModel=function(){return this.tv.dm()},Z.getColumnModel=function(){return this.tv.getColumnModel()},Z.setColumns=function($){this.tv.setColumns($)},Z.addColumns=function(Y){this.tv.addColumns(Y)},Z.endEditing=function(){this.tv.endEditing()},Z.validateImpl=function(){var U=this,x=U.th,q=Ir(x),C={x:0,y:0,width:U.getWidth(),height:q};Zd(x,C),C.y=q,C.height=E(0,U.getHeight()-q),Zd(U.tv,C)}},ms_vs:function(A){A._41o=function(){return this._29I.height<this._59I},A._43o=function(){var _=this;_._41o()&&(_._58I||(p(function(){_._94O()},_i),_.iv()),_._58I=new Date)},A._94O=function(){var C=this;if(C._58I){var w=new Date;w.getTime()-C._58I.getTime()>=_i?(delete C._58I,C.iv()):p(function(){C._94O()},_i)}},A._93I=function(){var X=this,Y=X._27I;if(X._58I||!X._autoHideScrollBar){Y||Mo(X._79O,Y=X._27I=ko());var F=X._29I,O=F.height,q=X._59I,K=X.getScrollBarSize(),P=F.width-K-2,k=O*(-X.ty()/q),M=O*(O/q),m=Y.style;q>O?(Ym>M&&(k=k+M/2-Ym/2,0>k&&(k=0),k+Ym>O&&(k=O-Ym),M=Ym),m.visibility=Ti,m.background=X.getScrollBarColor(),m.borderRadius=K/2+Dm,Zd(Y,P,k,K,M)):m.visibility=Qm}else Y&&(Y.style.visibility=Qm)}},ms_hs:function(e){e._40o=function(){return this._29I.width<this._91I},e._42o=function(){var W=this;W._40o()&&(W._95O||(p(function(){W._94I()},_i),W.iv()),W._95O=new Date)},e._94I=function(){var v=this;if(v._95O){var a=new Date;a.getTime()-v._95O.getTime()>=_i?(delete v._95O,v.iv()):p(function(){v._94I()},_i)}},e._92I=function(){var g=this,K=g._28I;if(g._95O||!g._autoHideScrollBar){K||Mo(g._79O,K=g._28I=ko());var R=g._29I,G=R.width,N=g._91I,_=g.getScrollBarSize(),L=R.height-_-2,z=G*(-g.tx()/N),W=G*(G/N),s=K.style;N>G?(Ym>W&&(z=z+W/2-Ym/2,0>z&&(z=0),z+Ym>G&&(z=G-Ym),W=Ym),s.visibility=Ti,s.background=g.getScrollBarColor(),s.borderRadius=_/2+Dm,Zd(K,z,L,W,_)):s.visibility=Qm}else K&&(K.style.visibility=Qm)}}}),Gq(Rh,Ol(16,16,[{type:ah,rect:[1,1,14,14],background:Jo},{type:Lm,rect:[1,1,14,14],width:1,color:Pq},{type:Ri,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Gq(Ar,Ol(16,16,{type:Lm,rect:[1,1,14,14],width:1,color:Pq})),Gq(Hm,Ol(16,16,[{type:Pd,rect:[2,2,12,12],borderWidth:1,borderColor:Pq,background:"#FFF"},{type:Pd,rect:[4,4,8,8],background:Jo}])),Gq(jd,Ol(16,16,{type:Pd,rect:[2,2,12,12],borderWidth:1,borderColor:Pq})),ec._15Q=function(R){R._29I=nj,R._59I=0,R._91I=0,R._5o=function(p){var c=this;c._30I=new cb,c._rows=new cb,c._rowMap={},c._31I=0,c._14I=0,c._view=ge(1,c),c._canvas=Wq(c._view),Mo(c._view,c._79O=ko()),c.dm(p?p:new aj)},R.getCheckIcon=function(b){var d=this.sm(),Z=d.co(b);return d.sg()?_c(Z?Hm:jd):_c(Z?Rh:Ar)},R.checkData=function(l){var T=this.sm(),C=T.co(l);T.sg()&&C||(this._32o=1,C?T.rs(l):T.as(l),delete this._32o)},R.getDataAt=function(o){o.target&&(o=this.lp(o));var c=S(o.y/this._rowHeight),s=this._rows;return 0>c||c>=s.size()?N:s.get(c)},R.onDataDoubleClicked=function(){},R.onDataClicked=function(){},R.adjustTranslateX=function(){return 0},R.adjustTranslateY=function(K){var H=this.getHeight()-this._59I;return H>K&&(K=H),K>0?0:O(K)},R.onPropertyChanged=function(r){var n=this,_=r.property;ad[_]?n.ivm():Qe[_]||n.redraw(),_===hq?n._42o():_===yo&&n._43o()},R.getLabel=function(r){return r.toLabel()},R.getLabelFont=function(){return this._labelFont},R.getLabelColor=function(M){var D=this;if(D.isCheckMode()){if(D._focusData===M)return D._labelSelectColor}else if(D.isSelected(M))return D._labelSelectColor;return D._labelColor},R.getStartRowIndex=function(){return this._31I},R.getEndRowIndex=function(){return this._14I},R.getRowDatas=function(){return this._rows},R.getRowIndex=function(n){return this._rowMap[n._id]},R.getRowSize=function(){return this._rows.size()},R.getViewRect=function(){return kg(this._29I)},R.isVisible=function(j){return this._visibleFunc?this._visibleFunc(j):!0},R.getCurrentSortFunc=function(){return this._sortFunc},R.setDataModel=function(h){var p=this,S=p._dataModel,q=p._selectionModel;S!==h&&(S&&(S.umm(p.handleDataModelChange,p),S.umd(p.handleDataPropertyChange,p),S.umh(p.handleHierarchyChange,p),q||S.sm().ums(p.handleSelectionChange,p)),p._dataModel=h,h.mm(p.handleDataModelChange,p),h.md(p.handleDataPropertyChange,p),h.mh(p.handleHierarchyChange,p),q?q._21I(h):h.sm().ms(p.handleSelectionChange,p),p.fp("dataModel",S,h))},R.validateModel=function(){var X=this;X._rows.clear(),X._rowMap={},X.buildChildren(X._dataModel._roots);var N=X._rows=X._rows.toList(X.isVisible,X),M=0,J=X.getCurrentSortFunc(),k=N.size();for(J&&N.sort(J);k>M;M++)X._rowMap[N.get(M)._id]=M},R.buildChildren=function(G){var N=this;G.each(function(Z){N._rows.add(Z),N.buildChildren(Z._children)})},R.handleDataModelChange=function(){this.ivm()},R.handleDataPropertyChange=function(D){"parent"===D.property?this.ivm():this.invalidateData(D.data)},R.handleHierarchyChange=function(){this.ivm()},R.handleSelectionChange=function(c){c.datas.each(this.invalidateData,this),this.onSelectionChanged(c)},R.onSelectionChanged=function(V){var G=this,S=G.sm();!G.isAutoMakeVisible()||1!==S.size()||"set"!==V.kind&&"append"!==V.kind||G._32o||G.makeVisible(S.ld())},R.handleBackgroundClick=function(B){Gf(B)&&!this.isCheckMode()&&this.sm().cs()},R.makeVisible=function(T){T&&(this._23I=T,this.iv())},R.scrollToIndex=function(Q){var $=this,t=$._29I,I=t.height,u=$._rowHeight,Z=u*Q;Q>=0&&Q<$._rows.size()&&I>0&&(Z+u>t.y+I?$.ty(-Z+I-u):Z<t.y&&$.ty(-Z))},R.autoScroll=function(x,w){var G=this,K=G._rowHeight,H=K,Q=K/4,$=G._29I,I=G.lp(x),R={x:G.tx(),y:G.ty()};return K>0&&$&&(I.x-$.x<H?G.translate(Q,0):$.x+$.width-I.x<H&&G.translate(-Q,0),I.y-$.y<H?G.translate(0,Q):$.y+$.height-I.y<H&&G.translate(0,-Q)),R.x=G.tx()-R.x,R.y=G.ty()-R.y,w&&(w.x+=R.x,w.y+=R.y),R},R.getTopRowOrderSelection=function(){var i=this.sm().getTopSelection(),x={},r=new cb;return i.each(function(B){x[B._id]=B}),this._rows.each(function(q){x[q._id]&&r.add(q)}),r},R.getRowOrderSelection=function(){var s=new cb;return this._rows.each(function(z){this.isSelected(z)&&s.add(z)},this),s},R.ivm=function(){this.invalidateModel()},R.invalidateModel=function(){var d=this;d._96I||(d._96I=1,d._32I=1,delete d._24I),d.iv()},R.redraw=function(){var N=this;N._32I||(N._32I=1,delete N._24I,N.iv())},R.invalidateData=function(N){var W=this;xj?W.redraw():W._32I||(W._24I||(W._24I={}),W._24I[N._id]=N,W.iv())},R.getFocusData=function(){return this._focusData},R.setFocusDataById=function(P){this.setFocusData(this.dm().getDataById(P))},R.setFocusData=function(q){var K=this,_=K._focusData;_!==q&&(K._focusData=q,K.fp("focusData",_,q),_&&K.invalidateData(_),q&&(K.invalidateData(q),K.isAutoMakeVisible()&&K.makeVisible(q)))},R.drawRowBackground=function(q,O,F,g,n,G,r){var b=this,_=b.isCheckMode();(O===b._focusData&&_||F&&!_)&&Re(q,g,n,G,r,b.getSelectBackground(O))},R.drawData=function(F,Z,H){var J=this,R=J._rowHeight,t=R*H,D=J._29I,n=D.x,d=D.width;F.save(),F.beginPath(),F.rect(n,t,d,R),F.clip(),J._87o(J.drawRow(F,Z,J.isSelected(Z),n,t,d,R),H,n,t,d,R),F.restore(),J._rowLineVisible&&Re(F,n,t+R-1,d,1,J._rowLineColor)},R._12I=function(J){var v=this,d=v._31I,z=v._29I,Q=z.x,w=z.y,T=z.width,R=z.height;for(J.beginPath(),J.rect(Q,w,T,R),J.clip(),J.clearRect(Q,w,T,R),v._76o(),v._93db(J);d<v._14I;d++)v.drawData(J,v._rows.get(d),d);v._92db(J)},R._13I=function(m){for(var f,i=this,B=i._rowHeight,t=i._29I,M=t.x,v=t.width,n=i._31I,W=i._30I;n<i._14I;n++)f=i._rows.get(n),i._24I[f._id]&&W.add({data:f,index:n});W.isEmpty()||(m.beginPath(),W.each(function(P){m.rect(M,P.index*B,v,B)}),m.clip(),W.each(function(X){m.clearRect(M,X.index*B,v,B)}),W.each(function(w){i._77o(w.index)}),i._93db(m),W.each(function(Y){i.drawData(m,Y.data,Y.index)}),i._92db(m),W.clear())},R.preValidateModel=function(){this.endEditing&&this.endEditing()},R.validateImpl=function(){var L=this,$=L._canvas,W=L.getWidth(),F=L.getHeight(),g=L._rowHeight,i=L._32I;(W!==$.clientWidth||F!==$.clientHeight)&&(Rj($,W,F),i=1);var J=T&&!b;L._96I&&!J&&(L.preValidateModel(),L.validateModel());
var Y=L._29I,h={x:-L.tx(),y:-L.ty(),width:W,height:F},s=L._rows.size(),H=Lq($),I=L._23I;i||ve(h,Y)||(i=1),L._29I=h,L._59I=s*g+L.getScrollBarSize(),L._31I=S(h.y/g),L._14I=C((h.y+h.height)/g),L._31I<0&&(L._31I=0),L._14I>s&&(L._14I=s),L._99I&&i&&L._99I(),yq(H,L.tx(),L.ty(),1),i?L._12I(H):L._24I&&L._13I(H),L._93I(),L._92I(),H.restore(),L._32I=L._24I=L._96I=N,I&&(L.scrollToIndex(L.getRowIndex(I)),delete L._23I),L.tx(L.tx()),L.ty(L.ty())}},ec._48o=function(F){F._rootVisible=!0,F._rootData=N,F._35o=function(){this._expandMap={},this._levelMap={}},F.validateModel=function(){var S=this,r=S._rootData;S._rows.clear(),S._levelMap={},S._rowMap={},S._currentLevel=0,r?S._rootVisible?S.isVisible(r)&&S.buildData(r):S.buildChildren(r):S.buildChildren(),delete S._currentLevel},F.buildData=function(S){var U=this,j=S._id,O=U._rows;U._rowMap[j]=O.size(),O.add(S),U._levelMap[j]=U._currentLevel,U.isExpanded(S)&&(U._currentLevel++,U.buildChildren(S),U._currentLevel--)},F.buildChildren=function(k){var G=this,j=k?k._children:G._dataModel._roots,c=G.getCurrentSortFunc();c&&G.isChildrenSortable(k)?j.toList(G.isVisible,G).sort(c).each(G.buildData,G):j.each(function(K){G.isVisible(K)&&G.buildData(K)})},F.getLevel=function(J){return this._levelMap[J._id]},F.getToggleIcon=function(h){var T=this,k=T._loader,R=T._collapseIcon;return k&&!k.isLoaded(h)?R:h.hasChildren()?T.isExpanded(h)?T._expandIcon:R:N},F.isCheckMode=function(){return this._checkMode!=N},F.isChildrenSortable=function(){return!0},F.handleDataModelChange=function(_){var W=this;_.kind===Qp?delete W._expandMap[_.data._id]:_.kind===Nq&&(W._expandMap={}),W.ivm()},F.toggle=function(k){var f=this;f.isExpanded(k)?f.collapse(k):f.expand(k)},F.isExpanded=function(K){return 1===this._expandMap[K._id]},F.expand=function(R){var B=this,H=B._loader;B.isExpanded(R)||(H&&!H.isLoaded(R)&&H.load(R),B._expandMap[R._id]=1,B.ivm(),B.onExpanded(R))},F.onExpanded=function(){},F.collapse=function(P){var G=this;G.isExpanded(P)&&(delete G._expandMap[P._id],G.ivm(),G.onCollapsed(P))},F.onCollapsed=function(){},F.expandAll=function($){if($)this.expand($),$.eachChild(function(Z){this.expandAll(Z)},this);else{var X=this;X._dataModel.each(function(o){o.hasChildren()&&(X._expandMap[o._id]=1)}),X.ivm()}},F.collapseAll=function(){this._expandMap={},this.ivm()},F.makeVisible=function(Y){if(Y){var V=this;if(!V._rootData||Y.isDescendantOf(V._rootData)){for(var v=Y._parent;v;)V.expand(v),v=v._parent;V._23I=Y,V.iv()}}},F.checkData=function(v){var e,b=this,q=b._checkMode,l=b.sm(),D=l.co(v);if(!l.sg()||!D){if(b._32o=1,q===ro)D?l.rs(v):l.as(v);else if(q===vb)e=new cb(v),e.addAll(v._children);else if("descendant"===q)e=new cb,Ah(v,e);else if("all"===q&&(e=new cb,Ah(v,e),!D))for(var p=v._parent;p;)e.add(p),p=p._parent;e&&(D?l.rs(e):l.as(e)),delete b._32o}},F._97I=function(L,V,N,b,a,T,r){var k=this,Q=k._indent,U=k._levelMap[V._id],O=k.getIconWidth(V),x=_c(k.getToggleIcon(V));x?(b+=Q*U,Tp(L,x,b+Q/2,a+r/2,V,k),b+=Q):b+=Q*(U+1),k._checkMode&&(Tp(L,k.getCheckIcon(V),b+Q/2,a+r/2,V,k),b+=Q),k.drawIcon(L,V,b,a,O,r),k.drawLabel(L,V,b+O,a,r)}},ec._14Q=function(O){O.getIcon=function(m){return m.getIcon()},O.getIconWidth=function(b){return this.getIcon(b)?this._indent:0},O.drawIcon=function(u,R,r,G,c,b){if(c){var k=this,i=k.getBodyColor(R),D=_c(k.getIcon(R),i);D&&(b-=k.isRowLineVisible()?1:0,_n(u,D,Qo,r,G,c,b,R,k,i),Tj(u,k.getBorderColor(R),r,G,c,b))}},O.drawLabel=function(q,D,m,R,b){var I=this;Xn(q,I.getLabel(D),I.getLabelFont(D),I.getLabelColor(D),m,R,0,b)}},ec._50o=function(r){r._98I=function(){var D=this,$=D._39o=new aj;D._60I=new cb,$.mm(D._17o,D),$.md(D._18o,D),$.mh(D._19o,D)},r.setColumns=function(L){this._39o.clear(),this.addColumns(L)},r.addColumns=function(t){var T=this._39o;t.forEach(function(N){if(!(N instanceof $h)){var x=Co(N.className);N=Ii(x?x:$h,N)}T.add(N)})},r.onColumnClicked=function(){},r.onCheckColumnClicked=function(){},r._3Q=function(V){for(var n,d=0,g=this._60I,_=g.size();_>d;d++)if(n=g.get(d),n.column===V)return n;return N},r.getColumnAt=function(B){var Z=this._4Q(B);return Z?Z.column:N},r._4Q=function(V){for(var k=this,r=V.target?k.lp(V).x:V.x,A=k._60I,E=0;E<A.size();E++){var x=A.get(E),B=x.startX;if(r>=B&&r<B+x.column.getWidth())return x}return N},r.getToolTip=function(j){var F=this,s=F.getDataAt(j),k=F.getColumnAt(j);return s&&k?k.getToolTip(s,F):N},r.adjustTranslateX=function(u){var x=this.getWidth()-this._91I;return x>u&&(u=x),u>0?0:O(u)},r._99I=function(){var D=this,o=D._29I,b=D._60I;b.clear(),D._91I=0,D._39o._roots.each(function(k){if(k.isVisible()){var n=D._91I+k.getWidth();D._91I<=o.x+o.width&&n>=o.x&&b.add({column:k,startX:D._91I}),D._91I=n}}),D._91I+=D.getScrollBarSize()},r.drawData=function(R,A,H){var J=this,g=J._rowHeight,F=g*H,i=J.isSelected(A),K=J._29I,u=K.x,o=K.width;J.drawRowBackground(R,A,i,u,F,o,g),J._60I.each(function(m){var N=m.column,W=m.startX,G=N.getWidth();G>0&&!J.isEditing(A,N)&&(R.save(),R.beginPath(),R.rect(W,F,G,g),R.clip(),J._87o(J.drawCell(R,A,i,N,W,F,G,g),H,W,F,G,g),J._columnLineVisible&&Re(R,W+G-1,F,1,g,J._columnLineColor),R.restore())}),J._rowLineVisible&&Re(R,u,F+g-1,o,1,J._rowLineColor)},r.drawCell=function(m,P,x,F,o,S,H,t){var v=this;if(F.drawCell)return F.drawCell(m,P,x,F,o,S,H,t,v);var Z=v.getValue(P,F);xq(m,Z,F,v.getLabelFont(P,F,Z),v.getLabelColor(P,F,Z),o,S,H,t,P,v)},r.getColumnModel=function(){return this._39o},r._17o=function(){this.redraw()},r._18o=function(z){var T=this;z.data===T._sortColumn&&eq[z.property]?T.ivm():(T._42o(),T.redraw())},r._19o=function(){this.redraw()},r.getCurrentSortFunc=function(){var n=this,b=n._sortColumn;if(b&&b.isSortable()){var U=b.getSortFunc(),A=Io===b.getSortOrder()?1:-1;return U||(U=fp),function(R,s){return U.call(n,n.getValue(R,b),n.getValue(s,b),R,s)*A}}return n._sortFunc},r.isCellEditable=function(V,A,d){return A.isEditable()&&this.isEditable()?A.isCellEditable?A.isCellEditable(V,A,d,this):!0:!1},r._37O=function(h,y){if(Gf(y))for(var K=this,v=K.lp(y),P=K._60I,S=K._rowHeight,t=K._29I,l=t.x,X=t.y,s=t.width,C=t.height,f=0;f<P.size();f++){var g=P.get(f),Z=g.startX,J=g.column,E=J.getWidth();if(J!==K._31o&&J!==K._4o&&v.x>=Z&&v.x<Z+E&&K.isCellEditable(h,J,y)){var W={x:Z,y:K.getRowIndex(h)*S,width:E,height:S},A={x:W.x+K.tx(),y:W.y+K.ty(),width:W.width,height:W.height},p=0,u=0;return W.x<l?p=W.x-l:W.x+W.width>l+s&&(p=W.x+W.width-l-s),p&&(K.tx(K.tx()-p),A.x-=p),W.y<X?u=W.y-X:W.y+S>X+C&&(u=W.y+S-X-C),u&&(K.ty(K.ty()-u),A.y-=u),K.beginEditing({data:h,column:J,value:K.getValue(h,J),event:y,rect:W,editorRect:A,view:K}),void 0}}}},Ie.BaseItemEditor=function(o,Q,v,l){this._data=o,this._column=Q,this._master=v,this._editInfo=l},Ke("BaseItemEditor",W,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var bd=z.Tab=function(){oj(bd,this)};iq("Tab",Jn,{ms_ac:["view","closable","disabled","visible"],_icon:N,_closable:!1,_disabled:!1,_visible:!0,setParent:jh});var $h=z.Column=function(){oj($h,this)};iq("Column",Jn,{_46o:1,ms_ac:["accessType","valueType",Ti,yh,Oq,lf,"align",Sm,"sortOrder",Zi,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Io,_sortFunc:N,_sortable:!0,_clickable:!0,setWidth:function(v){16>v&&(v=16);var p=this._width;this._width=v,this.fp(lf,p,v)},getToolTip:function(W,t){return this.formatValue(t.getValue(W,this))}});var mm=z.Property=function(){oj(mm,this)};iq("Property",Jn,{_46o:1,ms_ac:["accessType","valueType",yh,Oq,"categoryName",Sm,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:N,getToolTip:function(x,o,X){var u=this;return o?u.formatValue(X.getValue(x,u)):X.getPropertyName(u)}}),Ie.AccordionView=function(){var q=this;q._20o={},q._21o=new cb,q._10o=N,q._9o=N,q._11o=N,q._view=ge(0,q),q.iv()},Ke("AccordionView",W,{ms_v:1,ms_fire:1,ms_ac:[tj,sc,"titleHeight",Oh,md,"titleBackground","selectWidth",En,"orientation","separatorColor"],_expandIcon:Q.accordionViewExpandIcon,_collapseIcon:Q.accordionViewCollapseIcon,_titleHeight:Ec,_labelColor:Q.accordionViewLabelColor,_labelFont:Q.accordionViewLabelFont,_titleBackground:Q.accordionViewTitleBackground,_selectBackground:Q.accordionViewSelectBackground,_selectWidth:Q.accordionViewSelectWidth,_orientation:"v",_separatorColor:Q.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(x,A,V,g){var O=this,h=ko();if(O._20o[x])throw x+" already exists";h.onmousedown=dc,h.style.cursor=Rc,h.addEventListener(Ab?Sg:mp,function(W){dc(W)},r),h.addEventListener(Ab?Bn:rn,function(g){dc(g),Gf(g)&&(O._10o===x?O.collapse():O.expand(x))},r),Mo(O._view,h),O._20o[x]={content:A,div:h,canvas:Wq(h),icon:g},O._21o.add(x),V&&O.expand(x),O.iv()},remove:function(y){var X=this,H=X._20o[y];H&&(Xr(H.div),delete X._20o[y],X._21o.remove(y),X.iv())},clear:function(){var h=this;h._21o.toArray().forEach(h.remove,h),h._20o={},h._21o.clear(),h.iv()},isExpanded:function(t){return this._10o===t},expand:function(z){var b=this;b._20o[z]&&b._10o!==z&&(b._10o=z,b.onExpanded(z),b.iv())},onExpanded:function(){},collapse:function(){var m=this;m._10o&&(m.onCollapsed(m._10o),delete m._10o,m.iv())},onCollapsed:function(){},initCanvas:function(a,Y,O){Rj(a,Y,O);var X=Lq(a);return yq(X,0,0,1),X.clearRect(0,0,Y,O),X},drawTitle:function(k,J,d,l,v){var g=this,z=_c(v.icon),Y=g.isExpanded(J),L=g._titleHeight,x=g._titleBackground,N=g._selectWidth,V=g._separatorColor,E=_c(Y?g._expandIcon:g._collapseIcon),F=N+4;Re(k,0,0,d,l,x),Y&&N&&Re(k,0,0,N,l,g._selectBackground),(Y||g._21o.get(g._21o.size()-1)!==J)&&Re(k,0,l-1,d,1,V?V:Qi(x)),z&&(Tp(k,z,F+Uj(z)/2,L/2),F+=Uj(z)+2),Xn(k,J,g.getLabelFont(J),g.getLabelColor(J),F,0,0,L),E&&Tp(k,E,d-Uj(E)/2-4,L/2)},validateImpl:function(){var T=this,n=T._view,B=0,$=0,Q=T.getWidth(),O=T.getHeight(),z=T._titleHeight,m=T._21o.size()*z,X=T._11o,q=T._9o;delete T._11o,delete T._9o,T._21o.each(function(x){var a,i,j=T._20o[x],L=j.content,U=T._10o===x;Le(T)?(Zd(j.div,B,0,z,O),a=T.initCanvas(j.canvas,z,O),lj(a,0,O),ne(a,-G),T.drawTitle(a,x,O,z,j),a.restore(),U?(i=E(0,Q-m),L&&(T._11o=L,T._9o=oh(L),Zd(L,B+z,0,i,O)),B+=z+i):B+=z):(Zd(j.div,0,$,Q,z),a=T.initCanvas(j.canvas,Q,z),T.drawTitle(a,x,Q,z,j),a.restore(),U?(i=E(0,O-m),L&&(T._11o=L,T._9o=oh(L),Zd(L,0,$+z,Q,i)),$+=z+i):$+=z)});var l=T._9o;X&&X!==T._11o&&X.endEditing&&X.endEditing(),l&&l!==q&&Mo(n,l),q&&q!==l&&Xr(q)}}),Ie.SplitView=function(E,$,f,m){var X=this,C=X._dividerDiv=ko(),w=X._60O=Wq(),M=X._61O=Wq(),o=w.style,K=M.style;X._view=ge(1,X),Mo(X._view,C),o.msTouchAction=Eb,o.pointerEvents=Eb,o.cursor=Rc,K.msTouchAction=Eb,K.pointerEvents=Eb,K.cursor=Rc,E&&X.setLeftView(E),$&&X.setRightView($),f&&X.setOrientation(f),m!=N&&X.setPosition(m),X.setStatus(Ue),new Kr(X)},Ke("SplitView",W,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:Q.splitViewDividerSize,_dividerBackground:Q.splitViewDividerBackground,_dragOpacity:Q.splitViewDragOpacity,_toggleIcon:Q.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(m,_){var y=this,F=y._position;isNaN(m)||(_||(y._82O=0>m?-1:m>1?1:0),y._position=m,y.fp(Jh,F,m))},getLeftView:function(){return this._leftView},setLeftView:function(d){var K=this,z=K._leftView,o=K._view;if(K._leftView!==d){if(z&&z!==K._rightView){var m=oh(z);m.parentNode===o&&Xr(m)}if(K._leftView=d,d){var p=oh(d);p.parentNode!==o&&o.insertBefore(p,K._dividerDiv)}K.fp("leftView",z,d)}},getRightView:function(){return this._rightView},setRightView:function(D){var u=this,x=u._rightView,X=u._view;if(u._rightView!==D){if(x&&x!==u._leftView){var W=oh(x);W.parentNode===X&&Xr(W)}if(u._rightView=D,D){var w=oh(D);w.parentNode!==X&&X.insertBefore(w,u._dividerDiv)}u.fp("rightView",x,D)}},validateImpl:function(){var n=this,A=n._draggable,Y=n._position,d=n.getWidth(),B=n.getHeight(),V=n._dividerSize,C=n._dividerBackground,e=Ab?18:8,J=n._dividerDiv,l=n._82O,D=n._60O,P=n._61O,x=n._toggleIcon,R=n._status,q=J.style,Z=null,Q=Ab?20:4,k=x.comps[0];V>=e||0===V?n._coverDiv&&(Xr(n._coverDiv),delete n._coverDiv):n._coverDiv||(n._coverDiv=ko(),pb&&(n._coverDiv.style.background=We),Mo(J,n._coverDiv)),n._togglable?D.parentNode||(Mo(J,D),Mo(J,P)):(Xr(D),Xr(P));var F=n._coverDiv,L=n._leftView,y=n._rightView;if(Le(n)){if(V>d&&(V=d),R===Ue)if(1===l)var X=h(Y,d),s=E(0,d-V-X);else-1===l?(s=h(-Y,d),X=E(0,d-V-s)):(X=O((d-V)*Y),s=E(0,d-V-X));else"cl"===R?(X=0,s=E(0,d-V)):"cr"===R&&(s=0,X=E(0,d-V));L&&Zd(L,0,0,X,B),y&&Zd(y,X+V,0,s,B),Zd(J,X,0,V,B),n._22o=X,F&&(Zd(F,V/2-e/2,0,e,B),F.style.cursor=A?bo:""),J.style.cursor=A?bo:"";var $=J.clientHeight/2,N=J.clientWidth;Rj(D,N,N),Zd(D,0,$-N-Q,N,N),Z=Lq(D),yq(Z,0,0,1),k.rotation=-G,Kp(Z,x,0,0,N,N),Z.restore(),Rj(P,N,N),Zd(P,0,$+Q,N,N),Z=Lq(P),yq(Z,0,0,1),k.rotation=G,Kp(Z,x,0,0,N,N),Z.restore()}else{if(V>B&&(V=B),R===Ue)if(1===l)var b=h(Y,B),g=E(0,B-V-b);else-1===l?(g=h(-Y,B),b=E(0,B-V-g)):(b=O((B-V)*Y),g=E(0,B-V-b));else"cl"===R?(b=0,g=E(0,B-V)):"cr"===R&&(g=0,b=E(0,B-V));L&&Zd(L,0,0,d,b),y&&Zd(y,0,b+V,d,g),Zd(J,0,b,d,V),n._22o=b,F&&(Zd(F,0,V/2-e/2,d,e),F.style.cursor=A?gr:""),q.cursor=A?gr:"";var u=J.clientWidth/2,N=J.clientHeight;Rj(D,N,N),Zd(D,u-N-Q,0,N,N),Z=Lq(D),yq(Z,0,0,1),k.rotation=0,Kp(Z,x,0,0,N,N),Z.restore(),Rj(P,N,N),Zd(P,u+Q,0,N,N),Z=Lq(P),yq(Z,0,0,1),k.rotation=f,Kp(Z,x,0,0,N,N),Z.restore()}q.background=C}});var Kr=function(t){this.sv=t,this.addListeners()};Jl(Kr,W,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(I){var r=this,z=r.sv,e=z._dividerDiv,V=z._60O,d=z._61O,A=z._status,h=I.target;if(h===V)A===Ue?z.setStatus("cl"):"cr"===A&&z.setStatus(Ue);else if(h===d)A===Ue?z.setStatus("cr"):"cl"===A&&z.setStatus(Ue);else if(dm(I)&&(h===e||h===z._coverDiv)&&(dc(I),z.isDraggable())){z.getLeftView(),z.getRightView();var t=r.maskDiv=ko();if(t.style.left=0,t.style.top=0,t.style.width=z.getWidth()+"px",t.style.height=z.getHeight()+"px",z.getView().appendChild(t),!z.isContinuousLayout()){var M=r.resizeDiv=ko();M.style.left=e.style.left,M.style.top=e.style.top,M.style.width=e.style.width,M.style.height=e.style.height,M.style.opacity=z.getDragOpacity(),M.style.background=z.getDividerBackground(),Mo(r.getView(),M)}r._lastAbsPosition=z._22o,r._86o=Le(z)?Bb(I).x:Bb(I).y,pp(r,I)}},handleWindowTouchMove:function($){dm($)&&this.update($,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(a){var X=this;X.update(a,!0),X.sv.setStatus(Ue),X.maskDiv&&Xr(X.maskDiv),X.resizeDiv&&Xr(X.resizeDiv),X.maskDiv=X.resizeDiv=N},handle_mousedown:function(P){Gf(P)&&this.handle_touchstart(P)},handleWindowMouseMove:function(T){this.handleWindowTouchMove(T)},handleWindowMouseUp:function(d){this.handleWindowTouchEnd(d)},update:function(F,J){var U=this,c=U.sv,k=Le(c)?c.getWidth():c.getHeight(),Z=c._dividerSize,g=U._lastAbsPosition-U._86o;Le(c)?(g+=Bb(F).x,g>k-Z&&(g=k-Z),0>g&&(g=0),U.resizeDiv&&(U.resizeDiv.style.left=g+Dm)):(g+=Bb(F).y,g>k-Z&&(g=k-Z),0>g&&(g=0),U.resizeDiv&&(U.resizeDiv.style.top=g+Dm)),J&&k!==Z&&(1===c._82O?c.setPosition(g,1):-1===c._82O?c.setPosition(g-k+Z,1):c.setPosition(g/(k-Z),1))}}),Ie.TabView=function(){var z=this,F=z._view=ge(1,z),$=z._91O=ko(1),Z=z._tabModel=new aj,u=Z.sm(),l=z.invalidate;z._7o=new cb,z._canvas=Wq($),Mo(F,$),Mo(F,z._92O=ko(1)),u.setSelectionMode(gd),u.ms(z.handleSelectionChange,z),Z.mm(l,z),Z.mh(l,z),Z.md(l,z),z._interactor=new bq(z),z.iv()},Ke("TabView",W,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Oh,md,"tabBackground","selectWidth",En,"moveBackground","insertColor"],_tabPosition:_m,_tabHeight:Ec,_tabGap:Q.tabViewTabGap,_labelColor:Q.tabViewLabelColor,_labelFont:Q.tabViewLabelFont,_tabBackground:Q.tabViewTabBackground,_selectWidth:Q.tabViewSelectWidth,_selectBackground:Q.tabViewSelectBackground,_moveBackground:Q.tabViewMoveBackground,_insertColor:Q.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(I,t,B){var i,Y=this._tabModel;return I instanceof bd?(i=I,t&&i.setView(t)):(i=new bd,i.setName(I),i.setView(t)),Y.add(i),B&&Y.sm().ss(i),i},getLabel:function(f){return f.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(G){this._23o=G,this.iv()},get:function(h){var d=this,p=d._tabModel;if(vg(h))return p._roots.get(h);if(fh(h)){var b;return p.each(function(m){h===d.getLabel(m)&&(b=m)}),b}return h instanceof bd?h:N},select:function($){this._tabModel.sm().ss(this.get($))},remove:function(B){var f=this;if(B=f.get(B)){var R=f._tabModel,r=R._roots.indexOf(B);f._tabModel.remove(B),f.selectByIndex(--r)}},getCurrentTab:function(){return this._8o},hideTabView:function(v,h){h.parentNode===this._92O&&(Hq(h)?(h.style.display=vj,h._tab_=v):Xr(h),Fc())},showTabView:function($,K){Hq(K)&&(K.style.display="block",K._tab_=$),K.parentNode!==this._92O&&(Mo(this._92O,K),Fc())},_24o:function(){var u,n=this,a=n._8o,$=n._9o,C=n._tabModel.sm().ld();C&&(u=oh(C.getView())),u!==$&&($&&(a.getView()&&a.getView().endEditing&&a.getView().endEditing(),n.hideTabView(a,$)),u&&n.showTabView(C,u)),n._8o=C,n._9o=u,a!==C&&n.onTabChanged(a,C)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(f,n){this.selectByIndex(--n)},selectByIndex:function(Y){var u=this,z=u._tabModel,w=z.size();if(w&&!z.sm().ld()){Y==N&&(Y=0),Y>=w&&(Y=w-1),0>Y&&(Y=0);for(var J=Y;J>=0;J--){var L=u.get(J);if(!L.isDisabled())return u.select(L),L}for(J=Y+1;w>J;J++)if(L=u.get(J),!L.isDisabled())return u.select(L),L}},getTabWidth:function(z){var i=4,C=_c(z.getIcon());C&&(i+=Uj(C,z)+4);var m=this.getLabel(z);return m&&(i+=Tn(this.getLabelFont(z),m).width+4),z.isClosable()&&(i+=10),i},drawTab:function(M,n,B,T,k,U,K){var e,P=this,u=P._tabPosition,N=B+4,d=P._selectWidth,p=_c(n.getIcon()),D=n.isDisabled(),Q=P.getLabelColor(n),F=P.getLabelFont(n),E=P.getLabel(n),b=P._selectBackground,l=u===pc+"-vertical",L=u===hl+"-vertical";(l||L)&&(N=T+4),D&&(M.globalAlpha=Fj),Re(M,B,T,k,U,K),n===P._8o&&d&&(u===_m?Re(M,B,T+U-d,k,d,b):u===pc?Re(M,B+k-d,T,d,U,b):u===hl?Re(M,B,T,d,U,b):l?Re(M,B+k-d,T,d,U,b):L?Re(M,B,T,d,U,b):Re(M,B,T,k,d,b));var W=k/2;if(l&&(lj(M,W,T+U/2),ne(M,f),lj(M,-W,-T-U/2)),p){var v=dg(p,n),h=Uj(p,n);if(l||L){var R=B+k/2,J=N+v/2;lj(M,R,J),ne(M,G),lj(M,-R,-J),Tp(M,p,B+k/2,N+v/2,n,P),lj(M,R,J),ne(M,-G),lj(M,-R,-J),N+=v+4}else Tp(M,p,N+h/2,T+U/2,n,P),N+=h+4}return l||L?(lj(M,k/2,N+k/2),ne(M,G),lj(M,-k/2,-N-k/2),Xn(M,E,F,Q,B,N,U,k),lj(M,k/2,N+k/2),ne(M,-G),lj(M,-k/2,-N-k/2)):Xn(M,E,F,Q,N,T,k,U),l&&(lj(M,W,T+U/2),ne(M,-f),lj(M,-W,-T-U/2)),n.isClosable()&&(e=L?{x:B+k-12,y:T+U-12,width:12,height:12}:{x:B+k-12,y:T+2,width:12,height:12},this.drawCloseIcon(n,M,Q,e)),D&&(M.globalAlpha=1),e},drawCloseIcon:function(h,K,q,G){var M=G.x,n=G.y;K.strokeStyle=q,K.lineWidth=1,K.beginPath(),K.moveTo(M+2,n+8),K.lineTo(M+8,n+2),K.moveTo(M+8,n+8),K.lineTo(M+2,n+2),K.stroke()},getTabAt:function(s){var H=this._interactor._8Q(s);return H?H.tab:null},validateImpl:function(){var M=this;M._24o();var Y,x=M._canvas,Z=M._tabPosition,O=M._91O,h=M._92O,A=M._tabModel,j=M.getWidth(),_=M.getHeight(),l=M._tabHeight,C=M._7o,V=M._tabGap,S=Z===_m,F=Z===pc,v=Z===hl,B=Z===pc+"-vertical",I=Z===hl+"-vertical",W=M._23o,d=0;if((F||v)&&A._roots.each(function(F){d=E(M.getTabWidth(F),d)}),S?(Zd(O,0,0,j,l),Y={x:0,y:l,width:j,height:E(0,_-l)}):F?(Zd(O,0,0,d,_),Y={x:d,y:0,width:E(0,j-d),height:_}):v?(Zd(O,j-d,0,d,_),Y={x:0,y:0,width:E(0,j-d),height:_}):B?(Zd(O,0,0,l,_),Y={x:l,y:0,width:E(0,j-l),height:_}):I?(Zd(O,j-l,0,l,_),Y={x:0,y:0,width:E(0,j-l),height:_}):(Zd(O,0,_-l,j,l),Y={x:0,y:0,width:j,height:E(0,_-l)}),Zd(h,Y),B||I){M._9o&&(Y.x=0,Zd(M._8o.getView(),Y)),Rj(x,l,_);var D=Lq(x),J=0;if(yq(D,0,M.ty(),1),D.clearRect(0,0,l,_),C.clear(),A._roots.each(function(d){if(d.isVisible()){var T,k=M.getTabWidth(d);W&&W.tab===d||(T=M.drawTab(D,d,0,J,l,k,M._tabBackground)),C.add({_75o:T,tab:d,startY:J,endY:J+k,height:k}),J+=k+V}}),M._23Q=E(0,J-V),W){var f=W.position;M.drawTab(D,W.tab,0,W.startY,l,W.height,M._moveBackground),Re(D,0,f,l,1,M._insertColor)}if(D.restore(),M._selectionChanged){M._selectionChanged=!1;for(var i=M.ty(),N=0;N<C.size();N++){var K=C.get(N);if(K.tab===M._8o){if(K.endY+i<0){M.ty(-K.startY);break}if(K.startY+i>_){M.ty(_-K.endY);break}}}}M.ty(M.ty())}else if(F||v){M._9o&&(Y.x=0,Zd(M._8o.getView(),Y)),Rj(x,d,_);var D=Lq(x),J=0;if(yq(D,0,M.ty(),1),D.clearRect(0,0,d,_),C.clear(),A._roots.each(function(e){if(e.isVisible()){var t;W&&W.tab===e||(t=M.drawTab(D,e,0,J,d,l,M._tabBackground)),C.add({_75o:t,tab:e,startY:J,endY:J+l,height:l}),J+=l+V}}),M._23Q=E(0,J-V),W){var f=W.position;M.drawTab(D,W.tab,0,W.startY,d,W.height,M._moveBackground),Re(D,0,f,d,1,M._insertColor)}if(D.restore(),M._selectionChanged){M._selectionChanged=!1;for(var i=M.ty(),N=0;N<C.size();N++){var K=C.get(N);if(K.tab===M._8o){if(K.endY+i<0){M.ty(-K.startY);break}if(K.startY+i>_){M.ty(_-K.endY);break}}}}M.ty(M.ty())}else{M._9o&&(Y.y=0,Zd(M._8o.getView(),Y)),Rj(x,j,l);var D=Lq(x),e=0;if(yq(D,M.tx(),0,1),D.clearRect(0,0,j,l),C.clear(),A._roots.each(function(d){if(d.isVisible()){var N,g=M.getTabWidth(d);W&&W.tab===d||(N=M.drawTab(D,d,e,0,g,l,M._tabBackground)),C.add({_75o:N,tab:d,startX:e,endX:e+g,width:g}),e+=g+V}}),M._64I=E(0,e-V),W){var f=W.position;M.drawTab(D,W.tab,W.startX,0,W.width,l,M._moveBackground),Zj(D,M._insertColor,f,0,l)}if(D.restore(),M._selectionChanged){M._selectionChanged=!1;for(var g=M.tx(),N=0;N<C.size();N++){var K=C.get(N);if(K.tab===M._8o){if(K.endX+g<0){M.tx(-K.startX);break}if(K.startX+g>j){M.tx(j-K.endX);break}}}}M.tx(M.tx())}for(var a=[],G=h.children,N=0;N<G.length;N++){var o=G[N],X=o._tab_;X&&!A.contains(X)&&a.push(o)}a.forEach(function(Q){h.removeChild(Q)})}});var bq=function(d){this.tv=d,this.addListeners()};Jl(bq,W,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(E){this.handleScroll(E,10*(E.wheelDelta/40))},handle_DOMMouseScroll:function(m){this.handleScroll(m,10*-m.detail)},handleScroll:function(r,y){dc(r);var S=this.tv,F=S._tabPosition;!S._40o()||F!==_m&&F!==Jr||S.tx(this.tv.tx()+y),!S._41o()||F!==pc&&F!==hl&&F!==pc+"-vertical"&&F!==hl+"-vertical"||S.ty(this.tv.ty()+y)},_8Q:function(K){var j,Z,k=this.tv,q=k._tabPosition,W=k._7o;if(q===_m||q===Jr){var y=k.lp(K).x;for(j=0;j<W.size();j++)if(Z=W.get(j),Z.startX<=y&&y<=Z.endX)return Z}else if(q===pc||q===hl||q===pc+"-vertical"||q===hl+"-vertical"){var d=k.lp(K).y;for(j=0;j<W.size();j++)if(Z=W.get(j),Z.startY<=d&&d<=Z.endY)return Z}return N},isClickable:function(K){var v=this.tv,_=v._tabPosition,W=this._73o=this._8Q(K);return!v._40o()||_!==_m&&_!==Jr?!v._41o()||_!==pc&&_!==hl&&_!==pc+"-vertical"&&_!==hl+"-vertical"?W&&(!W.tab.isDisabled()||v.isMovable()):!0:!0},handle_mousemove:function(J){var H=this;Xe?H._74o=H._8Q(J):H.getView().style.cursor=H.isClickable(J)?Rc:""},handle_mousedown:function(e){this.handle_mousemove(e),this.handle_touchstart(e)},handle_touchstart:function(y){var Y=this,L=Y.tv,v=L._tabPosition;dc(y),Gf(y)&&Y.isClickable(y)&&(v===_m||v===Jr?(Y.x=Bb(y).x,Y.lp=L.lp(y),Y.tx=L.tx()):(Y.y=Bb(y).y,Y.lp=L.lp(y),Y.ty=L.ty()),pp(Y,y))},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(W){var A,q=this,B=q.tv,g=B._tabPosition,a=q._73o;if(g===_m||g===Jr){if(A=Bb(W).x-q.x,!q._25o&&!q.moving&&c(A)>2&&(B._40o()&&!Vi(W)?q._25o=1:a&&B.isMovable()&&(q.moving=1)),q._25o)B.tx(q.tx+A);else if(q.moving){var Z=q.lp.x+A,v=B._tabGap/2;B._7o.each(function($){var x=$.endX,j=Z-$.startX<x-Z;Z>=$.startX&&x>=Z&&B._7Q({tab:a.tab,startX:a.startX+A,width:a.width,front:j,insertTab:$.tab,position:j?E(0,$.startX-v):h(B._64I,x+v)})})}}else if(A=Bb(W).y-q.y,!q._25o&&!q.moving&&c(A)>2&&(B._41o()&&!Vi(W)?q._25o=1:a&&B.isMovable()&&(q.moving=1)),q._25o)B.ty(q.ty+A);else if(q.moving){var G=q.lp.y+A,v=B._tabGap/2;B._7o.each(function(g){var S=g.endY,b=G-g.startY<S-G;G>=g.startY&&S>=G&&B._7Q({tab:a.tab,startY:a.startY+A,height:a.height,front:b,insertTab:g.tab,position:b?E(0,g.startY-v):h(B._23Q,S+v)})})}},handleWindowMouseUp:function(w){this.handleWindowTouchEnd(w)},handleWindowTouchEnd:function(){var o=this,O=o.tv,A=O._tabPosition,g=O.getTabModel(),v=g._roots,f=o._73o;if(o.moving){var b=O._23o;if(b&&b.insertTab!==b.tab){var P=b.tab,r=v.remove(P),E=v.indexOf(b.insertTab);E>=0&&(b.front||E++,E<=v.size()&&(v.add(P,E),g._38I(P,r,E)))}O._7Q(N),delete o.moving}else if(!o._25o&&f){P=f.tab;var q=o._74o;if(!q||q.tab===P)if(!P.isDisabled()&&Fr(f._75o,o.lp)){var w=function(){var A=v.indexOf(P);g.remove(P),O.onTabClosed(P,A)};O.onTabClosing(P,w)&&w()}else P.isDisabled()||O._8o===P||g.sm().ss(P)}o._25o=o._73o=o._74o=A===_m||A===Jr?o.x=o.lp=o.tx=N:o.y=o.lp=o.ty=N}}),Ie.PropertyView=function(D){var M=this;M._view=ge(1,M),M._canvas=Wq(M._view),Mo(M._view,M._79O=ko()),M._rows=new cb,M._28o=new cb,M._26o={},M._26Q={};var i=M._propertyModel=new aj,b=M.ivm;i.mm(b,M),i.md(b,M),i.mh(b,M),M.dm(D?D:new aj),new rg(M)},Ke("PropertyView",W,{ms_ac:[Oh,Yb,md,yh,Oq,"categorizable",Bk,Zi,Cq,tj,sc,cl,nl,gg,"selectRowIndex",En,"background",pf,Bo,Si,Wc,cd],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:nj,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:qg,_background:Q.propertyViewBackground,_expandIcon:Q.propertyViewExpandIcon,_collapseIcon:Q.propertyViewCollapseIcon,_scrollBarColor:ap,_scrollBarSize:Xf,_autoHideScrollBar:Cr,_selectBackground:Q.propertyViewSelectBackground,_rowHeight:Lh,_rowLineVisible:Q.propertyViewRowLineVisible,_rowLineColor:Q.propertyViewRowLineColor,_10I:.5,_columnLineVisible:Q.propertyViewColumnLineVisible,_columnLineColor:Q.propertyViewColumnLineColor,_labelColor:Q.propertyViewLabelColor,_labelSelectColor:Q.propertyViewLabelSelectColor,_labelFont:Q.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(H){0>H&&(H=0),H>1&&(H=1);var j=this,V=j._10I;j._10I=H,j.fp("columnPosition",V,H)},getPropertyName:function(y){return y.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(r,Z,g){return g===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(I,E){return E===this._selectRowIndex?this._labelSelectColor:I.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(q){var F=this.getHeight()-this._59I;return F>q&&(q=F),q>0?0:O(q)},isExpanded:function(A){if(!A)return!0;var n=this._26o[A];return n?n.isExpanded:!(this._26Q[A]===!1)},toggle:function(A){var N=this;N.isExpanded(A)?N.collapse(A):N.expand(A)},expandAll:function(){this.validate();for(var Z in this._26o)this.expand(Z)},expand:function(o){if(o&&o!==vj){var l=this,I=l._26o[o];I&&!I.isExpanded&&(I.isExpanded=!0,l.onExpanded(o),l.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var w in this._26o)this.collapse(w)},collapse:function(x){if(x&&x!==vj){var r=this,p=r._26o[x];p&&p.isExpanded&&(p.isExpanded=!1,r.onCollapsed(x),r.ivm())}},onCollapsed:function(){},getCategoryName:function(J){if(!this.isCategorizable())return vj;var T=J.getCategoryName();return T?T:vj},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(F){var G=this,v=G._dataModel;v!==F&&(v&&(v.umd(G.handlePropertyChange,G),G._selectionModel||v.sm().ums(G.handleSelectionChange,G)),G._dataModel=F,F.md(G.handlePropertyChange,G),G._selectionModel?G._selectionModel._21I(F):F.sm().ms(G.handleSelectionChange,G),G.fp(eh,v,F))},isVisible:function(Q){return this._visibleFunc?this._visibleFunc(Q):!0},onPropertyChanged:function(J){var K=this,r=J.property;bb[r]?K.ivm():K.iv(),r===yo&&K._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:gb},handlePropertyChange:function(U){this._27o===U.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var K=this;K._96I||(K.setSelectRowIndex(-1),K._96I=1,K.iv())},redraw:function(){this.iv()},validateModel:function(){var D=this,A=D._rows,L=D._28o,d={},m=new cb,B=D._27o;D.updateCurrentData(),B!==D._27o&&D.endEditing(),A.clear(),L.clear(),D.getRawProperties().each(function(g){if(D.isVisible(g)){m.add(g);var r=D.getCategoryName(g);d[r]||(L.add(r,r===vj?0:s),d[r]={isExpanded:D.isExpanded(r),properties:new cb})}}),D._sortFunc&&m.sort(D._sortFunc);for(var a in D._26o)D._26Q[a]=D.isExpanded(a);D._26o=d,L.each(function(z){z!==vj&&A.add(z);var Z=d[z];Z.isExpanded&&m.each(function(K){D.getCategoryName(K)===z&&(Z.properties.add(K),A.add({property:K,data:D._27o}))},D)})},validateImpl:function(){var j=this;j._76o(),j._96I&&(j.validateModel(),delete j._96I);var X=j._canvas,M=j.getWidth(),d=j.getHeight(),F=-j.ty(),R=j._rowHeight,a=j._indent,B=M-a,f=j._rows,l=f.size(),_=j._9I=a+B*j._10I,t=j._59I=l*R;Rj(X,M,d),j._29I={x:0,y:F,width:M,height:d},j._31I=S(F/R),j._14I=C((F+d)/R),j._31I<0&&(j._31I=0),j._14I>l&&(j._14I=l);var L,n=Lq(X),K=j._background;yq(n,0,-F,1),n.beginPath(),n.rect(0,F,M,d),n.clip(),n.clearRect(0,F,M,d),j._93db(n),K&&Re(n,0,0,a,t,K);for(var V=j._31I;V<j._14I;V++){var Y=f.get(V),F=R*V;if(fh(Y))K&&Re(n,a,F,B,R,K),L=_c(j.isExpanded(Y)?j._expandIcon:j._collapseIcon),L&&_n(n,L,Qo,0,F,a,R),n.save(),n.beginPath(),n.rect(a,F,B,R),n.clip(),j.drawCategoryName(n,Y,V,a,F,B,R),n.restore();else{var x=Y.property,i=Y.data,L=_c(x.getIcon()),I=j._selectRowIndex===V?j.getSelectBackground():N;if(L&&_n(n,L,Qo,0,F,a,R),I&&Re(n,a,F,B,R,I),n.save(),n.beginPath(),n.rect(a,F,_-a,R),n.clip(),j.drawPropertyName(n,x,V,a,F,_-a,R),n.restore(),!j.isEditing(i,x)){var s=_+1,H=M-_-1;n.save(),n.beginPath(),n.rect(s,F,H,R),n.clip(),j._87o(j.drawPropertyValue(n,x,j.getValue(i,x),V,s,F,H,R,i),V,s,F,H,R),n.restore()}}j._rowLineVisible&&Re(n,a,F+R-1,B,1,j._rowLineColor)}j._columnLineVisible&&(Re(n,_,0,1,t,j._columnLineColor),Re(n,M-1,0,1,t)),j._92db(n),j._93I(),n.restore(),j.ty(j.ty())},drawCategoryName:function(Y,Q,e,y,A,s,W){Xn(Y,Q,this.getCategoryFont(Q),this.getCategoryColor(Q),y,A,s,W)},drawPropertyName:function(X,B,e,l,F,D,U){return B.drawPropertyName?(B.drawPropertyName(X,B,e,l,F,D,U,this),void 0):(Xn(X,this.getPropertyName(B),this.getPropertyFont(B,e),this.getPropertyColor(B,e),l,F,D,U),void 0)},drawPropertyValue:function(a,O,_,c,z,d,R,t,u){return O.drawPropertyValue?O.drawPropertyValue(a,O,_,c,z,d,R,t,u,this):(xq(a,_,O,this.getLabelFont(O,_,c),this.getLabelColor(O,_,c),z,d,R,t,u,this),void 0)},isPropertyEditable:function(j){return j.isEditable()&&this.isEditable()},setProperties:function(y){this._propertyModel.clear(),this.addProperties(y)},addProperties:function(x){if(x){var A=this._propertyModel;x.forEach(function(o){if(!(o instanceof mm)){var r=Co(o.className);o=Ii(r?r:mm,o)}A.add(o)})}},getRowIndexAt:function(i){var t=this,O=S(t.lp(i).y/t._rowHeight);return O>=0&&O<t._rows.size()?O:-1},getPropertyAt:function(Y){var y=this,R=y.getRowIndexAt(Y);return R>=0?y._rows.get(R).property:N},getToolTip:function(F){var d=this,v=d.getPropertyAt(F),G=d._27o;return v&&G?v.getToolTip(G,d._9I<d.lp(F).x,d):N}});var rg=function(C){this.pv=C,this.addListeners()};Jl(rg,W,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(h){this.getView().style.cursor=h},clear:function(){var K=this;K._62O=K.cp=K.ty=K.p=N,K.setCursor(ro)},handle_mousedown:function(v){this.handle_touchstart(v)},handle_touchstart:function(t){var c=this,Q=c.pv;dc(t),Q.setFocus(t)&&(Gf(t)?(c.cp=Bb(t),c.ty=Q.ty(),c.p=Q.getColumnPosition(),c.handle_touchmove(t)):Q.setSelectRowIndex(Q.getRowIndexAt(t)))
},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(M){this.handle_touchend(M)},handle_touchend:function(u){var U=this;if(U.cp&&!U._62O){var p=U.pv,x=p.lp(u),Q=x.x,W=x.y,M=p._indent,K=p.getRowIndexAt(u),L=p._9I;if(K>=0){var N=p._rowHeight,P=N*K,n=p._rows.get(K),E=n.property;if(fh(n))_c(p.isExpanded(n)?p._expandIcon:p._collapseIcon)&&Q>=0&&M>=Q&&W>=P&&P+N>=W?p.toggle(n):Zh(u)&&p.toggle(n);else if(Q>L&&p.isPropertyEditable(E,u)){var z={x:L+1,y:P,width:p.getWidth()-L-1,height:N},y={x:z.x+p.tx(),y:z.y+p.ty(),width:z.width,height:z.height},b=0,C=p._29I;z.y<C.y?b=z.y-C.y:z.y+N>C.y+C.height&&(b=z.y+N-C.y-C.height),b&&(p.ty(p.ty()-b),y.y-=b),p.beginEditing({data:n.data,property:E,value:p.getValue(n.data,E),event:u,rect:z,editorRect:y,view:p})}}p.setSelectRowIndex(K)}U.clear()},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(G){var M=this,d=M.pv,x=M.ty,f=M.cp,y=Bb(G),j=M._62O;if("p"===j)d.setTranslateY(x+y.y-f.y);else if("c"===j){var q=d.getWidth()-d._indent;if(q>16){var T=M.p-(f.x-y.x)/q,R=16/q;R>T&&(T=R),T>1-R&&(T=1-R),d.setColumnPosition(T)}}else"s"===j&&d.setTranslateY(x+(f.y-y.y)*d._59I/d._29I.height)},handle_mousemove:function(h){this.handle_touchmove(h)},handle_touchmove:function(t){if(!Xe&&Gf(t)){var g=this,E=g.pv,s=c(E.lp(t).x-E._9I)<=(Ab?8:3);g.cp?g._62O||(s?(g._62O="c",pp(g)):c(Bb(t).y-g.cp.y)>=2&&(g._62O=g.isV(t)?"s":"p",pp(g))):(s?g.setCursor(bo):g.setCursor(ro),g.isV(t)&&E._43o())}},isV:function(k){var D=this.pv,f=D._29I;return D._41o()&&f.x+f.width-D.lp(k).x<ag},handle_mousewheel:function(m){this.handleScroll(m,m.wheelDelta/40)},handle_DOMMouseScroll:function(x){2===x.axis&&this.handleScroll(x,-x.detail)},handleScroll:function(F,e){var A=this.pv;dc(F),A.endEditing(),A.translate(0,e*A.getRowHeight())},handle_keydown:function(H){var m=this.pv,n=m._rows.size(),b=m._selectRowIndex+(Mg(H)?-1:1);(Mg(H)||Yk(H))&&(0>b&&(b=0),b>=n&&(b=n-1),m.setSelectRowIndex(b))}}),Ie.ListView=function(m){this._5o(m),new Pl(this)},Ke("ListView",W,{ms_ac:[Oh,Yb,md,pf,Bk,Bo,Si,Zi,Cq,cl,nl,gg,mc,En],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:qg,_rowHeight:Lh,_rowLineVisible:Q.listViewRowLineVisible,_rowLineColor:Q.listViewRowLineColor,_scrollBarColor:ap,_scrollBarSize:Xf,_autoMakeVisible:Il,_autoHideScrollBar:Cr,_selectBackground:Q.listViewSelectBackground,_labelColor:Q.listViewLabelColor,_labelSelectColor:Q.listViewLabelSelectColor,_labelFont:Q.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(p){var L=this,h=L._checkMode;L._checkMode=p,L.fp(of,h,p)},drawRow:function(U,T,P,d,D,K,G){var v=this,I=0,A=v._indent,j=v.getIconWidth(T);v.drawRowBackground(U,T,P,d,D,K,G),v._checkMode&&(Tp(U,_c(v.getCheckIcon(T)),I+A/2,D+G/2,T,v),I+=A),v.drawIcon(U,T,I,D,j,G),v.drawLabel(U,T,I+j,D,G)}});var Pl=function(m){this.list=m,this._lastSelectDataTime=gs(),this.addListeners()};Jl(Pl,W,{ms_listener:1,getView:function(){return this.list._view},clear:function(m){var O=this,x=O.list;m&&"d"===O._62O&&!O.dragCancel&&x.handleDragAndDrop(m,"end"),x.draggingData&&(x.draggingData=null,x.redraw()),O.dragCancel=O._62O=O._isV=O._isH=O.cp=O.tx=O.ty=N},handle_mousedown:function(U){this.handle_touchstart(U)},handle_touchstart:function(G){var c=this,i=c.list;if(dc(G),i.setFocus(G)){var w=i.getDataAt(G);c.cp=Bb(G),c.tx=i.tx(),c.ty=i.ty(),Gf(G)?w&&i.handleDragAndDrop&&!c.isV(G)&&!c.isH(G)&&(i.draggingData=w,i.redraw(),i.handleDragAndDrop(G,"prepare")):(w&&c._33o(G,w),c.clear(G))}},handleWindowMouseUp:function(M){this.clear(M)},handleWindowTouchEnd:function(V){this.clear(V)},handle_mouseup:function(J){this.handle_touchend(J)},handle_touchend:function(P){var R=this,_=R.list;if(!R._isV&&!R._isH&&R.cp&&!R._62O){var L=_.getDataAt(P);L?(_.isCheckMode()?R._34o(P,L):R._33o(P,L),Zh(P)?_.onDataDoubleClicked(L,P):_.onDataClicked(L,P)):_.handleBackgroundClick(P)}R.clear(P)},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(T){var E=this,X=E.list,Y=E._62O,x=E.tx,G=E.ty,b=E.cp,W=Bb(T),n=X._29I;"p"===Y?X.setTranslate(x+W.x-b.x,G+W.y-b.y):"v"===Y?X.ty(G+(b.y-W.y)*X._59I/n.height):"h"===Y?X.tx(x+(b.x-W.x)*X._91I/n.width):"d"===Y&&(E.dragCancel||X.handleDragAndDrop(T,"between"))},handle_mousemove:function(S){this.handle_touchmove(S)},handle_touchmove:function(U){if(!Xe&&Gf(U)){var R=this,h=R.list;if(R._isV=R.isV(U),R._isH=R.isH(U),R.cp){if(!R._62O){if(Df(Bb(U),R.cp)<2)return;R._isV?R._62O="v":R._isH?R._62O="h":h.draggingData&&!this.dragCancel?(R._62O="d",h.handleDragAndDrop(U,"begin")):R._62O="p",R._62O&&"d"!==R._62O&&h.draggingData&&(h.draggingData=null,h.redraw()),pp(R)}}else R._isV&&h._43o(),R._isH&&h._42o()}},isV:function(Z){var l=this.list,j=l._29I;return l._41o()&&j.x+j.width-l.lp(Z).x<ag},isH:function(U){var i=this.list,d=i._29I;return i._40o()&&d.y+d.height-i.lp(U).y<ag},handle_mousewheel:function(s){this.handleScroll(s,s.wheelDelta/40,s.wheelDelta!==s.wheelDeltaX)},handle_DOMMouseScroll:function(I){this.handleScroll(I,-I.detail,1)},handleScroll:function(U,G,L){var m=this.list;dc(U),m.endEditing&&m.endEditing(),L&&m._41o()?m.translate(0,G*m.getRowHeight()):m._40o()&&m.translate(10*G,0)},handle_keydown:function(s){if(!Q.isInput(s.target)){var G,W=this.list,h=W.sm(),d=W._rows,U=d.size();if(In(s))W.selectAll();else if(te(s))W.handleDelete&&W.handleDelete(s);else if($i(s))"d"!==this._62O||this.dragCancel||(W.handleDragAndDrop(s,"cancel"),this.dragCancel=!0);else if($n(s))W.isCheckMode()&&(G=W.getFocusData(),G&&W.checkData(G));else if(Mg(s)||Yk(s)){var N=W.isCheckMode();if(G=N?W.getFocusData():h.ld()){var J=W.getRowIndex(G);J>=0&&(Mg(s)?0!==J&&(G=d.get(J-1),N?W.setFocusData(G):h.ss(G)):J!==U-1&&(G=d.get(J+1),N?W.setFocusData(G):h.ss(G)))}else U>0&&(G=d.get(0),N?W.setFocusData(G):h.ss(G))}}},_34o:function(V,B){var e=this.list,a=e.lp(V).x;return a>=0&&a<=e._indent?(e.checkData(B),void 0):(e.setFocusData(B),void 0)},_33o:function(j,N){var n=this.list,g=n.sm(),X=g.ld();if(Vi(j))n.isSelected(N)?g.rs(N):g.as(N);else if(un(j))if(X)for(var x=n.getRowIndex(X),C=n.getRowIndex(N);x!==C;)x+=C>x?1:-1,g.as(n._rows.get(x));else g.ss(N);else if(Gf(j)){var f=gs();if(g.contains(N)){var b=f-this._lastSelectDataTime;n.handleDataDoubleSelect&&b>500&&1500>b&&n.handleDataDoubleSelect(j,N)}g.ss(N),this._lastSelectDataTime=f}else g.contains(N)||g.ss(N)}}),Ie.TreeView=function(S){var _=this;_._35o(),_._5o(S),new nh(_)},Ke("TreeView",W,{ms_ac:[Oh,Yb,md,"rootVisible",of,"rootData",Zi,Cq,cl,nl,gg,Bk,pf,Bo,Si,tj,sc,mc,En,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:N,_indent:qg,_rowHeight:Lh,_rowLineVisible:Q.treeViewRowLineVisible,_rowLineColor:Q.treeViewRowLineColor,_scrollBarColor:ap,_scrollBarSize:Xf,_autoHideScrollBar:Cr,_expandIcon:Q.treeViewExpandIcon,_collapseIcon:Q.treeViewCollapseIcon,_autoMakeVisible:Il,_selectBackground:Q.treeViewSelectBackground,_labelColor:Q.treeViewLabelColor,_labelSelectColor:Q.treeViewLabelSelectColor,_labelFont:Q.treeViewLabelFont,_doubleClickToToggle:Q.treeViewDoubleClickToToggle,drawRow:function(q,P,Z,f,G,n,R){var C=this;C.drawRowBackground(q,P,Z,f,G,n,R),C._97I(q,P,Z,0,G,n,R)},isOnToggleIcon:function(h){var Q=this.getDataAt(h);if(Q){var A=this.getIndent(),E=this.lp(h).x;if(_c(this.getToggleIcon(Q))){var S=A*this.getLevel(Q);if(E>=S&&S+A>=E)return!0}}return!1}});var nh=function(m){oj(nh,this,[m])};Jl(nh,Pl,{toggle:function(m,y,e,h){var _=this.list,E=_.lp(m).x;if(_c(_.getToggleIcon(y))){var p=e*h;if(E>=p&&p+e>=E)return _.toggle(y),!0}return _.isDoubleClickToToggle()&&Zh(m)?(_.toggle(y),!0):!1},_34o:function(c,g){var v=this.list,j=v.lp(c).x,K=v._levelMap[g._id],F=v._indent,W=F*(K+1);return j>=W&&W+F>=j?(v.checkData(g),void 0):(this.toggle(c,g,F,K)||v.setFocusData(g),void 0)},_33o:function(l,_){var d=this,M=d.list;d.toggle(l,_,M._indent,M.getLevel(_))||nh.superClass._33o.call(d,l,_)},handle_keydown:function(R){if(id(R)||$q(R)){var E=this.list,I=E._rows,s=E.isCheckMode(),g=E.sm(),V=s?E.getFocusData():g.ld();V?V.hasChildren()&&(id(R)?E.collapse(V):E.expand(V)):I.size()>0&&(V=I.get(0),s?E.setFocusData(V):g.ss(V))}else nh.superClass.handle_keydown.call(this,R)}});var hf=Ie.TableView=function(b){this._98I(),this._5o(b),new dk(this)};Ke("TableView",W,{ms_ac:[Oh,Yb,md,"sortMode",yh,Oq,pf,Bo,Si,Wc,cd,"sortColumn",Zi,Cq,cl,nl,gg,mc,En],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:jn,_editable:!0,_batchEditable:!1,_rowHeight:Lh,_rowLineVisible:Q.tableViewRowLineVisible,_rowLineColor:Q.tableViewRowLineColor,_columnLineVisible:Q.tableViewColumnLineVisible,_columnLineColor:Q.tableViewColumnLineColor,_scrollBarColor:ap,_scrollBarSize:Xf,_autoHideScrollBar:Cr,_autoMakeVisible:Il,_selectBackground:Q.tableViewSelectBackground,_labelColor:Q.tableViewLabelColor,_labelSelectColor:Q.tableViewLabelSelectColor,_labelFont:Q.tableViewLabelFont,getCheckColumn:function(){var O=this;if(!O._31o){var D=O._31o=new $h;D.setEditable(!0),D.setWidth(40),D.getValue=O.getCheckColumValue,D.drawCell=O.drawCheckColumnCell}return O._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(L){var E=this,Y=E._39o,d=E.getCheckColumn();L!==E.isCheckMode()&&(L?Y.add(d,0):Y.remove(d),E.fp(of,!L,L))},getCheckColumValue:function(u,w,g){return g.isSelected(u)},drawCheckColumnCell:function(o,d,_,b,E,c,B,Z,r){Tp(o,r.getCheckIcon(d),E+B/2,c+Z/2,d,r)}});var dk=function(p){oj(dk,this,[p])};Jl(dk,Pl,{_34o:function(n,x){var P=this.list,q=P._31o;if(P.isCellEditable(x,q,n)){var f=P._3Q(q),O=P.lp(n).x;if(f&&O>=f.startX&&O<f.startX+q.getWidth())return P.checkData(x),void 0}P._37O(x,n),P.setFocusData(x)},_33o:function(l,I){this.list._37O(I,l),dk.superClass._33o.apply(this,arguments)}});var Bi=Ie.TreeTableView=function(m){var N=this,$=N._4o=new $h;N._35o(),N._98I(),N._5o(m),$.setDisplayName("Name"),$.setEditable(!0),$.setWidth(180),$.drawCell=nd,$.getValue=Dc,N._39o.add($),new cm(N)},nd=function(l,v,S,j,L,g,O,r,k){k._97I(l,v,S,L,g,O,r)},Dc=function(B,J,d){return d.getLabel(B)};Ke("TreeTableView",W,{ms_ac:[Oh,Yb,md,"sortMode",yh,Oq,Bk,of,"rootData","rootVisible",Zi,Cq,"sortColumn",tj,sc,cl,nl,gg,mc,Si,pf,Bo,Wc,cd,En,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:jn,_checkMode:N,_editable:!0,_batchEditable:!1,_indent:qg,_rowHeight:Lh,_rowLineVisible:Q.treeTableViewRowLineVisible,_rowLineColor:Q.treeTableViewRowLineColor,_columnLineVisible:Q.treeTableViewColumnLineVisible,_columnLineColor:Q.treeTableViewColumnLineColor,_expandIcon:Q.treeTableViewExpandIcon,_collapseIcon:Q.treeTableViewCollapseIcon,_scrollBarColor:ap,_scrollBarSize:Xf,_autoHideScrollBar:Cr,_autoMakeVisible:Il,_selectBackground:Q.treeTableViewSelectBackground,_labelColor:Q.treeTableViewLabelColor,_labelSelectColor:Q.treeTableViewLabelSelectColor,_labelFont:Q.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var cm=function(E){oj(cm,this,[E])};Jl(cm,Pl,{_34o:function(G,y){var A=this.list,k=A._4o,U=A._3Q(k),f=A.lp(G).x;if(U){var O=A._indent,I=U.startX+O*A.getLevel(y);if(_c(A.getToggleIcon(y))&&f>=I&&I+O>=f)return A.toggle(y),void 0;if(A.isCellEditable(y,k)&&(I+=O,f>=I&&I+O>=f))return A.checkData(y),void 0}A._37O(y,G),A.setFocusData(y)},_33o:function(W,F){var l=this.list,S=l.lp(W).x;if(_c(l.getToggleIcon(F))){var i=l._3Q(l._4o);if(i){var Y=l._indent,C=i.startX+Y*l.getLevel(F);if(S>=C&&C+Y>=S)return l.toggle(F),void 0}}l._37O(F,W),cm.superClass._33o.apply(this,arguments)}});var Kl=Ie.TableHeader=function(w){var o=this,D=o._view=ge(1,o),d=o._39o=w.getColumnModel(),i=o.iv;o.tv=o._tableView=w,o._60I=new cb,o._canvas=Wq(D),D.style.background=Q.tableHeaderBackground||"",D.style.height=Dn+Dm,d.mm(i,o),d.md(i,o),d.mh(i,o),w.mp(function(h){_f[h.property]&&o.iv()},o),new Eo(o),o.iv()};Ke("TableHeader",W,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Oh,md,Bk,"moveBackground","insertColor",Wc,cd,"resizable","movable"],_checkIcon:Ar,_movable:!0,_resizable:!0,_labelColor:Q.tableHeaderLabelColor,_labelFont:Q.tableHeaderLabelFont,_columnLineColor:Q.tableHeaderColumnLineColor,_columnLineVisible:Q.tableHeaderColumnLineVisible,_sortDescIcon:Q.tableHeaderSortDescIcon,_sortAscIcon:Q.tableHeaderSortAscIcon,_moveBackground:Q.tableHeaderMoveBackground,_insertColor:Q.tableHeaderInsertColor,_indent:qg,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(j){return j.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(v){return v.getColor()||this._labelColor},getLabelAlign:function(B){return B._align},onPropertyChanged:function(){this.iv()},_5Q:function(e){this._61I=e,this.iv()},getLogicalPoint:function(W){return fq(W,this._canvas,this.tv.tx())},validateImpl:function(){var H=this,n=H._canvas,Q=H.getWidth(),v=H.getHeight(),x=H.tv,r=H._60I,M=H._61I,R=-x.tx(),q=0;(Q!==n.clientWidth||v!==n.clientHeight)&&Rj(n,Q,v),r.clear(),H._39o._roots.each(function(v){if(v.isVisible()){var M=q+v.getWidth();R+Q>=q&&M>=R&&r.add({column:v,startX:q}),q=M}});var w=Lq(n);if(yq(w,-R,0,1),w.beginPath(),w.rect(R,0,Q,v),w.clip(),w.clearRect(R,0,Q,v),r.each(function(c){var j=c.column,r=c.startX,P=j.getWidth();P>0&&(w.save(),w.beginPath(),w.rect(r,0,P,v),w.clip(),M&&M.column===j||H.drawColumn(w,j,r,0,P,v),H._columnLineVisible&&Re(w,r+P-1,0,1,v,H._columnLineColor),w.restore())}),M){var F=M.column,q=M.startX,f=M.position,g=F.getWidth();w.save(),w.beginPath(),w.rect(q,0,g,v),w.clip(),w.fillStyle=H._moveBackground,w.fill(),H.drawColumn(w,F,q,0,g,v),w.restore(),Zj(w,H._insertColor,f,0,v)}w.restore()},_6Q:function(f){var b=this.tv;return b._31o===f&&b.sm().getSelectionMode()===Tm},drawColumn:function(r,G,Z,p,I,Y){var i=this,F=i.tv,R=_c(G.getIcon()),z=i.getLabelAlign(G);if(i._6Q(G)){var U=_c(i._checkIcon);Tp(r,U,Z+I/2,p+Y/2,G,i)}else{var d=i.getLabel(G),V=i.getLabelFont(G),M=i.getLabelColor(G),$=Tn(V,d).width,T=R?i._indent:0;z===pc?(R&&_n(r,R,Qo,Z,p,T,Y),Xn(r,d,V,M,Z+T,p,I,Y,pc)):z===hl?(R&&_n(r,R,Qo,Z+I-$-T,p,T,Y),Xn(r,d,V,M,Z,p,I,Y,hl)):(R&&_n(r,R,Qo,Z+(I-$-T)/2,p,T,Y),Xn(r,d,V,M,Z+(I-$+T)/2,p,0,Y,pc))}if(G.isSortable()&&F.getSortColumn()===G&&(R=_c(G.getSortOrder()===Io?i._sortAscIcon:i._sortDescIcon))){var b=Uj(R,G)/2+2;Tp(r,R,z===hl?Z+b:Z+I-b,p+Y/2,G,F)}}});var Eo=function(t){var I=this;I.th=t,I.tv=t._tableView,I.addListeners()};Jl(Eo,W,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(T){this.getView().style.cursor=T},handle_mousemove:function(C){if(!Xe){var p=this;delete p._29o,p.setCursor(ro);for(var P=p.th,Q=P._60I,e=P.lp(C).x,V=Q.size()-1;V>=0;V--){var b=Q.get(V),N=b.column,v=b.startX+N.getWidth();if(P.isResizable()&&c(v-e)<=(Ab?10:3))return p._29o=b,p.setCursor(bo),void 0;e>b.startX&&v>e&&(p._29o=b),(N.isClickable()||N.isSortable()||P.isMovable()||p.tv.getCheckColumn&&N===p.tv.getCheckColumn())&&e>b.startX&&v>e&&p.setCursor(Rc)}}},handle_mousedown:function(x){this.handle_touchstart(x)},handle_touchstart:function(f){var E=this;dc(f),E.tv.endEditing(),E.handle_mousemove(f),E._29o&&(E.x=Bb(f).x,E.lx=E.th.lp(f).x,E.w=E._29o.column.getWidth(),pp(E,f))},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function(z){var P=this,V=P.th,a=P.getView().style.cursor,o=P._29o,q=Bb(z).x-P.x;if(P.resizing||P.moving||(a===bo?P.resizing=1:V.isMovable()&&a===Rc&&c(q)>2&&(P.moving=1)),P.resizing)o.column.setWidth(P.w+q);else if(P.moving){var d=P.lx+q;V._60I.each(function(D){var P=D.startX,A=P+D.column.getWidth();if(d>=P&&A>=d){var j={column:o.column,startX:o.startX+q,front:A-d>d-P,insertColumn:D.column};j.position=j.front?P:A,V._5Q(j)}})}},_16Q:function(l,Z){var B=this,U=B.tv,N=B.th,D=N._checkIcon;if(N._6Q(l)){var f=_c(D),y=B.lx,w=l.getWidth(),R=Uj(f,l);if(y>=Z+w/2-R&&Z+w/2+R>=y){N.setCheckIcon(D===Rh?Ar:Rh);var G=U.sm(),z=U._rows;return D===Rh?G.rs(z):G.ss(z),U.onCheckColumnClicked(l),!0}}return!1},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(J){var e=this,R=e.tv,K=e.th,b=e._29o;if(e.moving){var M=K._61I;if(M&&M.insertColumn!==M.column){var T=M.column,S=R.getColumnModel()._roots,I=S.remove(T),x=S.indexOf(M.insertColumn);x>=0&&(M.front||x++,x<=S.size()&&(S.add(T,x),R.getColumnModel()._38I(T,I,x)))}K._5Q(N),delete e.moving}else if(!e.resizing&&b){T=b.column;var X=K.lp(J).x,H=b.startX,m=!0;if(K.onColumnClicked){var o=K.onColumnClicked(T,J,H);o===!1&&(m=!1)}if(m&&X>=H&&X<=H+T.getWidth()&&!e._16Q(T,H)){if(T.isSortable()){var u=R.getSortMode(),C=T.getSortOrder();u===jn?R.getSortColumn()===T?(C===Ik&&R.setSortColumn(N),T.setSortOrder(C===Io?Ik:Io)):R.setSortColumn(T):"bistate"===u&&(R.getSortColumn()===T?T.setSortOrder(C===Io?Ik:Io):R.setSortColumn(T))}R.onColumnClicked(T,J,H)}}e._29o=e.resizing=e.x=e.lx=e.w=N}}),Ie.TablePane=function(q){this.init(new hf(q))},Ke("TablePane",W,{ms_v:1,_44o:1}),Ie.TreeTablePane=function(g){this.init(new Bi(g))},Ke("TreeTablePane",W,{ms_v:1,_44o:1}),Ie.Toolbar=function(e){var i=this,Y=i._view=ge(1,i),k=Y.style;k.background=Q.toolbarBackground||"",k.height=Ec+Dm,i._canvas=Wq(Y),i._30o=new cb,i._90I=new cb,i.setItems(e||[]),Y.handleGroupSelectedChanged=function(g){if(g.isSelected()){var j=g.getGroupId();null!=j&&i._items.forEach(function(C){var O=C.element;O&&O!==g&&O.setSelected&&O.getGroupId&&O.getGroupId()===j&&O.setSelected(!1)})}},new Am(i)},Ke("Toolbar",W,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Hi,Oh,md,Yb,En,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:Q.toolbarLabelColor,_labelSelectColor:Q.toolbarLabelSelectColor,_labelFont:Q.toolbarLabelFont,_selectBackground:Q.toolbarSelectBackground,_itemGap:Q.toolbarItemGap,_separatorColor:Q.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(m){var d=this.getItemInfoAt(m);return d?d.item.toolTip:N},getLabelColor:function(w){return w&&w.selected&&w.type!==Rh&&w.type!==Sk?this._labelSelectColor:this._labelColor},onPropertyChanged:function(K){this.iv(),K.property===Hi&&this._items.forEach(function(r){Ur(r)})},redraw:function(){this.iv()},addItem:function(A,X){var e=this._items;X==N?e.push(A):e.splice(X,0,A),this.fp(Hi,N,e)},removeItem:function(Z){if(Z)for(var d=this._items,E=0;E<d.length;E++)Z===d[E]&&(d.splice(E,1),this.fp(Hi,N,d))},removeItemById:function(k){if(k!=N)for(var n=this._items,b=0;b<n.length;b++)if(k===n[b].id){var V=n.splice(b,1)[0];return this.fp(Hi,N,n),V}},getItemById:function(A){if(A!=N)for(var v=this._items,K=0;K<v.length;K++){var j=v[K];if(A===j.id)return j}},setItemVisible:function(P,K){var Z=this.getItemById(P);Z&&(Z.visible=K)},getItemInfos:function(){return this._30o},getItemInfoAt:function(b){var W=this,H=0,$=W._30o,_=W.lp(b),c=_.x,B=_.y;if(B>=0&&B<=W.getHeight())for(;H<$.size();H++){var D=$.get(H);if(D.startX<=c&&c<=D.endX)return D}return N},drawItem:function(Y,P,T,l,Q){if(P.visible===!1)return 0;if(Wp(P.visible)&&!P.visible())return 0;var J=this,y=P.disabled;y&&(Y.globalAlpha=Fj);var X=J.drawItemImpl(Y,P,T,l,Q),S=J._itemGap;return y&&(Y.globalAlpha=1),this._currentItem!==P||"separator"===P||P.separator===!0||P.unfocusable||Tj(Y,J._separatorColor,T-S/2,0,X+S,l),X},drawItemImpl:function(f,L,F,K,p){var $=this,m=$._view,U=$._itemGap,c=K/2,R=L.type,s=L.element,i=L.label;fh(s)&&(i=s,s=N);var G,S=$.getLabelFont(L),w=$.getLabelColor(L),u=L.selected,q=_c(L.icon),D=Uj(q,L),I=0,a=D+(i?Tn(S,i).width:0);if("separator"===L||L.separator===!0)return Zj(f,$._separatorColor,F,K/4,c),1;if(s){q&&Tp(f,q,F+D/2,c,L,$),Xn(f,i,S,w,F+D,0,0,K);var T=oh(s);p||$._90I.add(T),T.parentNode!==m&&Mo(m,T),s.iv&&s.iv(),s.validate&&s.validate();var h=T.getBoundingClientRect(),Q=h.width,A=T.style;return Kh(T),A.left=$.tx()+F+a+Dm,A.top=(K-h.height)/2+Dm,a+Q}return R===Sk?G=_c(u?Hm:jd):R===Rh&&(G=_c(u?Rh:Ar)),G?(I=Uj(G,L),Tp(f,G,F+I/2,c,L,$),F+=I,a+=I):u&&Re(f,F-U/2,0,a+U,K,$.getSelectBackground(L)),q&&Tp(f,q,F+D/2,c,L,$),Xn(f,i,S,w,F+D,0,0,K),a},validateImpl:function(){var Y=this,f=Y._canvas,a=Y.getWidth(),d=Y.getHeight(),e=Y._30o,Q=Y._items;Rj(f,a,d);var T=Lq(f),g=Y._itemGap,R=g/2;yq(T,Y.tx(),0,1),T.clearRect(0,0,a,d);var K=Y._90I;Y._90I=new cb,e.clear(),Q.forEach(function(n){var p=Y.drawItem(T,n,R,d);e.add({item:n,startX:R,endX:R+p,width:p}),p&&(R+=p+g)}),K.each(function(P){Y._90I.contains(P)||Xr(P)});var X=Y._64I;Y._64I=E(0,R),T.restore(),Y._stickToRight?(Y._65O=0,T=Lq(f),R=a-Y._64I+g,yq(T,0,0,1),T.clearRect(0,0,a,d),e.clear(),Q.forEach(function(C){var y=Y.drawItem(T,C,R,d,!0);e.add({item:C,startX:R,endX:R+y,width:y}),y&&(R+=y+g)}),T.restore()):Y.tx(Y.tx()),X!==Y._64I&&Y.onSumWidthChanged(X,Y._64I)},onSumWidthChanged:function(){},handleClick:function(R,G){var b=this,$=R.type,p=R.action,f=R.groupId,z=R.selected;R.disabled||(f!=N?z||(R.selected=!0,this._items.forEach(function(v){v.groupId===f&&R!==v&&(v.selected=!1)}),p&&R.action(R,b,G)):$===Rh||"toggle"===$?(R.selected=!z,p&&R.action(R,b,G)):p&&R.action(R,b,G)),Fc(),b.iv()}});var Am=function(I){this.tb=I,this.addListeners()};Jl(Am,W,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(V){this.handleScroll(V,10*(V.wheelDelta/40))},handle_DOMMouseScroll:function(s){this.handleScroll(s,10*-s.detail)},handleScroll:function($,Y){dc($);var u=this.tb;u.isScrollable()&&!u._stickToRight&&(u.tx(u.tx()+Y),Ud())},handle_mousemove:function(o){var K=this;Xe||K.setItem(o)},handle_mouseout:function(L){var K=this;L.target===K.getView()?K.tb.setCurrentItem(N):K.handle_mousemove(L)},handle_mousedown:function(I){this.handle_mousemove(I),this.handle_touchstart(I)},handle_touchstart:function(D){var u=this,f=u.tb,U=D.target;Gf(D)&&(U===u.getView()||U===f._canvas)&&(dc(D),f.setFocus(D)&&(this.setItem(D,!0),(f.isScrollable()||u.info&&!u.info.item.disabled)&&(u.x=Bb(D).x,u.tx=f.tx(),pp(u,D))))},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(w){var q=this,T=q.tb;if(!T._stickToRight){var $=Bb(w).x-q.x;!q._25o&&c($)>2&&T.isScrollable()&&(q._25o=1),q._25o&&T.tx(q.tx+$)}},handleWindowMouseUp:function(P){this.handleWindowTouchEnd(P)},handleWindowTouchEnd:function(i){var s=this,V=s.tb,K=s.info,Y=s.tb.getItemInfoAt(i);if(!s._25o&&K){var l=K.item;Y&&Y.item===l&&V.handleClick(l,i)}s._25o=s.x=s.tx=N,s.setItem()},setItem:function(d,T){var F=this,Q=F.tb,k=F.info=d?Q.getItemInfoAt(d):N,I=k?k.item:N;Q.setCurrentItem(I),T&&I&&Wp(I.onDown)&&I.onDown(d)}}),Ie.BorderPane=function(){this._view=ge(1,this),this.iv()},Ke("BorderPane",W,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(O,F){this._12o("leftView",O),F!=N&&this.setLeftWidth(F)},getRightView:function(){return this._rightView},setRightView:function(B,h){this._12o("rightView",B),h!=N&&this.setRightWidth(h)},getTopView:function(){return this._topView},setTopView:function(F,T){this._12o("topView",F),T!=N&&this.setTopHeight(T)},getBottomView:function(){return this._bottomView},setBottomView:function(_,t){this._12o("bottomView",_),t!=N&&this.setBottomHeight(t)},getCenterView:function(){return this._centerView},setCenterView:function(V){this._12o("centerView",V)},_12o:function(B,V){var j=this,U="_"+B,a=j._view,q=j[U];q!==V&&(q&&(q.getView?Xr(q.getView()):Xr(q)),j[U]=V,V&&(V.getView?Mo(a,V.getView(),1):Mo(a,V,1)),j.fp(B,q,V))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var _=this,G=_._topView,n=_._bottomView,u=_._leftView,H=_._rightView,J=_._centerView,t=_.getWidth(),z=_.getHeight(),V=0,s=0,q=t,Q=z,A=0,F=0,Y=0,M=0;G&&(A=_._topHeight==N?Ir(G):_._topHeight,s=A),n&&(F=_._bottomHeight==N?Ir(n):_._bottomHeight,Q=z-F),u&&(Y=_._leftWidth==N?dd(u):_._leftWidth,V=Y),H&&(M=_._rightWidth==N?dd(H):_._rightWidth,q=t-M);var a=E(0,q-V),h=E(0,Q-s);G&&Zd(G,0,0,t,A),n&&Zd(n,0,Q,t,F),u&&Zd(u,0,s,Y,h),H&&Zd(H,q,s,M,h),J&&Zd(J,V,s,a,h)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);